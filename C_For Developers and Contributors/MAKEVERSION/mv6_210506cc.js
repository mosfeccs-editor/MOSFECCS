function kf(da){var ua=0;return function(){return ua<da.length?{done:!1,value:da[ua++]}:{done:!0}}}function Hf(da){var ua="undefined"!=typeof Symbol&&Symbol.iterator&&da[Symbol.iterator];return ua?ua.call(da):{next:kf(da)}}function Ch(da){da=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,da];for(var ua=0;ua<da.length;++ua){var Va=da[ua];if(Va&&Va.Math==Math)return Va}return globalThis}
var Yi=Ch(this),Zi="function"==typeof Object.defineProperties?Object.defineProperty:function(da,ua,Va){da!=Array.prototype&&da!=Object.prototype&&(da[ua]=Va.value)};function $i(da,ua){if(ua){var Va=Yi;da=da.split(".");for(var Lb=0;Lb<da.length-1;Lb++){var cc=da[Lb];cc in Va||(Va[cc]={});Va=Va[cc]}da=da[da.length-1];Lb=Va[da];ua=ua(Lb);ua!=Lb&&null!=ua&&Zi(Va,da,{configurable:!0,writable:!0,value:ua})}}
$i("Promise",function(da){function ua(bb){this.V=0;this.qa=void 0;this.w=[];var Vb=this.da();try{bb(Vb.resolve,Vb.reject)}catch(Qc){Vb.reject(Qc)}}function Va(){this.w=null}function Lb(bb){return bb instanceof ua?bb:new ua(function(Vb){Vb(bb)})}if(da)return da;Va.prototype.V=function(bb){if(null==this.w){this.w=[];var Vb=this;this.da(function(){Vb.qa()})}this.w.push(bb)};var cc=Yi.setTimeout;Va.prototype.da=function(bb){cc(bb,0)};Va.prototype.qa=function(){for(;this.w&&this.w.length;){var bb=this.w;
this.w=[];for(var Vb=0;Vb<bb.length;++Vb){var Qc=bb[Vb];bb[Vb]=null;try{Qc()}catch(bd){this.la(bd)}}}this.w=null};Va.prototype.la=function(bb){this.da(function(){throw bb;})};ua.prototype.da=function(){function bb(bd){return function(qe){Qc||(Qc=!0,bd.call(Vb,qe))}}var Vb=this,Qc=!1;return{resolve:bb(this.Sa),reject:bb(this.la)}};ua.prototype.Sa=function(bb){if(bb===this)this.la(new TypeError("A Promise cannot resolve to itself"));else if(bb instanceof ua)this.Ta(bb);else{a:switch(typeof bb){case "object":var Vb=
null!=bb;break a;case "function":Vb=!0;break a;default:Vb=!1}Vb?this.Ra(bb):this.Aa(bb)}};ua.prototype.Ra=function(bb){var Vb=void 0;try{Vb=bb.then}catch(Qc){this.la(Qc);return}"function"==typeof Vb?this.Ua(Vb,bb):this.Aa(bb)};ua.prototype.la=function(bb){this.Ba(2,bb)};ua.prototype.Aa=function(bb){this.Ba(1,bb)};ua.prototype.Ba=function(bb,Vb){if(0!=this.V)throw Error("Cannot settle("+bb+", "+Vb+"): Promise already settled in state"+this.V);this.V=bb;this.qa=Vb;this.Ya()};ua.prototype.Ya=function(){if(null!=
this.w){for(var bb=0;bb<this.w.length;++bb)Uc.V(this.w[bb]);this.w=null}};var Uc=new Va;ua.prototype.Ta=function(bb){var Vb=this.da();bb.Ca(Vb.resolve,Vb.reject)};ua.prototype.Ua=function(bb,Vb){var Qc=this.da();try{bb.call(Vb,Qc.resolve,Qc.reject)}catch(bd){Qc.reject(bd)}};ua.prototype.then=function(bb,Vb){function Qc(Ne,lf){return"function"==typeof Ne?function(Rg){try{bd(Ne(Rg))}catch(Sg){qe(Sg)}}:lf}var bd,qe,Tg=new ua(function(Ne,lf){bd=Ne;qe=lf});this.Ca(Qc(bb,bd),Qc(Vb,qe));return Tg};ua.prototype.catch=
function(bb){return this.then(void 0,bb)};ua.prototype.Ca=function(bb,Vb){function Qc(){switch(bd.V){case 1:bb(bd.qa);break;case 2:Vb(bd.qa);break;default:throw Error("Unexpected state: "+bd.V);}}var bd=this;null==this.w?Uc.V(Qc):this.w.push(Qc)};ua.resolve=Lb;ua.reject=function(bb){return new ua(function(Vb,Qc){Qc(bb)})};ua.race=function(bb){return new ua(function(Vb,Qc){for(var bd=Hf(bb),qe=bd.next();!qe.done;qe=bd.next())Lb(qe.value).Ca(Vb,Qc)})};ua.all=function(bb){var Vb=Hf(bb),Qc=Vb.next();
return Qc.done?Lb([]):new ua(function(bd,qe){function Tg(Rg){return function(Sg){Ne[Rg]=Sg;lf--;0==lf&&bd(Ne)}}var Ne=[],lf=0;do Ne.push(void 0),lf++,Lb(Qc.value).Ca(Tg(Ne.length-1),qe),Qc=Vb.next();while(!Qc.done)})};return ua});function aj(){aj=function(){};Yi.Symbol||(Yi.Symbol=bj)}function cj(da,ua){this.w=da;Zi(this,"description",{configurable:!0,writable:!0,value:ua})}cj.prototype.toString=function(){return this.w};
var bj=function(){function da(Va){if(this instanceof da)throw new TypeError("Symbol is not a constructor");return new cj("jscomp_symbol_"+(Va||"")+"_"+ua++,Va)}var ua=0;return da}();function ck(){aj();var da=Yi.Symbol.iterator;da||(da=Yi.Symbol.iterator=Yi.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[da]&&Zi(Array.prototype,da,{configurable:!0,writable:!0,value:function(){return dk(kf(this))}});ck=function(){}}
function dk(da){ck();da={next:da};da[Yi.Symbol.iterator]=function(){return this};return da}function ek(){this.la=!1;this.w=null;this.Ba=void 0;this.V=1;this.Aa=0;this.da=null}function fk(da){if(da.la)throw new TypeError("Generator is already running");da.la=!0}ek.prototype.qa=function(da){this.Ba=da};function ml(da,ua){da.da={Va:ua,Wa:!0};da.V=da.Aa}ek.prototype.return=function(da){this.da={return:da};this.V=this.Aa};function nl(da,ua){da.V=2;return{value:ua}}
function ol(da){this.w=new ek;this.V=da}function pl(da,ua){fk(da.w);var Va=da.w.w;if(Va)return ql(da,"return"in Va?Va["return"]:function(Lb){return{value:Lb,done:!0}},ua,da.w.return);da.w.return(ua);return rl(da)}function ql(da,ua,Va,Lb){try{var cc=ua.call(da.w.w,Va);if(!(cc instanceof Object))throw new TypeError("Iterator result "+cc+" is not an object");if(!cc.done)return da.w.la=!1,cc;var Uc=cc.value}catch(bb){return da.w.w=null,ml(da.w,bb),rl(da)}da.w.w=null;Lb.call(da.w,Uc);return rl(da)}
function rl(da){for(;da.w.V;)try{var ua=da.V(da.w);if(ua)return da.w.la=!1,{value:ua.value,done:!1}}catch(Va){da.w.Ba=void 0,ml(da.w,Va)}da.w.la=!1;if(da.w.da){ua=da.w.da;da.w.da=null;if(ua.Wa)throw ua.Va;return{value:ua.return,done:!0}}return{value:void 0,done:!0}}
function sl(da){this.next=function(ua){fk(da.w);da.w.w?ua=ql(da,da.w.w.next,ua,da.w.qa):(da.w.qa(ua),ua=rl(da));return ua};this.throw=function(ua){fk(da.w);da.w.w?ua=ql(da,da.w.w["throw"],ua,da.w.qa):(ml(da.w,ua),ua=rl(da));return ua};this.return=function(ua){return pl(da,ua)};ck();this[Symbol.iterator]=function(){return this}}
function tl(da){function ua(Lb){return da.next(Lb)}function Va(Lb){return da.throw(Lb)}return new Promise(function(Lb,cc){function Uc(bb){bb.done?Lb(bb.value):Promise.resolve(bb.value).then(ua,Va).then(Uc,cc)}Uc(da.next())})}$i("globalThis",function(da){return da||Yi});$i("Object.is",function(da){return da?da:function(ua,Va){return ua===Va?0!==ua||1/ua===1/Va:ua!==ua&&Va!==Va}});
$i("Array.prototype.includes",function(da){return da?da:function(ua,Va){var Lb=this;Lb instanceof String&&(Lb=String(Lb));var cc=Lb.length;Va=Va||0;for(0>Va&&(Va=Math.max(Va+cc,0));Va<cc;Va++){var Uc=Lb[Va];if(Uc===ua||Object.is(Uc,ua))return!0}return!1}});
$i("String.prototype.includes",function(da){return da?da:function(ua,Va){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(ua instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(ua,Va||0)}});
$i("Math.hypot",function(da){return da?da:function(ua){if(2>arguments.length)return arguments.length?Math.abs(arguments[0]):0;var Va,Lb,cc;for(Va=cc=0;Va<arguments.length;Va++)cc=Math.max(cc,Math.abs(arguments[Va]));if(1E100<cc||1E-100>cc){if(!cc)return cc;for(Va=Lb=0;Va<arguments.length;Va++){var Uc=Number(arguments[Va])/cc;Lb+=Uc*Uc}return Math.sqrt(Lb)*cc}for(Va=Lb=0;Va<arguments.length;Va++)Uc=Number(arguments[Va]),Lb+=Uc*Uc;return Math.sqrt(Lb)}});
$i("Array.prototype.fill",function(da){return da?da:function(ua,Va,Lb){var cc=this.length||0;0>Va&&(Va=Math.max(0,cc+Va));if(null==Lb||Lb>cc)Lb=cc;Lb=Number(Lb);0>Lb&&(Lb=Math.max(0,cc+Lb));for(Va=Number(Va||0);Va<Lb;Va++)this[Va]=ua;return this}});$i("Number.isFinite",function(da){return da?da:function(ua){return"number"!==typeof ua?!1:!isNaN(ua)&&Infinity!==ua&&-Infinity!==ua}});$i("Number.isInteger",function(da){return da?da:function(ua){return Number.isFinite(ua)?ua===Math.floor(ua):!1}});
$i("Math.sign",function(da){return da?da:function(ua){ua=Number(ua);return 0===ua||isNaN(ua)?ua:0<ua?1:-1}});
window.drawCanvas=function(da,ua,Va,Lb,cc){function Uc(){Cb.addEventListener("mousedown",dj,!1);Cb.addEventListener("mousemove",gk,!1);Cb.addEventListener("touchstart",lf,!1);Cb.addEventListener("touchmove",Rg,!0);Cb.addEventListener("touchend",hk,!1);document.body.addEventListener("mouseup",ej,!1);document.body.addEventListener("touchcancel",Sg,!1);document.body.addEventListener("keydown",qe,!1);document.body.addEventListener("keypress",Tg,!1);document.body.addEventListener("keyup",Ne,!1);da||window.addEventListener("resize",
Vb(bd,100),!1)}function bb(){Cb.removeEventListener("mousedown",dj,!1);Cb.removeEventListener("mousemove",gk,!1);Cb.removeEventListener("touchstart",lf,!1);Cb.removeEventListener("touchmove",Rg,!0);Cb.removeEventListener("touchend",hk,!1);document.body.removeEventListener("mouseup",ej,!1);document.body.removeEventListener("touchcancel",Sg,!1);document.body.removeEventListener("keydown",qe,!1);document.body.removeEventListener("keypress",Tg,!1);document.body.removeEventListener("keyup",Ne,!1)}function Vb(a,
b){b=b||100;var c;return function(e){c&&clearTimeout(c);c=setTimeout(a,b,e)}}function Qc(a){return new Promise(function(b){return setTimeout(b,a)})}function bd(){var a=new Wc(0,0,0,0),b=screen.height;if(90===Math.abs(window.orientation))if(screen.width<screen.height){var c=screen.height;b=screen.width}else c=screen.width,b=screen.height;else c=screen.width;fj=c/window.innerWidth;1<h.length&&(Ac(),a=Rc(h,0,"s"));Jd=ua?90===Math.abs(window.orientation)?Va?.6:.71:1:da?.9>c/window.innerWidth?window.innerWidth/
c:1:1;da?ua?90===Math.abs(window.orientation)?(fc.width=1.4*c,fc.height=Va?1.18*b:Math.min(1.4*b,window.innerHeight),Cb.width=fc.width,Cb.height=fc.height-Oe.clientHeight-10,re.width=fc.width,re.height=Cb.height,se.width=fc.width,se.height=Cb.height,te.width=fc.width,te.height=fc.height,Oe.style.marginTop="5px"):(fc.width=1.6*c,fc.height=1.2*b,Cb.width=fc.width,Cb.height=fc.height-Oe.clientHeight-10,re.width=fc.width,re.height=Cb.height,se.width=fc.width,se.height=Cb.height,te.width=fc.width,te.height=
fc.height,Oe.style.marginTop="10px"):(fc.width=Math.max(window.innerWidth-10,Math.max(a.b+a.c+20,590)),re.width=fc.width,se.width=fc.width,Cb.width=fc.width,te.width=fc.width,90===Math.abs(window.orientation)?(fc.height=window.innerHeight,Cb.height=window.innerHeight-52):(fc.height=window.innerHeight-20,Cb.height=window.innerHeight-80),re.height=Cb.height,se.height=Cb.height,te.height=fc.height):(fc.width=Math.max(window.innerWidth-10,Math.max(a.b+a.c+20,590)),Cb.width=fc.width,re.width=fc.width,
se.width=fc.width,te.width=fc.width,fc.height=Math.max(window.innerHeight-10,Math.max(a.t+a.f+20,674)),Cb.height=Math.max(window.innerHeight-94-10,Math.max(a.t+a.f+20,596)),re.height=Cb.height,se.height=Cb.height,te.height=fc.height);dc.b=10;dc.t=42;dc.c=34*Jd;dc.f=503*Jd;wc.b=36*Jd+14;wc.t=38;wc.c=532*Jd;wc.f=36*Jd;Mb.b=10;Mb.t=Math.max(Cb.height-36*Jd-10,dc.t+dc.f+5);Mb.c=Dh?272*Jd:5;Mb.f=36*Jd;Dc.b=Dh?Mb.b+Mb.c+50:34*Jd+14;Dc.t=Mb.t+4;Dc.c=50;Dc.f=Mb.f-4;bf.t=36;bf.c=Cb.width-20;bf.f=Mb.t+Mb.f+
5-36-2;ta.b=34*Jd+14;ta.t=bf.t+36*Jd+12;ta.c=bf.c-dc.c-4;ta.f=bf.f-72*Jd-16;oa.b=ta.b+2*Ra;oa.t=ta.t+2*Ra;oa.c=ta.c-4*Ra;oa.f=ta.f-4*Ra;md.x=Dc.b+Dc.c+30;md.y=Dc.t+Dc.f/2-4;ce.x=Dc.b+Dc.c+80;ce.y=Dc.t+Dc.f/2-4;ik();Oe.style.top=String(Cb.height+4)+"px";da?(90===Math.abs(window.orientation)&&(mf.style.top="20px"),Oe.style.width=String(fc.width-10)+"px",Oe.style.left="10px"):(Oe.style.width=document.getElementById("svg")?"580px":"550px",Oe.style.height="40px",Oe.style.marginLeft=String(Mb.b)+"px");
Va&&ua&&(Be=.6,ul.style.transform="scale("+String(Be)+","+String(Be)+")");gj()}function qe(a){a.shiftKey&&(0===pb?(pb=10,document.getElementById("shift").className="shift selected"):1===pb&&(pb=11,document.getElementById("shift").className="shift selected"));a.altKey&&(0===pb?(pb=1,document.getElementById("alt").className="alt selected"):10===pb&&(pb=11,document.getElementById("alt").className="alt selected"));if(a.which&&8===a.which&&!1===Ug)if(a.stopPropagation(),a.preventDefault(),ue||0<tc.length){a=
tc.slice(0);if(0<ja.length&&0<a.length)for(var b=0;b<a.length;b++){for(var c=0;c<ja.length;c++)if(ja[c].I.includes(a[b])||ja[c].H.includes(a[b]))wg(c),c--;a.splice(b,1);b--}for(a=1;a<h.length;a++)h[a].s=0,tc.includes(h[a].t)&&(h[a].s=1);hj(1);Ac()}else ij()}function Tg(a){var b;a.charCode?b=a.charCode:b=a.keyCode;switch(b){case 113:ed(0);cd(0);break;case 99:ed(0);break;case 72:a=window.screenX;cc=window.open("help/MOSFECCS_Help.html","Structural Formula Editor Help","dependent=yes,scrollbars=yes,resizable=yes");
cc.resizeTo(900,900);cc.moveTo(a-cc.outerWidth-5,20);break;case 104:ed(1);break;case 79:case 111:case 101:ed(2);break;case 78:case 110:case 114:ed(3);break;case 83:case 115:ed(4);break;case 80:case 112:ed(5);break;case 70:case 102:ed(6);break;case 118:ed(7);break;case 98:ed(8);break;case 73:case 105:ed(9);break;case 88:case 120:ed(10);break;case 46:ed(11);break;case 43:case 89:ed(12);break;case 45:case 121:ed(13);break;case 49:cd(0);break;case 50:cd(1);break;case 116:cd(2);break;case 117:case 60:cd(3);
break;case 100:case 62:cd(4);break;case 51:cd(5);break;case 52:cd(6);break;case 53:cd(7);break;case 54:cd(8);break;case 55:Eh("7");cd(10);break;case 56:Eh("8");cd(10);break;case 57:Eh("9");cd(10);break;case 97:cd(9);break;case 119:cd(11);break;case 109:cd(12);break;case 76:case 108:cd(13);break;case 103:if("visible"===nf.style.visibility)return!1;Ac();a.preventDefault();jk();break;case 107:ti?(kk(0),ti=!1):(kk(1),ti=!0);break;case 69:Z.clearRect(ta.b+1,ta.t+1,ta.c-2,ta.f-2);Ac();ui();break;case 74:if(Vg=
Vg?!1:!0){if(a=Z,of(a),nd(),of(Wb),1!==O.length){if(2<=Oa.length)for(b=1;b<Oa.length;b++){var c=Oa[b].g;var e=Oa[b].h;var g=O[c].x;c=O[c].y;var f=O[e].x;e=O[e].y;var n=Oa[b].B;xg(a,g,c,f,e,n,Sd,"black")}for(b=1;b<O.length;b++)c=a,e=b,f=String(O[e].R),c.save(),c.font=String(I)+"pt Arial, Helvetica, sans-serif",c.fillStyle="magenta",g=h[e].x-.5*c.measureText(f).width,e=h[e].y+I/2,c.clearRect(g,e-I,c.measureText(f).width,I),c.fillText(f,g,e),c.restore();Wf=Xf=de=!1}}else ob(Z,0,!0);break;case 48:Pe=
Pe?!1:!0;!0===Pe&&(Vg=!1);ob(Z,0,!0);break;case 84:Pe=Pe?!1:!0;!0===Pe&&(Vg=!1);if(Pe){if(a=Z,of(a),nd(),of(Wb),1!==O.length){if(2<=Oa.length)for(b=1;b<Oa.length;b++)c=Oa[b].g,e=Oa[b].h,g=O[c].x,c=O[c].y,f=O[e].x,e=O[e].y,n=Oa[b].B,xg(a,g,c,f,e,n,Sd,"black");for(b=1;b<O.length;b++)lk(a,b,"black");if(0<Ha.length)for(b=0;b<Ha.length;b++)mk(a,b,"red");if(0<ja.length)for(b=0;b<ja.length;b++)nk(a,b,"black");Wf=Xf=de=!1}}else ob(Z,0,!0);break;case 63:cb=[];ok();a=0;if(0!==cb.length)for(nd();a<cb.length;)b=
String(a),A.save(),A.strokeStyle="red",A.strokeRect(cb[a].b,cb[a].t,cb[a].c,cb[a].f),A.fillStyle="red",A.font="14px sans-serif",A.fillText(b,cb[a].b+cb[a].c-yg,cb[a].t-4),A.restore(),a++;if(0!==cb.length){A.save();A.setLineDash([2,3]);for(a=0;a<cb.length;a++){c=cb[a].c/1.6;f=cb[a].f/1.6;e=cb[a].b+cb[a].c/2;n=cb[a].t+cb[a].f/2;b=0;g=c*f/Math.sqrt(c*c*Math.sin(Math.PI*b/180)*Math.sin(Math.PI*b/180)+f*f*Math.cos(Math.PI*b/180)*Math.cos(Math.PI*b/180));A.beginPath();A.strokeStyle="red";A.moveTo(e+g*Math.cos(Math.PI*
b/180),n-g*Math.sin(Math.PI*b/180));for(b=5;360>=b;b+=5)g=c*f/Math.sqrt(c*c*Math.sin(Math.PI*b/180)*Math.sin(Math.PI*b/180)+f*f*Math.cos(Math.PI*b/180)*Math.cos(Math.PI*b/180)),A.lineTo(e+g*Math.cos(Math.PI*b/180),n-g*Math.sin(Math.PI*b/180));A.stroke()}A.restore()}Td=pk();for(a=1;a<=Td;a++)Ud(a,String(a),"blue",!0,"s");Ac();break;case 33:gj();break;case 35:for(a=1;a<=Td;a++)Ud(a,String(a),"green",!0,"t")}}function Ne(a){if(16===a.which||18===a.which||!0===da&&0<pb&&0===a.which)pb=0,document.getElementById("shift").className=
"shift",document.getElementById("alt").className="alt"}function lf(a){a||(a=window.event);console.log("touchstart with "+a.touches.length+" fingers");2===a.touches.length?(Fh=!0,Wg=Math.hypot(a.targetTouches[0].pageX-a.targetTouches[1].pageX,a.targetTouches[0].pageY-a.targetTouches[1].pageY),console.log("pinchStart: distance="+If(Wg))):(a.preventDefault(),a.stopPropagation(),pd=(a.targetTouches[0].pageX-Cb.offsetLeft)/Be,qd=(a.targetTouches[0].pageY-Cb.offsetTop)/Be,gc(oa,pd,qd)&&(Ua=Wa=0,a=Bd(h,
X,pd,qd),0<a?(Wa=a,Ua=0,Yf(h[Wa].x,h[Wa].y),Ce=Wa):0>a?(Ua=-1*a,Wa=0,qk(Ua),Zf=Ua):Ua=Wa=0),dj())}function Rg(a){a||(a=window.event);!0===Fh&&2===a.touches.length?Xg=Math.hypot(a.targetTouches[0].pageX-a.targetTouches[1].pageX,a.targetTouches[0].pageY-a.targetTouches[1].pageY):(a.preventDefault(),pd=(a.targetTouches[0].pageX-Cb.offsetLeft)/Be,qd=(a.targetTouches[0].pageY-Cb.offsetTop)/Be,rk())}function Sg(a){pd=(a.changedTouches[0].pageX-Cb.offsetLeft)/Be;qd=(a.changedTouches[0].pageY-Cb.offsetTop)/
Be;Fh=!1;Wg=Xg=0}function hk(a){a||(a=window.event);0===a.touches.length&&Fh?(console.log("pinch ended with pinch_cur_dist="+If(Xg)),Xg<Wg?console.log("pinch"):Xg>Wg&&console.log("zoom"),Fh=!1,Wg=Xg=0):(pd=(a.changedTouches[0].pageX-Cb.offsetLeft)/Be,qd=(a.changedTouches[0].pageY-Cb.offsetTop)/Be,ej())}function dj(){Gh=!0;mb="";Db=pd;Eb=qd;if(gc(oa,Db,Eb)){Rb=Sb=0;vi=Db;wi=Eb;Ua=Wa=0;var a=Bd(h,X,Db,Eb);0<a?(Wa=a,Ua=0):0>a?(Ua=-1*a,Wa=0):Ua=Wa=0}Yg=!1}function gk(a){a||(a=window.event);pd=(a.pageX-
Cb.offsetLeft)/Be;qd=(a.pageY-Cb.offsetTop)/Be;rk()}function rk(){var a,b,c;var e=a=c=b=0;var g=-1,f=-1;var n=0;Sb=pd;Sb>oa.b+oa.c&&(Sb=oa.b+oa.c);Sb<oa.b&&(Sb=oa.b);Rb=qd;Rb>oa.t+oa.f&&(Rb=oa.t+oa.f);Rb<oa.t&&(Rb=oa.t);if(gc(ta,pd,qd)){"moveTree"!==mb&&"copyTree"!==mb&&"rotateTree"!==mb&&(e=Bd(h,X,pd,qd),g=0<Ha.length?sk(pd,qd):-1,f=0<ja.length?tk(pd,qd):-1);0<e?(Kd=e,Jf=0):0>e?(Jf=-1*e,Kd=0):Jf=Kd=0;-1<g?Kf=g:Kf=-1;-1<f?Zg=f:Zg=-1;Yg=Math.sqrt((Sb-vi)*(Sb-vi)+(Rb-wi)*(Rb-wi))>jj;if("moveAllMol"!==
mb&&"moveTree"!==mb&&"copyTree"!==mb&&"rotateTree"!==mb&&!ue&&Yg)if(0<Kd){if(0===Ce){var q=h[Kd].x;var y=h[Kd].y;Yf(h[Kd].x,h[Kd].y);Ce=Kd}}else if(0<Jf&&Jf!==Ua&&"provMeshDraw"!==mb&&"provChainDraw"!==mb&&"moveAtom"!==mb)0===Zf&&(qk(Jf),Zf=Jf);else if(-1<Kf){if(0>$g){var E=Ha[Kf].A,F=Ha[Kf].D,za=Ha[Kf].crv,Ja=f=g=e=0;0>E?(e=(h[X[-1*E].g].x+h[X[-1*E].h].x)/2,g=(h[X[-1*E].g].y+h[X[-1*E].h].y)/2):0<E&&(e=h[E].x,g=h[E].y);0>F?(f=(h[X[-1*F].g].x+h[X[-1*F].h].x)/2,Ja=(h[X[-1*F].g].y+h[X[-1*F].h].y)/2):
0<F&&(f=h[F].x,Ja=h[F].y);var ha=Vc(e,g,f,Ja);var Da=Math.sqrt((f-e)*(f-e)+(Ja-g)*(Ja-g));F=.8*ka/Da;E=-1*za*F*Da*Math.sin(Math.PI*ha/180);ha=-1*za*F*Da*Math.cos(Math.PI*ha/180);za=e+E;F=g+ha;E=f+E;ha=Ja+ha;A.save();da&&(A.fillStyle="rgba(0,255,0,0.4)",A.beginPath(),A.arc((za+E+e+f)/4+.25*(za-e),(F+ha+g+Ja)/4+.25*(F-g),3*Ra,0,2*Math.PI),A.fill());A.strokeStyle="green";A.La=1.5;A.beginPath();A.arc((za+E+e+f)/4+.25*(za-e),(F+ha+g+Ja)/4+.25*(F-g),4,0,2*Math.PI);A.stroke();A.restore();$g=Kf}}else if(-1<
Zg){if(0>Hh){e=Zg;g=(ja[e].T.x+ja[e].S.x)/2;f=(ja[e].T.y+ja[e].S.y)/2;A.save();da&&(A.fillStyle="LightGray",A.beginPath(),A.arc(g,f,3*Ra,0,2*Math.PI),A.fill());A.fillStyle="DarkGray";A.beginPath();A.arc(g,f,Ih,0,2*Math.PI);A.fill();A.restore();for(g=0;g<ja[e].I.length;g++)Ud(ja[e].I[g],"reactant","blue",!0,"t");for(g=0;g<ja[e].H.length;g++)Ud(ja[e].H[g],"product","green",!0,"t");Hh=Zg}}else 0<Ce&&(Ce=0,nd()),0<Zf&&(Zf=0,nd()),-1<$g&&($g=-1,nd()),-1<Hh&&(Hh=-1,nd());if(Gh){""===mb&&(e=Math.sqrt((Sb-
Db)*(Sb-Db)+(Rb-Eb)*(Rb-Eb)),pf=e>.5*Ra?!0:!1);if(pf&&""===mb&&0===Wa&&0===Ua&&1>=pb&&1<h.length&&gc(oa,Db,Eb)){if(1===tc.length&&Db>D.b+D.c/2-hc&&Db<D.b+D.c/2+hc&&Eb>D.t-2*hc&&Eb<D.t+2*hc){mb="rotateTree";return}if(0===uk(Db,Eb)&&0===pb)mb="spanSelRect",A.save(),A.clearRect(ta.b,ta.t,ta.c,ta.f),A.strokeStyle="magenta",A.setLineDash([2,3]),A.strokeRect(Db,Eb,Sb-Db,Rb-Eb),A.restore();else if(0<uk(Db,Eb)){$f(tc,1);De=Rc(h,1,"s");nd();A.save();A.strokeStyle="magenta";ob(A,1,!1);0===pb?kj="MOVE":1===
pb&&(kj="COPY");for(e=0;e<tc.length;e++)Ud(tc[e],kj,"magenta",!0,"t");Lf=A.getImageData(De.b-2,De.t-I,De.c+4,De.f+I+2);A.strokeRect(De.b,De.t,De.c,De.f);A.restore();Cd=De.b-2;Dd=De.t-I;0===pb?mb="moveSelMol":1===pb&&(mb="copySelMol")}}if(pf&&""===mb&&(0<Wa||0<Ua||ue&&1>=pb||1===h.length||!ue&&0<pb)){switch(!0){case 0===pb&&ue&&Db>D.b&&Db<D.b+D.c&&Eb>D.t&&Eb<D.t+D.f:0<Ua?n=X[Ua].g:0<Wa&&(n=Wa);if(0<Ua||0<Wa)xi(n),D=Rc(h,1,"s");ob(A,1,!1);A.save();A.lineWidth=1;A.setLineDash([2,3]);A.strokeRect(D.b,
D.t,D.c,D.f);Lf=A.getImageData(D.b,D.t,D.c,D.f);A.font="8pt sans-serif";A.fillStyle="magenta";A.fillText("MOVE",D.b,D.t-4);A.restore();Cd=D.b;Dd=D.t;mb="moveTree";return;case 1===pb&&(0<Wa||0<Ua):case 1===pb&&ue&&gc(D,Db,Eb):0<Ua?n=X[Ua].g:0<Wa&&(n=Wa);if(0<Wa||0<Ua)xi(n),D=Rc(h,1,"s");ob(A,1,!1);A.save();A.lineWidth=1;A.setLineDash([2,3]);A.strokeRect(D.b,D.t,D.c,D.f);Lf=A.getImageData(D.b,D.t,D.c,D.f);A.font="8pt sans-serif";A.fillStyle="magenta";A.fillText("COPY",D.b,D.t-4);A.restore();Cd=D.b;
Dd=D.t;mb="copyTree";break;case 10>pb&&0===Ua&&Ee&&(qf||cf):0<Wa?(q=Vd.indexOf(h[Wa].j),0>q||0===h[Wa].a.length?(mb="provBondDraw",ah=!0):(mb="",ah=!1)):(mb=1===h.length||1===pb%2?"provBondDraw":"",ah=!1);break;case 10>pb&&Fe&&0===Ua:mb="provChainDraw";0<Wa?(q=Vd.indexOf(h[Wa].j),0>q||0===h[Wa].a.length?(ag=h[Wa].x,bg=h[Wa].y,bh=!0):(mb="",bh=!1)):(1===h.length||1===pb%2?(ag=Db,bg=Eb):mb="",bh=!1);break;case 10>pb&&Qe&&0===Ua:mb="provMeshDraw";0<Wa?(q=Vd.indexOf(h[Wa].j),0>q||0===h[Wa].a.length?(b=
h[Wa].x,c=h[Wa].y,Mf=!0,zg=-1):(mb="",Mf=!1)):1===h.length||1===pb%2?(b=Db,c=Eb,Mf=!1,zg=-1):mb="";break;case 0===pb&&ve&&0<Ua:mb="provRingDraw";break;case 10===pb&&0<Wa:mb="moveAtom";break;case 10===pb&&0<Ua:Ed=Db;Fd=Eb;ch=!0;Zf=0;mb="moveBond";break;case 10===pb&&0===Wa&&0===Ua&&1<h.length:mb="moveAllMol";Ac();A.save();D=Rc(h,0,"s");ob(A,1,!1);A.lineWidth=1;A.strokeStyle="magenta";A.setLineDash([2,3]);A.strokeRect(D.b,D.t,D.c,D.f);Lf=A.getImageData(D.b,D.t,D.c,D.f);A.font="8pt sans-serif";A.fillStyle=
"magenta";A.fillText("MOVE ALL",D.b,D.t-4);A.restore();Cd=D.b;Dd=D.t;break;case 11===pb&&(0<Wa||0<Ua):0<Ua?n=X[Ua].g:0<Wa&&(n=Wa);if(0<Ua||0<Wa)xi(n),D=Rc(h,1,"s");ob(A,1,!1);A.save();A.lineWidth=1;A.setLineDash([2,3]);A.strokeRect(D.b,D.t,D.c,D.f);Lf=A.getImageData(D.b,D.t,D.c,D.f);A.font="8pt sans-serif";A.fillStyle="magenta";A.fillText("MOVE",D.b,D.t-4);A.restore();Cd=D.b;Dd=D.t;A.putImageData(Lf,Cd+10,Dd+10);mb="moveTree";break;case (16===Bb||17===Bb)&&(0<Wa||0<Ua):mb="provArrowDraw";a=Vc(Db,
Eb,Sb,Rb);dh=!1;0<Wa?(q=h[Wa].x,y=h[Wa].y):0<Ua&&(q=(h[X[Ua].g].x+h[X[Ua].h].x)/2,y=(h[X[Ua].g].y+h[X[Ua].h].y)/2);Ed=q;Fd=y;break;default:sb(),ob(Z,0,!0)}""===mb&&Ac()}if(Yg&&""!==mb)switch(mb){case "provBondDraw":ah||1!==h.length&&1!==pb%2?(q=h[Wa].x,y=h[Wa].y):(q=Db,y=Eb);Jh&&(vk(Wb,Ed,Fd,eh,fh,"erase"),Jh=!1);a=Vc(q,y,Sb,Rb);a=15*Math.floor(a/15);var ba=Math.cos(Math.PI*a/180)*ka;a=-1*Math.sin(Math.PI*a/180)*ka;gc(oa,q+ba,y+a)&&(vk(Wb,q,y,q+ba,y+a,"draw"),Ed=q,Fd=y,eh=q+ba,fh=y+a,Jh=!0);break;
case "provRingDraw":a=h[X[Ua].g].x;c=h[X[Ua].g].y;b=h[X[Ua].h].x;n=h[X[Ua].h].y;q=pd-(a+b)/2;y=qd-(c+n)/2;y=cg(b-a,n-c,q,y);4<Bb&&9>Bb||10===Bb?(10===Bb?ba=ie:ba=Bb-2,fd=Re(Wb,ba,Ua,"bond",y,"test"),!0===fd&&(Ag?(fd=Re(Wb,ba,Ua,"bond",y,"erase"),Ag=!1):(fd=Re(Wb,ba,Ua,"bond",y,"draw"),Ag=!0))):9===Bb&&(fd=Re(Wb,6,Ua,"bond",y,"test"),!0===fd&&(Ag?(fd=Re(Wb,6,Ua,"bond",y,"erase"),Ag=!1):(fd=Re(Wb,6,Ua,"bond",y,"draw"),Ag=!0)));Bg=y;break;case "moveAtom":0<Wa&&(Kh&&(wk(Wb,Wa,Ed,Fd,"erase"),Kh=!1),wk(Wb,
Wa,Sb,Rb,"draw"),Ed=Sb,Fd=Rb,Kh=!0);break;case "moveBond":0<Ua&&(ch&&(xk(Wb,Ua,Ed-Db,Fd-Eb,"erase"),ch=!1),xk(Wb,Ua,Sb-Db,Rb-Eb,"draw"),Ed=Sb,Fd=Rb,ch=!0);break;case "moveAllMol":ba=Sb-Db;q=Rb-Eb;gc(oa,Cd+ba+D.c,Dd+q+D.f)&&gc(oa,Cd+ba,Dd+q)&&(Cb.style.cursor="move",A.save(),A.fillStyle="white",A.fillRect(ta.b,ta.t,ta.c,ta.f),A.restore(),A.putImageData(Lf,Cd+ba,Dd+q),A.font="8pt sans-serif",A.fillStyle="magenta",A.fillText("MOVE ALL",Cd+ba,Dd+q-4),Ed=ba,Fd=q);break;case "moveSelMol":case "copySelMol":ba=
Sb-Db;q=Rb-Eb;gc(oa,Cd+ba+De.c,Dd+q+De.f)&&gc(oa,Cd+ba,Dd+q)&&(Cb.style.cursor="move",A.save(),A.fillStyle="white",A.fillRect(ta.b,ta.t,ta.c,ta.f),A.putImageData(Lf,Cd+ba,Dd+q),A.restore(),Ed=ba,Fd=q);break;case "moveTree":case "copyTree":y=new Wc(D.b+Sb-Db,D.t-hc-2+Rb-Eb,D.c,D.f+2*hc+2);lj(y,oa)?(ba=Sb-Db,q=Rb-Eb):(ba=Sb-Db,q=Rb-Eb,y.b<oa.b&&(ba=oa.b+4-Cd),y.t<oa.t+1&&(q=oa.t+hc+4-Dd),y.b+y.c>oa.b+oa.c&&(ba=oa.b+oa.c-4-D.c-Cd),y.t+y.f>oa.t+oa.f&&(q=oa.t+oa.f-D.f-4-Dd));Cb.style.cursor="move";A.save();
A.fillStyle="white";A.fillRect(bf.b,bf.t,bf.c,bf.f);A.restore();A.putImageData(Lf,Cd+ba,Dd+q);A.font="8pt sans-serif";A.fillStyle="magenta";"moveTree"===mb?A.fillText("MOVE",Cd+ba,Dd+q-4):A.fillText("COPY",Cd+ba,Dd+q-4);Ed=ba;Fd=q;break;case "rotateTree":A.save();A.fillStyle="white";A.fillRect(ta.b,ta.t,ta.c,ta.f);A.restore();xd=D.b+D.c/2;Wd=D.t+D.f/2;ba=Math.round(180*Math.atan2(Sb-xd,Wd-Rb)/Math.PI);A.save();A.translate(xd,Wd);A.rotate(Math.PI*ba/180);A.translate(-xd,-Wd);ob(A,1,!1);A.strokeStyle=
"magenta";A.fillStyle="magenta";A.beginPath();A.arc(xd,Wd,4,0,2*Math.PI);A.stroke();A.beginPath();A.arc(xd,Wd,2,0,2*Math.PI);A.fill();A.beginPath();A.strokeRect(xd-D.c/2,Wd-D.f/2,D.c,D.f);A.lineWidth="1";A.fillStyle="magenta";A.beginPath();A.moveTo(D.b+D.c/2-hc-4,D.t-hc-2);A.lineTo(D.b+D.c/2-hc+2,D.t-hc+6);A.lineTo(D.b+D.c/2-hc+4,D.t-hc-4);A.closePath();A.fill();A.beginPath();A.moveTo(D.b+D.c/2+hc-4,D.t-hc-4);A.lineTo(D.b+D.c/2+hc-2,D.t-hc+6);A.lineTo(D.b+D.c/2+hc+4,D.t-hc-2);A.closePath();A.fill();
A.lineWidth="1";A.beginPath();A.arc(xd,D.t-hc,hc,0,2*Math.PI);A.stroke();A.font="10pt sans-serif";A.fillStyle="magenta";A.fillText(String(ba)+"\u00b0",xd+hc+4,D.t-hc);A.restore();break;case "spanSelRect":if(gc(oa,Sb,Rb)){A.save();A.clearRect(oa.b,oa.t,oa.c,oa.f);if(0<tc.length)for(e=0;e<tc.length;e++)Ud(tc[e],"","magenta",!1,"t");D.b=Math.min(Db,Sb);D.t=Math.min(Eb,Rb);D.c=Math.abs(Db-Sb);D.f=Math.abs(Eb-Rb);A.strokeStyle="magenta";A.setLineDash([2,3]);A.strokeRect(Db,Eb,Sb-Db,Rb-Eb);A.restore();
Ge&&(A.fillStyle="magenta","reactant"===df?A.fillText("arrow start",D.b,D.t-8):"product"===df&&A.fillText("arrow end",D.b,D.t-8))}else A.clearRect(ta.b,ta.t,ta.c,ta.f),mb="";break;case "provChainDraw":ba=Math.sqrt((Sb-ag)*(Sb-ag)+(Rb-bg)*(Rb-bg));ba=Math.floor(ba/mj);y=Vc(ag,bg,Sb,Rb);q=15*Math.floor(y/15);y=7.5<y%15?1:-1;(ba!=Lh||Mh!=q||Nh!=y)&&1<=ba&&(Oh&&(yk(Wb,Lh,ag,bg,Mh,Nh,!0,"erase"),Oh=!1),yk(Wb,ba,ag,bg,q,y,!0,"draw"),Lh=ba,Mh=q,Nh=y,Oh=!0);break;case "provMeshDraw":0===wa.length&&(wa.push(new xc(b,
c)),yd=!1);1===wa.length&&(a=Vc(wa[wa.length-1].x,wa[wa.length-1].y,Sb,Rb),q=ia(30*Math.floor(a/30)),ba=ka*Math.cos(Math.PI*q/180),a=-1*ka*Math.sin(Math.PI*q/180),$b=wa[wa.length-1].x+ba,ac=wa[wa.length-1].y+a,gc(oa,$b,ac)?(q!=zg&&(!0===yd&&(we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,dg,eg,!0,"erase"),yd=!1),!1===yd&&(we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,$b,ac,!0,"prov"),dg=$b,eg=ac,zg=q,yd=!0)),ba=Math.sqrt((Sb-Db)*(Sb-Db)+(Rb-Eb)*(Rb-Eb)),ba>ka-Ra?(!0===yd&&(we(Wb,wa[wa.length-1].x,wa[wa.length-
1].y,dg,eg,!0,"erase"),yd=!1),ba=0<Ce?Kd:Bd(h,X,$b,ac),q=zk($b,ac),0<=q&&Yf(wa.x,wa.y),0<ba?(gh=ba,we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,$b,ac,!0,"prov"),yd=!0):0<=q?(Nf=q,we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,$b,ac,!0,"prov"),yd=!0):Nf=-1,wa.push(new xc($b,ac)),we(Wb,wa[wa.length-2].x,wa[wa.length-2].y,$b,ac,!0,"draw"),hh=Db,ih=Eb,rd=$b,sd=ac):($b=wa[wa.length-1].x,ac=wa[wa.length-1].y)):($b=wa[wa.length-1].x,ac=wa[wa.length-1].y));1<wa.length&&(!1===Mf&&(Z.font="12pt Calibri",Z.fillStyle=
"white",Z.fillText("C",wa[0].x-6,wa[0].y+6)),rd=wa[wa.length-1].x,sd=wa[wa.length-1].y,hh=wa[wa.length-2].x,ih=wa[wa.length-2].y,a=Vc(Sb,Rb,rd,sd),q=Vc(hh,ih,rd,sd),ba=ia(a-q),90>ba||270<ba?(yd&&we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,dg,eg,!0,"erase"),we(Wb,wa[wa.length-2].x,wa[wa.length-2].y,wa[wa.length-1].x,wa[wa.length-1].y,!0,"erase"),wa.pop()):(y=cg(rd-hh,sd-ih,Sb-rd,Rb-sd),q=0<y?ia(q-60):ia(q+60),ba=ka*Math.cos(Math.PI*q/180),a=-1*ka*Math.sin(Math.PI*q/180),$b=rd+ba,ac=sd+a,gc(oa,$b,ac)?
(q!=zg&&(!0===yd&&(we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,dg,eg,!0,"erase"),yd=!1),!1===yd&&(we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,$b,ac,!0,"prov"),dg=$b,eg=ac,zg=q,yd=!0)),ba=Math.sqrt((Sb-rd)*(Sb-rd)+(Rb-sd)*(Rb-sd)),ba>ka-Ra?(!0===yd&&(we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,dg,eg,!0,"erase"),yd=!1),ba=0<Ce?Kd:Bd(h,X,$b,ac),q=zk($b,ac),0<=q&&Yf(wa.x,wa.y),0<ba?(gh=ba,we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,$b,ac,!0,"prov"),yd=!0):0<=q?(Nf=q,we(Wb,wa[wa.length-1].x,wa[wa.length-1].y,
$b,ac,!0,"prov"),yd=!0):Nf=-1,wa.push(new xc($b,ac)),we(Wb,rd,sd,$b,ac,!0,"draw"),hh=rd,ih=sd,rd=$b,sd=ac):($b=rd,ac=sd)):($b=rd,ac=sd)));break;case "provArrowDraw":Ph=a,0!==eh&&0!==fh&&(a=Vc(eh,fh,Sb,Rb),-1<Ph&&0===rf&&(q=Math.cos(Math.PI*a/180),y=-1*Math.sin(Math.PI*a/180),ba=Math.cos(Math.PI*Ph/180),a=-1*Math.sin(Math.PI*Ph/180),rf=-1*cg(ba,a,q,y))),dh&&(Wb.clearRect(0,0,se.width,se.height),dh=!1),gc(oa,Sb,Rb)&&(ba=Wb,q=Ed,y=Fd,a=Sb,b=Rb,e=rf,g=Vc(q,y,a,b),c=ia(g-90*e),f=Math.sqrt((a-q)*(a-q)+
(b-y)*(b-y)),n=-.5*e*f*Math.sin(Math.PI*g/180),f=-.5*e*f*Math.cos(Math.PI*g/180),e=q+n,g=y+f,n=a+n,f=b+f,ba.save(),ba.lineWidth=Sd,ba.strokeStyle="magenta",ba.fillStyle="magenta",ba.beginPath(),ba.moveTo(q,y),ba.bezierCurveTo(e,g,n,f,a,b),ba.stroke(),ba.beginPath(),ba.moveTo(a,b),ba.lineTo(a-8*Math.cos(Math.PI*ia(c-30*rf)/180),b+8*Math.sin(Math.PI*ia(c-30*rf)/180)),16===Bb&&(ba.moveTo(a,b),ba.lineTo(a-8*Math.cos(Math.PI*ia(c+45*rf)/180),b+8*Math.sin(Math.PI*ia(c+45*rf)/180))),ba.stroke(),ba.restore(),
eh=Sb,fh=Rb,yi=rf,dh=!0)}}}else sb()}function ej(){function a(){df="reactant";je=[];He=[];tc=[];Ac();nd();sb();mb=""}var b=0,c=0,e=0,g=0,f=0,n=-1;c=-1;e=0;e="";b=0;g=1;b=0;b=1;b=g=-1;var q=b=0;q=[];var y=[];q=[];q=b=0;b={};b=new Wc(0,0,0,0);q=[];Gh=!1;ic=pd;rc=qd;if(""===mb||gc(oa,ic,rc))if(gc(bf,ic,rc))if(de=!1,da&&(gc(dc,ic,rc)||gc(wc,ic,rc)||gc(Mb,ic,rc)||gc(Dc,ic,rc))?18>Math.sqrt((ic-Db)*(ic-Db)+(rc-Eb)*(rc-Eb))&&(de=!0):Math.sqrt((ic-Db)*(ic-Db)+(rc-Eb)*(rc-Eb))<nj&&(de=!0),de&&gc(Dc,ic,rc))A.save(),
A.fillStyle="LightGrey",A.fillRect(Dc.b+2,Dc.t+2,Dc.c-4,Dc.f-4),A.restore(),setTimeout(function(){gj();pb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt"},100);else if(de&&Math.hypot(ic-md.x,rc-md.y)<md.r&&(A.save(),A.fillStyle="LightGray",A.beginPath(),A.arc(md.x,md.y,md.r-2,0,2*Math.PI),A.fill(),A.restore(),setTimeout(function(){Ak("in")},100)),de&&Math.hypot(ic-ce.x,rc-ce.y)<ce.r&&(A.save(),A.fillStyle="LightGray",A.beginPath(),A.arc(ce.x,ce.y,
ce.r-2,0,2*Math.PI),A.fill(),A.restore(),setTimeout(function(){Ak("out")},100)),de&&rc>ta.t+ta.f&&ic>Mb.b+Mb.c&&ic<Dc.b)vl();else if(de&&gc(dc,ic,rc))b=Math.floor((rc-dc.t)/(dc.f/14)),0>b&&(b=0),13<b&&(b=13),cd(b),(Fe||Qe||ee||ve)&&ed(0),Ac(),sb(),nd();else if(Dh&&de&&gc(Mb,ic,rc)&&(b=14+Math.floor((ic-Mb.b)/(Mb.c/8)),14>b&&(b=14),21<b&&(b=21),cd(b),ed(0)),de&&gc(wc,ic,rc))b=Math.floor((ic-wc.b)/(wc.c/14)),0>b&&(b=0),13<b&&(b=13),ed(b),Ac(),sb(),nd();else{if(gc(oa,ic,rc)){"moveTree"!==mb&&"copyTree"!==
mb&&"rotateTree"!==mb&&(f=Bd(h,X,ic,rc),n=sk(ic,rc),c=tk(ic,rc));0<f?(ib=f,zd=0):0>f?(zd=-1*f,ib=0):zd=ib=0;fg=sf=-1;-1<n&&(sf=n);-1<c&&(fg=c);Qh=Rh=Wf=Xf=!1;if(de){0<ib&&!1===pf&&(Xf=!0,g=Vd.indexOf(h[ib].j));0<zd&&!1===pf&&(Wf=!0);-1<sf&&!1===pf&&(Rh=!0);-1<fg&&!1===pf&&(Qh=!0);if(Xf){if(ee){if(0<ja.length&&(zi(h,X),dd.includes(ib)&&2<h[ib].a.length||!dd.includes(ib)&&1<h[ib].a.length))for(c=0;c<ja.length;c++)if(ja[c].I.includes(h[ib].t)||ja[c].H.includes(h[ib].t))wg(c),c--;Sh(h,X,ib,!0);Bc();sb();
ob(Z,0,!0);return}if(tf){if(Vd.includes(h[ib].j)){sb();return}if(14===Bb){for(e=q=0;e<h[ib].a.length;e++){b=h[ib].a[e].t;if(4===b||5===b)b=1;q+=b}h[ib].F<5-q&&3>=h[ib].F&&(h[ib].F+=1)}else 15===Bb&&0<h[ib].F&&--h[ib].F;Bc();sb();ob(Z,0,!0);return}if(ve){if(0<=g){sb();ob(Z,0,!0);return}if(4<Bb&&9>Bb||10===Bb){if(10===Bb)if(0<ie)b=ie;else{sb();return}else b=Bb-2;fd=Re(Wb,b,ib,"atom",1,"test");!0===fd&&jh(b,ib,1,"atom")}else 9===Bb&&(fd=Re(Wb,6,ib,"atom",1,"test"),!0===fd&&jh(-6,ib,1,"atom"));Bc();sb();
ob(Z,0,!0);return}if(qf&&h[ib].j!==Th[ke]){if(1===h[ib].u)for(c=0;c<h[ib].a.length;c++)--h[h[ib].a[c].p].G;h[ib].j=Th[ke];h[ib].u=Uh(Th[ke]);h[ib].F=0;if(1===h[ib].u)for(c=0;c<h[ib].a.length;c++)h[h[ib].a[c].p].G+=1,3<h[ib].a[c].t&&(b=Na(X,h[ib].a[c].p,ib),X[b].g===ib&&yc(h,X,b,1,!0));Bc();sb();ob(Z,0,!0);return}cf&&Ai("x");if(kh&&!Vd.includes(h[ib].j)){11===ke?h[ib].r=h[ib].r?!1:!0:12===ke?h[ib].o+=1:13===ke&&--h[ib].o;Bc();sb();ob(Z,0,!0);return}ob(Z,0,!0)}else if(Rh){if(0===pb&&-1<sf&&gc(oa,pd,
qd)&&ee){Bi(sf);Bc();sb();ob(Z,0,!0);return}if(0===pb&&-1<sf&&gc(oa,pd,qd)){Ha[sf].crv=0<Ha[sf].crv?-1:1;Bc();sb();ob(Z,0,!0);return}}else if(Qh){if(0===pb&&-1<fg&&gc(oa,pd,qd)&&ee){wg(fg);Bc();sb();ob(Z,0,!0);return}0===pb&&-1<fg&&gc(oa,pd,qd)&&21===Bb&&wl(fg)}else{if(Wf){if(10===pb&&0<zd&&gc(oa,pd,qd)){Cg(h,X,zd,1,!1);b=Rc(h,1,"s");lj(b,oa)||Cg(h,X,zd,-1,!1);for(c=1;c<h.length;c++)1===h[c].s&&uf(h,c);ob(Z,0,!0);oj();Ac();Bc();sb();da&&(qd=pd=0)}else{if(Ee)Bb+1!==X[zd].B?yc(h,X,zd,Bb+1,!0):(3===
Bb||4===Bb)&&yc(h,X,zd,-1,!0),Bc();else if(ee&&0<zd){if(0<ja.length&&(zi(h,X),!Xd(X,X[zd].g,X[zd].h)))for(c=0;c<ja.length;c++)if(ja[c].I.includes(h[X[zd].g].t)||ja[c].I.includes(h[X[zd].h].t)||ja[c].H.includes(h[X[zd].g].t)||ja[c].H.includes(h[X[zd].h].t))wg(c),c--;Bk(h,X,zd);Bc()}sb();ob(Z,0,!0)}return}ue&&1<h.length&&0===pb&&(ic<D.b+D.c/2+20&&ic>D.b+D.c/2-20&&rc<D.t+D.f+30&&rc>D.t+D.f&&pj(h,X,"y",1),ic<D.b+D.c+30&&ic>D.b+D.c&&rc<D.t+D.f/2+20&&rc>D.t+D.f/2-20&&pj(h,X,"x",1),Ac());if(Ee&&(qf||cf)&&
(1===h.length||1===pb%2)){f=ic;n=rc;fd=gc(oa,f,n);!0===fd&&(qf?e=Th[ke]:e="C",g=Of(h,e,f,n,!1),0<g&&cf&&Ai("x"));cf||(Bc(),ob(Z,0,!0));sb();return}if(ve&&(1===h.length||1===pb%2)){if(4<Bb&&9>Bb||10===Bb){if(10===Bb)if(0<ie)b=ie;else{sb();return}else b=Bb-2;fd=Re(Wb,b,0,"freespace",1,"test");!0===fd&&jh(b,0,1,"atom")}else 9===Bb&&(fd=Re(Wb,6,0,"freespace",1,"test"),!0===fd&&jh(-6,0,1,"atom"));Bc();sb();ob(Z,0,!0);return}nd()}nd();Ac()}if(pf){switch(mb){case "provBondDraw":ah||1!==h.length&&1!==pb%
2?(b=Wa,g=h[Wa].x,c=h[Wa].y):(b=Of(h,"C",Db,Eb,!1),g=Db,c=Eb);n=Vc(g,c,ic,rc);n=15*Math.floor(n/15);f=Math.cos(Math.PI*n/180)*ka;n=-1*Math.sin(Math.PI*n/180)*ka;f=g+f;n=c+n;if(gc(oa,f,n)){if(Ee&&(qf||cf)&&!Fe){if(0===ib)qf?e=Th[ke]:e="C",g=Of(h,e,f,n,!1),0<g&&(1===h[g].u&&1!==h[Wa].u&&(h[Wa].G+=1),xe(h,X,b,g,Bb+1),cf&&Ai("x"));else if(ib!=Wa)if(e=Vh(h,Wa,ib),0<=e)g=ib,Pf(h,X,Wa,ib,"+");else{if(3===Bb&&-1===h[ib].z||4===Bb&&1===h[ib].z){ob(Z,0,!0);sb();return}xe(h,X,Wa,ib,Bb+1);g=ib;if(0<ja.length&&
h[Wa].t!==h[ib].t)for(c=0;c<ja.length;c++)if(ja[c].I.includes(h[Wa].t)||ja[c].I.includes(h[ib].t)||ja[c].H.includes(h[Wa].t)||ja[c].H.includes(h[ib].t))wg(c),c--}else if(ib===Wa){ob(Z,0,!0);sb();return}ob(Z,0,!0);Bc();sb();return}}else{ob(Z,0,!0);sb();return}ob(Z,0,!0);Bc();sb();break;case "provChainDraw":xl(Lh,Db,Eb,Mh,Nh);bh=!1;ob(Z,0,!0);Bc();sb();mb="";break;case "provMeshDraw":yl(wa.length);Mf=!1;wa.length=0;ob(Z,0,!0);Bc();sb();mb="";break;case "provRingDraw":if(4<Bb&&9>Bb||10===Bb){if(10===
Bb)if(0<ie)b=ie;else{sb();return}else b=Bb-2;fd=Re(Wb,b,Ua,"bond",Bg,"test");!0===fd&&jh(b,Ua,Bg,"bond")}else 9===Bb&&(fd=Re(Wb,6,Ua,"bond",Bg,"test"),!0===fd&&jh(-6,Ua,Bg,"bond"));ob(Z,0,!0);Bc();sb();mb="";break;case "moveAtom":if(0<Kd&&Kd!==Wa){if(0!==h[Wa].z&&0!==h[Kd].z&&h[Kd].z!==h[Wa].z){ob(Z,0,!0);sb();return}Wh(Kd,Wa)}else h[Wa].x=Sb,h[Wa].y=Rb;Bc();ob(Z,0,!0);sb();mb="";break;case "moveBond":e=h[X[Ua].g].x+ic-Db;b=h[X[Ua].g].y+rc-Eb;f=h[X[Ua].h].x+ic-Db;n=h[X[Ua].h].y+rc-Eb;c=Bd(h,X,e,b);
g=Bd(h,X,f,n);0<c&&c!==X[Ua].g&&0<g&&g!==X[Ua].h&&0<=Vh(h,c,g)?zl(c,g,X[Ua].g,X[Ua].h):0<c&&c!==X[Ua].g?(h[X[Ua].h].x=f,h[X[Ua].h].y=n,Wh(c,X[Ua].g)):0<g&&g!==X[Ua].h?(h[X[Ua].g].x=e,h[X[Ua].g].y=b,Wh(g,X[Ua].h)):(h[X[Ua].g].x=e,h[X[Ua].g].y=b,h[X[Ua].h].x=f,h[X[Ua].h].y=n);Bc();ob(Z,0,!0);sb();mb="";break;case "moveAllMol":for(b=0;b<h.length;b++)h[b].x+=Ed,h[b].y+=Fd;if(0<ja.length)for(b=0;b<ja.length;b++)ja[b].T.x+=Ed,ja[b].T.y+=Fd,ja[b].S.x+=Ed,ja[b].S.y+=Fd;ob(Z,0,!0);Bc();sb();mb="";break;case "spanSelRect":f=
new Wc(Math.min(Db,ic),Math.min(Eb,rc),Math.abs(ic-Db),Math.abs(rc-Eb));e=!1;b=1;for(gg=[];b<h.length;)gc(f,h[b].x,h[b].y)&&(gg.push(b),e=!0),b++;if(0===gg.length){nd();sb();return}if(!Ge){Ck(gg);if(1===tc.length)xi(gg[0]),D=Rc(h,1,"s"),gc(ta,D.b,D.t-hc-2)&&gc(ta,D.b+D.c,D.t+D.f)?(ob(A,1,!1),A.save(),A.La="1",A.strokeRect(D.b,D.t,D.c,D.f),xd=D.b+D.c/2,Wd=D.t+D.f/2,A.lineWidth=da?2:1,A.strokeStyle="magenta",A.fillStyle="magenta",A.beginPath(),A.arc(xd,Wd,4,0,2*Math.PI),A.stroke(),A.beginPath(),A.arc(xd,
Wd,2,0,2*Math.PI),A.fill(),A.lineWidth="1",A.beginPath(),A.moveTo(D.b+D.c/2-hc-4,D.t-hc-2),A.lineTo(D.b+D.c/2-hc+2,D.t-hc+6),A.lineTo(D.b+D.c/2-hc+4,D.t-hc-4),A.closePath(),A.fill(),A.beginPath(),A.moveTo(D.b+D.c/2+hc-4,D.t-hc-4),A.lineTo(D.b+D.c/2+hc-2,D.t-hc+6),A.lineTo(D.b+D.c/2+hc+4,D.t-hc-2),A.closePath(),A.fill(),A.beginPath(),A.arc(xd,D.t-hc,hc,0,2*Math.PI),A.stroke(),A.beginPath(),A.moveTo(D.b+D.c/2,D.t+D.f),A.lineTo(D.b+D.c/2,D.t+D.f+30),A.stroke(),A.beginPath(),A.moveTo(D.b+D.c/2-20,D.t+
D.f+15),A.bezierCurveTo(D.b+D.c/2-20,D.t+D.f+5,D.b+D.c/2+20,D.t+D.f+5,D.b+D.c/2+20,D.t+D.f+15),A.bezierCurveTo(D.b+D.c/2+20,D.t+D.f+25,D.b+D.c/2-20,D.t+D.f+25,D.b+D.c/2-20,D.t+D.f+15),A.stroke(),A.beginPath(),A.moveTo(D.b+D.c/2+20,D.t+D.f+16),A.lineTo(D.b+D.c/2+16,D.t+D.f+24),A.lineTo(D.b+D.c/2+12,D.t+D.f+16),A.closePath(),A.fill(),A.beginPath(),A.strokeStyle="white",A.lineWidth="3",A.moveTo(D.b+D.c/2,D.t+D.f+15),A.lineTo(D.b+D.c/2,D.t+D.f+22),A.stroke(),A.fillStyle="magenta",A.font="10px Arial",
A.fillText("180\u00b0",D.b+D.c/2-10,D.t+D.f+38),A.beginPath(),A.moveTo(D.b+D.c,D.t+D.f/2),A.lineTo(D.b+D.c+30,D.t+D.f/2),A.strokeStyle="magenta",A.lineWidth="1",A.stroke(),A.beginPath(),A.moveTo(D.b+D.c+15,D.t+D.f/2-20),A.bezierCurveTo(D.b+D.c+5,D.t+D.f/2-20,D.b+D.c+5,D.t+D.f/2+20,D.b+D.c+15,D.t+D.f/2+20),A.bezierCurveTo(D.b+D.c+25,D.t+D.f/2+20,D.b+D.c+25,D.t+D.f/2-20,D.b+D.c+15,D.t+D.f/2-20),A.stroke(),A.beginPath(),A.moveTo(D.b+D.c+16,D.t+D.f/2+20),A.lineTo(D.b+D.c+24,D.t+D.f/2+16),A.lineTo(D.b+
D.c+16,D.t+D.f/2+12),A.closePath(),A.fill(),A.beginPath(),A.strokeStyle="white",A.lineWidth="3",A.moveTo(D.b+D.c+15,D.t+D.f/2),A.lineTo(D.b+D.c+22,D.t+D.f/2),A.stroke(),A.fillStyle="magenta",A.font="10px Arial",A.fillText("180\u00b0",D.b+D.c+32,D.t+D.f/2+3),A.restore(),ue=!0):A.clearRect(ta.b,ta.t,ta.c,ta.f),ue=!0;else if(1<tc.length){nd();for(b=0;b<tc.length;b++)Ud(tc[b],"","magenta",!1,"t");ue=!0}if(ee&&(ue||0<tc.length)){q=tc.slice(0);if(0<ja.length&&0<q.length)for(b=0;b<q.length;b++){for(c=0;c<
ja.length;c++)if(ja[c].I.includes(q[b])||ja[c].H.includes(q[b]))wg(c),c--;q.splice(b,1);b--}for(b=1;b<h.length;b++)h[b].s=0,tc.includes(h[b].t)&&(h[b].s=1);hj(1);Ac()}break}if(Ge&&e){if("reactant"===df){for(b=0;b<h.length;b++)h[b].s=0;tc=[]}b=Ck(gg);if(0<b)if("reactant"===df)A.clearRect(ta.b,ta.t,ta.c,ta.f),je=tc.slice(0),$f(je,1),Dk=Rc(h,1,"s"),A.clearRect(ta.b,ta.t,ta.c,ta.f),1===Bb-17?Ud(1,"reactant(s)","blue",!0,"s"):Ud(1,"arrow start","blue",!0,"s"),df="product";else if("product"===df)if(0<je.length&&
tc.length>je.length){He=tc.slice(je.length);if(0===He.length){a();sb();return}$f(He,2);Ek=Rc(h,2,"s");A.clearRect(ta.b,ta.t,ta.c,ta.f);1===Bb-17?(Ud(2,"reactant(s)","blue",!0,"s"),Ud(2,"product(s)","green",!0,"s")):(Ud(2,"arrow start","blue",!0,"s"),Ud(2,"arrow end","green",!0,"s"));A.restore();df="arrow"}else{a();sb();return}else{a();sb();return}else{a();sb();return}if("arrow"===df&&0<je.length&&0<He.length){A.clearRect(ta.b,ta.t,ta.c,ta.f);Ld=[];qj(je,He,Dk,Ek);1===Bb-17?(Ud(1,"reactant(s)","blue",
!0,"s"),Ud(2,"product(s)","green",!0,"s")):(Ud(1,"arrow start","blue",!0,"s"),Ud(2,"arrow end","green",!0,"s"));ja.push(new Ci(je,He,Bb-17,"","",Ld[0],Ld[1],Ld[2],Ld[3]));for(b=1;b<h.length;b++)1===h[b].s&&h[b].na.push(ja.length-1),2===h[b].s&&h[b].ma.push(ja.length-1),h[b].s=0;b=ja.length-1;b=0;df="reactant";je=[];He=[];tc=[];Ac();nd();Bc();ob(Z,0,!0)}}else if(Ge){a();sb();return}ee&&e&&(hj(1),Ac());if(!e){A.clearRect(ta.b,ta.t,ta.c,ta.f);a();sb();return}mb="";break;case "moveTree":case "moveSelMol":tc=
[];for(b=1;b<h.length;b++)1===h[b].s&&(h[b].x+=Ed,h[b].y+=Fd,tc.includes(h[b].t)||tc.push(h[b].t));if(0<ja.length){q=[];je=[];He=[];for(b=0;b<ja.length;b++)je=Xh(ja[b].I,tc),He=Xh(ja[b].H,tc),(0<je.length||0<He.length)&&q.push(b);if(0<q.length)for(b=0;b<q.length;b++)Fk(q[b])}A.clearRect(ta.b,ta.t,ta.c,ta.f);ob(Z,0,!0);oj();Ac();Bc();je=[];He=[];tc=[];sb();mb="";break;case "copyTree":case "copySelMol":q=[];y=[];f=h.length;n=X.length;for(b=0;b<f;b++)1===h[b].s&&(e=h.length,Yh(h,h,b,e),h[e].na=[],h[e].ma=
[],q.push(b),y.push(e),h[e].x=h[b].x+Ed,h[e].y=h[b].y+Fd);for(b=0;b<f;b++)if(1===h[b].s){e=c=-1;for(g=0;g<h[b].a.length;g++)e=h[b].a[g].p,c=q.indexOf(e),e=q.indexOf(b),-1<c&&-1<e&&(c=y[c],h[y[e]].a[g].p=c);e=c=-1;for(g=0;g<n;g++)if(X[g].g===b){var E=X.length;Zh(X,X,g,E);e=q.indexOf(b);X[E].g=y[e];c=q.indexOf(X[g].h);-1<c&&-1<e&&(X[E].h=y[c])}}A.clearRect(ta.b,ta.t,ta.c,ta.f);mb="";sb();ob(Z,0,!0);oj();Ac();Bc();break;case "rotateTree":e=ia(180*Math.atan2(ic-xd,Wd-rc)/Math.PI);for(b=1;b<h.length;b++)1===
h[b].s&&(n=ia(180*Math.atan2(h[b].x-xd,Wd-h[b].y)/Math.PI),c=Math.sqrt((h[b].x-xd)*(h[b].x-xd)+(h[b].y-Wd)*(h[b].y-Wd)),f=c*Math.sin(Math.PI*ia(n+e)/180),n=-c*Math.cos(Math.PI*ia(n+e)/180),h[b].x=xd+f,h[b].y=Wd+n);A.clearRect(ta.b,ta.t,ta.c,ta.f);b=Rc(h,1,"s");lj(b,oa)||ij();for(c=1;c<h.length;c++)1===h[c].s&&uf(h,c);ob(Z,0,!0);Bc();sb();mb="";Ac();break;case "provArrowDraw":b=Bd(h,X,ic,rc);q=Bd(h,X,Db,Eb);0!==q&&0!==b&&q!==b&&(0<q&&0<b&&(Vd.includes(h[b].j)||Vd.includes(h[q].j))||0>q&&(Vd.includes(h[X[Math.abs(q)].g].j)||
Vd.includes(h[X[Math.abs(q)].h].j))||0>b&&(Vd.includes(h[X[Math.abs(b)].g].j)||Vd.includes(h[X[Math.abs(b)].h].j))?(nd(),Ac()):(b=new Di(q,b,"",0),b.oa=16===Bb?"f":"h",b.crv=yi,Ha.push(b),Bc()));ob(Z,0,!0);sb();mb="";break;default:nd(),Ac()}sb()}}}else sb();else ob(Z,0,!0),sb()}function sb(){Cb.style.cursor="default";hg("erase");hg("mark");Qh=Rh=Wf=Xf=de=dh=Mf=yd=Oh=Jh=ch=Kh=!1;yi=rf=0;Gh=pf=Yg=!1;$g=-1;Kd=Zf=Ce=0;Kf=-1;Jf=ib=Ua=Wa=0;sf=-1;Wd=xd=Fd=Ed=zd=0;Bg=1}function Ac(){var a;for(a=0;a<h.length;a++)h[a].s=
0;tc=[];gg=[];ue=!1}function vk(a,b,c,e,g,f){"erase"===f?of(a):(a.save(),a.strokeStyle="magenta",a.lineWidth=Sd,gc(ta,e,g)&&(a.beginPath(),a.moveTo(b,c),a.lineTo(e,g),a.stroke()),a.restore())}function wk(a,b,c,e,g){var f;if("erase"===g)of(Wb);else{var n=Sd;for(f=0;f<h[b].a.length;){var q=h[b].a[f].p;var y=h[b].a[f].t;g=h[q].x;q=h[q].y;xg(a,g,q,c,e,y,n,"magenta");f++}}}function xk(a,b,c,e,g){var f;if("erase"===g)of(a);else{var n=Sd;g=X[b].g;var q=X[b].h;xg(a,h[g].x+c,h[g].y+e,h[q].x+c,h[q].y+e,X[b].B,
n,"magenta");b=Bd(h,X,h[g].x+c,h[g].y+e);var y=Bd(h,X,h[q].x+c,h[q].y+e);0<b&&b!==g&&b!==q&&0===y?(Yf(h[b].x,h[b].y),Ce=b):0<y&&y!==q&&y!==g&&0===b?(Yf(h[y].x,h[y].y),Ce=y):0<y&&0<b&&b!==g&&y!==q?(Yf(h[y].x,h[y].y),Yf(h[b].x,h[b].y)):0===b&&0===y&&0<Ce&&(Ce=0,nd());for(f=0;f<h[g].a.length;){if(h[g].a[f].p!==q){var E=h[g].a[f].p;y=h[g].a[f].t;b=h[E].x;E=h[E].y;xg(a,b,E,h[g].x+c,h[g].y+e,y,n,"magenta")}f++}for(f=0;f<h[q].a.length;)h[q].a[f].p!==g&&(E=h[q].a[f].p,y=h[q].a[f].t,b=h[E].x,E=h[E].y,xg(a,
b,E,h[q].x+c,h[q].y+e,y,n,"magenta")),f++}}function Re(a,b,c,e,g,f){var n=!1;var q=!0,y=[0,0,0,-.5*ka,-.5*ka,-.5*ka,0,0,0,0,0,0,0],E=[0,0,0,-.28868*ka,.5*ka,-.80902*ka,ka,0,0,0,0,0,0];var F=0<g?!0:!1;if("erase"===f){var za=Sd+2;var Ja="white"}else"draw"===f&&(za=Sd,Ja="magenta");if(!(1<h.length&&"atom"===e&&c!=ib)){0>b&&(ig=n=!0,b=Math.abs(b));var ha=b;"bond"===e&&(ha=b-1);g=360/b;var Da=(180-g)/2;var ba=Math.pow(-1,b)*Da;6===b&&(ba=90);if("freespace"===e&&"test"===f){var jb=Db+y[b];var Za=Eb+E[b]}if("atom"===
e){if(0<c&&2===h.length)jb=h[c].x,Za=h[c].y;else if(0<c&&1===h[c].a.length){jb=h[c].x;Za=h[c].y;n=h[c].a[0].p;var Aa=h[n].x;n=h[n].y;ba=Vc(Aa,n,jb,Za)}else if(0<c&&2===h[c].a.length&&!1===n)jb=h[c].x,Za=h[c].y,ba=lh(h,c);else return;Aa=c}"bond"===e&&0<X[c].B&&(e=X[c].g,Aa=X[c].h,jb=h[e].x,Za=h[e].y,ba=$a(h,e,Aa),Da=180-360/b,F||(Da*=-1,g*=-1));b=ia(ba-Da);rd=jb;sd=Za;"test"!==f&&(a.save(),a.lineWidth=za,a.strokeStyle=Ja,a.beginPath(),a.moveTo(rd,sd));for(za=0;za<ha-1;za++){Ja=ka*Math.cos(Math.PI*
b/180);c=-1*ka*Math.sin(Math.PI*b/180);$b=jb+Ja;ac=Za+c;if("test"===f){if(q=gc(oa,$b,ac),!1===q)return ig=!1,q}else a.lineTo($b,ac);b=ia(b+g);jb=$b;Za=ac;rd=$b;sd=ac}"test"!==f&&(a.lineTo(h[Aa].x,h[Aa].y),a.stroke(),a.restore());ig=!1;return q}}function we(a,b,c,e,g,f,n){a.save();"draw"===n?(a.lineWidth=Sd,a.strokeStyle="black",a.fillStyle="black"):"erase"===n?(a.lineWidth=Sd+2,a.strokeStyle="white",a.fillStyle="white"):"prov"===n&&(a.lineWidth=Sd,a.strokeStyle="magenta",a.fillStyle="magenta");a.beginPath();
a.moveTo(b,c);a.lineTo(e,g);a.stroke();if(f){f=Mf?String(wa.length-1):String(wa.length);var q=wa.length-1;if(wa.length>q&&0<q){var y=Vc(wa[q].x,wa[q].y,wa[q-1].x,wa[q-1].y);e=Vc(wa[q].x,wa[q].y,e,g);e=ia(rj(y,e)+180)}else e=1===wa.length&&0===q?270:-1;g=2===f.length?2*I:1.5*I;e=sj(g,e);a.font="12pt Calibri";"erase"===n?a.strokeText(f,tj,uj):"prov"===n&&(a.fillText(f,b+e.x-yg*f.length/2,c+e.y+I/2),tj=b+e.x-yg*f.length/2,uj=c+e.y+I/2)}a.restore()}function yk(a,b,c,e,g,f,n,q){var y;var E=1;var F=ka*
Math.cos(Math.PI*ia(g+E*f*30)/180);E=-ka*Math.sin(Math.PI*ia(g+E*f*30)/180);a.save();"draw"===q?(a.lineWidth=Sd,a.strokeStyle="magenta",a.fillStyle="magenta"):"erase"===q&&(a.lineWidth=Sd+2,a.strokeStyle="white",a.fillStyle="white");a.beginPath();a.moveTo(c,e);for(y=0;y<b;y++)a.lineTo(c,e),E=0===y%2?1:-1,F=ka*Math.cos(Math.PI*ia(g+E*f*30)/180),E=-ka*Math.sin(Math.PI*ia(g+E*f*30)/180),c+=F,e+=E;a.stroke();n&&(g=0>F?-8:4,0<Wa?y=b-1:y=b,a.font="12pt Calibri","erase"===q&&a.strokeText(y,c-F+g,e-E),a.fillText(y,
c-F+g,e-E));a.restore()}function xi(a){var b;for(b=0;b<h.length;b++)h[b].s=0;Nb=[];a=mh(h,a);for(b=0;b<a;b++)h[Nb[b]].s=1}function Ck(a){var b;for(b=0;b<a.length;b++)tc.includes(h[a[b]].t)||tc.push(h[a[b]].t);return tc.length}function Ud(a,b,c,e,g){A.save();D=Rc(h,a,g);A.strokeStyle=c;e&&A.setLineDash([2,3]);A.strokeRect(D.b,D.t,D.c,D.f);A.fillStyle=c;A.fillText(b,D.b,D.t-2);A.restore()}function Gk(a,b,c,e,g,f){var n;for(n=1;n<a.length;n++){if(-1===b||a[n].s===b)a[n].x=c+(a[n].x-c)*g,a[n].y=e+(a[n].y-
e)*g;f&&(a[n].s=0)}}function Hk(a,b,c,e){var g;if(0===a.length)return-1;for(g=0;g<a.length;g++)a[g].T.x=b+(a[g].T.x-b)*e,a[g].T.y=c+(a[g].T.y-c)*e,a[g].S.x=b+(a[g].S.x-b)*e,a[g].S.y=c+(a[g].S.y-c)*e}function Ik(a,b,c,e){var g;if(0===a.length)return-1;for(g=0;g<a.length;g++)a[g].b=b+(a[g].b-b)*e,a[g].t=c+(a[g].t-c)*e,a[g].c=a[g].c*e,a[g].f=a[g].f*e}function Ai(a){var b="";bb();nh=a;"x"===a?b="Enter Element Symbol:":"n"===a&&(b="Number of Atoms in ring:");document.getElementById("xheader").innerHTML=
b;oh.style.visibility="visible";oh.addEventListener("click",function(c){c.preventDefault()},!1);oh.addEventListener("mouseup",function(c){c.preventDefault()},!1);jg.focus();jg.value="";Al.addEventListener("click",function(c){var e=jg.value;c.preventDefault();"x"===nh?Jk(e):"n"===nh&&Eh(e);jg.value="";jg.blur();Uc();oh.style.visibility="hidden"},!1);oh.addEventListener("keypress",function(c){if(13===c.which){var e=jg.value;c.preventDefault();"x"===nh?Jk(e):"n"===nh&&Eh(e);jg.value="";jg.blur();Uc();
oh.style.visibility="hidden"}},!1)}function wl(a){bb();Dg.style.visibility="visible";ph.value=void 0===ja[a].fa?"":ja[a].fa;$h.value=void 0===ja[a].pa?"":ja[a].pa;ph.focus();Dg.addEventListener("click",function(b){b.preventDefault()},!1);Dg.addEventListener("mouseup",function(b){b.preventDefault()},!1);Kk.addEventListener("click",function e(c){Lk(a,ph.value+"|"+$h.value);c.preventDefault();ph.blur();$h.blur();Kk.removeEventListener("click",e,!1);Uc();Dg.style.visibility="hidden";Bc();sb();ob(Z,0,
!0)},!1);Dg.addEventListener("keypress",function g(e){13===e.which&&(Lk(a,ph.value+"|"+$h.value),e.preventDefault(),ph.blur(),$h.blur(),Dg.removeEventListener("keypress",g,!1),Uc(),Dg.style.visibility="hidden",Bc(),sb(),ob(Z,0,!0))},!1)}function Lk(a,b){var c=b.split("|");b=c[0];c=c[1];ja[a].fa=b?b.trim():"";ja[a].pa=c?c.trim():""}function jk(){function a(c){bb();Gd.rows=String(Math.floor(c.length/Gd.cols)+2);Gd.value=c;nf.style.visibility="visible";Ug=!0;nf.addEventListener("click",function(e){e.preventDefault();
Gd.select();Gd.selectionStart=0;Gd.selectionEnd=Gd.value.length},!1);nf.addEventListener("mouseup",function(e){e.preventDefault()},!1);Gd.addEventListener("onfocus",function(e){e.preventDefault();Gd.select();Gd.selectionStart=0;Gd.selectionEnd=Gd.value.length},!1);Gd.focus();Gd.selectionStart=0;Gd.selectionEnd=Gd.value.length;Bl.addEventListener("click",function(){Uc();nf.style.visibility="hidden";Ug=!1},!1);nf.addEventListener("keypress",function(e){13===e.which&&(Gd.selectionStart=0,Gd.selectionEnd=
0,Gd.blur(),Uc(),nf.style.visibility="hidden",Ug=!1,ed(0),cd(0))},!1)}var b;if(1<h.length)if(Mk(),0===Sc.length)a(td),Pe=!1,ob(Z,0,!0);else{ob(Z,0,!0);for(b=0;b<Sc.length;b++)Ei(A,O,Sc[b]);alert("WARNING:\nThe drawing of one or more stereogenic centres\nis ambiguous or inconsistent!\n\nCorrect the stereo-drawing of the centers marked by red squares and try again.\n\nThe red squares disappear with the next drawing action");Sc=[]}else alert("No atoms yet, empty SMILES code!")}function Cl(){bb();document.getElementById("smixheader").innerHTML=
"Enter SMILES Code";mf.style.visibility="visible";mf.addEventListener("click",function(a){a.preventDefault()},!1);mf.addEventListener("mouseup",function(a){a.preventDefault()},!1);Se.focus();Dl.addEventListener("click",function(a){var b=Se.value;""===b?a.preventDefault():(a.preventDefault(),vf=b,vj(vf.trim()));vf="";Se.value="";Se.blur();Uc();mf.style.visibility="hidden"},!1);El.addEventListener("click",function(a){a.preventDefault();vf="";Se.value="";Se.blur();Uc();mf.style.visibility="hidden"},
!1);Fl.addEventListener("click",function(a){var b=Se.value;""===b?a.preventDefault():(a.preventDefault(),vf=b,ui(),ob(Z,0,!0),vj(vf.trim()));vf="";Se.value="";Se.blur();Uc();mf.style.visibility="hidden"},!1);mf.addEventListener("keypress",function(a){if(13===a.which){var b=Se.value;""===b?a.preventDefault():(a.preventDefault(),vf=b,ui(),vj(vf.trim()));vf="";Se.value="";Se.blur();Uc();mf.style.visibility="hidden"}},!1)}function Eh(a){null!==a&&""!==a&&(9<parseInt(a,10)||3>parseInt(a,10)?(alert("Only rings from 3 to 9 atoms supported by ring tools\n\nFor larger rings use general chain tool."),
ie=0):(ie=parseInt(a,10),cd(10)))}function Jk(a){var b;""===mb?2===h.length||1===pb%2?b=h.length-1:b=ib:"provBondDraw"===mb&&(b=h.length-1);if(null!==a&&""!==a){var c=Vd.indexOf(a);var e=wj.indexOf(a);0>c&&0>e&&(2<a.length&&(a=a.substr(0,2)),a=a.match(Gl),null!==a?a=a[0]:(""!==h[b].j?(a=h[b].j,c="Not a chemical element!"):(a="C",c="Not a chemical element!\nReplacing with C"),alert(c)));if(a!==h[b].j&&(!Vd.includes(a)||1>=h[b].a.length)&&(h[b].j=a,h[b].u=Uh(a),1===h[b].u))for(a=0;a<h[b].a.length;a++)h[h[b].a[a].p].G+=
1;1===pb%2&&(pb--,document.getElementById("alt").className="alt");Bc();sb();ob(Z,0,!0)}}function cd(a){hg("erase");10===Bb&&10!==a&&(xj("n"),ie=0);Bb=a;0<=a&&4>=a?(Ee=!0,Ge=tf=ee=Qe=Fe=ve=!1):5<=a&&10>=a?(Ee=!1,ve=!0,Ge=tf=ee=Qe=Fe=!1):11===a?(Fe=ve=Ee=!1,Qe=!0,Ge=tf=ee=!1):12===a?(ve=Ee=!1,Fe=!0,Ge=tf=ee=Qe=!1):13===a?(Qe=Fe=ve=Ee=!1,ee=!0,Ge=tf=!1):14<=a&&17>=a?(ee=Qe=Fe=ve=Ee=!1,tf=!0,Ge=!1):18<=a&&21>=a&&(tf=ee=Qe=Fe=ve=Ee=!1,Ge=!0);(ve||Fe||Qe||ee)&&0!==ke&&ed(0);Ee&&kh&&ed(0);hg("mark");10===
a&&(0===ie?Ai("n"):2<ie&&10>ie&&xj(String(ie)))}function ed(a){0!==a&&(ve||Qe||Fe||tf||Ge)&&cd(0);ke=a;0<=a&&10>a?(qf=!0,kh=cf=!1):10===a?(qf=!1,cf=!0,kh=!1):10<a&&(cf=qf=!1,kh=!0);hg("erase");hg("mark")}function uk(a,b){var c;if(0===tc.length)return 0;for(c=1;c<=Td;c++)if(gc(Hd[c],a,b)&&tc.includes(c))return c;return 0}function lj(a,b){return a.t>b.t&&a.b>b.b&&a.b+a.c<b.b+b.c&&a.t+a.f<b.t+b.f}function oj(){var a,b,c=[];for(a=1;a<h.length;a++)if(1===h[a].s)for(b=1;b<h.length;b++)if(b!==a){var e=Math.sqrt((h[b].x-
h[a].x)*(h[b].x-h[a].x)+(h[b].y-h[a].y)*(h[b].y-h[a].y));e<=Ra&&c.push(a)}if(0<c.length)for(a=0;a<c.length;a++)Ei(Z,h,c[a])}function zk(a,b){var c;for(c=0;c<wa.length;c++){var e=Math.sqrt((a-wa[c].x)*(a-wa[c].x)+(b-wa[c].y)*(b-wa[c].y));if(e<=Ra)return c}return-1}function sk(a,b){var c;for(c=0;c<Ha.length;c++){if(0<Ha[c].A){var e=h[Ha[c].A].x;var g=h[Ha[c].A].y}else 0>Ha[c].A&&(g=-1*Ha[c].A,e=(h[X[g].g].x+h[X[g].h].x)/2,g=(h[X[g].g].y+h[X[g].h].y)/2);if(0<Ha[c].D){var f=h[Ha[c].D].x;var n=h[Ha[c].D].y}else 0>
Ha[c].D&&(n=-1*Ha[c].D,f=(h[X[n].g].x+h[X[n].h].x)/2,n=(h[X[n].g].y+h[X[n].h].y)/2);var q=Vc(e,g,f,n);var y=Math.sqrt((f-e)*(f-e)+(n-g)*(n-g));var E=.8*ka/y;var F=-1*Ha[c].crv*E*y*Math.sin(Math.PI*q/180);y=-1*Ha[c].crv*E*y*Math.cos(Math.PI*q/180);q=e+F;E=g+y;F=f+F;y=n+y;F=(q+F+e+f)/4+.25*(q-e);E=(E+y+g+n)/4+.25*(E-g);E=Math.sqrt((a-F)*(a-F)+(b-E)*(b-E));if(E<Ra)return c}return-1}function tk(a,b){var c;for(c=0;c<ja.length;c++){var e=(ja[c].T.x+ja[c].S.x)/2;var g=(ja[c].T.y+ja[c].S.y)/2;e=Math.sqrt((a-
e)*(a-e)+(b-g)*(b-g));if(e<Ra)return c}return-1}function Rc(a,b,c){var e,g=0,f=0,n=0,q=0,y=0,E=0,F=1E4,za=1E4;if(0<b)for(e=1;e<h.length;e++){var Ja="t"===c?h[e].t:h[e].s;Ja===b&&(a[e].x>y&&(y=a[e].x,n=e),a[e].y>E&&(E=a[e].y),a[e].x<F&&(F=a[e].x,q=e),a[e].y<za&&(za=a[e].y))}else for(e=1;e<h.length;e++)a[e].x>y&&(y=a[e].x,n=e),a[e].y>E&&(E=a[e].y),a[e].x<F&&(F=a[e].x,q=e),a[e].y<za&&(za=a[e].y);0<q&&0<n&&(g=yj(a,q)+zj(a,q),f=yj(a,n)+zj(a,n));a=yg*g.length+8;return new Wc(F-a,za-3*I/2-4,y-F+a+(yg*f.length+
2)+4,E-za+3*I/2+18)}function Fi(){var a;Hd=[new Wc(0,0,0,0)];if(1!==h.length){var b=Aj();for(a=1;a<=b;a++)Hd.push(Rc(h,a,"t"));return b}}function ok(){var a,b=[];if(0===ja.length)return-1;cb=[];for(a=1;a<h.length;a++)h[a].s=-1;for(a=0;a<ja.length;a++)b.includes(ja[a].I.join("-"))||($f(ja[a].I,a+100),cb.push(Rc(h,a+100,"s")),b.push(ja[a].I.join("-"))),b.includes(ja[a].H.join("-"))||($f(ja[a].H,a+200),cb.push(Rc(h,a+200,"s")),b.push(ja[a].H.join("-")));Ac()}function hg(a){if("erase"===a)Z.strokeStyle=
"white",Z.lineWidth=7,Z.beginPath(),Z.moveTo(wc.b,wc.t+wc.f+4),Z.lineTo(wc.b+wc.c,wc.t+wc.f+4),Z.stroke(),Z.beginPath(),Z.moveTo(dc.b-4,dc.t),Z.lineTo(dc.b-4,dc.t+dc.f),Z.stroke(),Z.beginPath(),Z.moveTo(Mb.b,Mb.t+Mb.f+4),Z.lineTo(Mb.b+Mb.c,Mb.t+Mb.f+4),Z.stroke();else if("mark"===a){var b=ke;var c=Bb;Z.strokeStyle="red";Z.lineWidth=5}Z.beginPath();Z.moveTo(wc.b+wc.c/14*b,wc.t+wc.f+4);Z.lineTo(wc.b+wc.c/14*(b+1),wc.t+wc.f+4);Z.stroke();14<=c&&21>=c?(Z.beginPath(),Z.moveTo(Mb.b+Mb.c/8*(c-14),Mb.t+Mb.f+
4),Z.lineTo(Mb.b+Mb.c/8*(c-13),Mb.t+Mb.f+4)):(Z.beginPath(),Z.moveTo(dc.b-5,dc.t+c*dc.f/14),Z.lineTo(dc.b-5,dc.t+(c+1)*dc.f/14-2));Z.stroke()}function Yf(a,b){A.save();da&&(A.fillStyle="rgba(255,0,0,0.1)",A.beginPath(),A.arc(a,b,3*Gi,0,2*Math.PI),A.fill());A.lineWidth=da?2:1;A.strokeStyle="red";A.beginPath();A.arc(a,b,Gi,0,2*Math.PI);A.stroke();A.restore()}function qk(a){var b=(h[X[a].g].x+h[X[a].h].x)/2;a=(h[X[a].g].y+h[X[a].h].y)/2;A.save();da&&(A.fillStyle="rgba(0,0,255,0.1)",A.beginPath(),A.arc(b,
a,3*Ih,0,2*Math.PI),A.fill());A.lineWidth=da?2:1;A.strokeStyle="blue";A.beginPath();A.arc(b,a,Ih,0,2*Math.PI);A.stroke();A.restore()}function Ei(a,b,c){var e=b[c].x;b=b[c].y;a.save();a.beginPath();a.lineWidth=2;a.strokeStyle="red";a.strokeRect(e-Ra-2,b-Ra-2,2*Ra+4,2*Ra+4);a.restore()}function vl(){var a=screen.height;if(90===Math.abs(window.orientation))if(screen.width<screen.height){var b=screen.height;a=screen.width}else b=screen.width,a=screen.height;else b=screen.width;fj=b/window.innerWidth;
var c="\norientation="+String(window.orientation)+" phone="+ua;c+="\nvps="+String(Math.round(1E3*fj)/1E3)+" iconscale="+String(Math.round(1E3*Jd)/1E3);c+="\ns.w="+String(b)+" s.h="+String(a);c+="\nw.iW="+String(window.innerWidth)+" w.iH="+String(window.innerHeight);c+="\nbgc.w="+String(fc.width)+" bgc.h="+String(fc.height);c+="\ncan.w="+String(Cb.width)+" can.h="+String(Cb.height);c+="\ntrect%="+If(100*(dc.t+dc.f)/fc.height)+"%";c+="\nbutreg.style.top="+String(Oe.style.top);alert(c)}function xj(a){Z.save();
Z.beginPath();Z.arc(dc.b+34*Jd/2,dc.t+378*Jd,8,0*Math.PI,2*Math.PI);Z.fillStyle="white";Z.fill();Z.font="10pt sans-serif";Z.fillStyle="black";Z.fillText(a,dc.b+34*Jd/2-a.length/2*8,dc.t+378*Jd+4);Z.restore()}function ik(){var a,b=[7,7,7,7,7,7,7,10,10,5,7,5,7,7],c=wc.b,e=dc.b+dc.c+8;Lc.save();Lc.clearRect(0,0,te.width,te.height);Lc.font="12pt Sans-Serif";Lc.fillStyle="blue";for(a=0;a<Bj.length;a++)Lc.fillText(Bj[a],c+38*a+18-b[a],wc.t+36+25);for(a=0;a<Bj.length;a++)Lc.fillText(Hl[a],c+38*a+18-b[a],
wc.t+36+42);for(a=0;a<Cj.length;a++)Lc.font="l"===Cj[a]?"italic 14pt serif":"12pt Sans-Serif",Lc.fillText(Cj[a],e,dc.t+4+36*a+20);Lc.font="12pt Sans-Serif";Lc.fillText("q",dc.b-3+18,dc.t-12);da?(Lc.fillText("E",60,Mb.t+60),Lc.fillText("backsp",115,Mb.t+60),Lc.fillText("g",220,Mb.t+60),Lc.fillText("H",400,Mb.t+60),Lc.fillText("!",Dc.b-10,Dc.t+20)):(Lc.fillText("E",60,Mb.t+110),Lc.fillText("backsp",130,Mb.t+110),Lc.fillText("g",240,Mb.t+110),Lc.fillText("H",445,Mb.t+110),Lc.fillText("!",354,Mb.t+53));
Lc.save();Lc.strokeStyle="blue";Lc.lineWidth=1;Lc.beginPath();Lc.moveTo(dc.b+18+8,wc.t-12);Lc.lineTo(wc.b,wc.t);Lc.moveTo(dc.b-3+22,wc.t-10);Lc.lineTo(dc.b-3+22,wc.t+4);Lc.stroke();Lc.restore()}function kk(a){0===a?te.style.visibility="hidden":1===a&&(te.style.visibility="visible")}function ob(a,b,c){var e;of(a);nd();of(Wb);if(1!==h.length){var g=1===b?"magenta":"black";if(2<=X.length)for(e=1;e<X.length;e++){var f=X[e].g;var n=X[e].h;if(1===b&&(1===h[f].s||1===h[n].s)||"moveAllMol"===mb||0===b){var q=
h[f].x;f=h[f].y;var y=h[n].x;n=h[n].y;var E=X[e].B;xg(a,q,f,y,n,E,Sd,g)}}q=1===b?"magenta":"black";for(e=1;e<h.length;e++)(1===b&&1===h[e].s||"moveMol"===mb||0===b)&&lk(a,e,q);if(0<Ha.length&&c)for(e=0;e<Ha.length;e++)mk(a,e,"red");if(0<ja.length&&c)for(e=0;e<ja.length;e++)nk(a,e,"black");Wf=Xf=de=!1}}function xg(a,b,c,e,g,f,n,q){var y=Vc(b,c,e,g);var E=Math.PI/2+y/180*Math.PI;y=-1*Eg*Math.sin(E);E=Eg*Math.cos(E);0!==f&&(1===f&&(a.beginPath(),a.strokeStyle=q,a.lineWidth=n,a.moveTo(b,c),a.lineTo(e,
g),a.stroke()),2===f&&(a.beginPath(),a.strokeStyle=q,a.lineWidth=n,a.moveTo(b+E,c+y),a.lineTo(e+E,g+y),a.stroke(),a.beginPath(),a.moveTo(b-E,c-y),a.lineTo(e-E,g-y),a.stroke()),3===f&&(a.strokeStyle=q,a.lineWidth=n,a.beginPath(),a.moveTo(b,c),a.lineTo(e,g),a.stroke(),a.beginPath(),a.moveTo(b+2*E,c+2*y),a.lineTo(e+2*E,g+2*y),a.stroke(),a.beginPath(),a.moveTo(b-2*E,c-2*y),a.lineTo(e-2*E,g-2*y),a.stroke()),4===f&&(a.beginPath(),a.fillStyle=q,a.moveTo(b,c),a.lineTo(e-1.5*E,g-1.5*y),a.lineTo(e+1.5*E,g+
1.5*y),a.lineTo(b,c),a.fill()),5===f&&(Dj?(a.beginPath(),a.strokeStyle=q,a.moveTo(b-E,c-y),a.lineTo(b+E,c+y),a.lineTo(e,g),a.lineTo(b-E,c-y),a.La=n,a.stroke()):(a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(e-2*E,g-2*y),a.lineTo(e+2*E,g+2*y),a.lineTo(b,c),a.clip(),a.beginPath(),a.strokeStyle=q,a.setLineDash([2,3]),a.moveTo(b,c),a.lineWidth=Ej,a.lineTo(e,g),a.stroke(),a.restore())))}function lk(a,b,c){function e(qa,Cc){var yb,wb=.3*I,jc=String(h[Cc].F);qa.save();qa.fillStyle="blue";for(yb=0;yb<jc;yb++){var gd=
h[Cc].x+ba[yb]*Math.cos(Math.PI*ia(Da[yb])/180);var Yc=h[Cc].y-ba[yb]*Math.sin(Math.PI*ia(Da[yb])/180);var Te=gd+wb*Math.cos(Math.PI*ia(Da[yb]+90)/180);var qh=Yc-wb*Math.sin(Math.PI*ia(Da[yb]+90)/180);gd+=wb*Math.cos(Math.PI*ia(Da[yb]-90)/180);Yc-=wb*Math.sin(Math.PI*ia(Da[yb]-90)/180);qa.beginPath();qa.arc(Te,qh,2,0,2*Math.PI);qa.fill();qa.beginPath();qa.arc(gd,Yc,2,0,2*Math.PI);qa.fill()}qa.restore()}function g(qa,Cc,yb,wb){qa.save();qa.font=String(I+2)+"pt";qa.strokeStyle="black";qa.lineWidth=
1;qa.beginPath();qa.arc(Cc,yb,.6*qa.measureText("+").width,0,2*Math.PI);qa.moveTo(Cc-.6*qa.measureText("+").width,yb);qa.lineTo(Cc+.6*qa.measureText("+").width,yb);"+"===wb&&(qa.moveTo(Cc,yb-.6*qa.measureText("+").width),qa.lineTo(Cc,yb+.6*qa.measureText("+").width));qa.stroke();qa.restore()}var f=0,n="",q=-1,y=new xc(0,0),E=f=0,F=0,za=0,Ja="",ha="";y=[];f=[];var Da=[],ba=[I,I,I,I],jb=za="";ha="";var Za=I,Aa=I;E=0;var tb=!1;a.save();a.font=String(I)+"pt Arial, Helvetica, sans-serif";a.fillStyle=c;
ha=yj(h,b);if(2>ha.length||kg.includes(ha)||ha.includes(":")||Pe||Vd.includes(ha))n="simple";else if(y=ha.match(/([A-Za-z]{1,2})H(\d{0,2})/))n="right";else if(y=ha.match(/H(\d{0,2})([A-Za-z]{0,2})/))n="left";za=a.measureText(h[b].j.charAt(0)).width/2;Ja=zj(h,b);""!==Ja&&(f=Ja.match(/(\d{1,2})/))&&(jb=f[1]);Il(h,b,!0);"right"===n?q=Nk(h,b,0):"left"===n&&(q=Nk(h,b,180));tb=!1;for(f=0;f<h[b].a.length;f++)if(E=$a(h,b,h[b].a[f].p),"right"===n&&(30>E||330<E)||"left"===n&&150<E&&210>E)tb=!0;"H"===h[b].j&&
0===h[b].a.ab&&(F=60);if(h[b].r){if("simple"===n)switch(h[b].a.length){case 0:F=180;Da=[ia(F+90),ia(F-90),ia(F+180),F];2===ha.length&&(ba[2]+=.5*I);3<h[b].F&&(Aa+=I);break;case 1:F=fb[0];Da=[ia(F+90),ia(F-90),F,ia(F+180)];""===ha?Aa=.6*I:1===ha.length?(ba=[1.1*I,1.1*I,1.1*I,1.1*I],3>h[b].F?Aa=.9*I:Aa=ba[2]+.6*I):2===ha.length&&(ba=[1.1*I,1.1*I,1.5*I,1.2*I],45>=F||315<=F?(ba=[1.1*I,1.1*I,1.5*I,1.2*I],3>h[b].F?Aa=1.7*I:Aa=ba[2]+.6*I):135<=F&&225>=F?(ba=[1.1*I,1.1*I,1.2*I,1.2*I],Aa=3>h[b].F?.9*I:ba[2]+
.6*I):225<F&&315>F?(ba=[1.5*I,I,1.1*I,1.2*I],Aa=3>h[b].F?1.2*I:ba[2]+.6*I):45<F&&135>F?(ba=[I,1.5*I,1.1*I,1.2*I],Aa=3>h[b].F?1.2*I:ba[2]+.6*I):(Aa=1.6*I,ba[2]=I));break;case 2:F=fb[0];0===h[b].F&&1===Ue(h,X,b)&&(F=ia(F+180));if(1===h[b].F)Da=[ia(F+180)],ba[0]=0===ha.length?.8*I:1.1*I;else if(1<h[b].F)if(Da=[ia(F+135),ia(F-135),F],0===ha.length)ba=[.8*I,.8*I,.8*I];else if(1===ha.length)ba=[I,I,I];else if(2===ha.length)for(f=0;f<h[b].F;f++)if(30>Da[f]||330<Da[f])ba[f]+=.7*I;else if(75>Da[f]||285<Da[f])ba[f]+=
.42*I;0===h[b].F?(Aa=I,1<=Ue(h,X,b)?Aa=1.1*I:""===ha?Aa=.84*I:2===ha.length&&(60>F||300<F)&&(Aa+=.6*I)):2>=h[b].F?Aa=0<ha.length?(60>F||300<F)&&2===ha.length?1.6*I:1.1*I:.7*I:2<h[b].F&&(Aa=ba[2]+.5*I);break;default:F=fb[fb.length-2],Aa=I,Da=[fb[fb.length-1],fb[fb.length-3]],ba=[1.3*I,1.3*I],2===ha.length&&(Aa=60>F||300<F?1.5*I:I,ba=[1.3*I,1.3*I]),""===ha&&(Aa=.8*I)}else if(0===h[b].a.length)Da=[270,90,180,0],ba=[1.2*I,1.2*I,1.2*I,a.measureText(ha).width],F=180,2<h[b].F&&(Aa=2*I);else if(1===h[b].a.length)F=
fb[0],ba=[1.2*I,1.2*I,1.2*I,1.2*I],Aa=1.1*I,45<F&&90>=F?(Da=[180,90,270,0],F=90):90<F&&135>F?(Da=[0,90,270,180],Aa=1.1*I,F=90):270<=F&&315>F?(Da=[180,270,90,0],Aa=1.1*I,F=270):225<F&&270>F?(Da=[0,270,90,180],Aa=1.1*I,F=270):45>=F||315<=F?(Da=[90,270,180,0],Aa=1.1*I,F=270):135<=F&&225>=F&&(Da=[90,270,0,180],Aa=1.1*I,F=270),1<h[b].F&&(Aa+=.6*I);else if(2===h[b].a.length){F=fb[0];ba[2]+=.6*I;Da=45<F&&135>F?[F,"right"===n?ia(F+120):ia(F-120),"right"===n?ia(F-120):ia(F+120),ia(F-90)]:[F,"right"===n?ia(F-
120):ia(F+120),"right"===n?ia(F+120):ia(F-120),ia(F-90)];if(45>F||315<F||135<F&&225>F)ba[1]+=.6*I;F=Da[1];2>h[b].F?Aa=1.3*I:(Aa=2*I,"right"===n&&0<F&&90>F&&(Aa=2*I,ba[1]=Aa-.6*I));2<h[b].F&&(ba[2]=a.measureText(ha).width,"left"===n&&(Da=[270,90,180,0]))}else ba=[1.2*I,1.2*I,1.2*I],"simple"===n?(F=fb[fb.length-2],Da=[fb[fb.length-1],fb[fb.length-2],fb[fb.length-3]]):q!==fb.length-1?(Da=[fb[fb.length-1],fb[fb.length-2],fb[fb.length-3]],F=fb[fb.length-2]):(Da=[fb[fb.length-2],fb[fb.length-3],fb[fb.length-
1]],F=fb[fb.length-3]),Aa=1<h[b].F?ba[1]+.6*I:1.3*I;y=sj(Aa,F);a.save();a.font=String(1.5*I)+"pt Arial, Helvetica, sans-serif";a.fillStyle="red";a.fillText("\u2022",h[b].x+y.x-a.measureText("\u2022").width/2,h[b].y+y.y+.7*I);a.restore()}else if(0<h[b].F)switch(h[b].a.length){case 0:F=0;Da=[ia(F+180),ia(F+90),ia(F-90),F];2===ha.length&&(ba=[I,I,I,a.measureText(ha).width]);3<h[b].F&&(Za+=I);break;case 1:F=fb[0];if("simple"===n){if(Da=2===h[b].a[0].t&&2>=h[b].F?[ia(F+60),ia(F-60),ia(F+180)]:3===h[b].a[0].t?
[F,ia(F-90),ia(F-90)]:[ia(F+90),ia(F-90),F,ia(F+180)],ba=[I,I,I,I],2===ha.length)for(f=0;f<h[b].F;f++)if(30>Da[f]||330<Da[f])ba[f]+=.5*I;else if(75>Da[f]||285<Da[f])ba[f]+=.3*I}else 45>F||315<F?(Da=[90,270,180,0],ba=[I,1.2*I,I,1.2*I]):135<=F&&225>=F?(Da=[270,90,0,180],ba=[1.2*I,I,a.measureText(ha.charAt(0)).width]):45<=F&&90>=F?(Da=[90,180,270,0],ba=[a.measureText(ha.charAt(0)).width,I,1.2*I]):90<F&&135>F?(Da=[90,0,270,180],ba=[a.measureText(ha.charAt(0)).width,I,1.2*I]):270<=F&&315>=F?(Da=[270,180,
90,0],ba=[1.2*I,I,1.3*I,1.2*I]):225<F&&270>F&&(Da=[270,0,90,180],ba=[1.2*I,I,1.3*I,1.2*I]);break;case 2:if("simple"===n)if(F=ia(fb[0]+180),1===h[b].F)Da=[F],ba[0]=2===ha.length?45>F||315<F?1.3*I:.9*I:I;else{if(1<h[b].F&&(Da=[ia(F+45),ia(F-45),ia(F+180)],2===ha.length))for(f=0;f<h[b].F;f++)(60>Da[f]||300<Da[f])&&2>f?ba[f]+=.5*I:(80>Da[f]||280<Da[f])&&2===f&&(ba[f]+=.25*I)}else if(F=fb[0],ba[2]+=.6*I,Da=45<F&&135>F?[F,"right"===n?ia(F+120):ia(F-120),"right"===n?ia(F-120):ia(F+120),ia(F-90)]:[F,"right"===
n?ia(F-120):ia(F+120),"right"===n?ia(F+120):ia(F-120),ia(F-90)],45>F||315<F||135<F&&225>F)ba[1]+=.6*I;break;default:if("simple"===n){if(Da=[fb[fb.length-1],fb[fb.length-3],fb[fb.length-2]],ba=[1.2*I,1.2*I,1.2*I],2===ha.length)for(f=0;f<h[b].F;f++)(60>Da[f]||300<Da[f])&&2>f&&(ba[f]+=.5*I)}else Da=q!==fb.length-1?[fb[fb.length-1],fb[fb.length-2],fb[fb.length-3]]:[fb[fb.length-2],fb[fb.length-3],fb[fb.length-1]],ba=[1.2*I,1.2*I,1.2*I]}"simple"===n&&""!==ha&&(f=h[b].x-za,E=h[b].y+I/2,ha.includes(":")?
(y=ha.match(/([CN]):(H)(\d{0,1})/))?(ha=y[1]+y[2]+y[3],a.save(),a.font=String(I)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.clearRect(f,E-I,a.measureText(ha).width+0,I+0),a.fillText(y[1],f,E),a.restore(),f+=a.measureText(y[1]).width,a.fillText(y[2],f,E),""!==y[3]&&(f+=a.measureText(y[2]).width,E+=4,a.save(),a.font=String(I-2)+"pt Arial",a.fillText(y[3],f,E),a.restore())):(y=ha.match(/(\d{0,1}H)([CN]):/))?(ha=y[2],a.clearRect(f,E-I,a.measureText(ha).width+0,I+0),a.save(),a.font=String(I)+
"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.fillText(ha,f,E),a.restore(),ha=y[1],f-=a.measureText(y[1]).width,a.clearRect(f,E-I,a.measureText(ha).width+0,I+0),a.fillText(ha,f,E)):(ha=ha.replace(":",""),a.save(),a.font=String(I)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.clearRect(f,E-I,a.measureText(ha).width+0,I+0),a.fillText(ha,f,E),a.restore()):(a.clearRect(f-1,E-I,a.measureText(ha).width+0+2,I+0+1),a.fillText(ha,f,E)));if(""!==Ja&&("simple"===n||tb)){switch(h[b].a.length){case 0:F=
30;Za=1===ha.length?1.2*I:1.6*I;2<h[b].F&&(Za+=.6*I);h[b].r&&2<h[b].F&&(Za=ba[2]+.8*I);break;case 1:F=fb[0];if(150<F&&200>F)F=ia(F-15);else if(340<F||20>F)F=ia(F+15);2>ha.length&&!tb?(Za=1.3*I,""===ha&&(Za=.8*I),""!==jb&&120<F&&240>F&&(Za=a.measureText(Ja).width+.6*I),2<h[b].F&&(Za+=.8*I),0<h[b].F&&2===h[b].a[0].t&&(Za=ba[0]+.6*I)):2===ha.length&&(45>F||315<F?Za=""!==jb?1.2*I:1.8*I:135<F&&225>F?Za=""!==jb?1.2*I:1.4*I:135>=F&&45<=F?Za=""!==jb?.8*I:1.2*I:225<=F&&315>=F&&(Za=I),""!==jb&&(Za+=.4*I),2<
h[b].F&&(Za+=1.2*I));h[b].r&&(Za=Aa+1.2*I);break;case 2:F=fb[0];h[b].r?Za=Aa+I:Za=1<ha.length&&(45>F||315<F)?1.8*I:1.4*I;2<h[b].F&&!h[b].r&&(Za=ba[2]+.5*I);break;case 3:case 4:case 5:case 6:q===fb.length-2&&tb?2>h[b].F?(F=fb[fb.length-3],Za=1.4*I):Za=ba[1]+.6*I:(F=fb[fb.length-2],Za=1.4*I,2===ha.length&&(60>F||300<F)&&(Za+=.2*I)),h[b].r&&(Za=Aa+I),""===ha&&(Za-=.2*I)}y=sj(Za,F);f=h[b].x+y.x;E=h[b].y+y.y;a.font=String(I+2)+"pt";0<jb.length&&(f=h[b].x+y.x-.6*a.measureText("+").width,E=h[b].y+y.y+I/
2,a.fillStyle="black",a.fillText(jb,f,E),f+=a.measureText(jb).width+I/2,E-=.6*a.measureText("+").width);g(a,f,E,0<h[b].o?"+":"\u2013")}if("right"===n||"left"===n)c="left"===n?-1*(a.measureText(ha).width-za):-1*za,(y=ha.match(/([A-Za-z]{1,2})H(\d{1,2})/))?(ha=y[1],za=y[2],f=h[b].x-a.measureText(ha.charAt(0)).width/2,E=h[b].y+I/2,a.clearRect(f,E-I,a.measureText(ha+"H").width,I),a.fillText(ha+"H",f,E),f+=a.measureText(ha+"H").width,E+=4,a.clearRect(f,E-I,a.measureText(za).width,I),a.fillText(za,f,E),
f+=a.measureText(za).width+2,E-=4,""==Ja||tb||(E-=.6*I,0<jb.length&&(a.fillStyle="black",a.fillText(jb,f,E),f+=a.measureText(jb).width+.2*I),E-=.6*a.measureText("+").width,g(a,f+4,E,0<h[b].o?"+":"\u2013"))):(y=ha.match(/H(\d{1,2})([A-Za-z]{1,2})/))?(ha=y[2],za=y[1],f=h[b].x+c,E=h[b].y+I/2,a.clearRect(f,E-I,a.measureText("H").width,I),a.fillText("H",f,E),f+=a.measureText("H").width,E+=4,a.clearRect(f,E-I,a.measureText(za).width,I),a.fillText(za,f,E),f+=a.measureText(za).width,E-=4,a.clearRect(f,E-
I,a.measureText(ha).width,I),a.fillText(ha,f,E),f=h[b].x+c,""==Ja||tb||(E-=.6*I,f-=a.measureText("+").width,E-=.6*a.measureText("+").width,g(a,f,E,0<h[b].o?"+":"\u2013"),0<jb.length&&(a.fillStyle="black",E+=.6*a.measureText("+").width,f-=a.measureText(jb).width+I/2,a.fillText(jb,f,E)))):!ha.match(/^H/)||"H"===ha&&0===h[b].a.length?(f=h[b].x-a.measureText(ha.charAt(0)).width/2,E=h[b].y+I/2,a.clearRect(f,E-I,a.measureText(ha).width,I),a.fillStyle="black",a.fillText(ha,f,E),f+=a.measureText(ha).width+
.5*I,""==Ja||tb||(3<h[b].F&&(f+=.8*I),E-=4,0<jb.length&&(f-=.4*I,a.fillStyle="black",a.fillText(jb,f,E),f+=a.measureText(jb).width+I/2),E-=.6*a.measureText("+").width,g(a,f,E,0<h[b].o?"+":"\u2013"))):(f=h[b].x-a.measureText(ha).width+a.measureText(ha.charAt(0)).width/2,E=h[b].y+I/2,a.clearRect(f,E-I,a.measureText(ha).width,I),a.fillStyle="black",a.fillText(ha,f,E),""==Ja||tb||(E-=.6*I,f-=a.measureText("+").width,E-=.6*a.measureText("+").width,g(a,f,E,0<h[b].o?"+":"\u2013"),0<jb.length&&(a.fillStyle=
"black",f-=a.measureText(jb).width+I/2,E+=.6*a.measureText("+").width,a.fillText(jb,f,E))));a.restore();0<h[b].F&&e(a,b)}function mk(a,b,c){var e=Ha[b].A,g=Ha[b].D,f=Ha[b].oa;b=Ha[b].crv;var n=0,q=0,y=0,E=0;0>e?(n=(h[X[-1*e].g].x+h[X[-1*e].h].x)/2,q=(h[X[-1*e].g].y+h[X[-1*e].h].y)/2):0<e&&(n=h[e].x,q=h[e].y);0>g?(y=(h[X[-1*g].g].x+h[X[-1*g].h].x)/2,E=(h[X[-1*g].g].y+h[X[-1*g].h].y)/2):0<g&&(y=h[g].x,E=h[g].y);var F=Vc(n,q,y,E);e=ia(F-90*b);var za=Math.sqrt((y-n)*(y-n)+(E-q)*(E-q));var Ja=.8*ka/za;
g=-1*b*Ja*za*Math.sin(Math.PI*F/180);za=-1*b*Ja*za*Math.cos(Math.PI*F/180);Ja=n+g;F=q+za;g=y+g;za=E+za;a.save();a.lineWidth=Sd;a.strokeStyle=c;a.fillStyle=c;a.beginPath();a.moveTo(n,q);a.bezierCurveTo(Ja,F,g,za,y,E);a.stroke();a.beginPath();a.moveTo(y,E);a.lineTo(y-8*Math.cos(Math.PI*ia(e-30*b)/180),E+8*Math.sin(Math.PI*ia(e-30*b)/180));"f"===f&&(a.moveTo(y,E),a.lineTo(y-8*Math.cos(Math.PI*ia(e+45*b)/180),E+8*Math.sin(Math.PI*ia(e+45*b)/180)));a.stroke();a.restore()}function Fk(a){new Wc(0,0,0,0);
new Wc(0,0,0,0);Ac();$f(ja[a].I,10);var b=Rc(h,10,"s");$f(ja[a].H,20);var c=Rc(h,20,"s");Ld=[];qj(ja[a].I,ja[a].H,b,c);ja[a].T.x=Ld[0];ja[a].T.y=Ld[1];ja[a].S.x=Ld[2];ja[a].S.y=Ld[3];Ld=[];Ac()}function nk(a,b,c){var e=new xc(ja[b].T.x,ja[b].T.y),g=new xc(ja[b].S.x,ja[b].S.y),f=ja[b].oa;var n=new xc(0,0);var q=0;var y=Vc(e.x,e.y,g.x,g.y);2===f&&(n.x=-1*Ra*Math.cos(Math.PI*ia(y-90)/180),n.y=Ra*Math.sin(Math.PI*ia(y-90)/180),e=ai(e,n),g=ai(g,n));a.save();a.strokeStyle=c;a.fillStyle=c;a.lineWidth=2;
a.beginPath();3===f&&(a.moveTo(e.x,e.y),a.lineTo(e.x+2*Ra*Math.cos(Math.PI*ia(y+30)/180),e.y-2*Ra*Math.sin(Math.PI*ia(y+30)/180)),a.moveTo(e.x,e.y),a.lineTo(e.x+2*Ra*Math.cos(Math.PI*ia(y-30)/180),e.y-2*Ra*Math.sin(Math.PI*ia(y-30)/180)));a.moveTo(e.x,e.y);a.lineTo(g.x,g.y);a.lineTo(g.x-2*Ra*Math.cos(Math.PI*ia(y+30)/180),g.y+2*Ra*Math.sin(Math.PI*ia(y+30)/180));a.moveTo(g.x,g.y);a.lineTo(g.x-2*Ra*Math.cos(Math.PI*ia(y-30)/180),g.y+2*Ra*Math.sin(Math.PI*ia(y-30)/180));a.stroke();2===f&&(e=Hi(e,n),
g=Hi(g,n),e=Hi(e,n),g=Hi(g,n),a.beginPath(),a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.lineTo(e.x+2*Ra*Math.cos(Math.PI*ia(y+30)/180),e.y-2*Ra*Math.sin(Math.PI*ia(y+30)/180)),a.moveTo(e.x,e.y),a.lineTo(e.x+2*Ra*Math.cos(Math.PI*ia(y-30)/180),e.y-2*Ra*Math.sin(Math.PI*ia(y-30)/180)),a.stroke(),e=ai(e,n),g=ai(g,n));""!==ja[b].fa&&3!==f&&(a.font=String(I)+"pt sans-serif",a.textBaseline="middle",n=1===f?2*Ra:4*Ra,q=a.measureText(ja[b].fa).width,c=270<y||90>y?1:-1,n=Math.abs(q/2*Math.sin(Math.PI*y/180))+n,
a.fillText(ja[b].fa,(e.x+g.x)/2-c*n*Math.sin(Math.PI*y/180)-q/2,(e.y+g.y)/2-c*n*Math.cos(Math.PI*y/180)));""!==ja[b].pa&&3!==f&&(a.font=String(I)+"pt sans-serif",a.textBaseline="middle",n=1===f?2*Ra:4*Ra,f=a.measureText(ja[b].pa).width,c=270<y||90>y?-1:1,n=Math.abs(f/2*Math.sin(Math.PI*y/180))+n,a.fillText(ja[b].pa,(e.x+g.x)/2-c*n*Math.sin(Math.PI*y/180)-q/2,(e.y+g.y)/2-c*n*Math.cos(Math.PI*y/180)));a.restore()}function of(a){a.clearRect(ta.b+2,ta.t+2,ta.c-4,ta.f-4)}function nd(){A.clearRect(0,0,
re.width,re.height)}function gj(){Fj.fillStyle="white";Fj.clearRect(0,0,fc.width,fc.height);A.clearRect(0,0,re.width,re.height);Wb.clearRect(0,0,se.width,se.height);Z.clearRect(0,0,Cb.width,Cb.height);Z.save();Z.font="12pt Sans-Serif";Z.fillStyle="black";Z.fillText("Structural Formula Editor  MOSFECCS",50,28);Z.fillStyle="black";Z.font="10pt Sans-Serif";Z.fillText("v6_210506(210506.1)",ta.b+ta.c-Z.measureText("v6_210506(210506.1)").width,28);Z.font="9pt Sans-Serif";Z.fillText("\u00a9 B.Jaun ETHZ",
ta.b+ta.c-90,ta.t+ta.f+15);Z.restore();Z.drawImage(Gj,wc.b,wc.t,wc.c,wc.f);Z.drawImage(Hj,dc.b,dc.t,dc.c,dc.f);Dh&&Z.drawImage(Ij,Mb.b,Mb.t,Mb.c,Mb.f);Z.save();Z.strokeStyle="black";Z.lineWidth=1.5;Z.strokeRect(Dc.b,Dc.t,Dc.c,Dc.f);Z.font="10pt Sans-Serif";Z.fillStyle="black";Z.fillText("redraw",Dc.b+Dc.c/2-Z.measureText("redraw").width/2,Dc.t+Dc.f/2+4);Z.restore();Z.save();Z.strokeStyle="black";Z.lineWidth=1.5;Z.beginPath();Z.arc(md.x,md.y,md.r,0,2*Math.PI);Z.stroke();Z.font="14pt Sans-Serif";Z.fillStyle=
"black";Z.fillText("+",Dc.b+Dc.c+30-Z.measureText("+").width/2,Dc.t+Dc.f/2);Z.restore();Z.save();Z.strokeStyle="black";Z.lineWidth=1.5;Z.beginPath();Z.arc(ce.x,ce.y,ce.r,0,2*Math.PI);Z.stroke();Z.font="14pt Sans-Serif";Z.fillStyle="black";Z.fillText("\u2013",ce.x-Z.measureText("\u2013").width/2,ce.y+5);Z.restore();Z.save();Z.font="10pt Sans-Serif";Z.fillStyle="black";Z.fillText("Bondlength",md.x-7,md.y+26);Z.fillText(String(Math.round(ka)),(md.x+ce.x)/2-6,md.y+6);hg("erase");hg("mark");Z.beginPath();
Z.strokeStyle="black";Z.lineWidth=1;Z.strokeRect(ta.b,ta.t,ta.c,ta.f);Z.restore();sb();1<h.length&&Ok();ob(Z,0,!0);cd(0);ed(0)}function Of(a,b,c,e,g){var f,n=0;for(f=1;f<a.length;f++)n=Bd(h,X,c,e);if(0!==n)return-n;f=Uh(b);g&&(b="("+b+")");g=a.length;a[g]=new mc(f,b,c,e,0,0,0);return a[g].za=g}function Sh(a,b,c,e){function g(q,y){var E;for(E=0;E<q.length;E++)0>q[E].A&&Number.isInteger(q[E].A)&&-1*q[E].A>y&&(q[E].A+=1),0>q[E].D&&Number.isInteger(q[E].D)&&-1*q[E].D>y&&(q[E].D+=1)}var f;var n=!1;if(2===
a.length&&a===h)a.splice(1,1);else{if(e)for(f=0;f<Ha.length;f++){n=!1;if(Ha[f].A===c||Ha[f].D===c)n=!0;0>Ha[f].A&&Number.isInteger(Ha[f].A)&&(b[-1*Ha[f].A].g===c||b[-1*Ha[f].A].h===c)&&(n=!0);0>Ha[f].D&&Number.isInteger(Ha[f].D)&&(b[-1*Ha[f].D].g===c||b[-1*Ha[f].D].h===c)&&(n=!0);n&&(Bi(f),f--)}for(f=1;f<b.length;f++)if(b[f].g===c||b[f].h===c){if(e){for(n=0;n<Ha.length;n++)Ha[n].A!==-1*f&&Ha[n].A!==-1*f||Bi(n);g(Ha,f)}else b===Ie&&0<Pb.length&&g(Pb,f);b.splice(f,1);f--}for(f=1;f<b.length;f++)b[f].g>
c&&--b[f].g,b[f].h>c&&--b[f].h;for(f=1;f<a.length;f++)if(f!==c)for(n=0;n<a[f].a.length;n++)a[f].a[n].p===c&&(1===a[c].u&&a===h&&--a[f].G,a[f].a.splice(n,1));for(f=1;f<a.length;f++)for(n=0;n<a[f].a.length;n++)f!==c&&a[f].a[n].p>c&&--a[f].a[n].p;if(e)for(f=0;f<Ha.length;f++)Ha[f].A>c&&--Ha[f].A,Ha[f].D>c&&--Ha[f].D;else if(b===Ie&&0<Pb.length)for(f=0;f<Pb.length;f++)Pb[f].A>c&&--Pb[f].A,Pb[f].D>c&&--Pb[f].D;a.splice(c,1);e&&ob(Z,0,!0)}}function Wh(a,b){var c;for(c=0;c<h[b].a.length;c++)xe(h,X,h[b].a[c].p,
a,h[b].a[c].t);Sh(h,X,b,!0)}function Bk(a,b,c){var e;for(e=0;e<Ha.length;e++)if(Ha[e].A===-1*c||Ha[e].D===-1*c)Bi(e),e--;for(e=0;e<Ha.length;e++)0>Ha[e].A&&Math.floor(Math.abs(Ha[e].A))>c&&(Ha[e].A+=1),0>Ha[e].D&&Math.floor(Math.abs(Ha[e].D))>c&&(Ha[e].D+=1);var g=b[c].g;var f=b[c].h;var n=-1;for(e=0;e<a[g].a.length;e++)a[g].a[e].p===f&&(n=e);0<=n&&a[g].a.splice(n,1);n=-1;for(e=0;e<a[f].a.length;e++)a[f].a[e].p===g&&(n=e);0<=n&&a[f].a.splice(n,1);b.splice(c,1)}function zl(a,b,c,e){var g=h[b].x;var f=
h[b].y;b=h[e].x;var n=h[e].y;e=Na(X,c,e);Bk(h,X,e);Wh(a,c);a=Bd(h,X,g,f);c=Bd(h,X,b,n);Wh(a,c)}function jh(a,b,c,e){var g;var f=1;var n=!0;var q=[0,0,0,-.5*ka,-.5*ka,-.5*ka,0,0,0,0,0,0,0],y=[0,0,0,-.28868*ka,.5*ka,-.80902*ka,ka,0,0,0,0,0,0];-6===a&&(ig=!0);0<c?n=!0:0>c&&(n=!1);var E=0<a?a:-a;c=360/Math.abs(a);var F=(180-c)/2;var za=Math.pow(-1,E)*F;6===E&&(za=90);if("atom"===e){if(1===h.length||1===pb%2){var Ja=ic+q[E];var ha=rc+y[E];var Da=Of(h,"C",Ja,ha,!1);0<Da&&(b=Da)}if(0<b&&0===h[b].a.length)Ja=
h[b].x,ha=h[b].y;else if(0<b&&1===h[b].a.length)Ja=h[b].x,ha=h[b].y,za=lh(h,b);else if(0<b&&2===h[b].a.length&&1===h[b].a[0].t&&1===h[b].a[1].t&&0<a)Ja=h[b].x,ha=h[b].y,za=lh(h,b);else return;Da=g=b}if("bond"===e){if(0===X[b].B)return;E--;4!==X[b].B&&5!==X[b].B||yc(h,X,b,1,!0);if(1===X[b].B&&-6===a){Ja=X[b].g;ha=X[b].h;for(Da=f=0;Da<h[Ja].a.length;){if(2===h[Ja].a[Da].t){f+=1;break}Da++}for(Da=0;Da<h[ha].a.length;){if(2===h[ha].a[Da].t){f+=1;break}Da++}0===f&&yc(h,X,b,2,!0)}else if(2<X[b].B){ig=!1;
return}g=X[b].g;Da=X[b].h;Ja=h[g].x;ha=h[g].y;f=1;za=$a(h,g,Da);F=180-360/Math.abs(a);n||(F*=-1,c*=-1)}b=ia(za-F);e=g;for(n=0;n<E-1;n++)f=ka*Math.cos(Math.PI*b/180),g=-1*ka*Math.sin(Math.PI*b/180),$b=Ja+f,ac=ha+g,Ja=Of(h,"C",$b,ac,!1),0>Ja&&(Ja=Math.abs(Ja)),f=-6===a?n%2+1:1,xe(h,X,e,Ja,f),e=Ja,b=ia(b+c),Ja=$b,ha=ac;xe(h,X,e,Da,-6===a&&1===f?2:1);ig=!1}function xl(a,b,c,e,g){var f;var n=1;ia(e+n*g*30);ia(e+n*g*30);if(bh)var q=Wa;else if(q=Of(h,"C",b,c,!1),0< !q)return;b=h[q].x;c=h[q].y;rd=b;sd=c;
for(f=0;f<a-1;f++){n=0===f%2?1:-1;var y=ka*Math.cos(Math.PI*ia(e+n*g*30)/180);n=-ka*Math.sin(Math.PI*ia(e+n*g*30)/180);b+=y;c+=n;n=Of(h,"C",b,c,!1);0>n&&(n=Math.abs(n));xe(h,X,q,n,1);q=n;rd=b;sd=c}}function yl(a){var b,c=-1;if(!1===Mf){var e=wa[0].x;var g=wa[0].y;var f=Of(h,"C",e,g,!1);0>f&&(f=Math.abs(f));0<=Nf&&0===Nf&&(c=f)}else f=Wa;e=h[f].x;g=h[f].y;rd=e;sd=g;for(b=1;b<a;b++){e=wa[b].x;g=wa[b].y;var n=Of(h,"C",e,g,!1);0>n&&(n=Math.abs(n));0<=Nf&&b===Nf&&(c=n);xe(h,X,f,n,1);f=n;rd=e;sd=g}0<gh&&
(n=gh,xe(h,X,f,n,1),gh=0);0<=c&&xe(h,X,f,c,1)}function hj(a){var b,c=0;for(b=1;b<h.length;)h[b].s===a&&(c=h[b].t,Sh(h,X,b,!0),b--),b++;for(b=1;b<h.length;)h[b].t>c&&--h[b].t,b++;if(0<ja.length)for(b=0;b<ja.length;b++)if(1===ja[b].I.length&&ja[b].I[0]===c||1===ja[b].H.length&&ja[b].H[0]===c)wg(b),b--;else{ja[b].I.includes(c)&&ja[b].I.splice(ja[b].I.indexOf(c),1);ja[b].H.includes(c)&&ja[b].H.splice(ja[b].H.indexOf(c),1);for(a=0;a<ja[b].I.length;a++)ja[b].I[a]>c&&--ja[b].I[a];for(a=0;a<ja[b].H.length;a++)ja[b].H[a]>
c&&--ja[b].H[a]}if(0<ja.length)for(b=0;b<ja.length;b++)Fk(b);nd();Ac();Bc();sb();ob(Z,0,!0)}function wg(a){var b,c;if(void 0!==ja[a]){for(b=1;b<h.length;b++)h[b].na.includes(a)&&h[b].na.splice(h[b].na.indexOf(a),1),h[b].ma.includes(a)&&h[b].ma.splice(h[b].ma.indexOf(a),1);for(b=1;b<h.length;b++){for(c=0;c<h[b].na.length;c++)h[b].na[c]>a&&--h[b].na[c];for(c=0;c<h[b].ma.length;c++)h[b].ma[c]>a&&--h[b].ma[c]}ja.splice(a,1)}}function ui(){h.length=1;O.length=1;wf.length=1;Je.length=1;Ec.length=0;X.length=
1;Oa.length=1;bi.length=1;Ie.length=1;Ha=[];ja=[];Td=0;Fg=[];wa=[];Ha=[];Pb=[];ja=[];Ke=[];hd.length=1;le=[];lg={};mg=[];Le=[];ye=[];Hd=[];cb=[];He=[];xf=[];bc={};je=[];dd=[];Yd=[];Zd=[];Fb=[];Pa=[];gg=[];tc=[];uc=[];Nb=[];Sc=[];Bb=ke=0;nh="";rf=bg=ag=Wd=xd=gh=ie=ci=Td=pb=0;$g=-1;Zf=Ce=0;Hh=-1;yi=Dd=Cd=0;Ph=-1;Kd=Eb=Db=Ua=Wa=fh=Fd=eh=Ed=uj=tj=0;Zg=Kf=-1;ib=Rb=Sb=Jf=0;fg=sf=-1;rc=ic=zd=0;Nf=-1;ac=$b=0;Mh="";Nh=1;ih=hh=sd=rd=eg=dg=Lh=zg=wi=vi=0;mb="";ng=rh=1;Ld=[];df="reactant";td="";Bg=1;qd=pd=0;Qh=
Rh=Wf=Xf=de=bh=Oh=ah=!1;fd=!0;cf=qf=kh=ig=Vg=Pe=ti=ue=Ug=Ag=ch=Kh=Jh=dh=Dj=Gh=Yg=Mf=yd=pf=sh=!1;Ee=!0;Ge=ve=Qe=tf=ee=Fe=!1;ka=da?45:30;Pk();I=Math.floor(6+8/30*(ka-15));yg=5+(ka-15)/5;Ra=ka/5;Gi=da?ua?ka/2:2*Ra:Ra+4;nj=ka/10;jj=ka/10;Gg=ka/5;Ih=da?15:Gg+2;mj=.86603*ka;Eg=Math.round(150*ka/24)/100;Ej=6*Eg;Sd=30<ka?2:1.5;fd=!0;cd(0);ed(0);xj("n");Pe=!1;nd();Jj()}function Qk(a){ka*=a;I=Math.floor(6+8/30*(ka-15));yg=5+(ka-15)/5;Ra=ka/5;Gi=da?ua?ka/2:2*Ra:Ra+4;hc=da?2*Ra:Ra+4;nj=ka/10;jj=ka/10;Gg=ka/5;
Ih=da?ua?ka/3:2*Gg:Gg+2;mj=.86603*ka;Eg=Math.round(150*ka/24)/100;Ej=6*Eg;Sd=30<ka?2:1.5}function Pk(){Z.save();Z.fillStyle="white";Z.fillRect(md.x+16,md.y-6,20,12);Z.font="10pt Sans-Serif";Z.fillStyle="black";Z.fillText(String(Math.round(ka)),(md.x+ce.x)/2-6,md.y+6);Z.restore()}function Ak(a){var b=ka,c=5*Math.floor(ka/5);new Wc(0,0,0,0);nd();if(!(2>h.length)){"in"===a?(b=c+5,50<b&&(b=50)):"out"===a&&(b=c-5,20>b&&(b=20));a=b/ka;if(1<a){for(Ve=1;Ve<h.length;Ve++)h[Ve].s=9;b=Rc(h,9,"s");for(Ve=1;Ve<
h.length;Ve++)h[Ve].s=0;if(a*b.c>ta.c||a*b.f>ta.f)return}Qk(a);Pk();new Wc(0,0,0,0);for(b=1;b<h.length;b++)h[b].s=9;b=Rc(h,9,"s");th(h,oa.b+oa.c/2-(b.b+b.c/2),oa.t+oa.f/2-(b.t+b.f/2),9);0<ja.length&&(Rk(ja,oa.b+oa.c/2-(b.b+b.c/2),oa.t+oa.f/2-(b.t+b.f/2)),Sk(oa.b+oa.c/2-(b.b+b.c/2),oa.t+oa.f/2-(b.t+b.f/2)));Gk(h,9,oa.b+oa.c/2,oa.t+oa.f/2,a,!1);0<ja.length&&(Hk(ja,oa.b+oa.c/2,oa.t+oa.f/2,a),Ik(cb,oa.b+oa.c/2,oa.t+oa.f/2,a));Ac();ob(Z,0,!0);of(Z);ob(Z,0,!0)}}function pj(a,b,c,e){var g;new Wc(0,0,0,0);
var f=0,n=0;if(!1!==ue){var q=Rc(a,e,"s");"y"===c?(f=-1*(q.b+q.c/2),n=0):"x"===c&&(n=-1*(q.t+q.f/2),f=0);th(a,f,n,e);for(q=1;q<a.length;q++)if(-1===e||a[q].s===e)if("y"===c?a[q].x*=-1:"x"===c&&(a[q].y*=-1),0!==a[q].z)for(g=0;g<a[q].a.length;g++)4===a[q].a[g].t?yc(h,X,Na(b,q,a[q].a[g].p),5,!1):5===a[q].a[g].t&&yc(h,X,Na(b,q,a[q].a[g].p),4,!1);th(a,-1*f,-1*n,e);for(g=1;g<a.length;g++)-1!==e&&a[g].s!==e||uf(a,g);for(q=0;q<Ha.length;q++)if(0<Ha[q].A){if(h[Ha[q].A].s===e||-1===e)Ha[q].crv=0<Ha[q].crv?
-1:1}else if(h[X[-1*Ha[q].A].g].s===e||-1===e)Ha[q].crv=0<Ha[q].crv?-1:1;Ac();Bc();sb();ob(Z,0,!0)}}function Bc(){Td=Fi();ok();Jj()}function Jj(){var a,b=h,c=X,e=Ha,g=ja,f=new Tk;var n=f.fa;var q=f.Ia;var y=f.Ha;var E=f.Pa;n.length=1;q.length=1;y.length=0;E.length=0;for(a=1;a<b.length;a++)Yh(b,n,a,a);for(a=1;a<c.length;a++)Zh(c,q,a,a);for(a=0;a<e.length;a++)Kj(e,y,a,a);for(a=0;a<g.length;a++)Ii(g,E,a,a);f.V=Td;f.w=Fg.length+1;f.ya=Bb;f.Ga=ke;Fg.push(f)}function Uk(){new Tk;var a;if(!(2>Fg.length)){Fg.pop();
var b=Fg[Fg.length-1];var c=b.fa;var e=b.Ia;var g=b.Ha;var f=b.Pa;var n=h;var q=X;var y=Ha;var E=ja;n.length=1;q.length=1;y.length=0;E.length=0;for(a=1;a<c.length;a++)Yh(c,n,a,a);for(a=1;a<e.length;a++)Zh(e,q,a,a);for(a=0;a<g.length;a++)Kj(g,y,a,a);for(a=0;a<f.length;a++)Ii(f,E,a,a);10===b.ya?Bb=0:Bb=b.ya;ke=b.Ga}}function ij(){Uk();cd(Bb);ed(ke);ob(Z,0,!0)}function Tk(){this.fa=[Jl];this.Ia=[Kl];this.Ha=[];this.Pa=[];this.Ga=this.ya=this.V=this.w=0}function Aj(){var a,b;for(a=0;a<h.length;a++)h[a].t=
0;var c=1;for(b=0;0<c;){c=0;for(a=1;a<h.length;a++)if(0===h[a].t){c=a;break}if(0===c)break;Nb=[];var e=mh(h,c);for(a=0;a<e;a++)h[Nb[a]].t=b;b++}return b-1}function pk(){var a,b;for(a=0;a<h.length;a++)h[a].s=0;var c=1;for(b=0;0<c;){c=0;for(a=1;a<h.length;a++)if(0===h[a].s){c=a;break}if(0===c)break;Nb=[];var e=mh(h,c);for(a=0;a<e;a++)h[Nb[a]].s=b;b++}return b-1}function $f(a,b){var c,e;if(0===a.length)return-1;for(c=0;c<a.length;c++)for(e=1;e<h.length;e++)h[e].t===a[c]&&h[e].s!==b&&(h[e].s=b)}function Uh(a){var b;
if(""===a||void 0===a)return-1;if("C:"===a)return 6;if("N:"===a)return 7;for(b=0;b<kg.length;b++)if(kg[b]===a)return b+1;return null!==a.match(Ll)?0:-1}function gc(a,b,c){return b>a.b&&b<a.b+a.c&&c>a.t&&c<a.t+a.f?!0:!1}function Bd(a,b,c,e){var g;for(g=1;g<a.length;g++){var f=Math.sqrt((c-a[g].x)*(c-a[g].x)+(e-a[g].y)*(e-a[g].y));if(f<=Ra)return g}for(g=1;g<b.length;g++){var n=b[g].g;var q=b[g].h;f=(a[n].x+a[q].x)/2;n=(a[n].y+a[q].y)/2;f=Math.sqrt((c-f)*(c-f)+(e-n)*(e-n));if(f<=Ra)return-g}return 0}
function Vh(a,b,c){var e;for(e=0;e<a[b].a.length;e++)if(a[b].a[e].p===c)return e;return-1}function Vk(a){var b,c=0;for(b=0;b<h[a].a.length;b++){var e=h[a].a[b].t;if(4===e||5===e)e=1;c+=e}return c}function yj(a,b){var c;var e="";if(Pe)return e=String(b);if(Vg)return e=String(a[b].R);if(!(c="C"!==a[b].j||a[b].a.length===a[b].G)){var g;for(g=c=0;c<a[b].a.length;)2===a[b].a[c].t&&g++,c++;c=2===g?!0:!1}c&&(e=a[b].j);if("C"!==a[b].j&&"H"!==a[b].j&&0<We[a[b].u]||"C"===a[b].j&&a[b].a.length===a[b].G)c=Lj(a,
b,!1),0<c&&(a=lh(a,b),90<a&&270>a?(1<c&&(e=String(c)+e),e="H"+e):(e+="H",1<c&&(e+=String(c))));return e}function Lj(a,b,c){var e=0,g;if("H"!==a[b].j&&0<We[a[b].u]){var f=We[a[b].u];wj.includes(a[b].j)&&(f-=2);c=c?a[b].G:0;for(g=0;g<a[b].a.length;g++){e=a[b].a[g].t;if(4===e||5===e)e=1;c+=e}e=f-c+a[b].o;if(Ml.includes(a[b].j)||"C"===a[b].j&&0<a[b].o)e=f-c-a[b].o;a[b].r&&e--}return Math.max(e,0)}function zj(a,b){var c="";1<Math.abs(a[b].o)&&(c+=String(Math.abs(a[b].o)));0<a[b].o?c+="+":0>a[b].o&&(c+=
"\u2013");return c}function qj(a,b,c,e){a=new xc(0,0);var g=new xc(0,0);var f=4*Ra;var n=c.b+c.c/2,q=c.t+c.f/2,y=e.b+e.c/2,E=e.t+e.f/2,F=Math.sqrt((y-n)*(y-n)+(E-q)*(E-q)),za=c.c/1.6,Ja=c.f/1.6,ha=e.c/1.6,Da=e.f/1.6,ba=c=0;e=Vc(n,q,y,E);za=za*Ja/Math.sqrt(za*za*Math.sin(Math.PI*e/180)*Math.sin(Math.PI*e/180)+Ja*Ja*Math.cos(Math.PI*e/180)*Math.cos(Math.PI*e/180));ha=ha*Da/Math.sqrt(ha*ha*Math.sin(Math.PI*e/180)*Math.sin(Math.PI*e/180)+Da*Da*Math.cos(Math.PI*e/180)*Math.cos(Math.PI*e/180));if(F-za-
ha<f)for(0<F-za-ha&&(c=1.05*Math.abs(f+za+ha-F)*Math.cos(Math.PI*e/180),ba=-1.05*Math.abs(f+za+ha-F)*Math.sin(Math.PI*e/180)),f=0;f<b.length;f++)uh(h,c,ba,b[f]);a.x=n+za*Math.cos(Math.PI*e/180);a.y=q-za*Math.sin(Math.PI*e/180);g.x=y-ha*Math.cos(Math.PI*e/180)+c;g.y=E+ha*Math.sin(Math.PI*e/180)+ba;Math.sqrt((g.x-n)*(g.x-n)+(g.y-q)*(g.y-q))<Math.sqrt((a.x-n)*(a.x-n)+(a.y-q)*(a.y-q))&&(b=a.x,a.x=g.x,g.x=b,b=a.y,a.y=g.y,g.y=b);Ld.push(a.x,a.y,g.x,g.y)}function uh(a,b,c,e){var g;for(g=1;g<a.length;g++)a[g].t===
e&&(a[g].x+=b,a[g].y+=c)}function xe(a,b,c,e,g){var f;if(!(c>=a.length||e>=a.length)&&c!==e){for(f=1;f<b.length;f++)if(b[f].g===c&&b[f].h===e||b[f].g===e&&b[f].h===c)return;var n=g;if(ig){f=Vk(c);var q=Vk(e);if(4<f+g&&"C"===a[c].j||4<q+g&&"C"===a[e].j)n=1}4===n&&"H"===a[c].j?(g=c,c=e,e=g,n=5):5===n&&"H"===a[c].j&&(g=c,c=e,e=g,n=4);b[b.length]=new me(c,e,n);4===n&&(a[e].z=1);5===n&&(a[e].z=-1);a[c].a.push(new Mj(e,n));a[e].a.push(new Mj(c,n));a===h&&(uf(a,c),uf(a,e))}}function Pf(a,b,c,e,g){var f=
0;var n=Vh(a,c,e);var q=Vh(a,e,c);if(0<=n&&0<=q){var y=a[c].a[n].t;var E=a[e].a[q].t;if(y===E){switch(g){case "+":if(1===y||2===y)f=y+1;else if(4===y||5===y)f=2;break;case "-":if(2===y||3===y)f=y-1}if(0<f)for(a[c].a[n].t=f,a[e].a[q].t=f,a=1;a<b.length;a++)0!==b[a].B&&(b[a].g===c&&b[a].h===e||b[a].h===c&&b[a].g===e)&&(b[a].B=f)}}}function yc(a,b,c,e,g){var f,n;var q=b[c].g;var y=b[c].h;var E=b[c].B;if((4===E||5===E)&&-1===e){if("H"!==a[y].j){for(g=n=f=0;g<a[q].a.length;){if(4===a[q].a[g].t||5===a[q].a[g].t){var F=
Na(b,q,a[q].a[g].p);b[F].h===q&&(f++,4===a[q].a[g].t?n++:5===a[q].a[g].t&&n--)}g++}if(!(0<f&&Math.abs(n)!==f||0<n&&5===E||0>n&&4===E)){for(g=n=f=0;g<a[y].a.length;){if(4===a[y].a[g].t||5===a[y].a[g].t)F=Na(b,y,a[y].a[g].p),b[F].h===y&&(f++,4===a[y].a[g].t?n++:5===a[y].a[g].t&&n--);g++}2>f&&(4===E||5===E)&&(a[y].z=0);e=q;q=y;y=e;a[y].z=4===b[c].B?1:-1;b[c].g=q;b[c].h=y}}}else if(E!==e){if(!0===g){for(g=n=f=0;g<a[y].a.length;){if(4===a[y].a[g].t||5===a[y].a[g].t)F=Na(b,y,a[y].a[g].p),b[F].h===y&&(f++,
4===a[y].a[g].t?n++:5===a[y].a[g].t&&n--);g++}if(Math.abs(n)!==f||1<f&&(4===E&&5===e||5===E&&4===e)||1<f&&(0<n&&5===e||0>n&&4===e))return}4===e&&(a[y].z=1);5===e&&(a[y].z=-1);1===e&&2>f&&(a[y].z=0);b[c].B=e;for(g=0;g<a[q].a.length;)a[q].a[g].p===y&&(a[q].a[g].t=e),g++;for(g=0;g<a[y].a.length;)a[y].a[g].p===q&&(a[y].a[g].t=e),g++}}function Nl(a,b,c,e,g,f,n){var q;var y=[];var E=[];var F=a.length;var za=b.length;for(q=1;q<F;q++)if(-1===g||a[q].s===g){var Ja=c.length;Yh(a,c,q,Ja);y.push(q);E.push(Ja);
c[Ja].x=a[q].x+f;c[Ja].y=a[q].y+n;-1<g&&(c[Ja].t=g)}for(q=1;q<F;q++)if(-1===g||a[q].s===g){for(f=0;f<a[q].a.length;f++)n=a[q].a[f].p,Ja=y.indexOf(n),n=y.indexOf(q),-1<Ja&&-1<n&&(Ja=E[Ja],c[E[n]].a[f].p=Ja);for(f=1;f<za;f++)if(b[f].g===q){var ha=e.length;Zh(b,e,f,ha);n=y.indexOf(q);e[ha].g=E[n];Ja=y.indexOf(b[f].h);-1<Ja&&-1<n&&(e[ha].h=E[Ja])}}}function Bi(a){void 0!==Ha[a]&&Ha.splice(a,1)}function Cg(a,b,c,e,g){var f=b[c].h,n=b[c].g;zi(a,b);if(!Xd(b,b[c].g,b[c].h)&&2!==b[c].B&&3!==b[c].B){vh(a,f,
n);var q=Nb.slice(0);var y=q.length;vh(a,n,f);var E=Nb.slice(0);f=E.length;f<y?(f=b[c].g,n=b[c].h,Nb=E.slice(0)):(f=b[c].h,n=b[c].g,Nb=q.slice(0));for(c=1;c<a.length;c++)a[c].s=0;for(c=1;c<Nb.length;c++)a[Nb[c]].s=1;y=a[f].x;q=a[f].y;c=ia(e*$a(a,f,n));Hg(a,1,-1*y,-1*q,!1);di(a,1,a[f].x,a[f].y,e*c,!1);n=Na(b,f,n);var F;for(E=1;E<a.length;E++)if(1===a[E].s&&(/x/.test("y")?a[E].x=-1*a[E].x:/y/.test("y")&&(a[E].y=-1*a[E].y),0!==a[E].z))for(F=0;F<a[E].a.length;F++)Na(b,E,a[E].a[F].p)!==n&&(4===a[E].a[F].t?
yc(h,X,Na(b,E,a[E].a[F].p),5,!1):5===a[E].a[F].t&&yc(h,X,Na(b,E,a[E].a[F].p),4,!1));di(a,1,a[f].x,a[f].y,-1*e*c,!1);Hg(a,1,y,q,!1);for(a=1;a<h.length;a++)1===h[a].s&&uf(h,a);g&&Ac()}}function th(a,b,c,e){var g;for(g=1;g<a.length;g++)if(-1===e||a[g].s===e)a[g].x+=b,a[g].y+=c}function Rk(a,b,c){var e;for(e=0;e<a.length;e++)a[e].T.x+=b,a[e].T.y+=c,a[e].S.x+=b,a[e].S.y+=c}function Sk(a,b){if(0===cb.length)return-1;var c;for(c=0;c<cb.length;c++)cb[c].b+=a,cb[c].t+=b}function Ok(){var a;new Wc(0,0,0,0);
var b=ka;for(a=1;a<h.length;a++)h[a].s=9;var c=Rc(h,9,"s");th(h,oa.b+oa.c/2-(c.b+c.c/2),oa.t+oa.f/2-(c.t+c.f/2),9);0<ja.length&&(Rk(ja,oa.b+oa.c/2-(c.b+c.c/2),oa.t+oa.f/2-(c.t+c.f/2)),Sk(oa.b+oa.c/2-(c.b+c.c/2),oa.t+oa.f/2-(c.t+c.f/2)));a=c.c/oa.c;c=c.f/oa.f;if(1<a||1<c)a=1/(1.1*Math.max(a,c)),a=5*Math.floor(b*a/5),a/=b,Gk(h,9,oa.b+oa.c/2,oa.t+oa.f/2,a,!1),Qk(a),I=Math.floor(6+8/30*(ka-15)),Z.save(),Z.fillStyle="white",Z.fillRect(md.x+16,md.y-6,20,12),Z.font="10pt Sans-Serif",Z.fillStyle="black",
Z.fillText(String(Math.round(ka)),(md.x+ce.x)/2-6,md.y+6),Z.restore(),0<ja.length&&(Hk(ja,oa.b+oa.c/2,oa.t+oa.f/2,a),Ik(cb,oa.b+oa.c/2,oa.t+oa.f/2,a));Ac()}function Yh(a,b,c,e){new mc(0,"",0,0,0,0,0);var g=new mc(0,"",0,0,0,0,0);c=a[c];g.s=c.s;g.za=c.za;g.u=c.u;g.j=c.j;g.x=c.x;g.y=c.y;g.o=c.o;g.G=c.G;g.ua=c.ua;g.va=c.va;g.aa=c.aa;g.z=c.z;g.r=c.r;g.R=c.R;g.U=c.U;g.J=c.J;g.F=c.F;g.t=c.t;g.na=c.na.slice(0);g.ma=c.ma.slice(0);for(a=0;a<c.a.length;a++)g.a.push(new Mj(c.a[a].p,c.a[a].t));b[e]=g}function Zh(a,
b,c,e){new me(0,0,0);var g=new me(0,0,0);a=a[c];g.s=a.s;g.Oa=a.Oa;g.g=a.g;g.h=a.h;g.B=a.B;b[e]=g}function Kj(a,b,c,e){new Di(0,0,"",0);var g=new Di(0,0,"",0);a=a[c];g.A=a.A;g.D=a.D;g.oa=a.oa;g.crv=a.crv;b[e]=g}function Ii(a,b,c,e){new Ci([],[],0,"","",0,0,0,0);var g=new Ci([],[],0,"","",0,0,0,0);a=a[c];g.I=a.I.slice(0);g.H=a.H.slice(0);g.oa=a.oa;g.fa=a.fa;g.pa=a.pa;g.T.x=a.T.x;g.T.y=a.T.y;g.S.x=a.S.x;g.S.y=a.S.y;b[e]=g}function Nj(a,b,c,e){var g;b.length=1;for(g=e.length=1;g<a.length;g++)Yh(a,b,g,
g);for(g=1;g<c.length;g++)Zh(c,e,g,g)}function Wk(a){var b,c,e,g=[];mg=[];xf=[];Le=[];for(b=1;b<a.length;b++)if("C"===a[b].j||2===a[b].a.length){for(c=e=0;c<a[b].a.length;c++)2===a[b].a[c].t&&e++;2==e&&g.push(b)}for(b=0;b<g.length;b++)mg.includes(g[b])||(c=Xk(a,g[b]),1!==a[c.l].a.length&&1!==a[c.C].a.length&&(0===c.n%2?Le.push(c):xf.push(c)))}function Xk(a,b){var c,e=-1,g=-1,f=new Oj(0,0,0,0);var n=[];var q=b;n.push(q);for(c=0;0>e&&20>=c;){var y=!1;for(b=0;b<a[q].a.length;b++)if(2===a[q].a[b].t&&
!n.includes(a[q].a[b].p)){q=a[q].a[b].p;n.push(q);y=!0;break}!1===y&&(e=q);c++}n=[];q=e;n.push(q);mg.push(q);for(c=0;0>g&&20>=c;){y=!1;for(b=0;b<a[q].a.length;b++)if(2===a[q].a[b].t&&!n.includes(a[q].a[b].p)){q=a[q].a[b].p;n.push(q);mg.push(q);y=!0;break}!1===y&&(g=q);c++}a=n.length;1!==a%2?f.o=0:(b=Math.floor(a/2),f.o=n[b]);f.l=e;f.C=g;f.n=a;return f}function Yk(a,b,c,e){var g,f=new Oj(0,0,0,0),n=0,q=0,y=0,E=0,F=0,za=0,Ja=0,ha=0,Da=0,ba="";f.o=c.o;f.l=c.l;f.C=c.C;f.n=c.n;var jb=a[f.l].x-a[f.o].x;
var Za=a[f.l].y-a[f.o].y;var Aa=a[f.C].x-a[f.o].x;var tb=a[f.C].y-a[f.o].y;c=[];var qa=[];var Cc=[];var yb=[];var wb=[];var jc=[];for(g=0;g<a[f.l].a.length;g++){if(0!==a[f.l].z&&3<a[f.l].a[g].t){var gd=Na(b,f.l,a[f.l].a[g].p);b[gd].h===f.l&&yb.push(a[f.l].a[g].p)}a[f.l].a[g].p===ye[f.l]?2!==a[f.l].a[g].t&&(n=1,c.push(a[f.l].a[g].p)):2!==a[f.l].a[g].t&&c.push(a[f.l].a[g].p);2===a[f.l].a[g].t&&(Da=a[f.l].a[g].p)}for(g=0;g<a[f.C].a.length;g++)0!==a[a[f.C].a[g].p].z&&Cc.push(a[f.C].a[g].p),a[f.C].a[g].p===
ye[f.C]?2!==a[f.C].a[g].t&&(n=2,qa.push(a[f.C].a[g].p)):2!==a[f.C].a[g].t&&qa.push(a[f.C].a[g].p),2===a[f.C].a[g].t&&(ha=a[f.C].a[g].p);"parse"===e&&2===qa.length&&qa[0]>qa[1]&&qa.reverse();1===c.length&&(0<a[f.l].G?(q=a[f.l].ua,y=a[f.l].va,E=a[f.l].aa):(b=(a[Da].x+a[c[0]].x)/2,g=(a[Da].y+a[c[0]].y)/2,Da=a[f.l].x-b,b=a[f.l].y-g,g=Math.sqrt(Da*Da+b*b),q=a[f.l].x+ka*Da/g,y=a[f.l].y+ka*b/g,E=-1*a[c[0]].z),c.unshift(-1));1===qa.length&&(0<a[f.C].G?(F=a[f.C].ua,za=a[f.C].va,Ja=a[f.C].aa):(b=(a[ha].x+a[qa[0]].x)/
2,g=(a[ha].y+a[qa[0]].y)/2,Da=a[f.C].x-b,b=a[f.C].y-g,g=Math.sqrt(Da*Da+b*b),F=a[f.C].x+ka*Da/g,za=a[f.C].y+ka*b/g,Ja=-1*a[qa[0]].z),qa.unshift(-1));Ec=[];Ec[0]=new mc(a[f.o].u,a[f.o].j,a[f.o].x,a[f.o].y,0,0,0);wb.push(f.o);1===n?(c[0]===ye[f.l]?(Ec[1]=new mc(a[c[0]].u,a[c[0]].j,a[c[0]].x-jb,a[c[0]].y-Za,0,0,a[c[0]].z),wb.push(c[0]),jc.push(1),-1!==c[1]?(Ec[2]=new mc(a[c[1]].u,a[c[1]].j,a[c[1]].x-jb,a[c[1]].y-Za,0,0,a[c[1]].z),wb.push(c[1])):(Ec[2]=new mc(1,"H",q-jb,y-Za,0,0,E),wb.push(-1))):(Ec[1]=
new mc(a[c[1]].u,a[c[1]].j,a[c[1]].x-jb,a[c[1]].y-Za,0,0,a[c[1]].z),wb.push(c[1]),jc.push(1),-1!==c[0]?(Ec[2]=new mc(a[c[0]].u,a[c[0]].j,a[c[0]].x-jb,a[c[0]].y-Za,0,0,a[c[0]].z),wb.push(c[0])):(Ec[2]=new mc(1,"H",q-jb,y-Za,0,0,E),wb.push(-1))),jc.push(2),-1===qa[0]?(Ec[3]=new mc(a[qa[1]].u,a[qa[1]].j,a[qa[1]].x-Aa,a[qa[1]].y-tb,0,0,a[qa[1]].z),wb.push(qa[1]),Ec[4]=new mc(1,"H",F-Aa,za-tb,0,0,Ja),wb.push(-1)):("parse"===e?(n=Math.min(qa[0],qa[1]),q=Math.max(qa[0],qa[1])):(n=uc.indexOf(qa[0]),q=uc.indexOf(qa[1])),
n<q?(Ec[3]=new mc(a[qa[0]].u,a[qa[0]].j,a[qa[0]].x-Aa,a[qa[0]].y-tb,0,0,a[qa[0]].z),wb.push(qa[0]),Ec[4]=new mc(a[qa[1]].u,a[qa[1]].j,a[qa[1]].x-Aa,a[qa[1]].y-tb,0,0,a[qa[1]].z),wb.push(qa[1])):(Ec[3]=new mc(a[qa[1]].u,a[qa[1]].j,a[qa[1]].x-Aa,a[qa[1]].y-tb,0,0,a[qa[1]].z),wb.push(qa[1]),Ec[4]=new mc(a[qa[0]].u,a[qa[0]].j,a[qa[0]].x-Aa,a[qa[0]].y-tb,0,0,a[qa[0]].z),wb.push(qa[0])))):2===n&&(qa[0]===ye[f.C]?(Ec[1]=new mc(a[qa[0]].u,a[qa[0]].j,a[qa[0]].x-Aa,a[qa[0]].y-tb,0,0,a[qa[0]].z),wb.push(qa[0]),
-1!==qa[1]?(Ec[2]=new mc(a[qa[1]].u,a[qa[1]].j,a[qa[1]].x-Aa,a[qa[1]].y-tb,0,0,a[qa[1]].z),wb.push(qa[1])):(Ec[2]=new mc(1,"H",F,za,0,0,Ja),wb.push(-1))):(Ec[1]=new mc(a[qa[1]].u,a[qa[1]].j,a[qa[1]].x-Aa,a[qa[1]].y-tb,0,0,a[qa[1]].z),wb.push(qa[1]),-1!==qa[0]?(Ec[2]=new mc(a[qa[0]].u,a[qa[0]].j,a[qa[0]].x-Aa,a[qa[0]].y-tb,0,0,a[qa[0]].z),wb.push(qa[0])):(Ec[2]=new mc(1,"H",F-Aa,za-tb,0,0,Ja),wb.push(-1))),-1===c[0]?(Ec[3]=new mc(a[c[1]].u,a[c[1]].j,a[c[1]].x-jb,a[c[1]].y-Za,0,0,a[c[1]].z),wb.push(c[1]),
jc.push(3),Ec[4]=new mc(1,"H",q-jb,y-Za,0,0,E),wb.push(-1)):("parse"===e?(n=Math.min(c[0],c[1]),q=Math.max(c[0],c[1])):(n=uc.indexOf(c[0]),q=uc.indexOf(c[1])),n<q?(Ec[3]=new mc(a[c[0]].u,a[c[0]].j,a[c[0]].x-jb,a[c[0]].y-Za,0,0,a[c[0]].z),wb.push(c[0]),jc.push(3),Ec[4]=new mc(a[c[1]].u,a[c[1]].j,a[c[1]].x-jb,a[c[1]].y-Za,0,0,a[c[1]].z),wb.push(c[1])):(Ec[3]=new mc(a[c[1]].u,a[c[1]].j,a[c[1]].x-jb,a[c[1]].y-Za,0,0,a[c[1]].z),wb.push(c[1]),jc.push(3),Ec[4]=new mc(a[c[0]].u,a[c[0]].j,a[c[0]].x-jb,a[c[0]].y-
Za,0,0,a[c[0]].z),wb.push(c[0]))),jc.push(4));for(g=1;g<wb.length;g++)Cc.includes(wb[g])&&(Ec[g].z=0);for(g=1;g<wb.length;g++)yb.includes(wb[g])&&(Ec[g].z=-1*a[f.l].z);if(Ec[jc[0]].z===Ec[jc[1]].z)Sc.push(wb[0]);else{c=[0,1,2,3,4];c=Zk(Ec,c,[0,0,0,0,0],[0,0,0,0,0],4110,e);c=$k(c);if(0<c)lg[String(f.o)]="@",ba=a[f.o].J="@";else if(0>c)lg[String(f.o)]="@@",ba=a[f.o].J="@@";else if(0===c)return"";if("parse"===e)return ba}}function Ji(a,b,c,e,g,f){var n,q=[],y=[],E=[],F="";var za=[];var Ja=[];var ha=
0;al(a,b,c,f);if("gen"===f){var Da=g.indexOf(c);var ba=-1;for(n=0;n<a[c].a.length;n++){var jb=g.indexOf(a[c].a[n].p);0<=jb&&jb<Da&&jb>ba&&(ba=jb)}0<=ba&&(ha=g[ba]);n=bl(a,c);Ol.includes(e)&&za.push(0);1===n&&0!==ha&&(0!==a[c].G?za.push(-1):za.push(0));if(void 0!==bc[String(c)])for(e=0;e<Zd.length;e++)jb=Zd[e].split(":"),n=jb[0],jb=jb[1],n=parseInt(n,10),jb=parseInt(jb,10),n===c&&jb!==ha?za.push(jb):jb===c&&n!==ha&&za.push(n);for(e=0;e<a[c].a.length;e++)a[c].a[e].p!==ha&&(za.includes(a[c].a[e].p)||
Ja.push(a[c].a[e].p));Ja=Pl(Ja,c,g);for(e=0;e<Ja.length;e++)za.push(Ja[e]);0===Da&&0===za[0]&&za.shift();q.push(c,ha,za[0],za[1],za[2])}else"parse"===f&&(q=g.slice(0),za=q.slice(2));y.push(0);for(e=1;e<q.length;e++)0<q[e]?(ha=Na(b,c,q[e]),3<b[ha].B&&b[ha].h===c?y.push(1):y.push(0)):y.push(0);E.push(0);for(e=1;e<q.length;e++){Ja=Na(b,q[e],q[0]);Da=!1;if(0<q[e])for(g=0;g<a[q[e]].a.length;g++)ha=Na(b,q[e],a[q[e]].a[g].p),3<b[ha].B&&b[ha].h===q[e]&&b[ha].g!==q[0]&&(Da=!0),!0===Da&&3<b[Ja].B&&b[Ja].h===
q[e]&&(Da=!1);!0===Da?E.push(1):E.push(0)}b=al(a,b,c,f);a=Zk(a,q,y,E,b,f);if(null===a)return Sc.push(c),"";if(3===za.length){F=f=0;for(za=1;5>za;za++)0<a[za].z?F++:0>a[za].z&&f++;y=a=Ql(a,q,4E3+100*F+10*f);q=new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);za=ef(y[0],y[1]);F=ef(y[0],y[2]);a=ef(y[0],y[3]);f=ef(y[0],y[4]);y=Ki(za);E=Ki(F);b=Ki(a);g=Ki(f);za=Li(za,ka/y);F=Li(F,ka/E);a=Li(a,ka/b);f=Li(f,ka/g);y=[];y.push(q);y.push(za);y.push(F);y.push(a);y.push(f);f=a=y;q=Mi(f,1,
2,3,4,0);za=Mi(f,2,3,4,1,0);F=Mi(f,3,4,1,2,0);f=Mi(f,4,1,2,3,0);!1===(q&&za&&F&&f)?(Sc.push(c),q=0):(q=$k(a),null===q&&(Sc.push(c),q=0));F=0<q?"@":0>q?"@@":""}return F}function al(a,b,c,e){var g=0,f=0;var n=a[c].a.length;0<a[c].G&&"parse"!==e&&(n++,0<a[c].aa?g++:0>a[c].aa&&f++);for(e=0;e<a[c].a.length;e++){var q=Na(b,c,a[c].a[e].p);4===a[c].a[e].t&&(b[q].g===c?g++:b[q].h===c&&f++);5===a[c].a[e].t&&(b[q].g===c?f++:b[q].h===c&&g++)}return 1E3*n+100*g+10*f}function mh(a,b){var c=[],e,g,f;Nb=[];c.push(b);
for(g=0;0<c.length;){b=c.pop();(f=Nb.includes(b))||Nb.push(b);for(e=0;e<a[b].a.length;e++)(f=Nb.includes(a[b].a[e].p))||c.push(a[b].a[e].p);g++;if(200<g)break}return Nb.length}function vh(a,b,c){var e=[],g="";Nb=[];var f=b;0<c&&(Nb.push(c),Nb.push(b),g+=String(a[c].R)+"-",g+=String(a[b].R));e.push(f);for(c=0;0<e.length;){f=e.pop();var n=Nb.includes(f);n||(Nb.push(f),0<c&&(g+="-"),g+=String(a[f].R));for(b=0;b<a[f].a.length;b++)(n=Nb.includes(a[f].a[b].p))||e.push(a[f].a[b].p);c++;if(200<c)break}return g}
function Pl(a,b,c){b=[];var e={},g=-1;b=a.slice(0);for(a=0;a<b.length;a++)g=c.indexOf(b[a]),0<=g&&(e[String(b[a])]=g);b.sort(function(f,n){return e[String(f)]-e[String(n)]});return b}function bl(a,b){var c,e=0,g,f=!1;var n=We[a[b].u];for(g=c=0;g<a[b].a.length;g++){var q=a[b].a[g].t;if(4===q||5===q)q=1;c+=q}c<=n&&(f=!0);0!==a[b].o&&(f=!1);"S"!==a[b].j||4!==c&&6!==c||(f=!1);"P"===a[b].j&&5===c&&(f=!1);"C"===a[b].j?e=n-c-Math.abs(a[b].o):wh.includes(a[b].j)&&f?e=n-c+a[b].o:0<a[b].G?e=a[b].G:e=0;return e}
function ei(a,b){var c;for(c=0;c<a[b].a.length;c++)if(3===a[b].a[c].t)return a[b].a[c].p;return 0}function Ue(a,b,c){var e=0;if(0<a[c].a.length)for(b=0;b<a[c].a.length;b++)2===a[c].a[b].t&&e++;return e}function yf(a){var b;for(b=0;b<Le.length;b++){if(a===Le[b].l)return Le[b].C;if(a===Le[b].C)return Le[b].l}return-1}function Na(a,b,c){var e;for(e=1;e<a.length;e++)if(a[e].g===b&&a[e].h===c||a[e].g===c&&a[e].h===b)return e;return-1}function zi(a,b){var c;Yd=[];dd=[];for(c=1;c<b.length;c++){var e=b[c].g;
Nj(a,wf,b,bi);var g=mh(wf,e);var f=c,n;var q=bi[f].g;var y=bi[f].h;var E=-1;for(n=0;n<wf[q].a.length;n++)wf[q].a[n].p===y&&(E=n);0<=E&&wf[q].a.splice(E,1);E=-1;for(n=0;n<wf[y].a.length;n++)wf[y].a[n].p===q&&(E=n);0<=E&&wf[y].a.splice(E,1);bi.splice(f,1);g===mh(wf,e)&&(Yd.push(c),(g=dd.includes(b[c].g))||dd.push(b[c].g),(g=dd.includes(b[c].h))||dd.push(b[c].h))}}function Xd(a,b,c){var e,g=!1;for(e=0;e<Yd.length;e++){var f=Yd[e];if(a[f].g===b&&a[f].h===c||a[f].g===c&&a[f].h===b)g=!0}return g}function cl(a){var b,
c=0,e=0,g=0,f=0;for(b=0;b<a.length;b++)"("===a.charAt(b)&&c++,")"===a.charAt(b)&&e++,"["===a.charAt(b)&&g++,"]"===a.charAt(b)&&f++;return c!==e?1:g!==f?-1:0}function Pj(a,b){return a.length!==b.length?!1:a.join()===b.join()?!0:!1}function Ni(a,b){b=b.slice(0);return Pj(a.slice(0).sort(function(c,e){return c-e}),b.sort(function(c,e){return c-e}))?!0:!1}function Qj(a,b){var c=a.join();for(a=0;a<b.length;a++){var e=b[a].join();if(c===e)return!0}return!1}function fi(a,b){var c=[];a=a.concat(b);b=a.length;
for(var e={};b--;){var g=a[b];e[g]||(c.unshift(g),e[g]=!0)}return c}function Xh(a,b){var c=[],e;for(e=0;e<b.length;e++)a.includes(b[e])&&c.push(b[e]);return c}function If(a){return String(Math.round(10*a)/10)}function ia(a){a%=360;0>a&&(a+=360);return a%360}function Vc(a,b,c,e){a=Math.atan2(e-b,c-a);0>a&&(a+=2*Math.PI);return ia(360-180*a/Math.PI)}function $a(a,b,c){return Vc(a[b].x,a[b].y,a[c].x,a[c].y)}function Ig(a,b,c,e,g,f){c-=a;e-=b;a=g-a;b=f-b;b=(c*a+e*b)/(Math.sqrt(c*c+e*e)*Math.sqrt(a*a+
b*b));1<b&&(b=1);-1>b&&(b=-1);return 180*Math.acos(b)/Math.PI}function Rl(a,b,c,e){var g=Math.sqrt((a[b[e].g].x-a[c].x)*(a[b[e].g].x-a[c].x)+(a[b[e].g].y-a[c].y)*(a[b[e].g].y-a[c].y));a=gi(a,b[e].g,b[e].h,c);return g*Math.sin(Math.PI*a/180)}function hi(a,b){return ia(ia(b)-ia(a))}function ff(a,b,c){var e=0,g=[],f=[],n=0,q=0,y=0;Pa=[];for(e=0;e<a[b].a.length;e++)0!==a[a[b].a[e].p].x&&0!==a[a[b].a[e].p].y&&(g.push($a(a,b,a[b].a[e].p)),f.push(a[b].a[e].p));g.sort(function(E,F){return E-F});f.sort(function(E,
F){return $a(a,b,E)-$a(a,b,F)});if(0<f.length){for(e=0;e<f.length-1;e++)y=hi(g[e],g[e+1]),n=f[e],q=f[e+1],Pa.push(new dl(n,q,y));y=hi(g[f.length-1],g[0]);n=f[f.length-1];q=f[0];Pa.push(new dl(n,q,y));c&&Pa.sort(function(E,F){return E.ca-F.ca})}}function Il(a,b,c){Pa=[];fb=[];ff(a,b,c);if(0!==Pa.length)for(a=0;a<Pa.length;a++){c=ia($a(h,b,Pa[a].Y)+Pa[a].ca/2);if(180<Math.floor(Pa[a].ca)||0===Math.floor(Pa[a].ca))c=ia(180+c);fb.push(c)}}function Nk(a,b,c){var e;if(0!==Pa.length){if(1===Pa.length)return 0;
for(e=0;e<Pa.length;e++){var g=$a(a,b,Pa[e].Y);var f=$a(a,b,Pa[e].ba);if(f<g||0===g&&f>g){if(c>g&&360>=c||c<f&&0<=c)return e}else if(c>g&&c<f)return e}}return-1}function rj(a,b){return ia(a+hi(a,b)/2)}function Qf(a,b,c,e,g){var f=new xc(0,0),n=new xc(0,0);new xc(0,0);f.x=a[c].x-a[b].x;f.y=a[c].y-a[b].y;var q=Math.sqrt(f.x*f.x+f.y*f.y);f.x/=q;f.y/=q;n.x=a[e].x-a[b].x;n.y=a[e].y-a[b].y;q=Math.sqrt(n.x*n.x+n.y*n.y);n.x/=q;n.y/=q;e=ai(f,n);q=Math.sqrt(e.x*e.x+e.y*e.y);return 0===q?ia($a(a,b,c)+(!1===
g?90:-90)):!1===g?Vc(0,0,e.x,e.y):Vc(e.x,e.y,0,0)}function gi(a,b,c,e){return Ig(a[b].x,a[b].y,a[c].x,a[c].y,a[e].x,a[e].y)}function uf(a,b){var c=a[b].a.slice(0);c.sort(function(e,g){return $a(a,b,e.p)-$a(a,b,g.p)});a[b].a=c.slice(0)}function lh(a,b){var c,e=-1,g=0,f=[];if(0===a[b].a.length)return 0;if(0<a[b].a.length){for(c=0;c<a[b].a.length;){f.push($a(a,b,a[b].a[c].p));if(1===a[b].a.length)return ia(180+f[f.length-1]);if(0<c){var n=hi(f[c-1],f[c]);var q=rj(f[c-1],f[c]);n>e&&(e=n,g=q)}c++}1<a[b].a.length&&
(n=hi(f[f.length-1],f[0]),q=rj(f[f.length-1],f[0]),n>e&&(g=q))}return g}function sj(a,b){b=Math.PI*b/180;return{x:a*Math.cos(b),y:-1*a*Math.sin(b)}}function xh(a,b){var c=new xc(0,0);if(void 0!==Ha[a])switch(b){case "st":return 0>Ha[a].A?(c.x=(h[X[-1*Ha[a].A].g].x+h[X[-1*Ha[a].A].h].x)/2,c.y=(h[X[-1*Ha[a].A].g].y+h[X[-1*Ha[a].A].h].y)/2):0<Ha[a].A&&(c.x=h[Ha[a].A].x,c.y=h[Ha[a].A].y),c;case "en":return 0>Ha[a].D?(c.x=(h[X[-1*Ha[a].D].g].x+h[X[-1*Ha[a].D].h].x)/2,c.y=(h[X[-1*Ha[a].D].g].y+h[X[-1*Ha[a].D].h].y)/
2):0<Ha[a].D&&(c.x=h[Ha[a].D].x,c.y=h[Ha[a].D].y),c}}function Sl(a,b,c,e){var g;a=new vd(0,0,0);var f=[],n=-1,q=g=0,y=0;n=0;q=-1;n=1;f=-1;y=[];var E=y=0,F=0,za=0;g=0;g=1;var Ja=!1;0!==c[0].z&&(Ja=!0);for(g=1;g<c.length;g++)0!==b[g]&&(za=Math.sqrt((c[g].x-c[0].x)*(c[g].x-c[0].x)+(c[g].y-c[0].y)*(c[g].y-c[0].y)+(c[g].z-c[0].z)*(c[g].z-c[0].z)),y+=(c[g].x-c[0].x)*ka/za,E+=(c[g].y-c[0].y)*ka/za,F+=(c[g].z-c[0].z)*ka/za);g=Math.sqrt(y*y+E*E+F*F);0<g?(g=ka/g,a.x=c[0].x-y*g,a.y=c[0].y-E*g,a.z=c[0].z-F*g):
Ja=!0;switch(e){case 3100:case 3010:n=-1;y=[];for(g=1;5>g;g++)0!==b[g]&&(0===c[g].z?y.push(g):0!==c[g].z&&(n=g));f=[];g=ia(Ig(c[0].x,c[0].y,c[y[0]].x,c[y[0]].y,c[y[1]].x,c[y[1]].y));q=ia(Ig(c[0].x,c[0].y,c[n].x,c[n].y,c[y[0]].x,c[y[0]].y));y=ia(Ig(c[0].x,c[0].y,c[n].x,c[n].y,c[y[1]].x,c[y[1]].y));f.push(g,q,y);f.sort(function(ha,Da){return ha-Da});180>=f[0]+f[1]?a.z=0:(a.x=c[n].x,a.y=c[n].y,a.z=-1*c[n].z);break;case 3110:for(g=1;5>g;g++)0!==b[g]&&0===c[g].z?f=g:0!==b[g]&&0!==c[g].z&&(0<c[g].z?q=g:
0>c[g].z&&(n=g));g=ia(Ig(c[0].x,c[0].y,c[q].x,c[q].y,c[n].x,c[n].y));q=ia(Ig(c[0].x,c[0].y,c[f].x,c[f].y,c[q].x,c[q].y));y=ia(Ig(c[0].x,c[0].y,c[f].x,c[f].y,c[n].x,c[n].y));n=Math.min(q,y);180<=g+n||g>q&&g>y?Ja=!0:a.z=0;break;case 3200:case 3020:case 3300:case 3030:case 3210:case 3120:a.z=0}return!1===Ja?a:null}function ai(a,b){var c=new xc(0,0);c.x=b.x+a.x;c.y=b.y+a.y;return c}function Hi(a,b){var c=new xc(0,0);c.x=a.x-b.x;c.y=a.y-b.y;return c}function Oi(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function ef(a,
b){var c=new vd(0,0,0);c.x=b.x-a.x;c.y=b.y-a.y;c.z=b.z-a.z;return c}function Ki(a){return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)}function Li(a,b){var c=new vd(0,0,0);c.x=a.x*b;c.y=a.y*b;c.z=a.z*b;return c}function Rf(a,b,c,e){var g=O[b].x;var f=O[b].y;var n=O[c].x;var q=O[c].y;var y=O[a].x;var E=O[a].y;a=(n-g)*(E-f)-(y-g)*(q-f);a/=Math.abs(a);g=O[c].x;f=O[c].y;n=O[b].x;q=O[b].y;y=O[e].x;E=O[e].y;b=(n-g)*(E-f)-(y-g)*(q-f);b/=Math.abs(b);return a*b}function cg(a,b,c,e){a=a*e-c*b;return 0===Math.abs(a)?
0:a/Math.abs(a)}function Zk(a,b,c,e,g,f){new vd(0,0,0);var n=[],q,y=!1;for(q=0;q<b.length;q++){if(-1===b[q]){var E=a;var F=b[0],za=new vd(0,0,0);za.x=E[F].ua;za.y=E[F].va;za.z=.5*ka*E[F].aa;E=za}else 0<b[q]?(E=a,F=b[q],za=new vd(0,0,0),za.x=E[F].x,za.y=E[F].y,za.z=.5*ka*E[F].z,E=za):E={x:0,y:0,z:0};n.push(E)}if("gen"===f){for(q=1;q<b.length;q++)1===c[q]&&(n[q].z=-1*n[0].z,n[0].z=0);for(q=1;q<b.length;q++)1===e[q]&&(n[q].z=0)}for(q=1;q<b.length;q++)0===b[q]&&(E=Sl(a,b,n,g),null!==E?(n[q].x=E.x,n[q].y=
E.y,n[q].z=E.z):y=!0);for(q=0;q<n.length;q++)0<n[q].z&&(n[q].z=.5*ka),0>n[q].z&&(n[q].z=-.5*ka);return y?null:n}function Ql(a,b,c){var e=b=0,g=0,f=0;f=0;var n=[],q=[1,2,3,4];switch(c){case 4100:case 4010:for(b=1;5>b;b++)0!==a[b].z&&(e=a[b].z,g=b);n.push(0);for(b=1;5>b;b++)f=Vc(a[0].x,a[0].y,a[b].x,a[b].y),n.push(f);f=n[g];for(b=1;5>b;b++)n[b]=ia(n[b]-f);q.sort(function(y,E){return n[y]-n[E]});for(b=1;5>b;b++)b!==g&&b!==q[2]&&(a[b].z=-1*e);a[q[2]].z=e;break;case 4200:for(b=1;5>b;b++)0===a[b].z&&(a[b].z=
-.5*ka);break;case 4020:for(b=1;5>b;b++)0===a[b].z&&(a[b].z=.5*ka);break;case 4300:case 4030:for(b=1;5>b;b++)0===a[b].z?g=b:e=a[b].z;for(b=1;5>b;b++)b===g&&(a[b].x=a[0].x,a[b].y=a[0].y,a[b].z=0<e?-.5*ka:.5*ka);break;case 4310:for(b=1;5>b;b++)0>a[b].z&&(a[b].x=a[0].x,a[b].y=a[0].y);break;case 4130:for(b=1;5>b;b++)0<a[b].z&&(a[b].x=a[0].x,a[b].y=a[0].y)}return a}function Rj(a,b){return a.x*b.x+a.y*b.y+a.z*b.z}function el(a,b){var c=new vd(0,0,0);c.x=a.y*b.z-a.z*b.y;c.y=a.z*b.x-a.x*b.z;c.z=a.x*b.y-a.y*
b.x;return c}function Mi(a,b,c,e,g,f){new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);c=ef(a[b],a[c]);e=ef(a[b],a[e]);g=ef(a[b],a[g]);a=ef(a[b],a[f]);f=el(c,e);b=Rj(f,g);a=Rj(f,a);f=b/Math.abs(b)===a/Math.abs(a);return 0==b||0==a?!1:f?!0:!1}function $k(a){new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);new vd(0,0,0);var b=ef(a[1],a[2]);var c=ef(a[1],a[3]);a=ef(a[1],a[4]);c=el(c,a);b=Rj(b,c);return 0==b?null:b/Math.abs(b)}function di(a,b,c,e,g,f){var n,q=[];for(n=1;n<a.length;n++)if(a[n].s===
b){q.push(n);var y=ia(180*Math.atan2(a[n].x-c,e-a[n].y)/Math.PI);var E=Math.sqrt((a[n].x-c)*(a[n].x-c)+(a[n].y-e)*(a[n].y-e));var F=E*Math.sin(Math.PI*ia(y+g)/180);y=-E*Math.cos(Math.PI*ia(y+g)/180);a[n].x=c+F;a[n].y=e+y;f&&(a[n].s=0)}}function Hg(a,b,c,e,g){var f;for(f=1;f<a.length;f++)if(a[f].s===b||0===b)a[f].x+=c,a[f].y+=e,g&&(a[f].s=0)}function Sj(a,b){a=String(a);if(a.length>=b)return a;for(;a.length<b;)a="0"+a;return a}function Tl(a,b){if(a.length>=b)return a;for(;a.length<b;)a="0"+a;return a}
function xc(a,b){this.x=a;this.y=b}function vd(a,b,c){this.x=a;this.y=b;this.z=c}function dl(a,b,c){this.Y=a;this.ba=b;this.ca=c}function Wc(a,b,c,e){this.b=a;this.t=b;this.c=c;this.f=e}function fl(a,b){this.r=a;this.Ka=b;this.da=0;this.Ma=[];this.ha=[];this.w=[];this.V=[]}function Oj(a,b,c,e){this.o=a;this.l=b;this.C=c;this.n=e}function Mj(a,b){this.p=a;this.t=b}function mc(a,b,c,e,g,f,n){this.za=this.s=0;this.u=a;this.j=b;this.x=c;this.y=e;this.o=g;this.z=n;this.r=!1;this.R=0;this.G=f;this.aa=this.va=
this.ua=0;this.J="";this.U=!1;this.t=this.F=0;this.a=[];this.na=[];this.ma=[]}function me(a,b,c){this.Oa=this.s=0;this.g=a;this.h=b;this.B=c}function Di(a,b,c,e){this.A=a;this.D=b;this.oa=c;this.crv=e}function Ci(a,b,c,e,g,f,n,q,y){this.I=a.slice(0);this.H=b.slice(0);this.oa=c;this.fa=e;this.pa=g;this.T=new xc(f,n);this.S=new xc(q,y)}function Mk(){function a(r){var z;Nj(Je,O,Ie,Oa);for(z=1;z<O.length;)O[z].s!==r&&(Sh(O,Oa,z,!1),z--),z++}function b(r){var z,u,w,x=!1;for(z=1;z<r.length;z++){var M=Vd.indexOf(r[z].j);
if(0<=M)var C="1010600"+String(Math.min(M+10,99));else{C=String(r[z].a.length);for(u=w=M=0;u<r[z].a.length;u++){var H=r[z].a[u].t;if(4===H||5===H)H=1;M+=H}C+=Sj(M,2);C+=Sj(r[z].u,2);C=0===r[z].o?C+"0":0<r[z].o?C+"1":C+"2";C+=String(Math.abs(r[z].o));u=We[r[z].u];M<=u&&(x=!0);0!==r[z].o&&(x=!1);r[z].r&&(x=!1);"S"!==r[z].j||4!==M&&6!==M||(x=!1);"P"===r[z].j&&5===M&&(x=!1);"C:"===r[z].j&&(u=2);"N:"===r[z].j&&(u=1);wh.includes(r[z].j)&&x?"C"===r[z].j?w=u-M-Math.abs(r[z].o):w=u-M+r[z].o:wh.includes(r[z].j)&&
!x?("C"===r[z].j?w=u-M-Math.abs(r[z].o):w=u-M+r[z].o,r[z].r&&w--):wh.includes(r[z].j)||0===u?w=0:(w=u-M+r[z].o,r[z].r&&w--);C+="0"+String(Math.max(Math.min(w,4),0))}r[z].R=parseInt(C,10)}}function c(r,z,u){for(z=1;z<r.length;z++)r[z].R*=2;r[u].R--;e(r)}function e(r){var z,u=[],w=0,x={};u[0]=0;for(z=1;z<r.length;z++)u[z]=r[z].R;u.sort(function(M,C){return M-C});x={};w=0;for(z=1;z<u.length;z++)u[z]>u[z-1]&&(w++,x[String(u[z])]=w);for(z=1;z<r.length;z++)r[z].R=x[String(r[z].R)];return w}function g(r){var z=
0,u;for(u=e(r);u!==z;){z=u;var w,x=r,M=[];for(w=1;w<x.length;w++){var C=1;for(u=0;u<x[w].a.length;u++){var H=x[w].a[u].p;H=gl[x[H].R];C*=H}M[w]=C}for(w=0;w<x.length;w++)x[w].R=parseInt(String(x[w].R)+Sj(M[w],12),10);u=e(r)}}function f(r){var z,u,w;for(z=1;z<r.length;z++){var x=w="";for(u=0;u<r[z].a.length;u++){var M=String(r[r[z].a[u].p].R);w=""===x?w+("["+String(r[z].a[u].p)):M===x?w+(","+String(r[z].a[u].p)):w+("];["+String(r[z].a[u].p));x=M}w+="]";id[z]=w}}function n(r){var z,u,w=!1,x=1,M="";var C=
id[r].split(";");for(z=0;z<C.length;z++){var H=1;var aa=C[z].replace("[","");aa=aa.replace("]","");aa=aa.split(",");if(u=1<aa.length){a:{u=r;var ra=parseInt(aa[0],10),Fa=parseInt(aa[1],10);if(2==aa.length){var Ga=Fc(u);var sa=Fc(ra);var ea=Fc(Fa);if(Ga===sa&&Ga===ea&&-1<Ga&&(ra=Na(Oa,u,ra),u=Na(Oa,u,Fa),-1<ra&&-1<u&&(2===Oa[ra].B&&1===Oa[u].B||1===Oa[ra].B&&2===Oa[u].B))){u=!0;break a}}u=!1}u=!u}if(u){w=!0;M+=C[z];for(u=1;u<=aa.length;u++)H*=u;x*=H}}w?(Zc.push(Number(r)),og[r]=M):og[r]="";return x}
function q(){function r(Ga){var sa,ea=[];if(0===Ga.length)return[[]];for(sa=0;sa<Ga.length;sa++){var Jb=Ga.slice(0);var Ma=Jb.splice(sa,1);var kb=r(Jb);for(Jb=0;Jb<kb.length;Jb++){var Xb=Ma.concat(kb[Jb]);ea.push(Xb)}}return ea}function z(Ga,sa){var ea,Jb,Ma=[];for(ea=0;ea<Ga.length;ea++)for(Jb=0;Jb<sa.length;Jb++){var kb=Ga[ea];var Xb=sa[Jb];kb=kb+","+Xb;Ma.push(kb)}return Ma}var u,w=[],x=[[]],M="";var C=[];var H="";var aa=[],ra=[],Fa=[];for(u=0;u<Zc.length;u++){aa=[];H=og[Zc[u]];H=H.replace("][",
";");H=H.replace("[","");H=H.replace("]","");w=H.split(";");ra=[];for(H=0;H<w.length;H++){x=[[]];Fa=[];C=w[H].split(",");aa.push(C.length);x=r(C);for(C=0;C<x.length;C++)M=x[C].join(),Fa.push(M);0<ra.length?ra=z(ra,Fa):ra=Fa}Sf[u]=ra.slice(0);gf[u]=ra.length}}function y(r){var z,u,w,x=r,M=gf.slice(0);for(z=0;z<r;z++)Nc[z]=[];for(w=0;w<Zc.length;w++)for(x/=M[w],z=u=0;z<r;z++)Nc[z].push(u),0===(z+1)%x&&(u++,u===M[w]&&(u=0))}function E(r,z){var u=[],w=[],x=[];var M="";M=[];w=Zc.indexOf(r);var C=O[r].a.slice(0);
for(M=0;M<O[r].a.length;M++)u[M]=O[r].a[M].p;M=Sf[w].slice();M=M[z];w=M.split(",");for(M=0;M<w.length;M++)w[M]=Number(w[M]);for(M=z=0;M<u.length;M++)w.includes(u[M])?(x[M]=w[z],z++):x[M]=u[M];C.sort(function(H,aa){return x.indexOf(H.p)-x.indexOf(aa.p)});O[r].a=C.slice(0)}function F(r,z){var u;ub=[];for(u=0;u<z.length;u++)if(2===z[u].B&&1<r[z[u].g].a.length&&1<r[z[u].h].a.length&&!(11>r[z[u].g].u&&1<Ue(r,z,z[u].g)||11>r[z[u].h].u&&1<Ue(r,z,z[u].h))&&!(11>r[z[u].g].u&&3<r[z[u].g].a.length||11>r[z[u].h].u&&
3<r[z[u].h].a.length||mg.includes(z[u].g)||mg.includes(z[u].h)))if(!Xd(z,z[u].g,z[u].h))ub.push(u);else if(!r[z[u].g].U&&!r[z[u].h].U){var w=Fc(z[u].g);var x=Fc(z[u].h);w===x&&0<=w&&w<Xc&&8<=Fb[w].length&&ub.push(u)}}function za(r,z){var u;for(u=0;u<ub.length;u++){var w=z[ub[u]].g;var x=z[ub[u]].h;var M;var C=r;var H,aa=0,ra=0,Fa=0,Ga=0;var sa=Fc(w);var ea=Fc(x);if(-1<sa&&-1===ea){for(M=H=0;M<C[w].a.length;M++)2!==C[w].a[M].t&&Fc(C[w].a[M].p)===sa&&(0===H?aa=C[w].a[M].p:1===H&&(ra=C[w].a[M].p),H++);
if(2===H){for(M=H=0;M<C[x].a.length;M++)2!==C[x].a[M].t&&(0===H?Fa=C[x].a[M].p:1===H&&(Ga=C[x].a[M].p),H++);C=Rf(aa,w,x,Fa);nc[String(w)+"-"+String(x)]={v:w,t:x,L:aa,M:ra,O:Fa,N:Ga,P:C,Fa:[sa]};na[sa].includes(String(w)+"-"+String(x))||na[sa].push(String(w)+"-"+String(x))}}else if(-1===sa&&-1<ea){for(M=H=0;M<C[x].a.length;M++)2!==C[x].a[M].t&&Fc(C[x].a[M].p)===ea&&(0===H?aa=C[x].a[M].p:1===H&&(ra=C[x].a[M].p),H++);if(2===H){for(M=H=0;M<C[w].a.length;M++)2!==C[w].a[M].t&&(0===H?Fa=C[w].a[M].p:1===
H&&(Ga=C[w].a[M].p),H++);C=Rf(aa,x,w,Fa);nc[String(x)+"-"+String(w)]={v:x,t:w,L:aa,M:ra,O:Fa,N:Ga,P:C,Fa:[ea]};na[ea].includes(String(x)+"-"+String(w))||na[ea].push(String(x)+"-"+String(w))}}else if(-1<sa&&-1<ea&&sa!==ea){for(M=H=0;M<C[w].a.length;M++)2!==C[w].a[M].t&&Fc(C[w].a[M].p)===sa&&(0===H?aa=C[w].a[M].p:1===H&&(ra=C[w].a[M].p),H++);if(2===H){for(M=H=0;M<C[x].a.length;M++)2!==C[x].a[M].t&&Fc(C[x].a[M].p)===ea&&(0===H?Fa=C[x].a[M].p:1===H&&(Ga=C[x].a[M].p),H++);2===H&&(C=Rf(aa,x,w,Fa),nc[String(w)+
"-"+String(x)]={v:w,t:x,L:aa,M:ra,O:Fa,N:Ga,P:C,Fa:[sa,ea]},na[ea].includes(String(w)+"-"+String(x))||na[ea].push(String(w)+"-"+String(x)),na[sa].includes(String(w)+"-"+String(x))||na[sa].push(String(w)+"-"+String(x)))}}}for(u=0;u<ub.length;u++)if(w=z[ub[u]].g,x=z[ub[u]].h,""===r[w].J||""===r[x].J)void 0!==Sa[String(w)+"-"+String(x)]&&delete Sa[String(w)+"-"+String(x)],void 0!==Sa[String(x)+"-"+String(w)]&&delete Sa[String(x)+"-"+String(w)],Ja(r,z,w,x);jc();if(0<$c.length)for(u=0;u<$c.length;u++){w=
!0;C=$c[u][$c[u].length-1];C=C.split("-");x=parseInt(C[1],10);hd=[];if(3===r[x].a.length){sa=[];for(C=0;C<r[x].a.length;C++)2!==r[x].a[C].t&&sa.push(r[x].a[C].p);wb(r,sa[0],x);wb(r,sa[1],x);C=gd(r,z,0,1,!1);0===C&&(w=!1)}else 1===r[x].a.length&&(w=!1);C=$c[u][0];C=C.split("-");x=parseInt(C[1],10);hd=[];if(3===r[x].a.length){sa=[];for(C=0;C<r[x].a.length;C++)2!==r[x].a[C].t&&sa.push(r[x].a[C].p);wb(r,sa[0],x);wb(r,sa[1],x);C=gd(r,z,0,1,!1);0===C&&(w=!1)}else 1===r[x].a.length&&(w=!1);if(w)for(C=0;C<
$c[u].length;C++)w=r,x=$c[u][C],void 0===Sa[x]&&void 0!==nc[x]&&(Sa[x]={v:nc[x].v,t:nc[x].t,L:nc[x].L,M:nc[x].M,O:nc[x].O,N:nc[x].N,P:nc[x].P},sa=String(Sa[x].t)+"-"+String(Sa[x].v),w[Sa[x].v].J=1===Sa[x].P?"t":"c",w[Sa[x].t].J=1===Sa[x].P?"t":"c",void 0===Sa[sa]&&(Sa[sa]={v:nc[x].t,t:nc[x].v,L:nc[x].O,M:nc[x].N,O:nc[x].L,N:nc[x].M,P:nc[x].P}))}}function Ja(r,z,u,w){var x,M=[],C=[],H=0,aa=0,ra=0,Fa=0;for(x=0;x<r[u].a.length;x++)2!==r[u].a[x].t&&M.push(r[u].a[x].p);1===M.length?(H=M[0],aa=0):2===M.length&&
(hd=[],wb(r,M[0],u),wb(r,M[1],u),x=gd(r,z,0,1,!0),0===x?aa=H=0:(1===x&&(H=M[0],aa=M[1]),-1===x&&(H=M[1],aa=M[0])));for(x=0;x<r[w].a.length;x++)2!==r[w].a[x].t&&C.push(r[w].a[x].p);1===C.length?(ra=C[0],Fa=0):2===C.length&&(hd=[],wb(r,C[0],w),wb(r,C[1],w),x=gd(r,z,0,1,!0),0===x?Fa=ra=0:(1===x&&(ra=C[0],Fa=C[1]),-1===x&&(ra=C[1],Fa=C[0])));if(0!==H&&0!==ra){x=Rf(H,u,w,ra);if(0===x||x!=x)console.log("set_ezConfig_one: vecproduct is 0 or NaN: e_z="+x),$a(r,H,u)===$a(r,u,w)&&Sc.push(u),$a(r,ra,w)===$a(r,
w,u)&&Sc.push(w),x=0;2!==M.length||Rf(H,u,w,ra)!==Rf(aa,u,w,ra)&&$a(r,aa,u)!==$a(r,u,w)||Sc.push(u);2!==C.length||Rf(ra,w,u,H)!==Rf(Fa,w,u,H)&&$a(r,Fa,w)!==$a(r,w,u)||Sc.push(w)}else x=0;1===x?(Sa[String(u)+"-"+String(w)]={v:u,t:w,L:H,M:aa,O:ra,N:Fa,P:x},Sa[String(w)+"-"+String(u)]={v:w,t:u,L:ra,M:Fa,O:H,N:aa,P:x},r[u].J="t",r[w].J="t"):-1!==x||Xd(z,u,w)||(Sa[String(u)+"-"+String(w)]={v:u,t:w,L:H,M:aa,O:ra,N:Fa,P:x},Sa[String(w)+"-"+String(u)]={v:w,t:u,L:ra,M:Fa,O:H,N:aa,P:x},r[u].J="c",r[w].J="c")}
function ha(r,z,u){for(var w in nc)if(nc.hasOwnProperty(w))switch(u){case "f":if(nc[w].v===z)return w;case "t":if(nc[w].t===z)return w;case "fl1":if(nc[w].L===z)return w;case "fl2":if(nc[w].M===z)return w;case "tl1":if(nc[w].O===z)return w;case "tl2":if(nc[w].N===z)return w;case "rx":if(nc[w].Fa===z)return w}return""}function Da(r,z){var u;for(u=0;u<Le.length;u++){var w=Le[u].l;var x=Le[u].C;""!==r[w].J&&""!==r[x].J||Ja(r,z,w,x)}}function ba(r,z){var u,w,x=0,M=0,C,H;for(w=0;w<xf.length;w++){var aa=
{o:0,l:0,C:0,n:0};aa.o=xf[w].o;aa.l=xf[w].l;aa.C=xf[w].C;aa.n=xf[w].n;if(""===r[aa.o].J){var ra=H=C=!1;for(u=0;u<r[aa.l].a.length;u++)4===r[aa.l].a[u].t&&(H=!0),5===r[aa.l].a[u].t&&(ra=!0);0<r[aa.l].G&&0<r[aa.l].aa&&(H=!0);0<r[aa.l].G&&0>r[aa.l].aa&&(ra=!0);if(ra||H)C=!0,M=aa.l,x=aa.C;ra=H=!1;for(u=0;u<r[aa.C].a.length;u++)4===r[aa.C].a[u].t&&(H=!0),5===r[aa.C].a[u].t&&(ra=!0);0<r[aa.C].G&&0<r[aa.C].aa&&(H=!0);0<r[aa.C].G&&0>r[aa.C].aa&&(ra=!0);(ra||H)&&!1===C?(C=!0,M=aa.C,x=aa.l):(ra||H)&&!0===C&&
(C=!1,Sc.push(aa.o));if(C){aa.l=M;aa.C=x;ra=r;var Fa=z,Ga=0,sa=0;C=aa.l;u=aa.C;hd=[];for(H=0;H<ra[C].a.length;H++)4!==ra[C].a[H].t&&5!==ra[C].a[H].t||wb(ra,ra[C].a[H].p,C);2===hd.length?Ga=gd(ra,Fa,0,1,!0):Ga=1;hd=[];for(H=0;H<ra[u].a.length;H++)1===ra[u].a[H].t&&wb(ra,ra[u].a[H].p,u);2===hd.length?sa=gd(ra,Fa,0,1,!0):sa=0===hd.length?0:1;(u=0!==Ga&&0!==sa?!0:!1)&&Ta.push(aa)}}}}function jb(r,z,u){var w;for(w=0;w<Ta.length;w++)Yk(r,z,Ta[w],u)}function Za(r,z,u){var w,x,M;"reset"===u&&(ab=[],Mc=[]);
for(w=1;w<r.length;w++)if("add"!==u||""===r[w].J){var C=Aa(r,z,w);if(x=""!==C?!0:!1){a:{var H,aa=r,ra=z;var Fa=w;hd=[];for(M=0;M<aa[Fa].a.length;M++)wb(aa,aa[Fa].a[M].p,Fa);for(M=0;M<hd.length-1;M++)for(H=M+1;H<hd.length;H++)if(Fa=gd(aa,ra,M,H,!0),0===Fa){M=!1;break a}M=!0}!1===M&&(x=!1);x&&!ab.includes(w)&&(ab.push(w),kc[String(w)]="",Mc.push(C))}}}function Aa(r,z,u){var w,x="",M=!1;for(w=0;w<r[u].a.length;w++){if(4===r[u].a[w].t||5===r[u].a[w].t)M=!0;1===r[u].G&&0!==r[u].aa&&(M=!0)}if(M){var C=
bl(r,u);x=r[u].j+":"+String(r[u].a.length)+":"+String(C)+":"+String(r[u].o);if("N:3:0:0"===x){var H=[];for(w=0;w<r[u].a.length;w++)Xd(z,u,r[u].a[w].p)&&H.push(r[u].a[w].p);2===H.length&&Xd(z,H[0],H[1])&&(x="N:3:0:az")}Ul.includes(x)||(M=!1);1<C?M=!1:2>=r[u].a.length&&(M=("P:2:1:0"===x&&2<=r[u].a.length||"As:2:1:0"===x&&2<=r[u].a.length)&&0<r[u].G?!0:!1)}return M?x:""}function tb(r,z){var u;for(u=0;u<ab.length;u++){var w=Ji(r,z,ab[u],Mc[u],uc,"gen");r[ab[u]].J=w;kc[String(ab[u])]=w}}function qa(r){var z,
u=0;for(z=1;z<r.length;z++)""!==r[z].J&&u++;return u}function Cc(r,z,u){z=[];var w;zc=[];uc=[];td="";z.push(u);for(w=0;0<z.length&&zc.length<r.length-1;){var x=z.pop();var M=zc.includes(x);if(!M){zc.push(x);var C="";0<nb[ye[x]]&&(C+="(",--nb[ye[x]]);C=x===u?C+String(x):C+("\u00b7"+String(x));uc.push(x);td+=C;1===r[x].a.length-gb[x]&&zc.length<r.length-1&&x!==u&&(td+=")");for(C=0;C<r[x].a.length;C++)(M=zc.includes(r[x].a[C].p))||z.push(r[x].a[C].p)}w++;if(200<w)break}}function yb(r,z,u){var w=[],x,
M,C=[];Zd=[];ye=[];nb=[];gb=[];nb[0]=0;gb[0]=0;for(x=1;x<r.length;x++)nb[x]=x===u&&1<r[x].a.length?Math.max(r[x].a.length-1,0):Math.max(r[x].a.length-2,0),gb[x]=0;w.push(u);for(M=0;0<w.length&&C.length<r.length-1;){u=w.pop();var H=C.includes(u);if(!H){ye[u]=0;if(0<C.length)for(x=C.length-1;0<=x;x--)if(0<=Vh(O,C[x],u)){ye[u]=C[x];break}C.push(u);for(x=0;x<r[u].a.length;x++)if(H=C.includes(r[u].a[x].p)){if(r[u].a[x].p!==ye[u]&&Xd(z,r[u].a[x].p,u)){H=String(r[u].a[x].p)+":"+String(u);var aa;a:{for(aa=
0;aa<Zd.length;aa++)if(Zd[aa]===H){aa=!0;break a}aa=!1}aa||(Zd.push(H),gb[u]+=1,gb[r[u].a[x].p]+=1,nb[r[u].a[x].p]=Math.max(nb[r[u].a[x].p]-1,0),nb[u]=Math.max(nb[u]-1,0))}}else w.push(r[u].a[x].p)}M++;if(200<M)break}}function wb(r,z,u){var w=[],x=[],M=[],C={},H=[],aa=[],ra=new fl(0,0),Fa;w.push(z);x.push(z);M.push(u);var Ga=C[String(z)]=0;H.push(r[z].J);for(""!==r[z].J&&Ga++;0<w.length;){var sa=w.shift();for(Fa=0;Fa<r[sa].a.length;Fa++){var ea=r[sa].a[Fa].p;x.includes(ea)||ea===u||(x.push(ea),H.push(r[ea].J),
""!==r[ea].J&&Ga++,M.push(sa),C[String(ea)]=C[String(sa)]+1,w.push(ea))}}for(Fa=0;Fa<x.length;Fa++)aa[Fa]=C[String(x[Fa])];ra.r=z;ra.Ka=u;ra.da=Ga;ra.Ma=x.slice(0);ra.ha=aa.slice(0);ra.w=M.slice(0);ra.V=H.slice(0);hd.push(ra)}function jc(){var r=0,z=r=0;z="";var u=-1,w=0,x=0,M=[],C=[],H=[],aa=[];if(0!==Md.length){$c=[];for(r=0;r<Md.length;r++)aa[r]=Md[r].split(",");M=Md.join().split(",");M=M.filter(function(ra,Fa,Ga){return Fa===Ga.indexOf(ra)});for(r=0;r<M.length;r++)for(C.push([]),z=0;z<aa.length;z++)aa[z][0]!==
M[r]&&aa[z][1]!==M[r]||C[C.length-1].push(z);x=w=r=0;z=aa[w][x];u=M.indexOf(z);$c.push([]);for(H=[];""!==z&&20>r;){H.includes(z)||($c[$c.length-1].push(z),H.push(z));if(H.length>=M.length)break;1===C[u].length?0!==x||H.includes(aa[w][1])?1!==x||H.includes(aa[w][0])?(x=0,w++,$c.push([])):x=0:x=1:2===C[u].length&&(C[u][0]===w?(w=C[u][1],aa[w][0]===z?x=1:aa[w][1]===z&&(x=0)):C[u][1]===w&&(w=C[u][0],aa[w][0]===z?x=1:aa[w][1]===z&&(x=0)));if(H.length>=M.length)break;z="";if(void 0===aa[w][x]||H.includes(aa[w][x]))break;
else z=aa[w][x],u=M.indexOf(z);r++}0===$c[$c.length-1].length&&$c.splice(-1,1)}}function gd(r,z,u,w,x){function M(Fa,Ga,sa,ea){var Jb=1;for(Ga=0;hd[sa].ha[Ga]<ea;)Ga++;for(;hd[sa].ha[Ga]===ea;)Jb*=gl[Fa[hd[sa].Ma[Ga]].R],Ga++;return Jb}var C=0;var H=hd[u].ha[hd[u].ha.length-1];var aa=hd[w].ha[hd[w].ha.length-1];for(C=0;C<=Math.min(H,aa);){var ra=M(r,z,u,C)-M(r,z,w,C);if(0!==ra){if(0<ra)return 1;if(0>ra)return-1}else{if(C===H&&C===aa&&0===ra)return C=Yc(r,z,hd[u].r,hd[w].r,hd[u].Ka,x),0!==C?1:0;C++;
if(C>H)return-1;if(C>aa)return 1}}}function Yc(r,z,u,w,x,M){function C(Ea,Ia,xa,Xa){var Qb=[],Oc=[],Gc=[],db=[];var lb=Ia.slice(0);var xb=lb.indexOf(xa);var ze=lb.indexOf(Xa);for(Ia=0;Ia<Ea[xa].a.length;Ia++)2!==Ea[xa].a[Ia].t&&(Qb.push(Ea[xa].a[Ia].p),Gc.push(lb.indexOf(Ea[xa].a[Ia].p)));if(2===Qb.length)Qb=Math.abs(xb-Gc[0])<Math.abs(xb-Gc[1])?Qb[0]:Qb[1];else if(1===Qb.length)Qb=Qb[0];else return"";for(Ia=0;Ia<Ea[Xa].a.length;Ia++)2!==Ea[Xa].a[Ia].t&&(Oc.push(Ea[Xa].a[Ia].p),db.push(lb.indexOf(Ea[Xa].a[Ia].p)));
if(2===Oc.length)Oc=Math.abs(ze-db[0])<Math.abs(ze-db[1])?Oc[0]:Oc[1];else if(1===Oc.length)Oc=Oc[0];else return"";if(-1===Rf(Qb,xa,Xa,Oc))return Ea[xa].J="c",Ea[Xa].J="c";Ea[xa].J="t";return Ea[Xa].J="t"}var H=[],aa=[],ra=0,Fa=0,Ga="",sa="";ra=Fa=ra=Fa="";var ea=!1,Jb=!1,Ma=!1,kb=!0,Xb=!1;Fa=ra="";H=0;vh(r,u,x);H=Nb.slice(0);vh(r,w,x);aa=Nb.slice(0);if(H.length===aa.length){for(u=1;u<H.length;u++)M&&H[u]===aa[u]?!1===Xb&&(Xb=!0,ra=ha(r,x,"f"),Fa=ha(r,H[u],"f"),""===ra||""===Fa||Md.includes(ra+","+
Fa)||Md.includes(Fa+","+ra)||Md.push(ra+","+Fa)):Xb=!1,ra=Te(H[u]),Fa=Te(aa[u]),0<ra&&0<Fa?(Ga=r[H[u]].J,sa=r[aa[u]].J,"c"===Ga&&"c"===sa||"t"===Ga&&"t"===sa||("c"===Ga&&"t"===sa||"t"===Ga&&"c"===sa?kb=!1:(Ga=C(r,H,H[u],ra),sa=C(r,aa,aa[u],Fa),Ga!==sa&&(kb=!1)))):(Fa=Aa(r,z,H[u]),ra=Aa(r,z,aa[u]),Fa===ra&&""!==Fa&&(Fa=Ji(r,z,H[u],Fa,H,"gen"),ra=Ji(r,z,aa[u],ra,aa,"gen"),""!==Fa&&""!==ra&&(Fa===ra?!1===ea&&!1===Jb?ea=!0:!0===Jb&&(Ma=!0,Jb=ea=!1):!1===ea&&!1===Jb?Jb=!0:!0===ea&&(Ma=!0,Jb=ea=!1))));
H=ea&&kb||kb&&!ea&&!Jb&&!Ma?0:-1}else H=-1;return H}function Te(r){var z;if(0===r)return-1;for(z=0;z<ub.length;z++){if(Oa[ub[z]].g===r&&("c"===O[r].J||"t"===O[r].J))return Oa[ub[z]].h;if(Oa[ub[z]].h===r&&("c"===O[r].J||"t"===O[r].J))return Oa[ub[z]].g}return-1}function qh(r){function z(Gb,vb){var jd,ud,$d=0;if(3===Gb[vb].a.length)for(jd=$d=0;jd<Gb[vb].a.length;jd++)if(2===Gb[vb].a[jd].t)$d++;else if(1===Gb[vb].a[jd].t)for(ud=0;ud<Gb[Gb[vb].a[jd].p].a.length;ud++)2===Gb[Gb[vb].a[jd].p].a[ud].t&&$d++;
return 3===$d?!0:!1}function u(Gb,vb){var jd,ud,$d;for(jd=$d=0;jd<Gb[vb].a.length;jd++)if(1===Gb[vb].a[jd].t)for(ud=0;ud<Gb[Gb[vb].a[jd].p].a.length;ud++)2===Gb[Gb[vb].a[jd].p].a[ud].t&&$d++;return 2<=$d?!0:!1}function w(Gb,vb){var jd,ud,$d="";var fe=!1;var zf=We[Gb[vb].u];for(ud=jd=0;ud<Gb[vb].a.length;ud++){var wd=Gb[vb].a[ud].t;if(4===wd||5===wd)wd=1;jd+=wd}jd<=zf&&0<zf&&(fe=!0);0!==Gb[vb].o&&(fe=!1);Gb[vb].r&&(fe=!1);0<Ta.length&&void 0!==lg[String(vb)]?(wd=lg[String(vb)],fe=!1):wd="";0<ab.length&&
ab.includes(vb)&&(void 0!==kc[String(vb)]?(wd=kc[String(vb)],""!==wd&&(fe=!1)):wd="");"S"!==Gb[vb].j||4!==jd&&6!==jd||(fe=!1);"P"===Gb[vb].j&&5===jd&&(fe=!1);"C:"===Gb[vb].j&&(zf=2);"N:"===Gb[vb].j&&(zf=1);ud=Lj(Gb,vb,!0)+Gb[vb].G;ud+jd!==zf&&(fe=!1);zf=Gb[vb].U&&Vl.includes(Gb[vb].j)?Gb[vb].j.toLowerCase():wj.includes(Gb[vb].j)?Gb[vb].j.slice(0,1):Gb[vb].j;fe&&wh.includes(Gb[vb].j)?Gb=zf:(fe=0>=ud?"":1===ud?"H":"H"+String(ud),0===Gb[vb].o?$d="":0<Gb[vb].o?($d="+"+String(Gb[vb].o),1===Gb[vb].o&&($d=
"+")):0>Gb[vb].o&&($d=String(Gb[vb].o),-1===Gb[vb].o&&($d="-")),Gb="["+zf+wd+fe+$d+"]");return Gb}var x=0,M=0,C=/\u00b7(\d+)/,H=[],aa="",ra="",Fa=x="",Ga=ra="";x="";var sa=0,ea=-1,Jb="",Ma=0,kb="",Xb=1,Ea=ea=0,Ia=0,xa=0,Xa=0,Qb=M=0,Oc=0,Gc=0;kb=[];var db=0,lb="",xb={};Qb=0;var ze=db="";ra=aa=td;for(ae in xb)xb.hasOwnProperty(ae)&&delete xb[ae];var ae=aa.match(/^(\d+)/);null!==ae&&(x=String(ae[0]),aa=aa.slice(ae.index+x.length),Ma=parseInt(ae[1],10),Jb="",void 0!==bc[String(Ma)]&&(Jb=bc[String(Ma)]),
Ga=w(r,Ma),ra=Ga+Jb+ra.slice(x.length),H.push(Ma));for(;0!==aa.length&&null!==ae;)if(ae=ra.match(C),null!==ae){x=String(ae[0]);aa=ra.slice(ae.index+x.length);Ma=parseInt(ae[1],10);Fa=ra.slice(0,ae.index);ra=ra.slice(ae.index+x.length);for(x=0;x<r[Ma].a.length;x++)if(r[Ma].a[x].p===ye[Ma]||H.includes(r[Ma].a[x].p)){r[Ma].U&&r[r[Ma].a[x].p].U?sa=0:sa=r[Ma].a[x].t;switch(sa){case 0:case 1:case 4:case 5:Jb="";break;case 2:Jb="=";break;case 3:Jb="#"}if(0<Jb.length)break}Ga=w(r,Ma);x="";ea=Te(Ma);-1===
ea&&(ea=yf(Ma));if(-1!==ea&&""!==r[Ma].J&&""!==r[ea].J)if(H.includes(ea)){if(void 0!==bc[String(Ma)])for(x=0;x<uc.length;x++)uc[x]!==Ma&&void 0!==bc[String(uc[x])]&&bc[String(uc[x])]===bc[String(Ma)]&&(xa!==uc[x]||0!==Xa&&"1"!==lb.charAt(2)?Xa===uc[x]&&(1===Xb?ze="\\"===db?"/":"\\":ze=db,void 0!==xb[String(xa)]&&""!==xb[String(xa)]&&"0"===lb.charAt(2)&&(xb[String(xa)]="")):(1===Xb?ze=db:ze="\\"===db?"/":"\\",void 0!==xb[String(Xa)]&&""!==xb[String(Xa)]&&"0"===lb.charAt(3)&&(xb[String(Xa)]="")));Jb+=
Ga;Jb+=ze;ze=""}else{if(void 0!==Sa[String(Ma)+"-"+String(ea)]){kb=String(Ma)+"-"+String(ea);lb="";Gc=Oc=0;ea=Sa[kb].t;Ea=Sa[kb].L;Ia=Sa[kb].M;H.includes(Ea)&&H.includes(Ia)&&(M=H.indexOf(Ea),Qb=H.indexOf(Ia),Ea=H[Math.max(M,Qb)],Ia=H[Math.min(M,Qb)]);lb+=String(-1!==Te(Ea)||-1!==yf(Ea)?1:0);lb+=String(-1!==Te(Ia)||-1!==yf(Ia)?1:0);xa=Sa[kb].O;Xa=Sa[kb].N;0!==xa&&0!==Xa&&(M=uc.indexOf(xa),Qb=uc.indexOf(Xa),void 0!==bc[String(xa)]&&void 0!==bc[String(ea)]&&bc[String(xa)]===bc[String(ea)]&&(Oc=xa),
void 0!==bc[String(xa)]&&void 0!==bc[String(ea)]&&bc[String(xa)]===bc[String(ea)]&&(Gc=Xa),0===Oc&&0===Gc?(xa=uc[Math.min(M,Qb)],Xa=uc[Math.max(M,Qb)]):0!==Gc&&0===Oc&&(Xa=xa,xa=Gc));lb+=String(-1!==Te(xa)||-1!==yf(xa)?1:0);lb+=String(-1!==Te(Xa)||-1!==yf(Xa)?1:0);Xb=Sa[kb].P;Ea!==Sa[kb].L&&(Xb*=-1);xa!==Sa[kb].O&&(Xb*=-1);switch(lb){case "0000":case "0001":case "0010":case "0011":if(!r[Ea].U&&z(r,Ea)){kb=[];for(M=Qb=0;M<r[Ea].a.length;M++)1===r[Ea].a[M].t?kb.push(r[Ea].a[M].p):2===r[Ea].a[M].t&&
(Qb=r[Ea].a[M].p);2===kb.length&&H.includes(Qb)&&H.includes(Ea)?(uc.indexOf(kb[0])>uc.indexOf(kb[1])&&(db=kb[0],kb[0]=kb[1],kb[1]=db),db=x=Ma===kb[0]?"\\":Ma===kb[1]&&void 0!==xb[String(kb[0])]?"\\"===xb[kb[0]]?"/":"\\":"\\",xb[String(Ma)]=x):(db=x="\\",xb[String(Ma)]=x)}else if(u(r,Ea)){kb=[];for(M=Qb=0;M<r[Ea].a.length;M++)1!==r[Ea].a[M].t||"c"!==r[r[Ea].a[M].p].J&&"t"!==r[r[Ea].a[M].p].J||uc.indexOf(Ea)<uc.indexOf(r[Ea].a[M].p)&&kb.push(r[Ea].a[M].p);1<kb.length&&H.includes(Ea)?(kb.sort(function(Gb,
vb){return uc.indexOf(Gb)-uc.indexOf(vb)}),Ma===kb[0]?(db=x="\\",xb[String(Ma)]=x):0<kb.indexOf(Ma)&&void 0!==xb[String(kb[0])]&&(db=x="\\"===xb[kb[0]]?"/":"\\",xb[String(Ma)]=x)):(db=x="\\",xb[String(Ma)]=x)}else db=x="\\",xb[String(Ma)]=x;break;case "0100":void 0!==bc[String(Ia)]&&H.includes(Ia)&&(db=x="\\",xb[String(Ma)]=x);break;case "1000":case "1001":case "1101":case "1010":case "1011":case "1100":case "1111":if(void 0!==xb[String(Ma)])db=x=xb[String(Ma)];else if(z(r,Ea))for(M=0;M<r[Ea].a.length;M++)1===
r[Ea].a[M].t&&void 0!==xb[String(r[Ea].a[M].p)]?(db=x="\\"===xb[String(r[Ea].a[M].p)]?"/":"\\",xb[String(Ma)]=x):1===r[Ea].a[M].t&&(db=x="\\",xb[String(Ma)]=x);else db=x="\\",xb[String(Ma)]=x}switch(lb){case "0100":case "0101":case "1101":case "0111":case "1111":case "1100":xb[String(Ia)]="\\";if("0100"===lb||"0101"===lb||"0111"===lb)db="\\";break;case "0110":uc.indexOf(Ia)<uc.indexOf(xa)?(db=xb[String(Ia)]="\\",xb[String(xa)]=1===Xb?xb[String(Ia)]:"\\"===xb[String(Ia)]?"/":"\\"):(db=xb[String(xa)]=
"\\",xb[String(Ia)]=1===Xb?xb[String(xa)]:"\\"===xb[String(xa)]?"/":"\\")}switch(lb){case "0000":case "1000":case "1100":if(void 0===bc[String(xa)]||bc[String(xa)]!==bc[String(ea)])xb[String(xa)]=1===Xb?db:"\\"===db?"/":"\\";break;case "0011":case "0010":case "1111":xb[String(xa)]=1===Xb?db:"\\"===db?"/":"\\";break;case "1011":case "1010":xb[String(xa)]=1===Xb?db:"\\"===db?"/":"\\";break;case "0100":case "0111":xb[String(xa)]=1===Xb?db:"\\"===db?"/":"\\"}switch(lb){case "0000":case "1000":case "1100":void 0!==
bc[String(xa)]&&bc[String(xa)]===bc[String(ea)]&&(xb[String(Xa)]=-1===Xb?db:"\\"===db?"/":"\\");break;case "0001":case "1001":case "1011":case "1101":xb[String(Xa)]=-1===Xb?db:"\\"===db?"/":"\\";break;case "0011":case "0111":case "1111":xb[String(Xa)]="\\"===xb[String(xa)]?"/":"\\";break;case "0101":xb[String(Xa)]=-1===Xb?db:"\\"===db?"/":"\\"}}Jb+=x+Ga}else void 0!==xb[String(Ma)]&&""!==xb[String(Ma)]?x=xb[String(Ma)]:x="",Jb+=x+Ga;void 0!==bc[String(Ma)]&&(Jb+=bc[String(Ma)]);ra=Fa+Jb+ra;H.push(Ma)}return ra}
function oc(r,z,u){var w=r=0,x=0,M="\u00bf";if(0<Pb.length)Pb.sort(function(C,H){return Math.abs(C.A)-Math.abs(H.A)});else return"";for(r=0;r<Pb.length;r++)x=w=0,0>Pb[r].A?Number.isInteger(Pb[r].A)?(w=u.indexOf(String(z[-1*Pb[r].A].g))+1,x=u.indexOf(String(z[-1*Pb[r].A].h))+1,M+=String(w)+"-"+String(x)+":"):(w=-1*(u.indexOf(String(Math.floor(-1*Pb[r].A)))+1)-.5,M+=String(w)+":"):0<Pb[r].A&&Number.isInteger(Pb[r].A)&&(w=u.indexOf(String(Pb[r].A))+1,M+=String(w)+":"),0>Pb[r].D&&Number.isInteger(Pb[r].D)?
(w=u.indexOf(String(z[-1*Pb[r].D].g))+1,x=u.indexOf(String(z[-1*Pb[r].D].h))+1,M+=String(w)+"-"+String(x)+":"):0<Pb[r].D&&(w=Number.isInteger(Pb[r].D)?u.indexOf(String(Pb[r].D))+1:u.indexOf(String(Math.floor(Pb[r].D)))+1.5,M+=String(w)+":"),M+=Pb[r].oa+":",M+=0<Pb[r].crv?"l":"r",r<Pb.length-1&&(M+=";");return M+"\u00bf"}function ge(r){var z=0,u="\u00a7";if(0<r.length){for(z=0;z<r.length;z++)r[z].I.sort(function(w,x){return w-x}),r[z].H.sort(function(w,x){return w-x});r.sort(function(w,x){w=w.I.join()+
w.H.join();x=x.I.join()+x.H.join();return w>x?1:x>w?-1:0})}else return"";for(z=0;z<r.length;z++)u+=r[z].I.join()+":"+r[z].H.join()+":"+String(r[z].oa)+":"+r[z].fa+":"+r[z].pa,z<r.length-1&&(u+=";");return u+"\u00a7"}function Jg(){var r,z="",u="";u=z=0;u=[];var w=[],x="";if(0!==Zd.length){w=[];for(r=0;r<Zd.length;r++)u=Zd[r].split(":"),z=u[0],u=u[1],z=zc.indexOf(parseInt(z,10)),u=zc.indexOf(parseInt(u,10)),w[Zd[r]]=Math.min(z,u);Zd.sort(function(M,C){return w[M]-w[C]});bc={};for(r=0;r<Zd.length;r++)u=
Zd[r].split(":"),z=u[0],u=u[1],x=9<r+1?"%":"",bc[z]=void 0!==bc[z]?bc[z]+(x+String(r+1)):x+String(r+1),bc[u]=void 0!==bc[u]?bc[u]+(x+String(r+1)):x+String(r+1)}}function yh(r,z,u){var w=r[u].a.slice(0);w.sort(function(x,M){var C=x.t;var H=M.t;if(4===C||5===C)C=1;if(4===H||5===H)H=1;return r[u].U?r[M.p].R-r[x.p].R:Xd(z,u,x.p)&&Xd(z,u,M.p)&&C!==H?C-H:Xd(z,u,x.p)&&2===C&&!Xd(z,u,M.p)&&2===H?1:!Xd(z,u,x.p)&&2===C&&Xd(z,u,M.p)&&2===H?-1:Xd(z,u,x.p)&&1<C||Xd(z,u,M.p)&&1<H?C-H:r[M.p].R===r[x.p].R?(ma.push({m:u,
Za:x.p,$a:M.p}),0):r[M.p].R-r[x.p].R});r[u].a=w.slice(0)}function zh(r){var z;var u=2;for(z=1;z<r.length;z++)u+=r[z].a.length-2;return u/2}function ne(r,z){var u;if(3>z.length)return!1;var w=z.slice(0);w.push(z[0]);for(z=0;z<w.length-1;z++){var x=!1;for(u=0;u<r[w[z]].a.length;u++)r[w[z]].a[u].p===w[z+1]&&(x=!0);if(!1===x)return!1}return!0}function Xe(r,z){var u=r.slice(0).sort(function(M,C){return M-C}),w=z.slice(0).sort(function(M,C){return M-C}),x=0;if(r.length!==z.length)return!1;for(x=0;x<u.length;x++)if(u[x]!==
w[x])return!1;return!0}function Pi(r,z){function u(Ea,Ia,xa,Xa,Qb,Oc){Ea=-1;var Gc=[];var db=[];db.push(Xa);db.push(Qb);var lb=Ka.splice(xa,1);Gc.push(lb);xa=0;for(Qb=Xa=!1;!Xa&&!Qb&&0<Ka.length;){if(0===Oc)for(lb=0,Ea=-1;lb<Ka.length;){if(Ia[Ka[lb]].g===db[db.length-1]||Ia[Ka[lb]].h===db[db.length-1]){Ea=lb;break}lb++}else if(1===Oc)for(lb=Ka.length-1,Ea=-1;0<=lb;){if(Ia[Ka[lb]].g===db[db.length-1]||Ia[Ka[lb]].h===db[db.length-1]){Ea=lb;break}lb--}0>Ea?Qb=!0:Ia[Ka[Ea]].g===db[db.length-1]?db.includes(Ia[Ka[Ea]].h)?
Ia[Ka[Ea]].h===db[0]&&2<db.length&&(Xa=!0,Fb.push(db),lb=Ka.splice(Ea,1),Gc.push(lb),aa.push(Gc)):(db.push(Ia[Ka[Ea]].h),lb=Ka.splice(Ea,1),Gc.push(lb)):db.includes(Ia[Ka[Ea]].g)?Ia[Ka[Ea]].g===db[0]&&2<db.length&&(Xa=!0,Fb.push(db),lb=Ka.splice(Ea,1),Gc.push(lb),aa.push(Gc)):(db.push(Ia[Ka[Ea]].g),lb=Ka.splice(Ea,1),Gc.push(lb));xa++;if(20<xa)return}if(Xa)return!0;if(Qb)return!1}function w(Ea,Ia,xa){var Xa;for(Xa=0;Xa<Ea.length;Xa++)if(X[Ea[Xa]].g===Ia&&X[Ea[Xa]].h===xa||X[Ea[Xa]].g===xa&&X[Ea[Xa]].h===
Ia)return Xa;return-1}function x(Ea,Ia){var xa;for(xa=0;xa<le.length;xa++)if(Ea[Yd[Ia]].g===le[xa]||Ea[Yd[Ia]].h===le[xa])return!0;return!1}function M(Ea){var Ia,xa;for(xa=0;xa<le.length;xa++){var Xa=[];for(Ia=0;Ia<Yd.length;Ia++)Ea[Yd[Ia]].g===le[xa]?Xa.push(Ea[Yd[Ia]].h):Ea[Yd[Ia]].h===le[xa]&&Xa.push(Ea[Yd[Ia]].g);ra[xa]=Xa.slice(0)}}var C,H,aa=[],ra=[],Fa=[];var Ga=[];Fa=0;var sa=[],ea=[];Ga=[];var Jb=[],Ma=[];Fa=Ga=0;var kb=[],Xb=[];ci=zh(r);zi(r,z);(function(Ea,Ia){var xa,Xa;le=[];for(xa=0;xa<
dd.length;xa++){var Qb=0;if(2<Ea[dd[xa]].a.length){for(Xa=0;Xa<Ea[dd[xa]].a.length;Xa++)Xd(Ia,dd[xa],Ea[dd[xa]].a[Xa].p)&&Qb++;3<=Qb&&le.push(dd[xa])}}})(r,z);Ka=[];for(C=0;C<Yd.length;C++)x(z,C)||Ka.push(Yd[C]);Fb=[];for(aa=[];0<Ka.length;)u(r,z,0,z[Ka[0]].g,z[Ka[0]].h,0);Xc=Fb.length;ca=Fb.slice(0);if(0<le.length){Fa=[];for(C=0;C<Yd.length;C++)Fa.push(Yd[C]);for(C=0;C<Fb.length;C++){for(H=0;H<Fb[C].length-1;H++)Ga=w(Fa,Fb[C][H],Fb[C][H+1]),Fa.splice(Ga,1);Ga=w(Fa,Fb[C][0],Fb[C][Fb[C].length-1]);
Fa.splice(Ga,1)}ra=[];M(z);for(Ga=0;Ga<le.length;Ga++)for(H=0;H<ra[Ga].length;H++){Ka=[];for(C=0;C<Fa.length;C++)Ka[C]=Fa[C];C=w(Ka,le[Ga],ra[Ga][H]);u(r,z,C,le[Ga],ra[Ga][H],0);u(r,z,C,le[Ga],ra[Ga][H],1)}for(C=Xc;C<Fb.length-1;){for(H=C+1;H<Fb.length;)H>C&&Xe(Fb[C],Fb[H])&&(Fb.splice(H,1),aa.splice(H,1),H--),H++;C++}for(C=Xc;C<Fb.length-1;){for(H=C+1;H<Fb.length;){if(!Xe(Fb[C],Fb[H])&&(Fb[C].length>Fb[H].length?(sa=Fb[C].slice(0),ea=Fb[H].slice(0)):Fb[H].length>Fb[C].length&&(sa=Fb[H].slice(0),
ea=Fb[C].slice(0)),Ga=[],Ga=Xh(sa,ea),Xe(Ga,ea))){Jb=[];for(Ga=0;Ga<sa.length-1;Ga++)Jb.push(Na(z,sa[Ga],sa[Ga+1]));Jb.push(Na(z,sa[sa.length-1],sa[0]));Ma=[];for(Ga=0;Ga<ea.length-1;Ga++)Ma.push(Na(z,ea[Ga],ea[Ga+1]));Ma.push(Na(z,ea[ea.length-1],ea[0]));for(Ga=Fa=0;Ga<Ma.length;Ga++)Jb.includes(Ma[Ga])||(Fa=Ma[Ga]);Ga=Math.min(sa.indexOf(z[Fa].g),sa.indexOf(z[Fa].h));Fa=Math.max(sa.indexOf(z[Fa].g),sa.indexOf(z[Fa].h));Ga=ea.includes(sa[Ga+1])?sa.slice(Fa).concat(sa.slice(0,Ga+1)):sa.slice(Ga,Fa-
Ga+1);kb.push(Ga);Xb.push(sa)}H++}C++}for(C=0;C<kb.length-1;){for(H=C+1;H<kb.length;)H>C&&Xe(kb[C],kb[H])&&(kb.splice(H,1),H--),H++;C++}for(C=0;C<Xb.length-1;){for(H=C+1;H<Xb.length;)H>C&&Xe(Xb[C],Xb[H])&&(Xb.splice(H,1),H--),H++;C++}for(C=0;C<Xb.length;C++)for(H=0;H<Fb.length;H++)Xe(Xb[C],Fb[H])&&(Fb.splice(H,1),H--);for(Ga=0;Ga<kb.length;Ga++)Fb.push(kb[Ga]);for(C=0;C<Fb.length;C++)!1===ne(r,Fb[C])&&(Fb.splice(C,1),aa.splice(C,1),C--);for(C=0;C<Fb.length-1;){for(H=C+1;H<Fb.length;)H>C&&Xe(Fb[C],
Fb[H])&&(Fb.splice(H,1),aa.splice(H,1),H--),H++;C++}Fb.sort(function(Ea,Ia){return Ea.length-Ia.length})}}function Ye(r,z){function u(Ea,Ia){var xa;for(xa=0;xa<Ia.length;xa++)if(Xe(Ia[xa],Ea))return!0}function w(Ea,Ia,xa){var Xa,Qb=Ea,Oc=[];var Gc=[];Gc.push(Ia);Oc.push(Ea);for(Ia=0;0<Gc.length;){Ea=Gc.pop();var db=Oc.includes(Ea);if(!db){if(0<Oc.length)for(Xa=Oc.length-1;0<=Xa;Xa--)if(aa[String(Ea)].includes(Oc[Xa])){Qb=Oc[Xa];break}Oc.push(Ea);var lb=[];for(Xa=0;Xa<aa[String(Ea)].length;Xa++)aa[String(Ea)][Xa]!==
Qb&&((db=Oc.includes(aa[String(Ea)][Xa]))||lb.push(aa[String(Ea)][Xa]));if(2===lb.length)Xa=parseInt(Ga[xa].charAt(Jb.indexOf(Ea)),10),void 0===Fa[String(Qb)+"-"+String(Ea)]||0!==Xa&&1!==Xa||Gc.push(Fa[String(Qb)+"-"+String(Ea)][Xa][0]);else if(1===lb.length)Gc.push(lb[0]);else return Oc.slice(0)}Ia++;if(200<Ia)break}}function x(Ea,Ia){var xa,Xa="";if(0!==Ia.length%2)return!1;var Qb=Ia.slice(0);Qb.push(Ia[0]);for(Ia=0;Ia<Qb.length-1;Ia++)for(xa=0;xa<Ea[Qb[Ia]].a.length;xa++)Ea[Qb[Ia]].a[xa].p===Qb[Ia+
1]&&(Xa+=2===Ea[Qb[Ia]].a[xa].t?"1":"0");return/00/.test(Xa)||/11/.test(Xa)?!1:!0}function M(Ea){var Ia;for(Ia=0;Ia<Ea.length;Ia++)if(!C.includes(Ea[Ia]))return!1;return!0}var C=[];var H=[];var aa={};var ra=[];var Fa={},Ga=[];var sa=0;var ea=1;ra=0;var Jb=[];var Ma=0;var kb=[],Xb=[];for(sa=1;sa<r.length;sa++)r[sa].U=!1;Kb=[];for(Qa in aa)aa.hasOwnProperty(Qa)&&delete aa[Qa];for(Qa in Fa)Fa.hasOwnProperty(Qa)&&delete Fa[Qa];for(ea=0;ea<dd.length;ea++){for(sa=Ma=ra=H=0;sa<r[dd[ea]].a.length;sa++)2===
r[dd[ea]].a[sa].t&&H++,2===r[dd[ea]].a[sa].t&&Xd(z,dd[ea],r[dd[ea]].a[sa].p)&&ra++,2!==r[dd[ea]].a[sa].t&&1===Ue(r,z,r[dd[ea]].a[sa].p)&&Ma++;1===ra&&3>=r[dd[ea]].a.length&&1===H&&C.push(dd[ea])}if(!(4>C.length)){for(ea=0;ea<ca.length;ea++)if(x(r,ca[ea])&&M(ca[ea]))for(Kb.push(Fb.indexOf(ca[ea])),sa=0;sa<ca[ea].length;sa++)r[ca[ea][sa]].U=!0,C.splice(C.indexOf(ca[ea][sa]),1);else for(sa=0;sa<ca[ea].length;sa++)C.includes(ca[ea][sa])&&C.splice(C.indexOf(ca[ea][sa]),1);H=[];for(ea=0;ea<C.length;ea++)3===
r[C[ea]].a.length&&C.includes(r[C[ea]].a[0].p)&&C.includes(r[C[ea]].a[1].p)&&C.includes(r[C[ea]].a[2].p)&&H.push(C[ea]);for(ea=0;ea<C.length;ea++)for(sa=0;sa<r[C[ea]].a.length;sa++)C.includes(r[C[ea]].a[sa].p)&&(void 0===aa[String(C[ea])]?aa[String(C[ea])]=[r[C[ea]].a[sa].p]:aa[String(C[ea])].push(r[C[ea]].a[sa].p));if(0<H.length){for(ea=0;ea<H.length;ea++)for(z=0;3>z;z++){sa=aa[String(H[ea])][z];Qa=String(sa)+"-"+String(H[ea]);Fa[Qa]=[];ra=[];for(sa=0;sa<aa[String(H[ea])].length;sa++)sa!==z&&ra.push(aa[String(H[ea])][sa]);
Fa[Qa].push(ra.slice(0));Fa[Qa].push(ra.reverse().slice(0))}Ga=[];ea=Math.pow(2,H.length-1)-1;sa=ea.toString(2).length;for(ea=0;ea<sa;ea++);for(ea=0;ea<Math.pow(2,H.length-1);ea++)Ga[ea]=Tl(ea.toString(2),sa);for(sa=0;sa<H.length;sa++)for(Ma=H[sa],Jb=H.slice(0),Jb.splice(Jb.indexOf(Ma),1),ea=ra=0;ea<aa[String(Ma)].length;ea++)for(z=0;z<Ga.length;z++)kb=w(Ma,aa[String(Ma)][ea],z),ra++,ne(r,kb)&&!u(kb,Xb)&&Xb.push(kb)}else{for(ea=Ma=0;ea<C.length;ea++)if(!r[C[ea]].U&&void 0!==aa[String(C[ea])]&&1<aa[String(C[ea])].length){Ma=
C[ea];break}if(0!==Ma)for(sa=0;sa<aa[String(Ma)].length;sa++)if(void 0!==aa[String(aa[String(Ma)][sa])]&&1<aa[String(aa[String(Ma)][sa])].length&&(kb=w(Ma,aa[String(Ma)][sa],-1),ne(r,kb)&&!u(kb,Xb))){Xb.push(kb);break}}for(ea=0;ea<Xb.length;ea++)if(x(r,Xb[ea]))for(z=0;z<Xb[ea].length;z++)r[Xb[ea][z]].U=!0}}function Fc(r){var z;for(z=0;z<Fb.length;z++)if(Fb[z].includes(r))return z;return-1}var ya,pg="";var Hc=-1;var Qa,lc="";Hc=0;var hf=1,Xc=0;lc="";var Af=ya=0,qg=0;ya=-1;var Nd="";var pc=[],Yb=0,
Od=1;ya=ya=0;var zb="",V=0,Bf=[],sc=[];zb=[];var id=[],Kb=[],na=[],nc={},Md=[],$c=[],Sa={},ma=[],ca=[];V=[];var Ba=[];var Ca=[];var La=[];var gb=[],nb=[],ub=[],Nc=[],Ka=[],ab=[],Ta=[],kc={},Mc=[],Zc=[],og=[],Sf=[],gf=[],zc=[];Sc=[];td="";Pb=[];for(ya=0;ya<Ha.length;ya++)Kj(Ha,Pb,ya,ya);Nj(h,Je,X,Ie);(function(r,z){var u,w;for(u=1;u<r.length;){if(1===r[u].u&&0<r[u].a.length&&1!==r[r[u].a[0].p].u){if(0<Pb.length)for(w=0;w<Pb.length;w++)0>Pb[w].A&&Number.isInteger(Pb[w].A)&&(z[-1*Pb[w].A].g===u||z[-1*
Pb[w].A].h===u)&&(Pb[w].A=-1*r[u].a[0].p-.5),0<Pb[w].D&&Number.isInteger(Pb[w].D)&&Pb[w].D===u&&(Pb[w].D=r[u].a[0].p+.5);r[r[u].a[0].p].ua=r[u].x;r[r[u].a[0].p].va=r[u].y;r[r[u].a[0].p].aa=r[u].z;Sh(r,z,u,!1);u--}u++}})(Je,Ie);for(ya=1;ya<Je.length;ya++)Je[ya].za=ya;for(ya=1;ya<Ie.length;ya++)Ie[ya].za=ya;La=1;for(V=0;V<Je.length-1;){Nb=[];Hc=0;for(ya=1;ya<Je.length;ya++)if(0===Je[ya].s){Hc=ya;break}if(0===Hc)break;ya=mh(Je,Hc);V+=ya;for(ya=0;ya<Nb.length;ya++)for(Je[Nb[ya]].s=La,Hc=0;Hc<Ie.length;Hc++)if(Nb.includes(Ie[Hc].g)||
Nb.includes(Ie[Hc].h))Ie[Hc].s=La;La++}La--;hf=La;V=[];Af=0;for(La=1;La<=hf;La++){a(La);for(ya=1;ya<O.length;ya++)O[ya].J="",void 0!==lg[String(ya)]&&(lg[String(ya)]=""),void 0!==kc[String(ya)]&&(kc[String(ya)]="");Xc=ci=0;td="";rh=ng=1;Bf=[];sc=[];id=[];le=[];lg=[];mg=[];Kb=[];Md=[];$c=[];Le=[];ma=[];ye=[];gb=[];nb=[];Af=0;ub=[];xf=[];bc=[];Nc=[];dd=[];Yd=[];Ka=[];Zd=[];Fb=[];ab=[];Ta=[];kc={};Mc=[];uc=[];Zc=[];og=[];gf=[];Sf=[];zc=[];Nb=[];for(Qa in Sa)Sa.hasOwnProperty(Qa)&&delete Sa[Qa];for(Qa in nc)nc.hasOwnProperty(Qa)&&
delete nc[Qa];Af=O[1].t;rh=ng=1;ci=zh(O);0<ci&&(Pi(O,Oa),Ye(O,Oa));for(ya=0;ya<Fb.length;ya++)na[ya]=[];b(O);g(O);for(ya=1;ya<O.length;ya++)yh(O,Oa,ya);Wk(O);ba(O,Oa);Da(O,Oa);F(O,Oa);za(O,Oa);g(O);sh=!1;for(ya=1;ya<O.length;ya++)yh(O,Oa,ya),""!=O[ya].J&&(sh=!0);Za(O,Oa,"reset");0<ab.length&&(sh=!0);pc=[];for(ya=1;ya<O.length;ya++)1===O[ya].R&&pc.push(ya);if(pc.length===O.length-1||!1===sh)for(pc.length=1,c(O,Oa,pc[0]),g(O),ya=1;ya<O.length;ya++)yh(O,Oa,ya);f(O);ng=1;Zc=[];for(ya=1;ya<O.length;ya++)ng*=
n(ya);if(0<Zc.length&&!1===sh)for(yb(O,Oa,pc[0]),Cc(O,Oa,pc[0]),ya=0;ya<zc.length;ya++)if(-1<(Hc=Zc.indexOf(zc[ya]))){ya=Zc[Hc];Zc.splice(Hc,1);ng/=n(ya);break}q();y(ng);for(Hc=0;Hc<pc.length;Hc++)for(Od=pc[Hc],rh=ng,qg=0;0<rh;){for(ya=0;ya<Zc.length;ya++)E(Zc[ya],Nc[qg][ya]);yb(O,Oa,Od);Cc(O,Oa,Od);Jg();0<ab.length&&tb(O,Oa);0<Ta.length&&jb(O,Oa,"gen");ya=0;for(Yb=qa(O);ya!==Yb;)ya=Yb,za(O,Oa),Da(O,Oa),Za(O,Oa,"add"),0<ab.length&&tb(O,Oa),ba(O,Oa),0<Ta.length&&jb(O,Oa,"gen"),Yb=qa(O);for(Qa in Sa)Sa.hasOwnProperty(Qa)&&
(0!==Sa[Qa].M&&void 0!==bc[String(Sa[Qa].v)]?void 0!==bc[String(Sa[Qa].v)]&&bc[String(Sa[Qa].L)]===bc[String(Sa[Qa].v)]&&(ya=Sa[Qa].L,Sa[Qa].L=Sa[Qa].M,Sa[Qa].M=ya,Sa[Qa].P*=-1):0!==Sa[Qa].M&&uc.indexOf(Sa[Qa].L)>uc.indexOf(Sa[Qa].M)&&(ya=Sa[Qa].L,Sa[Qa].L=Sa[Qa].M,Sa[Qa].M=ya,Sa[Qa].P*=-1),0!==Sa[Qa].N&&void 0!==bc[String(Sa[Qa].t)]?void 0!==bc[String(Sa[Qa].t)]&&bc[String(Sa[Qa].N)]===bc[String(Sa[Qa].t)]&&(ya=Sa[Qa].O,Sa[Qa].O=Sa[Qa].N,Sa[Qa].N=ya,Sa[Qa].P*=-1):0!==Sa[Qa].N&&uc.indexOf(Sa[Qa].O)>
uc.indexOf(Sa[Qa].N)&&(ya=Sa[Qa].O,Sa[Qa].O=Sa[Qa].N,Sa[Qa].N=ya,Sa[Qa].P*=-1));lc="";for(ya=0;ya<uc.length;ya++)0<ya&&(lc+=","),lc+=String(O[uc[ya]].za);td=qh(O);sc.includes(td)||(sc.push(td),Bf.push(lc));qg++;rh--}1<sc.length&&(zb=sc.slice(0),sc.sort(function(r,z){return r.length===z.length?r>z?-1:r<z?1:0:r.length-z.length}));for(ya=0;ya<zb.length;ya++)if(sc[0]===zb[ya]){lc=Bf[ya];break}td=sc[0];V.push(td);Ba.push(lc);Ca.push(Af)}La=[];for(ya=0;ya<V.length;ya++)La.push(V[ya]+"!"+Ba[ya]+"!"+String(Ca[ya]));
La.sort(function(r,z){r=r.split("!");z=z.split("!");return r[0]===z[0]?0:r[0].length===z[0].length?r[0]>z[0]?-1:r[0]<z[0]?1:0:z[0].length-r[0].length});zb=lc=td="";for(ya=0;ya<La.length;ya++)Ca=La[ya].split("!"),0<ya&&(td+=".",lc+=".",zb+="."),td+=Ca[0],lc+=Ca[1],zb+=Ca[2];uc=lc.split(/[,.]/);0<Ha.length&&(pg=oc(Je,Ie,uc));lc=function(r,z){var u,w="";for(u=0;u<z.length;u++)0<r[z[u]].F&&(w+=String(u+1)+":"+String(r[z[u]].F)+";");return""!==w?w="!"+w.slice(0,-1)+"!":""}(Je,uc);if(0<ja.length){Ke=[];
for(ya=0;ya<ja.length;ya++)Ii(ja,Ke,ya,ya);Ca=[];Ca=zb.split(".");for(Hc=0;Hc<Ke.length;Hc++){for(Nd=0;Nd<Ke[Hc].I.length;Nd++)Ca.includes(String(Ke[Hc].I[Nd]))&&(Ke[Hc].I[Nd]=Ca.indexOf(String(Ke[Hc].I[Nd]))+1);for(Nd=0;Nd<Ke[Hc].H.length;Nd++)Ca.includes(String(Ke[Hc].H[Nd]))&&(Ke[Hc].H[Nd]=Ca.indexOf(String(Ke[Hc].H[Nd]))+1)}Nd=ge(Ke)}td=td+pg+lc+Nd}function vj(a){function b(){var ma;gd=0;Yc=[];var ca=pk();for(ma=1;ma<=ca;ma++)D=Rc(h,ma,"s"),th(h,oa.b-D.b,oa.t-D.t,ma),D=Rc(h,ma,"s"),Yc.push(D);
var Ba=oa.b+10;var Ca=oa.t+10;var La=[];var gb=[];for(ma=gd=0;ma<ca;ma++){Ba>oa.b+oa.c-10-Yc[ma].c&&(Ba=oa.b+10,Ca+=10+gd,gd=0);gd=Math.max(gd,Yc[ma].f);var nb=Ba+Yc[ma].c;La.push(Ba-Yc[ma].b);gb.push(Ca-Yc[ma].t);Ba=nb+10}for(ma=0;ma<Yc.length;ma++)uh(h,La[ma],gb[ma],ma+1),Yc[ma].b+=La[ma],Yc[ma].t+=gb[ma]}function c(ma){var ca,Ba,Ca,La=[],gb=[];for(ca=0;ca<ma.length;ca++)for(Ba=0;Ba<ma.length;Ba++)if(ca!==Ba&&!Ni(ma[ca].I,ma[Ba].H)){var nb=!1;for(Ca=0;Ca<ma[Ba].H.length;Ca++)ma[ca].I.includes(ma[Ba].H[Ca])&&
(nb=!0);nb&&(Ca=fi(ma[Ba].H,ma[ca].I),ma[Ba].H=Ca.slice(0),ma[ca].I=Ca.slice(0))}for(ca=0;ca<ma.length;)Qj(ma[ca].I,La)||La.push(ma[ca].I),Qj(ma[ca].H,gb)||gb.push(ma[ca].H),ca++;for(ca=0;ca<La.length;)pc.push(new ba(La[ca])),ca++;for(ca=0;ca<gb.length;)Qj(gb[ca],La)||pc.push(new ba(gb[ca])),ca++;for(ca=0;ca<ma.length;)Ba=Ja(ma[ca].H,pc),La=Ja(ma[ca].I,pc),-1<Ba&&-1<La&&(pc[Ba].Na.push(new jb(La,ca+nc)),pc[La].Da.push(new jb(Ba,ca+nc))),ca++;for(ca=0;ca<pc.length;)0!==pc[ca].Na.length||pg.includes(ca)||
pg.push(ca),0!==pc[ca].Da.length||Hc.includes(ca)||Hc.push(ca),ca++}function e(ma){var ca,Ba=ta.b+ta.c/2;var Ca=ta.t+ta.f/2;new Wc(0,0,0,0);new Wc(0,0,0,0);Td=Aj();Yc=[];for(ca=1;ca<=Td;ca++){var La=Rc(h,ca,"t");uh(h,Ba-(La.b+La.c/2),Ca-(La.t+La.f/2),ca);La=Rc(h,ca,"t");Yc.push(La)}cb=[];for(Ca=0;Ca<pc.length;){var gb=pc[Ca].ra.slice(0);La=ta.b;var nb=[];for(ca=0;ca<gb.length;ca++)nb.push(gb[ca]);for(ca=0;ca<gb.length;ca++){var ub=gb[ca];var Nc=La+Yc[ub-1].c/2;uh(h,Nc-Ba,0,ub);La+=Yc[ub-1].c+ma;Yc[ub-
1]=Rc(h,ub,"t")}for(ca=1;ca<h.length;ca++)h[ca].s=-1;$f(nb,Ca+100);ca=Rc(h,Ca+100,"s");cb.push(ca);Ca++}}function g(ma){var ca;for(ca=0;ca<pg.length;ca++)Md.push({A:pg[ca],path:f(ma,pg[ca],ca)})}function f(ma,ca,Ba){var Ca=[],La={},gb=0,nb=[];Ca.push(ca);nb.push(ca);for(La[String(ca)]=0;0<Ca.length;){var ub=Ca.shift();for(ca=0;ca<ma[ub].Da.length;ca++){var Nc=ma[ub].Da[ca].Xa;nb.includes(Nc)||(nb.push(Nc),La[String(Nc)]=La[String(ub)]+1,Ca.push(Nc))}}for(ca=0;ca<nb.length;ca++)ma[nb[ca]].path=Ba,
ma[nb[ca]].ha=La[String(nb[ca])],0<ca&&ma[nb[ca]].ha===ma[nb[ca-1]].ha?gb++:gb=1,ma[nb[ca]].Ea=gb;return nb.slice(0)}function n(){var ma=!1,ca=1,Ba,Ca,La,gb,nb=oa.b,ub,Nc=0,Ka=[],ab=18*Ra;for(gb=0;gb<Md.length;gb++){var Ta=0;for(ma=!1;Ta<Md[gb].path.length;){var kc=Md[gb].path[Ta];1<pc[kc].Ea&&(ma=!0);Ta++}}for(gb=0;gb<Md.length;gb++){for(Ta=ub=0;Ta<Md[gb].path.length;)kc=Md[gb].path[Ta],ub=Math.max(ub,cb[kc].f),Ta++;var Mc=oa.b;var Zc=nb+3*Ra+ub/2;for(Ta=Ba=La=0;Ta<Md[gb].path.length;){kc=Md[gb].path[Ta];
Nc=Math.max(Nc,kc);var og=cb[kc].b+cb[kc].c/2;var Sf=cb[kc].t+cb[kc].f/2;ub=Zc-cb[kc].f/2;if(pc[kc].ha!==Ba)if(Ba++,Mc+=ca*(La+ab),!1===ma&&1===ca&&Mc>oa.b+oa.c){for(Ca=0;Ca<Ka.length;Ca++)cb[Ka[Ca]].t+cb[Ka[Ca]].f>nb&&(nb=cb[Ka[Ca]].t+cb[Ka[Ca]].f);Mc-=ca*(La+ab);Mc+=ca*(La/2-cb[kc].c/2);Zc=nb+ab+3*Ra;ub=Zc-cb[kc].f/2;ca=0}else if(!1===ma&&0===ca)ca=Math.abs(oa.b+oa.c-Mc)<Math.abs(oa.b-Mc)?-1:1,Mc+=ca*(La+ab);else{if(!1===ma&&-1===ca&&Mc<oa.b){for(Ca=0;Ca<Ka.length;Ca++)cb[Ka[Ca]].t+cb[Ka[Ca]].f>
nb&&(nb=cb[Ka[Ca]].t+cb[Ka[Ca]].f);Mc-=ca*(La+ab);Mc-=ca*(La/2-cb[kc].c/2);Zc=nb+ab+3*Ra;ub=Zc-cb[kc].f/2;ca=0}}else if(1<pc[kc].Ea)for(Ca=1;Ca<pc[kc].Ea;Ca++)ub+=cb[kc-Ca].f+3*Ra;Ca=Mc+cb[kc].c/2;var gf=ub+cb[kc].f/2;for(La=0;La<pc[kc].ra.length;La++)uh(h,Ca-og,gf-Sf,pc[kc].ra[La]);cb[kc].b=Mc;cb[kc].t=ub;Ka.push(kc);La=cb[kc].c;Ta++}for(Ca=0;Ca<Ka.length;Ca++)cb[Ka[Ca]].t+cb[Ka[Ca]].f>nb&&(nb=cb[Ka[Ca]].t+cb[Ka[Ca]].f)}if(pc.length>Nc)for(Mc=oa.b,ub=nb+3*Ra,ma=0,Ca=Nc+1;Ca<pc.length;Ca++)for(La=
0;La<pc[Ca].ra.length;La++)uh(h,Mc-cb[Ca].b,ub-cb[Ca].t,pc[Ca].ra[La]),ma=Math.max(ma,cb[Ca].f),cb[Ca].b=Mc,cb[Ca].t=ub,Mc+=cb[Ca].c+3*Ra,Mc>oa.b+oa.c&&(Mc=oa.b,ub+=ma+3*Ra,ma=0)}function q(ma){var ca,Ba;for(ca=0;ca<ma.length;++ca)for(Ba=ca+1;Ba<ma.length;++Ba)ma[ca]===ma[Ba]&&ma.splice(Ba--,1);return ma}function y(ma,ca){var Ba=ma.split(";");for(ma=0;ma<Ba.length;ma++){var Ca=Ba[ma].split(":");h[Ye[parseInt(Ca[0],10)]+ca].F=parseInt(Ca[1],10)}}function E(ma,ca){var Ba,Ca=0,La=0,gb=1;new xc(0,0);
new xc(0,0);var nb=new xc(0,0),ub=new xc(0,0);var Nc=ma.split(";");for(ma=0;ma<Nc.length;ma++){var Ka=Nc[ma].split(":");if(4===Ka.length){if(/\d-\d/.test(Ka[0])){var ab=Ka[0].split("-");var Ta=Ye[parseInt(ab[0],10)]+ca;ab=Ye[parseInt(ab[1],10)]+ca;Ta=Na(X,Ta,ab);0<Ta&&(Ca=-1*Ta)}else if(Number(Ka[0]))if(Number.isInteger(Number(Ka[0])))Ca=Ye[parseInt(Ka[0],10)]+ca;else if(Ca=Number(Ka[0]),0>Ca){ab=Ye[Math.floor(-1*Ca)]+ca;for(Ta=Ba=0;Ta<h[ab].a.length;Ta++)if(1===h[ab].a[Ta].t&&1===h[h[ab].a[Ta].p].u){Ba=
h[ab].a[Ta].p;break}0===Ba?(uf(h,ab),Ta=1===h[ab].a.length?ia($a(h,h[ab].a[0].p,ab)+60):lh(h,ab),ha(h,X,ab,Ta,1),Ta=Na(X,ab,h.length-1),Ca=-1*Ta):Ca=Ba}if(/\d-\d/.test(Ka[1]))ab=Ka[1].split("-"),Ta=Ye[parseInt(ab[0],10)]+ca,ab=Ye[parseInt(ab[1],10)]+ca,Ta=Na(X,Ta,ab),0<Ta&&(La=-1*Ta);else if(Number(Ka[1]))if(Number.isInteger(Number(Ka[1])))La=Ye[parseInt(Ka[1],10)]+ca;else if(La=Number(Ka[1]),0<La){ab=Ye[Math.floor(La)]+ca;for(Ta=Ba=0;Ta<h[ab].a.length;Ta++)if(1===h[ab].a[Ta].t&&1===h[h[ab].a[Ta].p].u){Ba=
h[ab].a[Ta].p;break}0===Ba?(uf(h,ab),Ta=1===h[ab].a.length?ia($a(h,h[ab].a[0].p,ab)+60):lh(h,ab),ha(h,X,ab,Ta,1),La=h.length-1):La=Ba}Ta=Ka[2];"l"===Ka[3]?gb=1:"r"===Ka[3]&&(gb=-1);Ka=new Di(Ca,La,Ta,gb);Ha.push(Ka)}}Fi();for(ma=0;ma<Ha.length;ma++)if(Ca=Ha[ma].A,La=Ha[ma].D,0>Ca&&(Ca=X[-1*Ca].g),0>La&&(La=X[-1*La].g),h[Ca].t!==h[La].t){ca=h[Ca].t;gb=h[La].t;ab=Hd[ca].b<Hd[gb].b?!0:!1;ab||(Hg(h,ca,-1*(Hd[gb].c+10),0,!1),Hg(h,gb,Hd[ca].c+10,0,!1),Fi(),ab=!0);nb.x=Hd[ca].b+Hd[ca].c/2;nb.y=Hd[ca].t+
Hd[ca].f/2;ub.x=Hd[gb].b+Hd[gb].c/2;ub.y=Hd[gb].t+Hd[gb].f/2;Ta=xh(ma,"st");Ba=xh(ma,"en");Nc=Vc(nb.x,nb.y,Ta.x,Ta.y);Ka=Vc(ub.x,ub.y,Ba.x,Ba.y);Ac();for(Ta=0;Ta<h.length;Ta++)h[Ta].s=h[Ta].t;switch(!0){case ab&&45<=Nc&&135>Nc:di(h,ca,nb.x,nb.y,90,!1);break;case ab&&135<=Nc&&225>Nc:pj(h,X,"x",ca);break;case ab&&225<=Nc&&315>Nc:console.log("bottom: rotate tree "+ca+" by 90\u00b0"),di(h,ca,nb.x,nb.y,-90,!1),Fi(),Ta=xh(ma,"st"),Ba=xh(ma,"en"),console.log("translate arweTree="+gb+" arwsc.y="+If(Ta.y)+
" arwec.y="+If(Ba.y)),Hg(h,gb,Hd[ca].b+Hd[ca].c-Hd[gb].b,Ta.y-Ba.y,!1),Ta=xh(ma,"st"),Ba=xh(ma,"en"),console.log("after translation arweTree="+gb+" arwsc.y="+If(Ta.y)+" arwec.y="+If(Ba.y))}console.log("arro["+ma+"] is intermolecular\nst:"+Ca+" arwsTree="+ca+" en:"+La+" arweTree="+gb+"\narwsDir="+If(Nc)+" arweDir="+If(Ka)+" arwimsleft="+ab)}}function F(ma,ca){var Ba;Bf=[];var Ca=ma.split(";");for(ma=0;ma<Ca.length;){var La=[];var gb=[];var nb=Ca[ma].split(":");var ub=nb[0].split(",");for(Ba=0;Ba<ub.length;)La.push(parseInt(ub[Ba],
10)+ca),Ba++;ub=nb[1].split(",");for(Ba=0;Ba<ub.length;)gb.push(parseInt(ub[Ba],10)+ca),Ba++;Ba=parseInt(nb[2],10);ub=void 0!==nb[3]?nb[3]:"";nb=void 0!==nb[4]?nb[4]:"";Bf.push(new Ci(La,gb,Ba,ub,nb,0,0,0,0));ma++}}function za(ma,ca){for(var Ba=0;Ba<ca.length;){if(ca[Ba].ra.includes(ma))return Ba;Ba++}return-1}function Ja(ma,ca){for(var Ba=0;Ba<ca.length;){if(Ni(ma,ca[Ba].ra))return Ba;Ba++}return-1}function ha(ma,ca,Ba,Ca,La){var gb=ma[Ba].x+ka*Math.cos(Math.PI*Ca/180);Ca=ma[Ba].y+-1*ka*Math.sin(Math.PI*
Ca/180);ma[ma.length]=new mc(1,"H",gb,Ca,0,0,1);ma[ma.length-1].t=ma[Ba].t;ma[Ba].G+=1;ma[Ba].ua=gb;ma[Ba].va=Ca;ma[Ba].aa=0;3<La&&(ma[Ba].aa=4===La?1:-1);xe(ma,ca,Ba,ma.length-1,La)}function Da(ma){function ca(d,k,l,m){var t=0,U=0,p="",B=0,K=!1;l=0;var W,N="";if(W=m.match(Wl))""!==W[1]&&(p=W[1],t=0);else if(W=m.match(hl)){if(""!==W[1]){p=W[1];Tf.includes(p)&&(K=!0,p=p[0].toUpperCase()+p.substring(1));if(!kg.includes(p))return Fc="invalidElement",-1;t=Uh(p)}""!==W[5]&&(U="+"===W[5]?1:"-"===W[5]?-1:
parseInt(W[5],10));""!==W[2]&&("@"===W[2]?N="@":"@@"===W[2]&&(N="@@"));"H"===W[3]&&(B=""!==W[4]?parseInt(W[4],10):1)}else{p=m;Tf.includes(m)&&(K=!0,p=p[0].toUpperCase()+p.substring(1));if(!kg.includes(p))return Fc="invalidElement",-1;t=Uh(p)}m=d.length;d[m]=new mc(t,p,0,0,U,B,0);!0===K&&(d[m].U=!0);""!==N&&(d[m].J=N,sc.push(m));for(t=0;t<hf[m].length;t++){for(U=1;U<lc.length;U++)if(lc[U].g===m&&lc[U].h===hf[m][t]||lc[U].h===m&&lc[U].g===hf[m][t]){l=lc[U].B;break}xe(d,k,m,hf[m][t],l)}return m}function Ba(d,
k){var l;for(l=0;l<d.length;l++)if(d[l].i.includes(k))return l;return-1}function Ca(d,k,l,m){var t,U={},p=[],B=[];Hb=[];B.push(l);for(p.push(l);0<p.length;){var K=p.shift();if(K===m)break;for(t=0;t<d[K].a.length;t++)l=d[K].a[t].p,B.includes(l)||(B.push(l),U[String(l)]=K,p.push(l))}t=m;Hb=[];for(Hb.push(m);void 0!==U[String(t)];)U.hasOwnProperty(String(t))&&(Hb.push(U[String(t)]),t=U[String(t)]);Hb.reverse();kd=[];for(Ib=1;Ib<Hb.length-2;Ib++)0<Gc(Hb[Ib],Hb[Ib+1])||1!==k[Na(k,Hb[Ib],Hb[Ib+1])].B||
kd.push(Na(k,Hb[Ib],Hb[Ib+1]))}function La(d,k,l){var m=0;if(Id.includes(l)){for(k=0;k<d[l].a.length;k++)O[l].U&&2===O[l].a[k].t&&m++;return m}return-1}function gb(d,k,l,m){k=[];var t=[];Cf=[];k.push(l);var U=1;for(l=0;0<k.length;){var p=k.pop();var B=t.includes(p);if(!B){t.push(p);Cf.push(p);if(p===m)return 1;for(B=0;B<d[p].a.length;B++)t.includes(d[p].a[B].p)||d[p].a[B].t===U&&d[d[p].a[B].p].U&&k.push(d[p].a[B].p)}U=1===U?2:1;l++;if(200<l)break}}function nb(d,k,l,m){var t;k={};var U=[],p=[];Cf=
[];p.push(l);for(U.push(l);0<U.length;){var B=U.shift();if(B===m)break;for(t=0;t<d[B].a.length;t++)d[d[B].a[t].p].U&&(l=d[B].a[t].p,p.includes(l)||(p.push(l),k[String(l)]=B,U.push(l)))}t=m;Cf=[];for(Cf.push(m);void 0!==k[String(t)];)k.hasOwnProperty(String(t))&&(Cf.push(k[String(t)]),t=k[String(t)]);Cf.reverse();return Cf.slice(-1)[0]===m?1:-1}function ub(d,k,l,m){var t,U=[];for(t=0;t<d[k].a.length;t++)!l.includes(d[k].a[t].p)||0!==m&&d[k].a[t].t!==m||U.push(d[k].a[t].p);return U.slice(0)}function Nc(d,
k,l){var m,t="+";if(1===l.length%2)return-1;for(m=0;m<l.length-1;m++)Pf(d,k,l[m],l[m+1],t),t="+"===t?"-":"+";return 0}function Ka(d,k,l,m){var t=[],U,p=0,B=Math.floor(oa.c/(.866*ka))-3;new xc(0,0);var K="",W=0,N=0,S=1,Y=0;var G=J[l].i.slice(0);0<m?p=m:l!==ne&&(p=J[l].m);for(U=0;U<G.length;U++){m=G[U];void 0!==na[String(p)+"-"+String(m)]&&(K=String(p)+"-"+String(m));yf(m)&&""===K&&void 0!==na[String(m)+"-"+String(yf(m))]&&(K=String(m)+"-"+String(yf(m)));var P=d;var fa=k,la=l,v=U,Q=Xc[m],T=p,pa,R=0,
va=0,rb,Ob=new xc(0,0);for(pa=rb=0;pa<P[Q].a.length;pa++)void 0!==oc[String(P[Q].a[pa].p)]&&rb++;if(0===v)la===ne||0===Ab?(Ob.x=ta.b+20,Ob.y=ta.t+ta.f/2):0===Tb.length&&ge.includes(la)?(Ob.x=ta.b+ta.c/2-(J[la].i.length-1)*ka*.866/2,Ob.y=ta.t+ta.f/2):(fa=Sf(P,fa,T),Ob.x=P[T].x+ka*Math.cos(Math.PI*fa/180),Ob.y=P[T].y-ka*Math.sin(Math.PI*fa/180),""!==Mc(T)&&(K=Mc(T),na[K].t!==G[v]&&(K="")));else{if(1===v){if(la===ne||0===Tb.length&&($c.includes(la)||ge.includes(la))){if(!(R=3===P.length)){va=P;la=G;
pa=!0;for(R=1;R<la.length-1;R++)ei(va,la[R])||kc(va,la[R])||(pa=!1);R=pa}R=R||2<G.length&&0<ei(P,G[v])&&ei(P,G[v])!==G[0]?300:330}else w(P,T)&&w(P,Q)?R=$a(P,T,Q):R=270;pa=Na(fa,T,Q);la=Na(fa,Q,G[v]);0<pa&&2===fa[pa].B?void 0!==na[String(T)+"-"+String(Q)]?(K=String(T)+"-"+String(Q),va=gf(P,K,G[v])):2===fa[la].B&&2===P[Q].a.length?(t[0]=T,t.push(Q),t.push(G[v]),va=0):va=60:3===fa[la].B?va=3===P.length?60:0:(void 0!==na[String(G[v-1])+"-"+String(G[v])]&&(K=String(G[v-1])+"-"+String(G[v])),va=4===P[Q].a.length&&
(!sc.includes(Q)||1<rb)?0:2===fa[Na(fa,Q,G[v])].B&&6===P[Q].u&&2===P[Q].a.length&&1===P[Q].o&&6<P[G[v]].u?0:1===v%2?60:-60,Y++)}else if(1<v)switch(R=$a(P,G[v-2],Q),la=Na(fa,Q,G[v]),pa=Na(fa,G[v-2],Q),fa=String(fa[la].B)+"."+String(fa[pa].B),fa){case "1.1":if(2<v)if(R=$a(P,G[v-3],G[v-2]),Y>=B){R=$a(P,G[v-2],G[v-1]);if(180<R&&0===N)N=1,W++,S=270<R?-1:1;else if(0===N){R=$a(P,G[v-3],G[v-2]);va=0;Y++;break}0<N&&4>N?(va=60*S,Y++,N++):4===N&&(R=$a(P,G[v-3],G[v-2]),N=va=0,B+=1===W%2?-1:1,Y=3)}else 4===P[Q].a.length&&
(!sc.includes(Q)||1<rb)?(R=$a(P,G[v-2],G[v-1]),va=0):(fa=$a(P,G[v-2],G[v-1]),T=$a(P,G[v-3],G[v-2]),2<Math.abs(fa-T)?($a(P,G[v-3],G[v-2]),va=0):3<v?(fa=$a(P,G[v-4],G[v-3]),2<Math.abs(T-fa)?(R=$a(P,G[v-4],G[v-3]),va=0):(R=$a(P,G[v-2],G[v-1]),va=1===v%2?60:-60)):(R=$a(P,G[v-2],G[v-1]),va=1===v%2?60:-60),Y++);else va=1===v%2?60:-60,Y++;break;case "1.2":""!==K?(R=$a(P,G[v-2],G[v-1]),va=gf(P,K,G[v]),K=""):(R=$a(P,G[v-2],G[v-1]),va=90<R&&270>R?60:-60,t=[]);break;case "1.3":va=0;break;case "2.1":void 0!==
na[String(Q)+"-"+String(G[v])]&&(K=String(Q)+"-"+String(G[v]));if(16===P[Q].u&&4===P[Q].a.length){R=$a(P,G[v-2],G[v-1]);va=0;break}if(6===P[Q].u&&2===P[Q].a.length&&1===P[Q].o&&6<P[G[v]].u){R=$a(P,G[v-2],G[v-1]);va=0;break}2<v?(R=$a(P,G[v-3],G[v-2]),va=2<Math.abs($a(P,G[v-3],G[v-2])-$a(P,G[v-2],G[v-1]))?0:1===v%2?60:-60):2===v&&0<T&&w(P,T)?(R=$a(P,T,G[0]),va=0):va=1===v%2?60:-60;break;case "2.2":2===P[Q].a.length?(0===t.length&&(t.push(G[v-2]),t.push(G[v-1])),t.push(G[v]),va=0):va=1===v%2?60:-60;
break;case "3.1":va=2===P[Q].a.length?0:1===v%2?60:-60;break;default:va=1===v%2?60:-60}fa=ia(R+va);v=ka*Math.cos(Math.PI*fa/180);T=-1*ka*Math.sin(Math.PI*fa/180);Ob.x=P[Q].x+v;Ob.y=P[Q].y+T}P=Ob;if(""!==K&&"="!==Yb[m]&&0!==na[K].N&&na[K].N===m||""!==K&&"="!==Yb[m]&&0===na[K].N&&na[K].O===m)""!==Mc(m)?K=Mc(m):K="";d[m].x=P.x;d[m].y=P.y}Tb.push(l)}function ab(d,k,l,m,t,U){var p=0,B=ka,K=0,W="",N=0,S=0,Y=0;N=0;S=-1;var G=0,P=0,fa=0,la=1;la=0;la=1;var v=0,Q=[];G=[];var T=[],pa=la=0;Y=-1;if(0<U&&eb[l].includes(U)){for(;0<
eb[l].indexOf(U);)eb[l]=eb[l].splice(1,eb[l].length).concat(eb[l][0]);0<t&&(N=eb[l][0],S=V[U].indexOf(t),Ta(d,k,eb[l][0],t,m,"chend",1,S,0,0,"",ka),Q.push(eb[l][0]))}else{eb[l].sort(function(R,va){return V[va].length-V[R].length});N=eb[l][0];for(G=0;G<eb[l].length;G++)if(d[V[eb[l][G]][0]].U){-1===ii&&(N=eb[l][G]);break}Ta(d,k,N,0,0,"first",1,0,ta.b+ta.c/2,ta.t+ta.f/2,"",ka);Q.push(N)}G=eb[l].slice(0);G.splice(G.indexOf(N),1);G.sort(function(R,va){return ra(d,R)!==ra(d,va)?ra(d,R)?-1:1:V[va].length-
V[R].length});G.unshift(N);eb[l]=G.slice(0);for(pa=0;20>pa&&Q.length<eb[l].length;){for(G=0;G<Q.length;G++)for(P=0;P<eb[l].length;P++)if(S=-1,T=[],!Q.includes(eb[l][P])&&(S=C(Q[G],eb[l][P]),-1<S&&(v=Q[G],la=eb[l][P],W=String(Math.min(v,la))+"-"+String(Math.max(v,la)),void 0===qb[W]))){Ga([zb[S].sa,zb[S].ta],V[la])?(N=zb[S].sa,Y=zb[S].ta):(N=zb[S].ta,Y=zb[S].sa);S=0;T=V[la].slice(0);T.push(V[la][0]);for(fa=0;fa<T.length-1;fa++)if(T[fa]===N){S=fa;break}for(fa=0;fa<d[Y].a.length;fa++)d[Y].a[fa].p!==
N&&V[v].includes(d[Y].a[fa].p)&&!V[la].includes(d[Y].a[fa].p)&&(K=d[Y].a[fa].p);la=Ma(d,N,Y,K);la=-1*la;Ta(d,k,eb[l][P],N,Y,"bond",la,S,0,0,"",ka);Q.push(eb[l][P])}for(G=0;G<Q.length;G++)for(P=0;P<eb[l].length;P++)if(S=-1,T=[],!Q.includes(eb[l][P])&&(S=C(Q[G],eb[l][P]),-1<S&&(v=Q[G],la=eb[l][P],W=String(Math.min(v,la))+"-"+String(Math.max(v,la)),void 0!==qb[W]))){Ga(qb[W],V[la])?(N=qb[W][0],Y=qb[W][qb[W].length-1],p=qb[W][qb[W].length-2]):(N=qb[W][qb[W].length-1],Y=qb[W][0],p=qb[W][1]);S=0;T=V[la].slice(0);
T.push(V[la][0]);for(fa=0;fa<T.length-1;fa++)if(T[fa]===N){S=fa;break}for(fa=0;fa<d[Y].a.length;fa++)d[Y].a[fa].p!==N&&V[v].includes(d[Y].a[fa].p)&&!V[la].includes(d[Y].a[fa].p)&&(K=d[Y].a[fa].p);la=Ma(d,K,Y,p);3<qb[W].length&&(V[eb[l][P]].length-qb[W].length<qb[W].length?B=.8*ka:V[eb[l][P]].length-qb[W].length>=qb[W].length&&(B=1.25*ka));Ta(d,k,eb[l][P],N,Y,"bridge",la,S,0,0,W,B);Q.push(eb[l][P])}for(G=0;G<Q.length;G++)for(P=0;P<eb[l].length;P++)if(Y=-1,T=[],!(Q.includes(eb[l][P])||(Y=M(Q[G],eb[l][P]),
-1===Y||-1<ze(id[Y].ya)))){S=0;v=Q[G];la=eb[l][P];N=id[Y].ya;T=V[la].slice(0);for(fa=0;fa<T.length;fa++)if(T[fa]===N){S=fa;break}Ta(d,k,eb[l][P],N,0,"atom",1,S,0,0,"",ka);Q.push(eb[l][P])}pa++}}function Ta(d,k,l,m,t,U,p,B,K,W,N,S){var Y,G=0,P=0;G=0;var fa="",la=0,v=fa=0,Q=la=0,T=la=0;Q=0;var pa=1;la=0;la=[];var R=0,va=!1,rb=0,Ob=0,vc=0;P=0;var Ic=!1;R=[];T=[];T=[];var Ze=[],Pd=[],ld=[],oe=[];ld="";var pe="normal";vc="";var ji=[],ki=[];oe=Pd=0;ld=1;var li=0,Tj=!0,Qi=!1,Kg=0,$e=0;P=0;var mi=[];Pd=[0,
0,0,-.5*S,-.5*S,-.5*S,0,0,0,0,0,0,0,0,0,0,0];oe=[0,0,0,-.28868*S,.5*S,-.80902*S,S,0,0,0,0,0,0,0,0,0];li=[0,0,0,300,270,252,270,231.43,225,220,270,270,270,270,270,270,210];Ic=[[[45,45,45,45,45,45,45,45],[45,45,45,45,90,-45,90,45],[72,72,72,-36,72,72,72,-36]],[[60,60,60,-48,72,72,72,-48,60],[60,40,40,40,40,40,40,60,-60]],[[60,60,60,-60,60,60,60,60,-60,60],[60,60,60,-36,72,72,-36,72,72,-36]],[[60,60,60,-60,60,60,60,-38.53,68.53,68.53,-38.53],[32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,
32.73],[45,45,45,-63,72,72,72,-63,45,45,45],[51.43,51.43,51.43,51.43,51.43,-68.57,60,60,60,60,-68.57],[60,60,60,-30,-18,72,72,72,-18,-30,60]],[[60,60,60,-60,60,60,60,-60,60,60,60,-60],[72,72,-54,72,72,-54,72,72,-54,72,72,-54],[60,60,60,-48,-36,72,72,72,-36,72,-48,60]],[[60,60,60,-60,60,-48,72,72,72,-48,60,-60,60],[68.53,68.53,-47.06,68.53,68.53,-68.53,60,60,60,-68.53,68.53,68.53,-47.06]],[[60,60,60,-60,60,-60,60,60,60,60,-60,60,-60,60],[60,60,60,-60,60,-60,60,60,60,60,-60,60,-60,60]],[[68.53,68.53,
-68.53,60,60,60,-90,60,60,60,-90,60,60,60,-68.53],[72,72,-72,72,72,-72,72,72,-72,72,72,-72,72,72,-72]],[[60,60,-90,60,60,60,-90,60,60,60,-90,60,60,60,-90,60],[60,60,60,-60,60,-60,60,60,60,-60,60,60,-60,60,60,-60],[45,45,-45,45,45,45,45,-45,45,45,-45,45,45,45,45,-45]]];vc=[];R=[0,0,0,1,2,2,2,3,0,0,0,0,0,0,0,0,2];Ob=[[75,69.735,70.53],[75,30,75,75]];var Xl=[[.89658,.89658,.89658],[.89658,.89658,1,.89658]],Yl=[[30,131.93,36.136],[30,120,30,30]],Zl=[[.75,1.2091,1.2091],[.75,.75,1,.75]],$l=[[140],[120,
60],[75,90.964,33.148],[75,69.896,35.104,75],[75,38,42.2,41,58.5],[65,55.2,27.3,32.5,65,55.2]],am=[[1.3054],[.6666,1],[.59771,1.1902,.88169],[.58232,.97813,1,.58232],[.6666,.75,.75,1,.75],[.58333,.86667,.975,1,.88333,.86667]];if(!Zb.includes(l)){var Ub=V[l].length;for(Y=0;Y<V[l].length;Y++)6!==d[V[l][Y]].u&&la.push(Y);0<la.length&&0===B&&"first"===U&&(B=R=la[0]-R[Ub]);R=V[l].slice(B,V[l].length).concat(V[l].slice(0,B));Jg[l]&&(va=!0);if(7<Ub){for(Y=1;Y<R.length;Y++)vc=Na(k,R[Y],R[Y-1]),2===k[vc].B?
(T[Y-1]=1,void 0!==na[String(R[Y-1])+"-"+String(R[Y])]?(vc=String(R[Y-1])+"-"+String(R[Y]),R.includes(na[vc].L)&&R.includes(na[vc].O)||!R.includes(na[vc].L)&&!R.includes(na[vc].O)?T[Y-1]="t"===na[vc].P?-1:1:T[Y-1]="t"===na[vc].P?1:-1):T[Y-1]=0):H(k,vc,3)?T[Y-1]=-1:-1<ze(R[Y-1])&&ze(R[Y])===ze(R[Y-1])?T[Y-1]=1:T[Y-1]=2<d[R[Y]].a.length?1:0;T[R.length-1]=0;Qi=!1;$e=0;vc=Ic[Ub-8][$e].slice(0);if(7<Ub)for(;!Qi&&$e<Ic[Ub-8].length;){Ze=[];for(B=0;B<Ic[Ub-8][$e].length-1;B++)Ze.push(Math.sign(Ic[Ub-8][$e][B])*
Math.sign(Ic[Ub-8][$e][B+1]));Ze.push(Math.sign(Ic[Ub-8][$e][Ic[Ub-8][$e].length-1])*Math.sign(Ic[Ub-8][$e][0]));mi=Ze.slice(0);for(Kg=0;Kg<mi.length;){Tj=!0;for(Y=0;Y<T.length;Y++)if(0!==T[Y]&&-1===Math.sign(T[Y]*mi[Y])){Tj=!1;break}if(!0===Tj){Qi=!0;break}else Kg++,mi=Ze.slice(Kg,Ze.length).concat(Ze.slice(0,Kg))}if(Qi){P=$e;vc=Ic[Ub-8][P].slice(Kg,mi.length).concat(Ic[Ub-8][P].slice(0,Kg));break}$e++;$e>=Ic[Ub-8].length&&(P=0)}}if("first"===U){Q=0;fa=360/Math.abs(Ub);G=(180-fa)/2*Math.pow(-1,Ub);
6===Ub&&(G=90);8===Ub&&(G=90);var Df=K;var Ef=W;9>Ub&&(Df+=Pd[Ub],Ef+=oe[Ub]);d[R[0]].x=Df;d[R[0]].y=Ef;v=li[Ub];Q++}if("chend"===U){Q=0;kc(d,t)&&kc(d,m)?G=$a(d,Xc[t],t):""!==Mc(t)&&""!==Zc(m)&&Mc(t)===Zc(m)?(fa=Mc(t),w(d,na[fa].v)&&w(d,na[fa].L)&&w(d,na[fa].M)&&!w(d,na[fa].t)?G=Qf(d,na[fa].v,na[fa].L,na[fa].M,!0):w(d,na[fa].v)&&w(d,na[fa].L)&&!w(d,na[fa].t)?G=ia($a(d,na[fa].L,na[fa].v)+60):w(d,na[fa].v)&&w(d,na[fa].M)&&!w(d,na[fa].t)?G=ia($a(d,na[fa].M,na[fa].v)-60):G=30):""!==Zc(t)?(fa=Zc(t),G=
w(d,na[fa].v)&&w(d,na[fa].t)&&(w(d,na[fa].L)||w(d,na[fa].M))?ia($a(d,na[fa].v,na[fa].t)+gf(d,fa,m)):w(d,na[fa].v)&&w(d,na[fa].t)?ia($a(d,na[fa].v,na[fa].t)+60):G+gf(d,fa,m)):G=0<ei(d,t)?$a(d,ei(d,t),t):Sf(d,k,t);Df=d[t].x+S*Math.cos(Math.PI*G/180);Ef=d[t].y+-1*S*Math.sin(Math.PI*G/180);d[R[0]].x=Df;d[R[0]].y=Ef;if(""!==Zc(m))fa=Zc(m),la=Math.sign(gf(d,fa,R[1])),v=G+la*(180-360/Math.abs(Ub))/2,fa=-360*la/Math.abs(Ub),p=-1*la;else if(3<d[m].a.length&1===sa(d,m)){for(K=la=0;K<d[m].a.length;K++)la+=d[m].a[K].t;
fa=0<We[d[m].u]&&la>We[d[m].u]&&2<lb(d,m)?-360/Math.abs(Ub):360/Math.abs(Ub);v=ia(ia(G+30)-(180-fa/2))}else 7<Ub?(fa=360/Math.abs(Ub),v=ia(G-(180-vc[Q])/2)):(fa=360/Math.abs(Ub),v=ia(G-(180-fa)/2));Q++}if("atom"===U){T=R.slice(1,R.length);T.reverse();R=R.slice(0,1);R=R.concat(T);Df=d[m].x;Ef=d[m].y;for(K=T=la=Q=0;K<d[m].a.length;K++)0!==d[d[m].a[K].p].x&&0!==d[d[m].a[K].p].y&&(Q+=d[d[m].a[K].p].x,la+=d[d[m].a[K].p].y,T++);0<T&&(Q/=T,la/=T);G=Vc(Q,la,d[m].x,d[m].y);fa=360/Ub;v=ia(G-(180-fa)/2);Q=1}if("bond"===
U){la=Na(k,m,t);if(3<lb(d,m)&&3<lb(d,t)&&(Pd=oc[String(m)].slice(0),ld=oc[String(t)].slice(0),Pd.sort(function(Uj,Vj){return Uj-Vj}),ld.sort(function(Uj,Vj){return Uj-Vj}),Pj(Pd,ld))){li=0;oe=[];ld="";for(K=0;K<Pd.length;K++)Zb.includes(Pd[K])&&(li++,oe.push(Pd[K]),ld+=String(V[Pd[K]].length));if(2===li){ld+=String(Ub);Pd=V[oe[0]].length>=V[oe[1]].length?oe[0]:oe[1];oe=V[oe[0]].length<=V[oe[1]].length?oe[0]:oe[1];pe="normal";switch(!0){case "333"===ld||"444"===ld||"777"===ld||"888"===ld:pe="squew";
break;case "3"===ld.charAt(2):pe="normal";break;case "4"===ld.charAt(2):pe="normal";break;case "5"===ld.charAt(2):pe=700>parseInt(ld,10)?"wide":"normal";break;case "6"===ld.charAt(2):pe=770>parseInt(ld,10)?"wide":"shrunk";break;case 6<parseInt(ld.charAt(2),10):pe="squew";break;default:pe="normal"}"squew"===pe?(ji=$l[Ub-3].slice(0),ki=am[Ub-3].slice(0)):"wide"===pe?(ji=Yl[Ub-5].slice(0),ki=Zl[Ub-5].slice(0)):"shrunk"===pe&&(ji=Ob[Ub-5].slice(0),ki=Xl[Ub-5].slice(0));for(K=0;K<d[t].a.length;K++)V[Pd].includes(d[t].a[K].p)&&
d[t].a[K].p!==m&&"wide"!==pe?p=Ma(d,m,t,d[t].a[K].p):V[oe].includes(d[t].a[K].p)&&d[t].a[K].p!==m&&"wide"===pe&&(p=Ma(d,m,t,d[t].a[K].p))}}if(1===k[la].B&&va){for(K=Ob=0;K<d[m].a.length;){if(2===d[m].a[K].t){Ob+=1;break}K++}for(K=0;K<d[t].a.length;){if(2===d[t].a[K].t){Ob+=1;break}K++}rb=0<Ob?1:0}else 2===k[la].B&&va&&(rb=1);Df=d[t].x;Ef=d[t].y;G=$a(d,m,t);"normal"===pe?(fa=9>Ub?360/Ub:Ic[Ub-8][P][1],ld=1):(fa=ji[0],ld=ki[0]);0>p&&(fa=-1*fa);v=ia(G+fa);Q=2}"bridge"===U&&(Df=d[t].x,Ef=d[t].y,pa=1,
G=$a(d,m,t),fa=p*Fa(d,k,Ub,N,S,pa),v=ia(G+fa),Q=qb[N].length);for(;Q<R.length;){G=ld*S*Math.cos(Math.PI*v/180);P=ld*S*-1*Math.sin(Math.PI*v/180);$b=Df+G;ac=Ef+P;if(0===d[R[Q]].x&&0===d[R[Q]].y){if(0<Bd(O,Oa,$b,ac)&&(P=Bd(O,Oa,$b,ac),void 0!==oc[String(P)])){Ic=!1;for(B=0;B<oc[String(P)].length;B++)if(-1<C(l,oc[String(P)][B])){Ic=!0;break}Ic&&(G=S*Math.cos(Math.PI*ia(30+v)/180),P=-1*S*Math.sin(Math.PI*ia(30+v)/180),$b=Df+G,ac=Ef+P)}d[R[Q]].x=$b;d[R[Q]].y=ac}7<Ub&&(fa=vc[Q]);""!==N&&(pa++,fa=p*Fa(d,
k,Ub,N,S,pa));"normal"!==pe&&(fa=p*ji[Q-1],ld=ki[Q-1]);v=ia(v+fa);Df=$b;Ef=ac;va&&0===Ue(d,k,R[Q])&&0===Ue(d,k,R[Q-1])&&Q%2===rb&&Pf(d,k,R[Q],R[Q-1],"+");Q++}if(va)for(0===Ue(d,k,R[Q-1])&&0===Ue(d,k,R[0])&&(Q-1)%2===rb&&Pf(d,k,R[0],R[Q-1],"+"),R.push(R[0]),Y=1;Y<R.length;Y++)0===Ue(d,k,R[Y])&&0===Ue(d,k,R[Y-1])&&Pf(d,k,R[Y],R[Y-1],"+");Zb.push(l)}}function kc(d,k){var l,m=0;for(l=0;l<d[k].a.length;l++)2===d[k].a[l].t&&m++;return 2===m?!0:!1}function Mc(d){var k="",l;for(l in na)if(na.hasOwnProperty(l)&&
na[l].v===d){k=l;break}return k}function Zc(d){var k="",l;for(l in na)if(na.hasOwnProperty(l)&&na[l].t===d){k=l;break}return k}function og(d){var k="";"0"!==d.charAt(0)&&"0"!==d.charAt(2)?k=d.charAt(0)===d.charAt(2)?"t":"c":"0"!==d.charAt(0)&&"0"!==d.charAt(3)?k=d.charAt(0)===d.charAt(3)?"c":"t":"0"!==d.charAt(1)&&"0"!==d.charAt(2)?k=d.charAt(0)===d.charAt(2)?"c":"t":"0"!==d.charAt(1)&&"0"!==d.charAt(3)&&(k=d.charAt(0)===d.charAt(2)?"t":"c");return k}function Sf(d,k,l){var m=0,t=0;t=d[l].a.length;
var U=m=0,p=[],B=[];B=-1;var K=0;K="";var W=0,N=0;K=N=0;var S=-1;m=0;W=1;var Y=[];S=[];for(m=0;m<t;m++)0!==d[d[l].a[m].p].x&&0!==d[d[l].a[m].p].y&&p.push(d[l].a[m].p);if(void 0===oc[String(l)])for(m=0;m<t;m++)void 0!==oc[String(d[l].a[m].p)]&&U++;m=p.length;p.sort(function(G,P){return Ba(J,G)-Ba(J,P)});switch(t){case 0:B=270;break;case 1:0===m&&(B=30);break;case 2:0===m?B=30:1===m&&(S=Ba(J,l),t=$a(d,p[0],l),2<J[S].i.length?J[S].i[0]===l?(m=Na(k,J[S].i[0],J[S].i[1]),2===k[m].B?W=ea(d,k,m):K=Ma(d,J[S].i[2],
J[S].i[1],J[S].i[0])):J[S].i.slice(-1)===l&&(B=J[S].i.slice(-3),m=Na(k,B[1],B[2]),2===k[m].B?W=ea(d,k,m):K=Ma(d,B[0],B[1],B[2])):2===J[S].i.length&&(J[S].i[1]===l?0<J[S].m&&w(d,J[S].m)&&(m=Na(k,J[S].i[0],l),2===k[m].B?W=ea(d,k,m):K=Ma(d,J[S].m,J[S].i[0],l)):0<J[S].K&&w(d,J[S].K)&&(m=Na(k,J[S].i[1],l),2===k[m].B?W=ea(d,k,m):K=Ma(d,J[S].K,J[S].i[1],l))),0!==K||kc(d,l)||(K=0<Math.cos(Math.PI*t/180)*Math.sin(Math.PI*t/180)?1:-1),B=ia(t-W*K*60));break;case 3:0===m?B=30:1===m?(t=$a(d,p[0],l),0<Math.cos(Math.PI*
t/180)*Math.sin(Math.PI*t/180)?B=t-60:B=t+60):2===m&&(B=Qf(d,l,p[0],p[1],!0));break;case 4:if(0===m)B=30;else if(1===m)t=$a(d,p[0],l),sc.includes(l)&&2>U?0<Math.cos(Math.PI*t/180)*Math.sin(Math.PI*t/180)?B=t-60:B=t+60:16===d[l].u?B=t:0<Math.cos(Math.PI*t/180)*Math.sin(Math.PI*t/180)?B=t-90:B=t+90;else if(2===m)void 0!==oc[String(l)]||140>gi(d,l,p[0],p[1])?(B=Qf(d,l,p[0],p[1],!0),B=ia(B+30)):(t=$a(d,p[0],l),B=ia(t-90));else if(3===m)if(3===lb(d,l))if(""!==aa(d,l))for(K=aa(d,l),m=0;m<p.length;m++)aa(d,
p[m])===K&&(B=qb[String(K)][0]===l?$a(d,qb[String(K)][qb[K].length-1],l):$a(d,qb[String(K)][0],l));else for(m=0;m<p.length;m++){if(void 0!==oc[String(p[m])]&&1<oc[String(p[m])].length){B=$a(d,p[m],l);break}}else{Y=[];S=[];for(m=0;m<p.length;m++)Ba(J,p[m])===Ba(J,l)?Y.push(p[m]):S.push(p[m]);if(2===Y.length)175<gi(d,l,Y[0],Y[1])&&185>gi(d,l,Y[0],Y[1])?B=$a(d,S[0],l):(K=Qf(d,l,Y[0],Y[1],!0),W=$a(d,l,S[0]),N=Math.abs(W-K),B=K+N,2>Math.abs(B-W)&&(B=K-N));else if(ff(d,l,!0),175<Pa[Pa.length-1].ca){for(m=
0;m<p.length;m++)if(p[m]!==Pa[Pa.length-1].Y&&p[m]!==Pa[Pa.length-1].ba){N=p[m];break}B=$a(d,N,l)}else B=Qf(d,l,Pa[Pa.length-1].Y,Pa[Pa.length-1].ba,!1)}}return B}function gf(d,k,l){var m=0,t=0,U=!1,p=1;"0"!==na[k].W.charAt(0)?w(d,na[k].L)?(m=na[k].L,t=na[k].W.charAt(0),U=!1):w(d,na[k].M)&&(m=na[k].M,t=na[k].W.charAt(0),U=!0):"0"!==na[k].W.charAt(1)&&(w(d,na[k].M)?(m=na[k].M,t=na[k].W.charAt(1),U=!0):w(d,na[k].L)&&(m=na[k].L,t=na[k].W.charAt(1),U=!1));l===na[k].O?p="0"!==na[k].W.charAt(2)?U?na[k].W.charAt(2)===
t?-1:1:na[k].W.charAt(2)===t?1:-1:U?na[k].W.charAt(3)===t?1:-1:na[k].W.charAt(3)===t?-1:1:l===na[k].N&&(p="0"!==na[k].W.charAt(3)?U?na[k].W.charAt(3)===t?-1:1:na[k].W.charAt(3)===t?1:-1:U?na[k].W.charAt(2)===t?1:-1:na[k].W.charAt(2)===t?-1:1);w(d,m)&&w(d,na[k].v)&&w(d,na[k].t)?(l=d[m].x-d[na[k].v].x,m=d[m].y-d[na[k].v].y,t=d[na[k].t].x-d[na[k].v].x,d=d[na[k].t].y-d[na[k].v].y,d=cg(l,m,t,d)):w(d,na[k].O)&&w(d,na[k].v)&&w(d,na[k].t)?(l=d[na[k].O].x-d[na[k].v].x,m=d[na[k].O].y-d[na[k].v].y,t=d[na[k].t].x-
d[na[k].v].x,d=d[na[k].t].y-d[na[k].v].y,d=cg(l,m,t,d)):w(d,na[k].N)&&w(d,na[k].v)&&w(d,na[k].t)?(l=d[na[k].N].x-d[na[k].v].x,m=d[na[k].N].y-d[na[k].v].y,t=d[na[k].t].x-d[na[k].v].x,d=d[na[k].t].y-d[na[k].v].y,d=cg(l,m,t,d)):d=1;return-1*p*d*60}function zc(d,k,l,m){function t(Q,T,pa,R){Q=T[pa].g;var va=T[R].g;pa=T[pa].h;T=T[R].h;return Q===va||pa===T||Q===T||va==pa?!0:!1}function U(Q,T,pa,R){var va=!1;var rb=Q[T[pa].g].x;var Ob=Q[T[pa].g].y;var vc=Q[T[pa].h].x;var Ic=Q[T[pa].h].y;var Ze=Q[T[R].g].x;
pa=Q[T[R].g].y;var Pd=Q[T[R].h].x;Q=Q[T[R].h].y;vc-=rb;Ic-=Ob;Pd-=Ze;T=Q-pa;Q=vc*T-Pd*Ic;if(1E-8>Math.abs(Q))return 0;0<Q&&(va=!0);rb-=Ze;Ob-=pa;pa=vc*Ob-Ic*rb;if(0>pa===va)return 0;Ob=Pd*Ob-T*rb;return 0>Ob===va||pa>Q===va||Ob>Q===va?0:1}var p=1E3,B=0,K=0,W=0,N=0,S=0,Y=0,G=0;Y=0;Y=[];W=[];var P=[],fa=[],la=[],v=[];p=[];N=[];N=l/2;S=l;K=l/2;p=new Wc(0,0,0,0);for(B=1;B<d.length-1;B++)for(W=B+1;W<d.length;W++)if(0!==d[B].x||0!==d[B].y||0!==d[W].x||0!==d[W].y)Y=Math.sqrt((d[B].x-d[W].x)*(d[B].x-d[W].x)+
(d[B].y-d[W].y)*(d[B].y-d[W].y)),void 0!==oc[String(B)]&&void 0!==oc[String(W)]?S=N:S=l,Y<S&&(Y=[B,W],P.push(Y));if(0<P.length)for(B=0;B<P.length-1;B++)for(W=B+1;W<P.length;W++)N=Na(k,P[B][0],P[W][0]),S=Na(k,P[B][1],P[W][1]),Y=Na(k,P[B][1],P[W][0]),G=Na(k,P[B][0],P[W][1]),0<N&&0<S?fa.push([N,S]):0<Y&&0<G&&fa.push([Y,G]);for(W=1;W<k.length;W++)for(p.b=Math.min(d[k[W].g].x,d[k[W].h].x),p.t=Math.min(d[k[W].g].y,d[k[W].h].y),p.c=Math.abs(d[k[W].g].x-d[k[W].h].x),p.f=Math.abs(d[k[W].g].y-d[k[W].h].y),
B=1;B<d.length;B++)B!==k[W].g&&B!==k[W].h&&gc(p,d[B].x,d[B].y)&&Rl(d,k,B,W)<K&&la.push([B,W]);for(B=1;B<d.length;B++)if(!(2>d[B].a.length))for(K=0;K<d[B].a.length-1;K++)for(W=K+1;W<d[B].a.length;W++)p=ia($a(d,B,d[B].a[W].p)-$a(d,B,d[B].a[K].p)),10>p&&v.push([B,d[B].a[K].p,d[B].a[W].p]);p=[];for(B=1;B<k.length-1;B++)for(K=B+1;K<k.length;K++)t(d,k,B,K)||(0<Ia(d,k,B)||0<Ia(d,k,K))&&-1<x(Ia(d,k,B))&&-1<x(Ia(d,k,K))||1===U(d,k,B,K)&&p.push([B,K]);N=[];for(B=1;B<V.length;B++)if(!(7<V[B].length||!0===Oc(B)))for(W=
V[B].slice(0),W.push(V[B][0]),W.unshift(V[B][V[B].length-1]),K=1;K<W.length-1;K++)2<lb(d,W[K])||165<gi(d,W[K],W[K-1],W[K+1])&&N.push([B,W[K]]);if(0===m){he=[];for(B=0;B<P.length;B++)he.push(P[B]);Lg=[];for(B=0;B<fa.length;B++)Lg.push(fa[B]);Ad=[];for(B=0;B<la.length;B++)Ad.push(la[B]);rg=[];for(B=0;B<v.length;B++)rg.push(v[B]);Ae=[];for(B=0;B<p.length;B++)Ae.push(p[B]);Ah=[];for(B=0;B<N.length;B++)Ah.push(N[B])}return 1===m?P.length+fa.length+la.length+v.length+p.length+N.length:he.length+Lg.length+
Ad.length+rg.length+Ae.length+Ah.length}function r(d,k){function l(v,Q,T,pa){var R=!1;switch(!0){case 0===xa(T)&&0===xa(pa):Ba(J,T)<Ba(J,pa)&&(R=!0);break;case 0<xa(T)&&0===xa(pa):R=!0;break;case 0<xa(T)&&0<xa(pa):V[xa(T)].length>V[xa(pa)].length&&(R=!0)}R&&(R=pa,pa=T,T=R);Ca(v,Q,T,pa)}function m(v,Q,T,pa){var R=la,va=la,rb;l(v,Q,T,pa);if(0<kd.length){T=0;for(rb=-1;T<kd.length;)Cg(v,Q,kd[T],1,!0),pa=zc(v,Q,jc,1,""),Cg(v,Q,kd[T],-1,!0),pa<R&&(rb=T,R=pa),T++;R<va&&-1!==rb&&(Cg(v,Q,kd[rb],1,!0),la=zc(v,
Q,jc,0,"inside fixAtomAtomCollisionsByFlip: after flipBranch after bestFlip"))}}function t(v,Q,T,pa){var R=0,va=0,rb=0,Ob=0;var vc=Ia(v,Q,T);var Ic=Ia(v,Q,pa);if(0<vc&&0<Ic){for(S=0;S<V[vc].length;S++)R+=v[V[vc][S]].x,va+=v[V[vc][S]].y;R/=V[vc].length;va/=V[vc].length;var Ze=(v[Q[T].g].x+v[Q[T].h].x)/2;vc=(v[Q[T].g].y+v[Q[T].h].y)/2;for(S=0;S<V[Ic].length;S++)rb+=v[V[Ic][S]].x,Ob+=v[V[Ic][S]].y;rb/=V[Ic].length;Ob/=V[Ic].length;var Pd=(v[Q[pa].g].x+v[Q[pa].h].x)/2;Ic=(v[Q[pa].g].y+v[Q[pa].h].y)/2;
R-=Ze;va-=vc;rb-=Pd;Ob-=Ic;Ic=Math.sqrt(R*R+va*va);vc=Math.sqrt(rb*rb+Ob*Ob);R=Ra*R/Ic;va=Ra*va/Ic;rb=Ra*rb/vc;Ob=Ra*Ob/vc;v[Q[T].g].x+=R;v[Q[T].g].y+=va;v[Q[T].h].x+=R;v[Q[T].h].y+=va;v[Q[pa].g].x+=rb;v[Q[pa].g].y+=Ob;v[Q[pa].h].x+=rb;v[Q[pa].h].y+=Ob}}function U(v,Q,T,pa){var R=new xc(v[Q[pa].h].x-v[Q[pa].g].x,v[Q[pa].h].y-v[Q[pa].g].y);var va=new xc(v[T].x-v[Q[pa].g].x,v[T].y-v[Q[pa].g].y);R=new xc(R.x/Oi(R),R.y/Oi(R));R=new xc(R.x*(va.x*R.x+va.y*R.y),R.y*(va.x*R.x+va.y*R.y));var rb=new xc(0,0);
va=new xc(0,0);rb.x=v[T].x-(v[Q[pa].g].x+R.x);rb.y=v[T].y-(v[Q[pa].g].y+R.y);va.x=rb.x*jc/Oi(rb);va.y=rb.y*jc/Oi(rb);for(R=0;0<Ad.length&&Ad[0][0]===T&&Ad[0][1]===pa&&4>R;)v[T].x+=va.x,v[T].y+=va.y,zc(v,Q,jc,0," inside fixAtBondCollisions after atom move"),R++}function p(v,Q,T){var pa=rg[T][0],R=rg[T][1],va=rg[T][2],rb=T=0;Pa=[];ff(v,pa,!0);var Ob=Ia(v,Q,Na(Q,pa,R));var vc=Ia(v,Q,Na(Q,pa,va));0===Ob&&0===vc?(T=R,rb=va):0===Ob&&0<vc?(T=R,rb=va):0<Ob&&0===vc&&(T=va,rb=R);R=Pa.length-1;for(va=Pa.length-
1;0<=va;va--)if(0<Gc(Pa[va].Y,Pa[va].ba))R--;else if(Pa[va].Y===T||Pa[va].ba===T)R--;else break;0>R&&(R=Pa.length-1);0!=T&&0!=rb&&void 0!==Pa[R]&&(rb=$a(v,pa,T),R=Qf(v,pa,Pa[R].Y,Pa[R].ba,180<Pa[R].ca?!0:!1),W(v,Q,pa,T,rb,1),W(v,Q,pa,T,R,-1))}function B(v,Q,T,pa){Ca(v,Q,Q[T].g,Q[pa].g);var R=Hb.slice(0);var va=kd.slice(0);Ca(v,Q,Q[T].h,Q[pa].g);Hb.length>R.length&&(R=Hb.slice(0),va=kd.slice(0));Ca(v,Q,Q[T].g,Q[pa].h);Hb.length>R.length&&(R=Hb.slice(0),va=kd.slice(0));Ca(v,Q,Q[T].h,Q[pa].h);Hb.length>
R.length&&(R=Hb.slice(0),va=kd.slice(0));Hb=R.slice(0);kd=va.slice(0);for(L=0;L<kd.length&&(Cg(v,Q,kd[L],1,!0),la=zc(v,Q,jc,0," inside fixCrossingBonds: after flipBranch"),0!==Ae.length);L++)Cg(v,Q,kd[L],-1,!0)}function K(v,Q,T,pa){var R=ka*pa;if(!(void 0===T||1>T||T>Q.length)){var va=Hb[Math.min(Hb.indexOf(Q[T].g),Hb.indexOf(Q[T].h))];var rb=Hb[Math.max(Hb.indexOf(Q[T].g),Hb.indexOf(Q[T].h))];T=Math.sqrt((v[rb].x-v[va].x)*(v[rb].x-v[va].x)+(v[rb].y-v[va].y)*(v[rb].y-v[va].y));var Ob=$a(v,va,rb);
Q=R*Math.cos(Math.PI*Ob/180);R=-1*R*Math.sin(Math.PI*Ob/180);vh(v,rb,va);va=v[Nb[1]].x+Q;rb=v[Nb[1]].y+R;va=Math.sqrt((v[Nb[0]].x-va)*(v[Nb[0]].x-va)+(v[Nb[0]].y-rb)*(v[Nb[0]].y-rb));if(va<T&&0<pa||va>T&&0>pa)Q*=-1,R*=-1;for(pa=1;pa<Nb.length;pa++)v[Nb[pa]].x+=Q,v[Nb[pa]].y+=R}}function W(v,Q,T,pa,R,va){Q=Hb[0];vh(v,pa,T);for(pa=0;pa<v.length;pa++)v[pa].s=0;for(pa=0;pa<Nb.length;pa++)v[Nb[pa]].s=1;0===R&&0<Q&&(R=Math.sqrt((v[T].x-v[Q].x)*(v[T].x-v[Q].x)+(v[T].y-v[Q].y)*(v[T].y-v[Q].y)),R=180*Math.asin(2*
Ra/R)/Math.PI);pa=v[T].x;Q=v[T].y;Hg(v,1,-1*pa,-1*Q,!1);di(v,1,v[T].x,v[T].y,va*R,!1);Hg(v,1,pa,Q,!1);Ac()}function N(v,Q,T,pa){var R=V[T].indexOf(pa);Q=new xc(v[pa].x,v[pa].y);var va=new xc(0,0);new xc(0,0);-1<R&&(T=db(v,T),T=Vc(T.x,T.y,Q.x,Q.y),va.x=2*Ra*Math.cos(Math.PI*T/180),va.y=-2*Ra*Math.sin(Math.PI*T/180),v[pa].x=Q.x+va.x,v[pa].y=Q.y+va.y)}var S=0,Y=0,G=0,P=Y=0,fa=0,la=0;P=-1;la=zc(d,k,jc,0," After first checkCollisions");if(0<rg.length)for(G=0;0<rg.length&&6>G;)p(d,k,0),la=zc(d,k,jc,0," after fixLigDirSame"),
G++;if(0<Lg.length)for(G=0;0<Lg.length&&6>=G;){t(d,k,Lg[0][0],Lg[0][1]);la=zc(d,k,jc,0," after fixBondColl");if(0===la)return;G++}else if(0<Ae.length)for(G=0;0<Ae.length&&6>G;)B(d,k,Ae[0][0],Ae[0][1]),0!==Ae.length&&(la=zc(d,k,jc,0,"after fixCrossingBonds"),G++);else if(0<Ad.length)for(G=0;0<Ad.length&&6>G;){for(S=0;S<Ad.length;S++){m(d,k,Ad[0][0],k[Ad[0][1]].g);la=zc(d,k,jc,0,"atBondTooClose after fixAtomAtomCollisonByFlip with fra");if(0===la)return;if(0===Ad.length)break;else{m(d,k,Ad[0][0],k[Ad[0][1]].h);
la=zc(d,k,jc,0,"atBondTooClose after fixAtomAtomCollisonByFlip with toa");if(0===la)return;if(0===Ad.length)break}U(d,k,Ad[S][0],Ad[S][1])}la=zc(d,k,jc,0," after fixAtBondCollisions by moving atom");G++}for(G=0;0<he.length&&10>=G;){m(d,k,he[0][0],he[0][1]);la=zc(d,k,jc,0," after fixAtomAtomCollisonByFlip inside tooClose() while loop");if(0===la)return;if(0<he.length&&(l(d,k,he[0][0],he[0][1]),0<kd.length)){if(0===kd.length%2){P=kd[Math.floor(kd.length/2)-1];fa=kd[Math.floor(kd.length/2)];for(Y=0;0<
he.length&&6>Y;)K(d,k,P,Ra/ka),la=zc(d,k,jc,0," after stretch bond1 even number"),Y++;if(0===la)return;K(d,k,P,-1*(Y+1)*Ra/ka);for(Y=0;0<he.length&&6>Y;)K(d,k,fa,Ra/ka),la=zc(d,k,jc,0," after stretch bond2 even number"),Y++;if(0===la)return;K(d,k,fa,-1*(Y+1)*Ra/ka);la=zc(d,k,jc,0," after stretch bond");if(0===la)return;for(Y=0;0<he.length&&6>Y;)K(d,k,P,Ra/ka),K(d,k,fa,Ra/ka),la=zc(d,k,jc,0," after stretch 2bonds even number"),Y++;if(0===la)return;K(d,k,P,-1*(Y+1)*Ra/ka);K(d,k,fa,-1*(Y+1)*Ra/ka)}else{P=
kd[Math.floor(kd.length/2)];for(Y=0;0<he.length&&6>Y;)K(d,k,P,2*Ra/ka),la=zc(d,k,jc,0," after stretch bond odd number"),Y++;if(0===la)return;K(d,k,P,-2*(Y+1)*Ra/ka)}for(Y=1;Y<Hb.length-2;Y++)if(kd.includes(Na(k,Hb[Y],Hb[Y+1]))){P=Ma(d,Hb[Y+1],Hb[Y],Hb[Y-1]);W(d,k,Hb[Y+1],Hb[Y],0,P);la=zc(d,k,jc,0," after bending bond");if(0===la)return;W(d,k,Hb[Y+1],Hb[Y],0,-1*P)}}G++}la=zc(d,k,jc,0," after while loop");0!==la&&0<Ah.length&&(N(d,k,Ah[0][0],Ah[0][1]),la=zc(d,k,jc,0," after while loop: after fix_pRingAngle"));
0!==la&&la!=Ae.length&&0!=he.length&&(l(d,k,he[0][0],he[0][1]),1<Hb.length&&(P=Na(k,Hb[0],Hb[1]),K(d,k,P,-2*Ra/ka),la=zc(d,k,jc,0," after while loop: after stretchBond")));if(0!==la&&la===Ae.length)for(G=0;0<Ae.length&&6>G;)B(d,k,Ae[0][0],Ae[0][1]),la=zc(d,k,jc,0," after while loop: after fixCrossingBonds"),G++;0!==la&&la===Ad.length&&(U(d,k,Ad[0][0],Ad[0][1]),la=zc(d,k,jc,0," after while loop: after fixAtBondCollisions"))}function z(d,k){var l=[];l=[];var m=new Oj(0,0,0,0),t=[],U=[],p=0,B=0,K=0,
W=l=0,N=0,S=p=p=0,Y=0,G=[];U=0;B="";var P=[];P=U=P=0;var fa=[],la=0,v=0;l=0;p="";B=!0;var Q=fa=0;p=l=0;p=[];var T="",pa=0,R=0,va=0;if(d===O)for(W=1;W<d.length;W++)uf(O,W);Sc=[];for(W=0;W<sc.length;W++){v=sc[W];G=[];P=[];t=[];U=[];fa=[];la=0;l=[];B="";p=l=N=Y=S=0;B=!0;p="";p=[];m.o=0;m.l=0;m.C=0;K=B=p=p=m.n=0;Pa=[];Q="@"===d[v].J?1:-1;if(2===Ue(d,k,sc[W])){m=Xk(d,sc[W]);m.l<m.C&&(p=m.l,m.l=m.C,m.C=p);for(p=0;p<d[m.l].a.length;p++)1===d[m.l].a[p].t&&(t.push(d[m.l].a[p].p),G.push(d[m.l].a[p].p));for(p=
0;p<d[m.C].a.length;p++)1===d[m.C].a[p].t&&(U.push(d[m.C].a[p].p),G.push(d[m.C].a[p].p))}else{for(p=0;p<d[v].a.length;p++)B=kb(v,d[v].a[p].p),""!==B?P.push([d[v].a[p].p,parseInt(B,10)]):G.push(d[v].a[p].p);G.sort(function(rb,Ob){return rb-Ob});if(0<P.length)for(P.sort(function(rb,Ob){return parseInt(rb[1],10)-parseInt(Ob[1],10)}),p=P.length-1;0<=p;p--)G.unshift(P[p][0]);for(p=0;p<G.length;p++)G[p]<v&&(N=G[p])}ff(d,v,!0);if(4===G.length)if(0!==m.o)yc(d,k,Na(k,m.l,t[0]),5,!0),k[Na(k,m.l,t[0])].h===
m.l&&yc(d,k,Na(k,m.l,t[0]),-1,!0),1<t.length&&(yc(d,k,Na(k,m.l,t[1]),4,!0),k[Na(k,m.l,t[1])].h===m.l&&yc(d,k,Na(k,m.l,t[1]),-1,!0));else{if(0===S&&0<lb(d,v)){for(p=U=0;p<G.length;p++)Ia(d,k,Na(k,v,G[p]))?U++:(S=G[p],Y=0);if(4===U&&(Pa=[],ff(d,v,!0),4===Pa.length&&180<=Pa[3].ca))for(U=Pa[3].Y,sc.includes(Pa[3].Y)&&(U=Pa[3].ba),sc.includes(Pa[3].ba)&&(U=Pa[0].Y),P=ia(180+Vc(d[v].x,d[v].y,(d[Pa[3].Y].x+d[Pa[3].ba].x)/2,(d[Pa[3].Y].y+d[Pa[3].ba].y)/2)),P=-1*cg(d[U].x-d[v].x,d[U].y-d[v].y,Math.cos(Math.PI*
P/180),-1*Math.sin(Math.PI*P/180)),fa=0;170<Pa[Pa.length-1].ca&&6>fa;)u(d,v,U,15*P),Pa=[],ff(d,v,!0),fa++;if(0!==S){for(p=0;p<G.length;p++)-1<lb(d,G[p])&&(l=G[p]);0===l&&(S=0)}if(0===S){for(p=0;p<d[v].a.length;p++)if(""!==T&&aa(d,d[v].a[p].p)===T&&aa(d,v)===T){S=d[v].a[p].p;T="";pa=0;break}for(p=0;p<d[v].a.length;p++)if(0===S&&0<R&&V[R].includes(v)&&-1===lb(d,d[v].a[p].p)&&V[R].includes(d[v].a[p].p)){S=d[v].a[p].p;va=R=0;break}}if(0===S){for(p=0;p<d[v].a.length;p++)if(""===T&&""!==aa(d,d[v].a[p].p)&&
aa(d,v)===aa(d,d[v].a[p].p)){T=aa(d,d[v].a[p].p);pa=d[v].a[p].p;break}for(p=0;p<d[v].a.length;p++)if(0===R&&-1===lb(d,d[v].a[p].p)&&Gc(v,d[v].a[p].p)&&""===aa(d,d[v].a[p].p)){R=Gc(v,d[v].a[p].p);va=d[v].a[p].p;break}if(0!==R&&""!==T){if(qb[T][0]===pa&&qb[T][qb[T].length-1].includes(sc)||qb[T][qb[T].length-1]===pa&&qb[T][0].includes(sc))sc.includes(pa)?S=0:(S=pa,R=0);0!==S||sc.includes(Pa[0].Y)?sc.includes(Pa[0].ba)?sc.includes(va)?S=0:(S=va,T=""):(S=Pa[0].ba,R=0,T=""):(S=Pa[0].Y,R=0,T="")}else 0!==
R&&Gc(v,va)?S=va:""!==T&&aa(d,v)===T&&(S=pa);0===S&&(T="",R=0)}if(0===S)for(p=0;p<G.length;p++)0<lb(d,G[p])||(S=G[p],Y=0)}if(0===S&&void 0!==oc[String(v)]){l=[];for(p=0;p<G.length;p++)Ia(d,k,Na(k,v,G[p]))||l.push(G[p]);0<l.length&&(S=l[0],1<l.length?Y=l[1]:Y=0)}if(0===S){B=!0;ff(d,v,!0);for(p=0;p<Pa.length;p++)if(88>Pa[p].ca||92<Pa[p].ca){B=!1;break}if(!0===B)for(p=0;p<G.length;p++)if(!sc.includes(G[p])&&void 0===oc[String(G[p])]){S=G[p];break}}if(0===S)for(ff(d,v,!0),l=0;4>l;){S=Pa[l].Y;Y=Pa[l].ba;
if(sc.includes(S)||sc.includes(Y)||void 0!==oc[String(S)]||void 0!==oc[String(Y)])Y=S=0;else break;l++}0===S&&(sc.includes(G[0])||sc.includes(G[2])?sc.includes(G[1])||sc.includes(G[3])||(S=G[1],Y=G[3]):(S=G[0],Y=G[2]));if(0!==S)p=Na(k,v,S),1===k[p].B&&(k[p].g===v?yc(d,k,p,4,!0):(l=k[p].g,k[p].g=k[p].h,k[p].h=l,0<=d[S].z?yc(d,k,p,4,!0):yc(d,k,p,5,!0))),0!==Y&&1===k[Na(k,v,Y)].B&&(yc(d,k,Na(k,v,Y),5,!0),k[Na(k,v,Y)].h===v&&yc(d,k,Na(k,v,Y),-1,!0));else{Sc.push(v);continue}}else if(4>G.length)if(0!==
m.o)yc(d,k,Na(k,m.l,t[0]),5,!0),k[Na(k,m.l,t[0])].h===m.l&&yc(d,k,Na(k,m.l,t[0]),-1,!0),1<t.length&&(yc(d,k,Na(k,m.l,t[1]),4,!0),k[Na(k,m.l,t[1])].h===m.l&&yc(d,k,Na(k,m.l,t[1]),-1,!0));else{0===S&&2===G.length&&(p=Qf(d,v,G[0],G[1],!1),B=d[v].x+ka*Math.cos(Math.PI*p/180),K=d[v].y+-1*ka*Math.sin(Math.PI*p/180),d[d.length]=new mc(1,"H",B,K,0,0,1),d[v].G+=1,xe(d,k,v,d.length-1,4),S=d.length-1,Y=0,G.unshift(d.length-1));if(0===S){if(void 0!==oc[String(v)]){for(p=0;p<d[v].a.length;p++)xb(d,v,d[v].a[p].p)&&
fa.push(d[v].a[p].p);0<fa.length&&(la=fa[0])}if(0<lb(d,v)||0<fa.length)if(ff(d,v,!0),175>ia(Pa[0].ca+Pa[1].ca)&&0===Qb(v)){for(p=0;p<d[v].a.length;p++)if(""!==T&&aa(d,d[v].a[p].p)===T){S=d[v].a[p].p;T="";break}if(0===S)for(p=0;p<d[v].a.length;p++)if(0===S&&0<R&&""===aa(d,d[v].a[p].p)&&-1===lb(d,d[v].a[p].p)&&V[R].includes(d[v].a[p].p)){S=d[v].a[p].p;R=0;break}if(0===S){for(p=0;p<d[v].a.length;p++)if(""===T&&""!==aa(d,d[v].a[p].p)&&aa(d,v)===aa(d,d[v].a[p].p)){T=aa(d,d[v].a[p].p);pa=d[v].a[p].p;break}for(p=
0;p<d[v].a.length;p++)if(0===R&&-1===lb(d,d[v].a[p].p)&&Gc(v,d[v].a[p].p)&&""===aa(d,d[v].a[p].p)){R=Gc(v,d[v].a[p].p);va=d[v].a[p].p;break}0!==R&&""!==T?sc.includes(pa)?sc.includes(va)?S=0:(S=va,T=""):(S=pa,R=0):0!==R?S=va:""!==T&&(S=pa);0===S&&(T="",R=0)}}else{l=[];for(p=0;p<G.length;p++)(0<lb(d,G[p])||Wj.includes(G[p]))&&l.push(G[p]);if(0<la)for(p=0;p<G.length;p++)if(G[p]!==la){Y=G[p];break}1!==l.length||0!==Y||180<=Pa[Pa.length-1].ca?0===Y&&(Y=-1):Y=l[0];0!==Y&&(p=0<Y?ia(180+$a(d,v,Y)):Jb(d,v),
Y=0,B=d[v].x+ka*Math.cos(Math.PI*p/180),K=d[v].y+-1*ka*Math.sin(Math.PI*p/180),0<Bd(O,Oa,B,K)&&(p=ia(p+120),B=d[v].x+ka*Math.cos(Math.PI*p/180),K=d[v].y+-1*ka*Math.sin(Math.PI*p/180)),0<Bd(O,Oa,B,K)&&(p=ia(p-240),B=d[v].x+ka*Math.cos(Math.PI*p/180),K=d[v].y+-1*ka*Math.sin(Math.PI*p/180)),d[d.length]=new mc(1,"H",B,K,0,0,1),d[v].G+=1,xe(d,k,v,d.length-1,4),S=d.length-1,Y=0,G.unshift(d.length-1))}}if(0===S)for(p=0;p<G.length;p++)if(1===d[G[p]].a.length&&G[p]!==N){S=G[p];break}if(0===S)for(p=0;p<G.length;p++)if(1===
d[G[p]].a.length){S=G[p];break}if(0===S)for(p=0;p<G.length;p++)if(0< !xa(G[p])&&1===k[Na(k,v,G[p])].B&&G[p]!==N){S=G[p];break}if(0===S)for(p=0;p<G.length;p++)if(0< !xa(G[p])&&1===k[Na(k,v,G[p])].B){S=G[p];break}if(0===S)for(p=0;p<G.length;p++)if(1===k[Na(k,v,G[p])].B&&G[p]!==N){S=G[p];break}if(0===S)for(p=0;p<G.length;p++)if(1===k[Na(k,v,G[p])].B){S=G[p];break}0===S&&(S=G[1]);sc.includes(S)&&(ff(d,v,!0),p=180<Pa[Pa.length-1].ca?Qf(d,v,Pa[Pa.length-1].ba,Pa[Pa.length-1].Y,!0):ia(30+$a(d,v,S)),ha(d,
k,v,p,4),S=O.length-1,G.push(S));if(0!==S&&0<Na(k,v,S))p=Na(k,v,S),1===k[p].B&&(k[p].g===v?yc(d,k,p,4,!0):(l=k[p].g,k[p].g=k[p].h,k[p].h=l,0<=d[S].z?yc(d,k,p,4,!0):yc(d,k,p,5,!0)));else{Sc.push(v);continue}}0===m.o?(G.splice(G.indexOf(N),1),3>G.length&&G.unshift(0),p=[v,N,G[0],G[1],G[2]],p=Ji(d,k,v,"",p,"parse")):p=Yk(d,k,m,"parse");""!==p&&p!==(1===Q?"@":"@@")?0!==m.o?(yc(d,k,Na(k,m.l,t[0]),4,!0),k[Na(k,m.l,t[0])].h===m.l&&yc(d,k,Na(k,m.l,t[0]),-1,!0),1<t.length&&(yc(d,k,Na(k,m.l,t[1]),5,!0),k[Na(k,
m.l,t[1])].h===m.l&&yc(d,k,Na(k,m.l,t[1]),-1,!0))):(yc(d,k,Na(k,v,S),5,!1),4===d[v].a.length&&0!==Y&&yc(d,k,Na(k,v,Y),4,!1)):""===p&&(0!==m.o?(yc(d,k,Na(k,m.l,t[0]),1,!0),1<t.length&&yc(d,k,Na(k,m.l,t[1]),1,!0)):(yc(d,k,Na(k,v,S),1,!0),4===d[v].a.length&&0!==Y&&yc(d,k,Na(k,v,Y),1,!0)),Sc.push(v))}}function u(d,k,l,m){var t=Math.sqrt((d[l].x-d[k].x)*(d[l].x-d[k].x)+(d[l].y-d[k].y)*(d[l].y-d[k].y));d[l].x=d[k].x+t*Math.cos(Math.PI*m/180);d[l].y=d[k].y-t*Math.sin(Math.PI*m/180)}function w(d,k){return 0!==
d[k].x&&0!==d[k].y?!0:!1}function x(d){var k;if(0===eb.length)return-1;for(k=0;k<eb.length;k++)if(eb[k].includes(d))return k;return-1}function M(d,k){var l;for(l=0;l<id.length;l++)if(id[l].Z===d&&id[l].$===k||id[l].$===d&&id[l].Z===k)return l;return-1}function C(d,k){var l;for(l=0;l<zb.length;l++)if(zb[l].Z===d&&zb[l].$===k||zb[l].$===d&&zb[l].Z===k)return l;return-1}function H(d,k,l){var m="";for(m in qb)if(qb.hasOwnProperty(m)&&qb[m].length===l&&qb[m].includes(d[k].h)&&qb[m].includes(d[k].g))return m}
function aa(d,k){d="";for(d in qb)if(qb.hasOwnProperty(d)&&qb[d].includes(k))return d;return""}function ra(d,k){for(L=0;L<V[k].length;L++)if(""!==aa(d,V[k][L]))return!0;return!1}function Fa(d,k,l,m,t,U){k=0;var p=qb[m].length,B=l-p;var K=qb[m][0];m=qb[m][p-1];d=Math.sqrt((d[m].x-d[K].x)*(d[m].x-d[K].x)+(d[m].y-d[K].y)*(d[m].y-d[K].y));switch(!0){case 1===U:switch(B){case 1:k=180-180*Math.acos(d/(2*t))/Math.PI;break;case 2:k=180-180*Math.acos(Math.abs(d-t)/(2*t))/Math.PI;break;case 3:U=2*t*Math.cos(Math.PI/
6);k=180-180*Math.acos(Math.abs(d-U)/(2*t))/Math.PI;break;case 4:U=t*(2*Math.cos(2*Math.PI/7)+1);k=180-180*Math.acos(Math.abs(d-U)/(2*t))/Math.PI;break;case 5:U=2*t*(Math.cos(Math.PI/8)+Math.cos(3*Math.PI/8));k=180-180*Math.acos(Math.abs(d-U)/(2*t))/Math.PI;break;default:k=0}break;case 2===U:switch(B){case 2:k=180*Math.acos(Math.abs(d-t)/(2*t))/Math.PI;break;case 3:U=2*t*Math.cos(Math.PI/6);k=180-180*Math.acos(Math.abs(d-U)/(2*t))/Math.PI;k=k-90+360/l;break;case 4:U=t*(2*Math.cos(2*Math.PI/7)+1);
k=180-180*Math.acos(Math.abs(d-U)/(2*t))/Math.PI;k=180-k-360/l;break;case 5:U=2*t*(Math.cos(Math.PI/8)+Math.cos(3*Math.PI/8));k=180-180*Math.acos(Math.abs(d-U)/(2*t))/Math.PI;k=90-k+1080/(2*l);break;default:k=0}break;case 2<U:k=360/l}return k}function Ga(d,k){var l=k.slice(0);l.push(k[0]);for(k=0;k<l.length-1&&d[0]!==l[k];k++);return d[1]===l[k+1]?!0:!1}function sa(d,k){var l,m=0;for(l=0;l<d[k].a.length;l++)0!==d[d[k].a[l].p].x&&0!==d[d[k].a[l].p].y&&m++;return m}function ea(d,k,l){var m,t="",U="",
p=1;if(2!==k[l].B)return 1;if(null!==Yb[k[l].h].match(/[\\|/]/))for(t=Yb[k[l].h].match(/[\\|/]/)[0],m=0;m<d[k[l].g].a.length;m++){var B=d[k[l].g].a[m].p;if(B!==k[l].h&&/[\\|/]/.test(Yb[B])){U=Yb[B].match(/[\\|/]/)[0];break}}else if(null!==Yb[k[l].g].match(/[\\|/]/))for(t=Yb[k[l].g].match(/[\\|/]/)[0],m=0;m<d[k[l].h].a.length;m++)if(B=d[k[l].h].a[m].p,B!==k[l].g&&/[\\|/]/.test(Yb[B])){U=Yb[B].match(/[\\|/]/)[0];break}""!==t&&""!==U&&(p=t===U?1:-1);return p}function Jb(d,k){var l,m=new xc(0,0);if(void 0!==
oc[String(k)]&&0<oc[String(k)].length){for(l=0;l<oc[String(k)].length;l++)m.x+=Xj[oc[String(k)][l]].x-d[k].x,m.y+=Xj[oc[String(k)][l]].y-d[k].y;return Vc(m.x,m.y,0,0)}return-1}function Ma(d,k,l,m){return-1*cg(d[l].x-d[k].x,d[l].y-d[k].y,d[m].x-d[l].x,d[m].y-d[l].y)}function kb(d,k){for(var l in Kb)if(Kb.hasOwnProperty(l)&&(Kb[l].ja===d&&Kb[l].ga===k||Kb[l].ja===k&&Kb[l].ga===d))return l;return""}function Xb(d,k,l){var m=-1,t=k[k.length-1],U=-1;var p=Ya[k[0]].i.indexOf(Kb[d].ja);var B=Ya[l[0]].i.indexOf(Kb[d].ga),
K=[],W=[],N=[];k=k[0];if(k===t)U=Ya[t].i.indexOf(Kb[d].ja);else for(;-1<p&&k!==t;)if(W.push(Ya[k].i[p]),p--,0>p){var S=Ya[k].m;k=Ya[k].ia;p=Ya[k].i.indexOf(S);if(k===t){U=p;break}p=Ya[k].i.indexOf(S)}k=l[0];if(k===t)m=Ya[t].i.indexOf(Kb[d].ga);else for(p=B;-1<p&&k!==t;)if(N.unshift(Ya[k].i[p]),p--,0>p&&(S=Ya[k].m,k=Ya[k].ia,p=Ya[k].i.indexOf(S),k===t)){m=p;break}for(p=m;p>=U;p--)K.unshift(Ya[t].i[p]);V.push(K.concat(N,W))}function Ea(d){var k,l=Qa.length,m=Qa.length,t=[];for(k=0;k<V[d].length;k++)V[d][k]<
l&&(l=V[d][k]);for(k=0;k<V[d].length;k++)V[d][k]<m&&V[d][k]!==l&&(m=V[d][k]);if(V[d].indexOf(l)>V[d].indexOf(m)){for(k=V[d].length-1;0<=k;k--)t.push(V[d][k]);V[d]=t.slice(0)}for(k=0;0<V[d].indexOf(l)&&!(m=V[d].shift(),V[d].push(m),k++,20<k););}function Ia(d,k,l){for(d=1;d<V.length;d++)if(V[d].includes(k[l].g)&&V[d].includes(k[l].h))return d;return 0}function xa(d){var k;for(k=1;k<V.length;k++)if(V[k].includes(d))return k;return 0}function Xa(d){for(L=1;L<V.length;L++)V[L].includes(d)&&(void 0===oc[String(d)]&&
(oc[String(d)]=[]),oc[String(d)].push(L))}function Qb(d){for(L=1;L<V.length;L++)if(3===V[L].length&&V[L].includes(d))return L;return 0}function Oc(d){var k,l=!0;for(k=0;k<V[d].length;k++){var m=Qa[V[d][k]].match(/^\[([a-z]{0,2})(H{0,1})([0-9]{0,2})([-|+]{0,1}\d{0,2})\]$/);null!==m?""!==m[1]&&(Tf.includes(m[1])?Id.includes(V[d][k])||Id.push(V[d][k]):l=!1):Tf.includes(Qa[V[d][k]])?Id.includes(V[d][k])||Id.push(V[d][k]):l=!1}return l}function Gc(d,k){var l,m=0;for(l=1;l<V.length;l++)if(V[l].includes(d)&&
V[l].includes(k)){m=l;break}return m}function db(d,k){var l,m=new xc(0,0),t=0,U=0;for(l=0;l<V[k].length;l++)t+=d[V[k][l]].x,U+=d[V[k][l]].y;m.x=t/V[k].length;m.y=U/V[k].length;return m}function lb(d,k){var l=0,m;for(m=0;m<d[k].a.length;m++)0<xa(d[k].a[m].p)&&!xb(d,k,d[k].a[m].p)&&l++;return 2<l?l:-1}function xb(d,k,l){for(d=0;d<be.length;d++)if(be[d].wa===k&&be[d].xa===l||be[d].wa===l&&be[d].xa===k)return!0;return!1}function ze(d){var k;for(k=0;k<zb.length;k++)if(d===zb[k].sa||d===zb[k].ta)return k;
return-1}function ae(){function d(G,P){var fa,la;for(fa=0;fa<U[G].length;fa++){var v=!1;for(la=0;la<U[P].length;la++)if(U[G][fa].v===U[P][la].v&&U[G][fa].t===U[P][la].t||U[G][fa].v===U[P][la].t&&U[G][fa].t===U[P][la].v)B.push(new wd(U[G][fa].v,U[G][fa].t)),v=!0;v||t.push(new wd(U[G][fa].v,U[G][fa].t))}}function k(G,P){G=G.slice(0);var fa=[],la=new wd(G[P].v,G[P].t);fa.push(new wd(la.v,la.t));Y.push(la.v);for(G.splice(P,1);0<G.length;){var v=!1;for(P=0;P<G.length;P++)if(la.t===G[P].v){la.v=G[P].v;
la.t=G[P].t;fa.push(new wd(la.v,la.t));Y.push(la.v);v=!0;G.splice(P,1);break}else if(la.t===G[P].t){la.t=G[P].v;la.v=G[P].t;fa.push(new wd(la.v,la.t));Y.push(la.v);v=!0;G.splice(P,1);break}if(!v)return!1}for(S=0;S<fa.length;S++);return!0}var l=!1,m=[],t=[];l=[];var U=[[]],p=0,B=[];m=[];var K=[!1],W=[!1],N=0,S=0,Y=[];p=[];N=[];p=V.slice(1,V.length);p.sort(function(G,P){return G.length-P.length});V=[[0]];V=V.concat(p);for(p=1;p<V.length;p++){U[p]=[];for(N=0;N<V[p].length-1;N++)U[p].push(new wd(V[p][N],
V[p][N+1]));U[p].push(new wd(V[p][V[p].length-1],V[p][0]))}for(p=1;p<V.length-1;p++)for(N=p+1;N<V.length;N++)m=Xh(V[p],V[N]),m.length===V[p].length&&m.length===V[N].length?(V.splice(N,1),N--):(B=[],t=[],l=[],d(p,N),l=t.slice(0),B=[],t=[],d(N,p),m=[],m=l.concat(t),0<m.length&&(Y=[],l=!1,l=k(m,0),!0===l&&Y.length<V[N].length&&(V[N]=Y)));for(p=1;p<V.length;p++)Ea(p);V.sort(function(G,P){return G[0]-P[0]});for(p=1;p<V.length;p++){U[p]=[];for(N=0;N<V[p].length-1;N++)U[p].push(new wd(V[p][N],V[p][N+1]));
U[p].push(new wd(V[p][V[p].length-1],V[p][0]));for(N=0;N<U[p].length;N++);}for(S=1;S<V.length;S++)for(N=[],p=0;p<V[S].length;p++)N.push(Qa[V[S][p]]);Af=[];id=[];zb=[];for(p=1;p<V.length-1;p++)for(N=p+1;N<V.length;N++)if(m=[],m=Xh(V[p],V[N]),B=[],d(N,p),1===m.length)id.push({Z:p,$:N,ya:m[0]}),W[p]=!0,W[N]=!0;else if(0<B.length)for(S=0;S<B.length;S++)zb.push({Z:p,$:N,sa:B[S].v,ta:B[S].t}),K[p]=!0,K[N]=!0;for(p=1;p<V.length;p++)void 0!==K[p]&&!1!==K[p]||void 0!==W[p]&&!1!==W[p]||Af.push(p);for(p=1;p<
Qa.length;p++)oc[String(p)]=void 0,Xa(p)}function Gb(d){var k;ne=-1;ge=[];$c=[];Sa=[];ni=-1;for(k=0;k<d.length;k++)if(0===d[k].m&&0===d[k].K)ne=k;else if(0<d[k].m&&0<d[k].K&&void 0!==oc[String(d[k].m)]&&void 0!==oc[String(d[k].K)])ge.push(k);else if(0<d[k].K&&void 0!==oc[String(d[k].K)])$c.push(k);else if(0<d[k].m&&0===d[k].K&&(Sa.push(k),0===d[k].X))for(Ib=1;Ib<V.length;Ib++)V[Ib].includes(d[k].m)&&(ni=Ib)}function vb(d,k){d[k].i.reverse();d[k].ka.reverse();var l=d[k].K;d[k].K=d[k].m;d[k].m=l;for(l=
d[k].i.length-1;0<l;l--)Yb[d[k].i[l]]=Yb[d[k].i[l-1]],Xc[d[k].i[l]]=d[k].i[l-1];Xc[d[k].i[0]]=0;Yb[d[k].i[0]]="";Yb[d[k].i[0]]=Yb[d[k].m];Xc[d[k].i[0]]=d[k].m;Xc[d[k].m+1]===d[k].m&&(Yb[d[k].m]=Yb[d[k].m+1],Xc[d[k].m]=d[k].m+1)}function jd(d,k){J[d].i=J[d].i.concat(J[k].i);J[d].K=J[k].K}function ud(d,k,l){var m=new jf(d[k].X,d[k].i[l-1],k,d[k].K);1>l||2>d[k].i.length||(m.i=d[k].i.slice(l),m.ka=d[k].ka.slice(l),d[k].i=d[k].i.slice(0,l),d[k].ka=d[k].ka.slice(0,l),d[k].K=m.i[0],vb(J,k),d.push(m))}function $d(d,
k){var l=[],m,t;var U=new jf(0,0,-1,0);if(0!==J.length){for(t=0;t<J.length;t++)t===ne&&(l.push(J[t].i[0]),l.push(J[t].i[J[t].i.length-1])),0<Sa.length&&Sa.includes(t)&&!xa(0<J[t].m)&&l.push(J[t].i[J[t].i.length-1]),0<$c.length&&$c.includes(t)&&l.push(J[t].i[J[t].i.length-1]),0<ge.length&&ge.includes(t)&&(l.push(J[t].i[0]),l.push(J[t].i[J[t].i.length-1]));q(l);od=[];if(1<l.length){for(t=0;t<l.length-1;t++)for(m=t+1;m<l.length;m++){var p=!1;Ca(d,k,l[t],l[m]);for(ec=0;ec<Hb.length;ec++)if(0<xa(Hb[ec])){p=
!0;break}if(p)break;Hb.length>od.length?od=Hb.slice(0):Hb.length===od.length&&0<fe(d,Hb[0])&&0<fe(d,Hb[Hb.length-1])&&(0===fe(d,od[0])||0===fe(d,od[od.length-1]))&&(od=Hb.slice(0))}if(3<od.length){d=[];l=Ba(J,od[0]);k=J[l].i.indexOf(od[0]);for(t=1;t<od.length;t++)Ba(J,od[t])!==l&&(m=J[Ba(J,od[t-1])].i.indexOf(od[t-1]),d.push({o:l,s:k,e:m}),l=Ba(J,od[t]),k=J[l].i.indexOf(od[t]));d.push({o:l,s:k,e:J[Ba(J,od[od.length-1])].i.indexOf(od[od.length-1])});for(t=0;t<d.length;t++){if(d[t].s>d[t].e)for(m=d[t].s,
d[t].s=d[t].e,d[t].e=m,k=J[d[t].o].i.slice(d[t].s,d[t].e+1),k.reverse(),m=k.length-1;0<m;m--)Yb[k[m]]=Yb[k[m-1]],Xc[k[m]]=k[m-1];else k=J[d[t].o].i.slice(d[t].s,d[t].e+1);U.i=U.i.concat(k)}hb=[];hb[hb.length]=new jf(U.X,U.m,U.ia,U.K);hb[hb.length-1].i=U.i.slice(0);for(t=0;t<J.length;t++){U=-1;for(m=0;m<d.length;m++)if(d[m].o===t){U=m;break}-1<U?(0<d[U].s&&(hb[hb.length]=new jf(J[t].X+1,J[t].m,0,J[t].i[d[U].s]),hb[hb.length-1].i=J[t].i.slice(0,d[U].s),vb(hb,hb.length-1)),d[U].e<J[t].i.length-1&&(hb[hb.length]=
new jf(J[t].X+1,J[t].i[d[U].e],0,J[t].K),hb[hb.length-1].i=J[t].i.slice(d[U].e+1))):-1<Ba(J,J[t].m)?(hb[hb.length]=new jf(J[Ba(J,J[t].m)].X,J[t].m,Ba(J,J[t].m),J[t].K),hb[hb.length-1].i=J[t].i.slice(0),hb[0].i.includes(hb[hb.length-1].m)&&(hb[hb.length-1].ia=0,hb[hb.length-1].X=1)):(hb[hb.length]=new jf(J[t].X,J[t].m,J[t].ia,J[t].K),hb[hb.length-1].i=J[t].i.slice(0))}hb[0].i[0]>hb[0].i[hb[0].i.length-1]&&vb(hb,0);for(m=0;m<hb[0].i.length;m++)hb[0].ka.push(Qa[hb[0].i[m]]);Xc[hb[0].i[0]]=0<hb[0].m?
hb[0].m:0;for(m=1;m<hb[0].i.length;m++)Xc[hb[0].i[m]]=hb[0].i[m-1];for(t=1;t<hb.length;t++){0<hb[t].m&&0===xa(hb[t].m)?(hb[t].ia=Ba(hb,hb[t].m),hb[t].X=hb[hb[t].ia].X+1):(hb[t].ia=-2,hb[t].X=-1);for(m=0;m<hb[t].i.length;m++)hb[t].ka.push(Qa[hb[t].i[m]]);Xc[hb[t].i[0]]=0<hb[t].m?hb[t].m:0;for(m=1;m<hb[t].i.length;m++)Xc[hb[t].i[m]]=hb[t].i[m-1]}J=[];J=hb;for(t=1;t<J.length;t++)Ba(J,J[t].m)}else od=[]}else od=[]}}function fe(d,k){var l,m;for(l=0;l<d[k].a.length;l++)for(m=1;m<V.length;m++)if(V[m].includes(d[k].a[l].p))return m;
return 0}function zf(d,k,l,m){this.Qa=d;this.ja=k;this.Ja=l;this.ga=m}function wd(d,k){this.v=d;this.t=k}function jf(d,k,l,m){this.X=d;this.m=k;this.ia=l;this.K=m;this.i=[];this.ea="";this.ka=[]}var J=[],oi="",Cf=[],Ri=-1,Jc=[],sg=[],Ad=[],rg=[],Si=0,Lg=[],Yj=[],Ae=[],Ah=[],Uf=0,Ya=[],tg=[],ug=[],Mg=0,Bh=-1,Qd={},L=0,Ff=0,Ib=0,ec=0,qc,ii=0,Ti=0,pi=-1,od=[],ni=0,af="",hb=[],Zj=0,qi=0,il="",Wj=[],vg=[],jl=[],Id=[],ri=[],Ui=[[]],si=[],Ng=[],Tb=[],Zb=[],Ab=0,be=[],ak=[],qb={},kl=new xc(0,0),Xj=[{x:0,
y:0}],eb=[],Gf=1,bk=0,Hb=[],kd=[],Og=[],Vi=0,Pg=-1,he=[],Kc=0,Pc=0,Wi=!1,Xi=!1,Tc=[],ad=[],Me=0,Vf=0,Rd="",ll="",Qg="",hl=/^\[([A-Z]{0,1}[a-z]{0,2})(@{0,2})(H{0,1})([0-9]{0,2})([-|+]{0,1}\d{0,2})\]$/,Wl=/^\[(R{1,1}\d{0,1})\]$/;if(0!==ma.length){O.length=1;Oa.length=1;J=[];ge=[];Jg=[];ni=0;ne=-1;Qa=[];lc=[new me(0,0,0)];Af=[];Tb=[];Zb=[];qb={};zb=[];V=[[0]];sc=[];id=[];$c=[];Sa=[];for(qc in Kb)Kb.hasOwnProperty(qc)&&delete Kb[qc];for(qc in oc)oc.hasOwnProperty(qc)&&delete oc[qc];for(qc in na)na.hasOwnProperty(qc)&&
delete na[qc];for(qc in qb)qb.hasOwnProperty(qc)&&delete qb[qc];(function(d){var k,l=0,m=0,t=0,U=!1,p=!1,B=0,K="",W=1,N,S=!1,Y="";Ya[m]=new jf(0,0,-1,0);var G=N="";/^\[H[+-]{0,1}\]/.test(d)&&(p=!0);for(k=0;k<d.length;k++){var P=d.charAt(k);k<d.length-1&&(K=P+d.charAt(k+1));if((U||!wh.includes(K.charAt(0))||!Tf.includes(K.charAt(1)))&&k<d.length-1&&(kg.includes(K)||Tf.includes(K)||Vd.includes(K)))l++,Ya[m].i.push(l),N+=K,U||(Ya[m].ka[l]=N,Qa[l]=N,Yb[l]=G,Od[l]="",Ya[m].ea+=K,G=N=""),1<l?(1<Ya[m].i.length?
(Xc[l]=Ya[m].i[Ya[m].i.length-2],lc.push(new me(Ya[m].i[Ya[m].i.length-2],Ya[m].i[Ya[m].i.length-1],W))):(Xc[l]=Ya[m].m,lc.push(new me(Ya[m].m,Ya[m].i[Ya[m].i.length-1],W))),W=1):Xc[l]=0,k++,K="";else if("H"===P&&U&&!p||!kg.includes(P)&&!Tf.includes(P)&&"R"!==P)if(U||null===P.match(/%{1}/))if(U||null===P.match(/[0-9]{1}/))if("("===P)B++,t++,Ya[t]=new jf(B,Ya[m].i[Ya[m].i.length-1],m,0),m=t;else if(")"===P)B--,m=Ya[m].ia;else if("["===P)U=!0,N="[";else if("]"===P)N+="]",Ya[m].ka[l]=N,Qa[l]=N,Yb[l]=
G,Od[l]="",Ya[m].ea+=N,G=N="",U=!1;else if("="===P)Ya[m].ea+=P,G+=P,W=2;else if("#"===P)Ya[m].ea+=P,G+=P,W=3;else if("\\"===P||"/"===P)Ya[m].ea+=P,G+=P;else{if(!U||"H"!==P)if(!U||kg.includes(P)||Tf.includes(P))return Fc='invalidSymbol in SMILES:"'+P+'"',-1;N+=P}else Y=S?Y+P:P,S&&2!==Y.length||(void 0!==Kb[String(Y)]?(Kb[String(Y)].Ja=m,Kb[String(Y)].ga=l):(Kb[String(Y)]=new zf(m,l,0,0),Kb[String(Y)].Qa=m,Kb[String(Y)].ja=l),Ya[m].ea+=Y,""!==G&&(Od[l]=G,G=""),Y="",S=!1);else!1===U&&(S=!0,Y="");else l++,
Ya[m].i.push(l),N+=P,U||(Ya[m].ka[l]=N,Qa[l]=N,Yb[l]=G,Od[l]="",Ya[m].ea+=P,G=N=""),1<l?(1<Ya[m].i.length?(Xc[l]=Ya[m].i[Ya[m].i.length-2],lc.push(new me(Ya[m].i[Ya[m].i.length-2],Ya[m].i[Ya[m].i.length-1],W))):(Xc[l]=Ya[m].m,lc.push(new me(Ya[m].m,Ya[m].i[Ya[m].i.length-1],W))),W=1):Xc[l]=0}Zd=[];for(var fa in Kb)Kb.hasOwnProperty(fa)&&Zd.push(String(Kb[fa].ja)+":"+String(Kb[fa].ga))})(ma);for(qc in Kb)if(Kb.hasOwnProperty(qc)){lc.push(new me(Kb[qc].ja,Kb[qc].ga,1));tg=[];ug=[];for(Ff=Kb[qc].Qa;0<=
Ff;)tg.push(Ff),Ff=Ya[Ff].ia;for(Ff=Kb[qc].Ja;0<=Ff;)ug.push(Ff),Ff=Ya[Ff].ia;for(;0<tg.length&&0<ug.length;)if(tg[tg.length-1]===ug[ug.length-1])pi=tg.pop(),pi=ug.pop();else break;-1<pi&&(tg.push(pi),ug.push(pi));Xb(qc,tg,ug)}for(Ib=1;Ib<Qa.length;Ib++)hf[Ib]=[];for(L=1;L<lc.length;L++)hf[lc[L].g].push(lc[L].h),hf[lc[L].h].push(lc[L].g);for(L=1;L<Qa.length;L++)if(Ti=ca(O,Oa,Xc[L],Qa[L]),0>Ti)return;Le=[];xf=[];Wk(O);for(L=1;L<O.length;L++)if("="===Yb[L]){Xi=Wi=!1;Tc=[];ad=[];Rd="";Vf=Me=0;Kc=Xc[L];
Pc=0<yf(Kc)?yf(Kc):L;for(qc in Kb)Kb.hasOwnProperty(qc)&&(Kb[qc].ja===Kc?Me=Kb[qc].ga:Kb[qc].ga===Kc&&(Me=Kb[qc].ja),Kb[qc].ja===Pc?Vf=Kb[qc].ga:Kb[qc].ga===Pc&&(Vf=Kb[qc].ja));/[\\|/]/.test(Yb[Kc])&&(Wi=!0);for(Ib=0;Ib<O[Kc].a.length;Ib++)2!==O[Kc].a[Ib].t&&(Tc.push(O[Kc].a[Ib].p),/[\\|/]/.test(Yb[O[Kc].a[Ib].p])||/[\\|/]/.test(Od[O[Kc].a[Ib].p]))&&(Wi=!0);0===Me&&2===Tc.length?Tc.sort(function(d,k){return d-k}):0<Me&&2===Tc.length&&(/[\\|/]/.test(Yb[Kc])?Me===Tc[0]&&(Tc[0]=Kc[1],Tc[1]=Me):/[\\|/]/.test(Od[Me])&&
Me!==Tc[0]?(Tc[1]=Tc[0],Tc[0]=Me):/[\\|/]/.test(Yb[Me])&&Me!==Tc[1]&&(Tc[0]=Tc[1],Tc[1]=Me));/[\\|/]/.test(Od[Pc])&&(Xi=!0);for(Ib=0;Ib<O[Pc].a.length;Ib++)2!==O[Pc].a[Ib].t&&(ad.push(O[Pc].a[Ib].p),/[\\|/]/.test(Yb[O[Pc].a[Ib].p])&&(Xi=!0));0===Vf&&2===ad.length?ad.sort(function(d,k){return d-k}):0<Vf&&2===ad.length&&(/[\\|/]/.test(Od[Pc])?ad[0]===Vf&&(ad[0]=ad[1],ad[1]=Vf):Vf!==ad[0]&&(ad[1]=ad[0],ad[0]=Vf));!1!==Wi&&!1!==Xi&&(Rd=/[\\|/]/.test(Yb[Kc])?Rd+("\\"===Yb[Kc]?"1":"2"):2===Tc.length&&/[\\|/]/.test(Od[Tc[0]])?
Rd+("\\"===Od[Tc[0]]?"1":"2"):"0",Rd=2===Tc.length&&/[\\|/]/.test(Yb[Tc[1]])?Rd+("\\"===Yb[Tc[1]]?"1":"2"):Rd+"0",Rd=/[\\|/]/.test(Od[Pc])?2===ad.length?Rd+("\\"===Od[Pc]?"2":"1"):Rd+("\\"===Od[Pc]?"1":"2"):/[\\|/]/.test(Yb[ad[0]])?Rd+("\\"===Yb[ad[0]]?"1":"2"):Rd+"0",Rd=/[\\|/]/.test(Od[Pc])?Rd+"0":2===ad.length&&/[\\|/]/.test(Yb[ad[1]])?Rd+("\\"===Yb[ad[1]]?"1":"2"):Rd+"0",ll=og(Rd),void 0===na[String(Kc)+"-"+String(Pc)]&&(na[String(Kc)+"-"+String(Pc)]={v:Kc,t:Pc,L:Tc[0],M:0,O:ad[0],N:0,W:Rd,P:ll},
2===Tc.length&&(na[String(Kc)+"-"+String(Pc)].M=Tc[1]),2===ad.length&&(na[String(Kc)+"-"+String(Pc)].N=ad[1])),void 0===na[String(Pc)+"-"+String(Kc)]&&(Qg=na[String(Kc)+"-"+String(Pc)].P,na[String(Pc)+"-"+String(Kc)]={v:Pc,t:Kc,L:0,M:0,O:0,N:0,W:"",P:""},2===ad.length?(na[String(Pc)+"-"+String(Kc)].L=ad[1],na[String(Pc)+"-"+String(Kc)].M=ad[0],Qg="t"===Qg?"c":"t"):na[String(Pc)+"-"+String(Kc)].L=ad[0],2===Tc.length?(na[String(Pc)+"-"+String(Kc)].O=Tc[1],na[String(Pc)+"-"+String(Kc)].N=Tc[0],Qg="t"===
Qg?"c":"t"):na[String(Pc)+"-"+String(Kc)].O=Tc[0],na[String(Pc)+"-"+String(Kc)].P=Qg,na[String(Pc)+"-"+String(Kc)].W="t"===Qg?"1010":"1020"))}af="";for(L=1;L<V.length;L++)af=af+"-"+V[L].length;af=af.slice(1);for(ec=0;af!==il&&20>ec;){il=af;ae();af="";for(L=1;L<V.length;L++)af=af+"-"+V[L].length;af=af.slice(1);ec++}ak[0]=0;for(L=1;L<lc.length;L++)ak.push(Gc(lc[L].g,lc[L].h));Jg=[];for(L=1;L<V.length;L++)if(!0===Oc(L))for(Jg[L]=!0,ec=0;ec<V[L].length;ec++)1===ec%2&&(Yb[V[L][ec]]="=");else Jg[L]=!1;
if(0<zb.length)for(L=0;L<zb.length;L++)void 0===Qd[String(zb[L].Z)]&&(Qd[String(zb[L].Z)]=[]),Qd[String(zb[L].Z)].push(zb[L].$),void 0===Qd[String(zb[L].$)]&&(Qd[String(zb[L].$)]=[]),Qd[String(zb[L].$)].push(zb[L].Z);if(0<id.length)for(L=0;L<id.length;L++)void 0===Qd[String(id[L].Z)]&&(Qd[String(id[L].Z)]=[]),Qd[String(id[L].Z)].push(id[L].$),void 0===Qd[String(id[L].$)]&&(Qd[String(id[L].$)]=[]),Qd[String(id[L].$)].push(id[L].Z);Gf=0;for(qc in Qd)if(Qd.hasOwnProperty(qc)){eb[Gf]=[];eb[Gf]=fi(eb[Gf],
Qd[qc]);for(L=0;L<Qd[qc].length;L++)eb[Gf]=fi(eb[Gf],Qd[String(Qd[qc][L])]);eb[Gf]=q(eb[Gf]);eb[Gf].sort(function(d,k){return parseInt(d,10)-parseInt(k,10)});Gf++}if(1<eb.length){for(L=0;L<eb.length-1;L++)for(Ib=L+1;Ib<eb.length;Ib++)!0===Pj(eb[L],eb[Ib])&&eb.splice(Ib--,1);for(L=0;L<eb.length-1;L++)for(Ib=L+1;Ib<eb.length;Ib++)for(ec=0;ec<eb[L].length;ec++)if(eb[Ib].includes(eb[L][ec])){eb[L]=fi(eb[L],eb[Ib]);eb.splice(Ib--,1);break}}eb.sort(function(d,k){var l,m=0,t=0;if(k.length===d.length){for(l=
0;l<d.length;l++)m+=V[d[l]].length,t+=V[k[l]].length;return t-m}return k.length-d.length});(function(d,k){var l=0,m=0,t=0,U=0,p=m=l=U=t=0;p=[];var B=!1;for(t=0;t<Ya.length;t++)for(l=m=U=0;U<Ya[t].i.length;)0<xa(Ya[t].i[U])?(0<U&&0<l&&(J[J.length-1].K=Ya[t].i[U],l=0),m=Ya[t].i[U]):(0===U?J[J.length]=new jf(Ya[t].X,Ya[t].m,Ya[t].ia,0):0<m&&(J[J.length]=new jf(0,m,-2,0),m=0),J[J.length-1].i.push(Ya[t].i[U]),J[J.length-1].ka.push(Qa[Ya[t].i[U]]),l=Ya[t].i[U]),U++;eb.sort(function(K,W){return W.length-
K.length});J.sort(function(K,W){return K.X-W.X});for(t=0;t<J.length;t++)0===J[t].m&&0<J[t].K&&(vb(J,t),p.push(t));if(0<J.length){for(t=0;t<J.length;t++){if(0===J[t].X&&0===J[t].K&&0!==J[t].m)for(U=0;U<J.length;U++)if(t!==U&&0<J[U].m&&0<J[U].K&&void 0!==oc[String(J[U].K)]&&(l=J[t].i[J[t].i.length-1],m=J[U].i[0],hf[l].includes(m))){jd(t,U);J.splice(U,1);B=!0;break}if(!0===B)break}Gb(J);$d(d,k);for(t=0;t<J.length;t++)0===J[t].m&&0<J[t].K&&(vb(J,t),p.push(t));if(1<d[J[0].i[0]].a.length)for(t=0;t<d[J[0].i[0]].a.length;t++)if(xa(d[J[0].i[0]].a[t].p)){J[0].m=
d[J[0].i[0]].a[t].p;break}for(t=0;t<J.length;t++)if(p=J[t].i[J[t].i.length-1],1<d[p].a.length)for(U=0;U<d[p].a.length;U++)if(0===J[t].K&&xa(d[p].a[U].p)){J[t].K=d[p].a[U].p;break}Gb(J)}})(O,Oa);be=[];for(L=1;L<lc.length;L++)void 0!==oc[String(lc[L].g)]&&void 0!==oc[String(lc[L].h)]&&0===ak[L]&&be.push({bb:L,wa:lc[L].g,xa:lc[L].h});for(qc in Kb)Kb.hasOwnProperty(qc)&&xe(O,Oa,Kb[qc].ja,Kb[qc].ga,1);(function(d){var k,l,m=0;Wj=[];for(l=0;l<zb.length-1;l++){var t=zb[l].Z;var U=zb[l].$;for(k=l+1;k<zb.length;k++)if(t===
zb[k].Z&&U===zb[k].$||t===zb[k].$&&U===zb[k].Z){var p=String(Math.min(t,U))+"-"+String(Math.max(t,U));void 0!==qb[p]?qb[p]=fi(qb[p],[zb[k].sa,zb[k].ta,zb[l].sa,zb[l].ta]):(qb[p]=[zb[k].sa,zb[k].ta,zb[l].sa,zb[l].ta],qb[p]=q(qb[p]))}}for(var B in qb)if(qb.hasOwnProperty(B)){k=[];for(l=0;l<qb[B].length;l++)if(2<lb(d,qb[B][l])){m=qb[B][l];k.push(m);break}for(p=0;k.length<qb[B].length;){for(l=0;l<d[m].a.length;l++)qb[B].includes(d[m].a[l].p)&&!k.includes(d[m].a[l].p)&&(m=d[m].a[l].p,k.push(m));p++;if(20<
p)break}qb[B]=k.slice(0);l=B.split("-");t=V[parseInt(l[0],10)].length>=V[parseInt(l[1],10)].length?parseInt(l[0],10):parseInt(l[1],10);Ga(qb[B],V[t])||qb[B].reverse()}q(Wj)})(O);ye=Xc.slice(0);(function(d,k){var l;var m=-1;var t="",U=0;var p=J.length+V.length-1;if(1<V.length){var B=1;for(l=2;l<V.length;l++)V[l].length>V[B].length&&(B=l);ii=8<V[B].length?B:-1}0<eb.length&&(m=0);switch(!0){case -1<ne||$c.includes(0):Ka(d,k,0,0);t=0===ne?"mchain":"achain";Ab=Zb.length+Tb.length;break;case 0<J.length&&
0<ge.length:Ka(d,k,ge[0],0);Ng.push(ge[0]);m=xa(J[ge[0]].m);xa(J[ge[0]].K);var K=J[ge[0]].m;var W=J[ge[0]].i[0];B=x(m);-1!==B?ab(d,k,B,W,K,m):Ta(d,k,m,K,W,"chend",1,V[m].indexOf(K),0,0,"",ka);t="cchain";Ab=Zb.length+Tb.length;break;case 0<eb.length:ab(d,k,m,0,0,0);t="ringSys";Ab=Zb.length+Tb.length;break;case 1<V.length&&0<ii&&8<V[ii].length:Ta(d,k,ii,0,0,"first",1,0,ta.b+ta.c/2,ta.t+ta.f/2,"",ka);t="ring";Ab=Zb.length+Tb.length;break;case 0<J.length&&0>ne&&0===J[0].X:Ka(d,k,0,0);t="achain";Ab=Zb.length+
Tb.length;break;case 0<J.length&&0>ne||0<$c.length:Ka(d,k,$c[0],0);t="achain";Ab=Zb.length+Tb.length;break;case 0<J.length&&0===J[0].X&&0<ni:Ta(d,k,ni,0,0,"first",1,0,ta.b+ta.c/2,ta.t+ta.f/2,"",ka);t="ring";Ab=Zb.length+Tb.length;break;case 0<Af.length:Ta(d,k,Af[0],0,0,"first",1,0,ta.b+ta.c/2,ta.t+ta.f/2,"",ka);t="ring";Ab=Zb.length+Tb.length;break;case 0<J.length:Ka(d,k,0,0),t="achain",Ab=Zb.length+Tb.length}for(;Ab<p&&20>U;)if(U++,m=!1,"cchain"===t){if(K=J[Ng[Ng.length-1]].K,W=J[Ng[Ng.length-1]].i.slice(-1)[0],
m=xa(J[Ng[Ng.length-1]].K),B=x(m),-1!==B?(ab(d,k,B,W,K,m),t="ringSys"):(B=V[m].indexOf(K),Ta(d,k,m,K,W,"chend",1,B,0,0,"",ka),t="ring"),Ab=Zb.length+Tb.length,Ab===p)return}else{if("achain"===t){var N=Tb[Tb.length-1];K=J[N].K;W=J[N].i.slice(-1)[0];switch(!0){case 0<K&&void 0!==W&&0<xa(K)&&!Zb.includes(xa(K)):l=xa(K);B=x(l);0<=B?(ab(d,k,B,W,K,l),Ab=Zb.length+Tb.length,t="ringSys"):(B=V[l].indexOf(K),Ta(d,k,l,K,W,"chend",1,B,0,0,"",ka),Ab=Zb.length+Tb.length,t="ring");if(Ab===p)return;break;case 0<
K&&!w(d,K):B=Ba(J,K);if(-1<B&&(K===J[B].i[0]?Ka(d,k,B,W):K===J[B].i.slice(-1)[0]?(vb(J,B),Ka(d,k,B,J[B].m)):(ud(J,B,J[B].i.indexOf(K)),w(d,J[J.length-1].m)||(J[J.length-1].m=J[N].i.slice(-1)[0]),p++,Ka(d,k,J.length-1,J[J.length-1].m)),Ab=Zb.length+Tb.length,t="achain",Ab===p))return;break;case 0<J[N].m&&!w(d,J[N].m):B=Ba(J,J[N].m);if(-1<B){if(J[N].m===J[B].i[0]?Ka(d,k,B,J[N].i[0]):J[N].m===J[B].i.slice(-1)[0]?(vb(J,B),Ka(d,k,B,J[N].i[0])):(ud(J,B,J[B].i.indexOf(J[N].m)),w(d,J[J.length-1].m)||(J[J.length-
1].m=J[N].i[0]),p++,Ka(d,k,J.length-1,J[J.length-1].m)),Ab=Zb.length+Tb.length,t="achain",Ab===p)return}else if(l=xa(J[N].m),0<l&&(B=x(l),0<=B?(ab(d,k,B,J[N].i[0],J[N].m,l),Ab=Zb.length+Tb.length,t="ringSys"):(B=V[l].indexOf(J[N].m),Ta(d,k,l,J[N].m,J[N].i[0],"chend",1,B,0,0,"",ka),Ab=Zb.length+Tb.length,t="ring"),Ab===p))return;break;case (0===J[N].K||w(d,J[N].K))&&(0===J[N].m||w(d,J[N].m)):l=!1;if(0<Tb.length)for(N=0;N<J.length;N++)if(!Tb.includes(N)){if(0<J[N].m&&w(d,J[N].m)&&(Ka(d,k,N,J[N].m),
Ab=Zb.length+Tb.length,t="achain",l=!0,Ab===p)||!l&&0<J[N].K&&w(d,J[N].K)&&(vb(J,N),Ka(d,k,N,J[N].m),Ab=Zb.length+Tb.length,t="achain",l=!0,Ab===p))return;if(!l)for(W=J[N].i[0],K=0;K<d[W].a.length;K++)if(w(d,d[W].a[K].p)&&(Ka(d,k,N,d[W].a[K].p),Ab=Zb.length+Tb.length,t="achain",l=!0,Ab===p))return;if(!l)for(W=J[N].i.slice(-1)[0],K=0;K<d[W].a.length;K++)if(w(d,d[W].a[K].p)&&(Ka(d,k,N,d[W].a[K].p),Ab=Zb.length+Tb.length,t="achain",l=!0,Ab===p))return;if(!l)for(B=1;B<J[N].i.length-1&&!l;){W=J[N].i[B];
for(K=0;K<d[W].a.length;K++)if(w(d,d[W].a[K].p)&&(Ka(d,k,N,d[W].a[K].p),Ab=Zb.length+Tb.length,t="achain",l=!0,Ab===p))return;B++}}if(!l&&0<Zb.length)for(N=1;N<V.length;N++)if(!Zb.includes(N))for(B=0;B<V[N].length;B++)for(W=V[N][B],K=0;K<d[W].a.length;K++)if(w(d,d[W].a[K].p)&&(-1<x(N)?(ab(d,k,x(N),d[W].a[K].p,W,N),t="ringSys"):(Ta(d,k,N,W,d[W].a[K].p,"chend",1,B,0,0,"",ka),t="ring"),Ab=Zb.length+Tb.length,Ab===p))return;break;default:for(K=J[Tb.slice(-1)[0]].i.slice(-1)[0],B=0;B<d[K].a.length;B++)if(!1===
w(d,d[K].a[B].p))if(W=Ba(J,d[K].a[B].p),-1<W&&J[W].i[0]===d[K].a[B].p){Ka(d,k,W,K);Ab=Zb.length+Tb.length;t="achain";if(Ab===p)return;m=!0;break}else if(-1<W&&J[W].i.slice(-1)[0]===d[K].a[B].p){vb(J,W);Ka(d,k,W,K);Ab=Zb.length+Tb.length;t="achain";if(Ab===p)return;m=!0;break}}}else if("ring"===t||"ringSys"===t){if(0<be.length){for(N=W=l=K=0;N<be.length;N++)if(w(d,be[N].wa)&&!w(d,be[N].xa)?(K=be[N].xa,l=xa(K),W=be[N].wa):w(d,be[N].xa)&&!w(d,be[N].wa)&&(K=be[N].wa,l=xa(K),W=W=be[N].xa),0<K){B=x(l);
0<=B?(ab(d,k,B,W,K,l),Ab=Zb.length+Tb.length,t="ringSys"):(B=V[l].indexOf(K),Ta(d,k,l,K,W,"chend",1,B,0,0,"",ka),Ab=Zb.length+Tb.length,t="ring");if(Ab===p)return;m=!0;break}if(m)continue}l=!1;for(N=0;N<J.length;N++)if(!Tb.includes(N)&&("ring"===t||"ringSys"===t)){0<xa(J[N].m)&&Zb.includes(xa(J[N].m))?(Ka(d,k,N,J[N].m),t="achain",Ab=Zb.length+Tb.length,l=!0):0<xa(J[N].K)&&Zb.includes(xa(J[N].K))&&(vb(J,N),Ka(d,k,N,J[N].m),t="achain",Ab=Zb.length+Tb.length,l=!0);if(Ab===p)return;if(l)break}if(m)continue}for(l=
0;l<J.length;l++)if(!Tb.includes(l)&&0<J[l].m&&w(d,J[l].m)){Ka(d,k,l,0);t="achain";Ab=Zb.length+Tb.length;if(Ab===p)return;break}for(l=1;l<V.length;l++)if(!Zb.includes(l)){for(N=0;N<V[l].length;N++){for(B=0;B<d[V[l][N]].a.length;B++)if(0===xa(d[V[l][N]].a[B].p)&&!0===w(d,d[V[l][N]].a[B].p)){K=V[l][N];W=d[V[l][N]].a[B].p;-1<x(l)?(ab(d,k,x(l),W,K,l),t="ringSys"):(Ta(d,k,l,K,W,"chend",1,N,0,0,"",ka),t="ring");Ab=Zb.length+Tb.length;if(Ab===p)return;m=!0;break}if(m)break}if(m)break}if(!m)for(l=0;l<J.length;l++)if(!Tb.includes(l)){for(N=
1;N<V.length;N++)if(Zb.includes(N)){for(B=0;B<V[N].length;B++)if(-1<Na(k,V[N][B],J[l].i[0])){B=V[N][B];Ka(d,k,l,B);t="achain";Ab=Zb.length+Tb.length;if(Ab===p)return;m=!0;break}if(m)break}if(m)break}}Ab!==p&&(qg="Not all components plotted")})(O,Oa);Ui[0]=[[0,120,240],[0,120,240],[0,120,240],[0,120,180,240],[30,120,180,240,330]];Ui[1]=[[120,240],[120,240],[120,180,240],[60,150,210,270]];Ti=O.length-1;for(L=1;L<=Ti;L++)if(Si=Lj(O,L,!1),0<O[L].G){O[L].G<=Si&&(O[L].G=Math.max(O[L].G-Si,0));si=[];for(ec=
0;ec<O[L].a.length;ec++)si.push($a(O,L,O[L].a[ec].p));if(O[L].G>Si&&1<O[L].G)for(ec=0;ec<O[L].G;ec++)Bh=Sf(O,Oa,L),ha(O,Oa,L,Bh,1),--O[L].G;else for(ec=0;ec<O[L].G;ec++)0===si.length&&6>O[L].G?Bh=Ui[0][O[L].G-1][ec]:1===si.length&&5>O[L].G?Bh=ia(si[0]+Ui[1][O[L].G-1][ec]):(Pa=[],ff(O,L,!0),Bh=Qf(O,L,Pa[Pa.length-1].ba,Pa[Pa.length-1].Y,!0)),ha(O,Oa,L,Bh,1),--O[L].G}Id=[];for(L=1;L<O.length;L++)if(O[L].U)for(Id.push(L),qa=0;qa<O[L].a.length;qa++)2===O[L].a[qa].t&&Pf(O,Oa,L,O[L].a[qa].p,"-");if(1<Id.length)for(jl=
[],vg=Id.slice(0),Pg=vg[0],oi="+",bk=1;0<vg.length&&bk<=Id.length;)Yj=[],vg.splice(vg.indexOf(Pg),1),Yj=ub(O,Pg,vg,1),qi=Yj[0],void 0!==qi&&-1<qi?("+"===oi?(Pf(O,Oa,Pg,qi,"+"),oi="-"):oi="+",jl.push(Pg),Pg=qi):0<vg.length&&(Pg=vg[0],oi="+"),bk++;(function(d,k,l){ri=[];for(d=1;d<Oa.length;d++)l.includes(Oa[d].g)&&l.includes(Oa[d].h)&&2===Oa[d].B&&ri.push(d)})(O,Oa,Id);sg=[];Jc=[];for(L=0;L<Id.length;L++)1===La(O,Oa,Id[L])?sg.push(Id[L]):Jc.push(Id[L]);if(0<Jc.length)for(L=0;L<Jc.length-1;L++){for(ec=
L+1;ec<Jc.length;ec++)if(Ri=gb(O,Oa,Jc[L],Jc[ec]),1===Ri&&0===Nc(O,Oa,Cf)){Jc.splice(Jc.indexOf(Jc[L]),1);Jc.splice(Jc.indexOf(Jc[ec]),1);sg.push(Jc[L]);sg.push(Jc[ec]);break}if(0===Jc.length)break}sg=[];Jc=[];for(L=0;L<Id.length;L++)1===La(O,Oa,Id[L])?sg.push(Id[L]):Jc.push(Id[L]);if(0<Jc.length){for(L=1;L<O.length;L++)if(O[L].U)for(qa=0;qa<O[L].a.length;qa++)2===O[L].a[qa].t&&O[O[L].a[qa].p].U&&Pf(O,Oa,L,O[L].a[qa].p,"-");for(L=0;L<ri.length;L++)Pf(O,Oa,Oa[ri[L]].g,Oa[ri[L]].h,"+");for(L=0;L<Jc.length-
1;L++){for(ec=L+1;ec<Jc.length;ec++)if(Ri=nb(O,Oa,Jc[L],Jc[ec]),1===Ri&&0===Nc(O,Oa,Cf)){Jc.splice(Jc.indexOf(Jc[L]),1);Jc.splice(Jc.indexOf(Jc[ec]),1);sg.push(Jc[L]);sg.push(Jc[ec]);break}if(0===Jc.length)break}}r(O,Oa);if(1<V.length)for(L=1;L<V.length;L++)kl=db(O,L),Xj[L]=kl;for(L=1;L<O.length;L++)if(void 0===Qa[L]||0===We[O[L].u]||1===O[L].u)"[H]"===Qa[L]&&2===O.length&&(O[L].r=!0);else{Vi=0;Og=[];Og=Qa[L].match(hl);if(null!==Og)"H"===Og[3]&&(Vi=""!==Og[4]?parseInt(Og[4],10):1);else if("[H]"===
Qa[L])Vi=1;else continue;for(Ib=Uf=Zj=Mg=0;Ib<O[L].a.length;Ib++)Uf=4===O[L].a[Ib].t||5===O[L].a[Ib].t?Uf+1:Uf+O[L].a[Ib].t,1===O[O[L].a[Ib].p].u&&Zj++;Uf+=Vi-Zj;Mg=We[O[L].u]+O[L].o-Uf;1===Math.abs(Mg)%2&&10<O[L].u?(O[L].r=!0,(17===O[L].u||35===O[L].u||53===O[L].u)&&1<Uf&&0===O[L].o&&(O[L].r=!1)):1===Math.abs(Mg)%2&&0<Mg?O[L].r=!0:2===Mg&&0===O[L].o?(6===O[L].u&&(O[L].j="C:"),7===O[L].u&&(O[L].j="N:")):2===Mg&&1===Uf-O[L].o&&7===O[L].u&&(O[L].j="N:");Tf.includes(Og[1])&&0!==We[O[L].u]&&We[O[L].u]===
Uf&&(O[L].r=!0)}0<sc.length&&(z(O,Oa),r(O,Oa));for(L=1;L<O.length;L++)uf(O,L)}}function ba(ma){this.ra=ma.slice(0);this.Na=[];this.Da=[];this.Ea=this.ha=this.path=0}function jb(ma,ca){this.Xa=ma;this.Fa=ca}var Za=new Wc(0,0,0,0),Aa=0,tb=0,qa=0,Cc=0,yb=Za=0,wb=!1,jc=2*Ra,gd=0,Yc=[],Te=0,qh=0,oc={},ge=[],Jg=[],yh=[],zh=[];yb=[];yb=[];var ne=-1,Xe=0,Pi=[],Ye={};Cc=0;var Fc="";Aa=-1;var ya="",pg=[],Hc=[],Qa=[],lc=[new me(0,0,0)],hf=[[0]],Xc=[],Af=[],qg="";Cc=-1;var Nd="",pc=[],Yb=[],Od=[],zb=[],V=[[0]],
Bf=[];Za=-1;tb="";var sc=[],id=[],Kb={},na={},nc=0,Md=[],$c=[],Sa=[];yb=[];if(""!==a)if(Bc(),yb=a.match(/!(.+)!/),null!==yb?(Nd=yb[1],Cc=yb.index):a.includes("!")&&(Fc="unmatched ! (lone pairs section)"),yb=[],yb=a.match(/\u00bf(.+)\u00bf/),null!==yb?(ya=yb[1],Aa=yb.index):a.includes("\u00bf")&&(Fc="unmatched \u00bf (curved arrows section)"),yb=[],yb=a.match(/\u00a7(.+)\u00a7/),null!==yb?(tb=yb[1],Za=yb.index):a.includes("\u00a7")&&(Fc="unmatched \u00a7 (reaction arrows section)"),""!==Fc)alert("Parse-SMILES Error:\n"+
Fc+"\nin SMILES: "+a);else{-1<Aa?a=a.substring(0,Aa):-1<Cc?a=a.substring(0,Cc):-1<Za&&(a=a.substring(0,Za));if(/^\./.test(a)||/\.$/.test(a)||/\.\./.test(a))Fc="illegal dot at start and/or end or multiple dots";if(""!==Fc)alert("Parse-SMILES Error:\n"+Fc+"\nin SMILES: "+a);else{yb=a.split(".");Yc=[];if(1<h.length){Xe=h.length-1;Td=Aj();for(Aa=1;Aa<=Td;Aa++)Za=Rc(h,Aa,"t"),Yc.push(Za),gd=Math.max(gd,Za.f);Cc=Td;0<ja.length?(nc=0,pc=[],c(ja),nc=ja.length):nc=0}else nc=Cc=0;""!==tb&&F(tb,Cc);Aa=0;for(Cc=
1+Cc;Aa<yb.length&&""!==yb[Aa];){1===cl(yb[Aa])?Fc="unbalanced ()":-1===cl(yb[Aa])&&(Fc="unbalanced []");if(""!==Fc){alert("Parse-SMILES Error:\n"+Fc+"\nin SMILES: "+yb[Aa]);pb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt";return}Da(yb[Aa]);""!=qg&&(Fc=""===Fc?qg:Fc+("\n"+qg));if(""!==Fc){alert("Parse-SMILES Error:\n"+Fc+"\nin SMILES: '"+yb[Aa]+"'");Uk();return}for(tb=1;tb<O.length;tb++)O[tb].s=Cc,O[tb].t=Cc;for(tb=1;tb<Oa.length;tb++)Oa[tb].s=
Cc;Za=0;wb=!1;if(1!==O[1].u)for(tb=1;tb<O.length;tb++)1===O[tb].u&&Za++;else for(wb=!0,tb=1;tb<O.length;)1!==O[tb].u&&(wb=!1),tb++;Pi.push(Za);Nl(O,Oa,h,X,Cc,0,0);yh.push(h.length-1);if(wb)zh.push(h.length-1);else{for(tb=h.length-1;0<tb&&1===h[tb].u;)tb--;zh.push(tb)}Za=Rc(h,Cc,"s");gd=Math.max(gd,Za.f);th(h,oa.b+oa.c/2-(Za.b+Za.c/2),oa.t+oa.f/2-(Za.t+Za.f/2),Cc);Za.b=0;Za.t=0;Yc.push(Za);Cc++;Aa++}Td=Cc-1;Aa=yb=0;for(tb=qa=1;Aa<Td;){for(;tb<=zh[Aa];)Ye[qa]=qa+yb,qa++,tb++;yb+=Pi[Aa];Aa<Td-1&&(tb=
yh[Aa]+1);Aa++}if(0<Bf.length)for(c(Bf),Aa=0;Aa<Bf.length;)Ii(Bf,ja,Aa,Aa+nc),Aa++;for(Aa=1;Aa<=Td;)0>za(Aa,pc)&&pc.push(new ba([Aa])),Aa++;if(0<ja.length)for(g(pc),e(3*Ra),n(),Aa=0;Aa<ja.length;Aa++){for(qa=0;qa<pc.length;qa++)Ni(pc[qa].ra,ja[Aa].I)&&(Te=qa),Ni(pc[qa].ra,ja[Aa].H)&&(qh=qa);Ld=[];qj(ja[Aa].I,ja[Aa].H,cb[Te],cb[qh]);ja[Aa].T.x=Ld[0];ja[Aa].T.y=Ld[1];ja[Aa].S.x=Ld[2];ja[Aa].S.y=Ld[3]}""!==Nd&&y(Nd,Xe);0===ja.length&&b();""!==ya&&E(ya,Xe);Ok();if(0<Sc.length){q(Sc);ob(Z,0,!0);for(Aa=
0;Aa<Sc.length;Aa++)Ei(A,h,Sc[Aa]);alert("WARNING:\nParsing of SMILES failed at one or more \nambiguous or inconsistent stereogenic centres!\n\nStereo up/down bonds at centers marked by red squares were replaced by normal single bonds.\n\nThe red squares disappear with the next drawing action");Sc=[]}else if(Mk(),td=td.trim(),a=a.trim(),td.includes(a))ob(Z,0,!0),pb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt",Bc(),sb();else if(0<Sc.length){q(Sc);
ob(Z,0,!0);for(Aa=0;Aa<Sc.length;Aa++)Ei(A,h,Sc[Aa]);alert("WARNING:\nParsing of SMILES produced one or more \nambiguous or inconsistent stereogenic centres!\n\nCheck the stereo-drawing of the centers marked by red squares.\n\nThe red squares disappear with the next drawing action");pb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt";Sc=[]}else ob(Z,0,!0),pb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className=
"alt",alert("Parsing failed!\nentered SMILES:\n"+a+"\n"+td+"\nSMILES of parsed structure"),Bc(),sb();yb=[];pb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt"}}}var Dh="yes"===Lb?!0:!1,ka=da?45:30,I=Math.floor(6+8/30*(ka-15)),yg=5+(ka-15)/5,Ra=ka/5,Gi=da?ua?ka/2:2*Ra:Ra+4,hc=da?2*Ra:Ra+4,nj=ka/10,jj=ka/10,Gg=ka/5,Ih=da?ua?ka/3:2*Gg:Gg+2,mj=.86603*ka,Eg=Math.round(150*ka/24)/100,Ej=6*Eg,Sd=30<ka?2:1.5,Bj=" c;h;o;n;s;p;f;C;b;i;x;.;+;-".split(";"),Hl=
" ;;e;r; ; ; ;v; ; ; ; ;Y;y".split(";"),Cj="1;2;t;u or <;d or >;3;4;5;6;a;7-9;w;m;l".split(";"),Th="C H O N S P F Cl Br I X \u2022 + \u2013".split(" "),Gl=/^Ac|Ag|Al|Am|Ar|As|At|Au|Ba|Be|Bh|Bi|Bk|Br|Ca|Cd|Ce|Cf|Cl|Cm|Co|Cr|Cs|Cu|Db|Ds|Dy|Er|Es|Eu|Fe|Fm|Fr|Ga|Gd|Ge|He|Hf|Hg|Ho|Hs|In|Ir|K|Kr|La|Li|Lr|Lu|Md|Mg|Mn|Mo|Mt|Na|Nb|Nd|Ne|Ni|No|Np|Os|Pa|Pb|Pd|Pm|Po|Pr|Pt|Pu|Ra|Rb|Re|Rf|Rg|Rh|Rn|Ru|Sb|Sc|Se|Sg|Si|Sm|Sn|Sr|Ta|Tb|Tc|Te|Th|Ti|Tl|Tm|Xe|Yb|Zn|Zr|B|C|F|H|I|N|O|P|S|U|V|W|Y$/g,Ll=/^R[1234]?$/g,Vd=["R",
"R1","R2","R3","R4"],wj=["C:","N:"],kg="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu".split(" "),We=[0,1,0,0,0,3,4,3,2,1,0,0,0,3,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,3,2,1,0,1,2,0,0,0,0,0,0,0,0,1,2,3,4,3,2,1,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,2,0,0,0,0,0,0,0,0,
0,0,0,0,0,0],Ml=["B","Al"],gl=[1,2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,
701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217],wh="B C N O P S F Cl Br I Si".split(" "),Vl="B C N O P S As Se".split(" "),Tf="b c n o p s as se".split(" "),Ul="C:4:0:0 C:3:1:0 Si:4:0:0 Si:3:1:0 Ge:4:0:0 Ge:3:1:0 Sn:4:0:0 Sn:3:1:0 N:4:0:1 P:4:0:1 B:4:0:-1 B:3:1:-1 P:4:0:0 As:4:0:1 N:3:0:az P:3:0:0 As:3:0:0 P:2:1:0 As:2:1:0 S:4:0:0 S:4:0:1 S:3:0:0 S:3:0:1 Se:4:0:0 Se:4:0:1 Se:3:0:0 Se:3:0:1".split(" "),
Ol="N:3:0:az P:3:0:0 P:2:1:0 As:3:0:0 As:2:1:0 S:3:0:0 S:3:0:1 Se:3:0:0 Se:3:0:1".split(" "),Ve=0,Be=1,Jd=1,fj=1,Gj=new Image,Hj=new Image,Ij=new Image,dc=new Wc(10,42,34,503),wc=new Wc(38,38,532,36),Mb=new Wc(10,549,136,36),bf=new Wc(10,0,10,10),ta=new Wc(48,0,10,10),oa=new Wc(0,0,10,10),Dc=new Wc(0,0,0,0),D=new Wc(0,0,0,0),De=new Wc(0,0,0,0),Dk=new Wc(0,0,0,0),Ek=new Wc(0,0,0,0),md={x:0,y:0,r:12},ce={x:0,y:0,r:12},Jl=new mc(0,"",0,0,0,0,0),h=[new mc(0,"",0,0,0,0,0)],O=[new mc(0,"",0,0,0,0,0)],wf=
[new mc(0,"",0,0,0,0,0)],Je=[new mc(0,"",0,0,0,0,0)],Ec=[new mc(0,"",0,0,0,0,0)],Kl=new me(0,0,0),X=[new me(0,0,0)],Oa=[new me(0,0,0)],bi=[new me(0,0,0)],Ie=[new me(0,0,0)],Fg=[],wa=[],hd=[new fl(0,0)],Ha=[],Pb=[],ja=[],Ke=[],vf="",fb=[],le=[],lg={},mg=[],Le=[],ye=[],Hd=[],cb=[],He=[],xf=[],bc={},je=[],dd=[],Yd=[],Zd=[],Fb=[],Pa=[],gg=[],tc=[],uc=[],Nb=[],Sc=[],ke=0,Bb=0,nh="",kj="",pb=0,Td=0,ci=0,ie=0,gh=0,xd=0,Wd=0,ag=0,bg=0,rf=0,$g=-1,Ce=0,Zf=0,Hh=-1,Cd=0,Dd=0,yi=0,Ph=-1,tj=0,uj=0,Ed=0,eh=0,Fd=
0,fh=0,Wa=0,Ua=0,Db=0,Eb=0,Kd=0,Kf=-1,Zg=-1,Jf=0,Sb=0,Rb=0,ib=0,sf=-1,fg=-1,zd=0,ic=0,rc=0,Nf=-1,$b=0,ac=0,Mh="",Nh=1,vi=0,wi=0,zg=0,Lh=0,dg=0,eg=0,rd=0,sd=0,hh=0,ih=0,mb="",rh=1,ng=1,Fh=!1,Xg=0,Wg=0,Ld=[],df="reactant",td="",Bg=1,pd,qd,ah=!1,Oh=!1,bh=!1,de=!1,Xf=!1,Wf=!1,Rh=!1,Qh=!1,fd=!0,sh=!1,pf=!1,yd=!1,Mf=!1,Yg=!1,Gh=!1,Dj=!1,dh=!1,Jh=!1,Kh=!1,ch=!1,Ag=!1,Ug=!1,ue=!1,ti=!1,Pe=!1,Vg=!1,ig=!1,kh=!1,qf=!1,cf=!1,Ee=!0,Fe=!1,ee=!1,tf=!1,Qe=!1,ve=!1,Ge=!1;var ul=document.getElementById("container");
var fc=document.getElementById("bgc");var re=document.getElementById("igc");var se=document.getElementById("pdc");var Cb=document.getElementById("can");var te=document.getElementById("sho");var Fj=fc.getContext("2d");var A=re.getContext("2d");var Wb=se.getContext("2d");var Z=Cb.getContext("2d");var Lc=te.getContext("2d");Z.setLineDash||(Dj=!0);Fj.save();A.save();Wb.save();Z.save();Lc.save();var Oe=document.getElementById("buttonregion");Oe.style.position="absolute";var bm=document.getElementById("shift");
var cm=document.getElementById("alt");var Lf=Z.getImageData(0,0,1,1);var oh=document.getElementById("xbox");var Al=document.getElementById("xok");var jg=document.getElementById("xtxa");var Dg=document.getElementById("abox");var ph=document.getElementById("atxa");var $h=document.getElementById("btxa");var Kk=document.getElementById("aok");var nf=document.getElementById("smilesbox");var Bl=document.getElementById("smilesok");var Gd=document.getElementById("smitxa");Ug=!1;var mf=document.getElementById("smixbox");
var Se=document.getElementById("smixtxa");var El=document.getElementById("smixcancel");var Dl=document.getElementById("smixadd");var Fl=document.getElementById("smixok");ik();Jj();Uc();da&&window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){setTimeout(bd,500);setTimeout(bd,100);setTimeout(function(){window.scrollTo(0,0)},500)},!1);(function(){var a,b;return tl(new sl(new ol(function(c){if(1==c.V)return a=[],a.push(new Promise(function(e){Gj.onload=function(){e()};
Gj.src="elebar.svg"})),a.push(new Promise(function(e){Hj.onload=function(){e()};Hj.src="toolbar.svg"})),Dh&&a.push(new Promise(function(e){Ij.onload=function(){e()};Ij.src="lewis_rxnarrows.svg"})),nl(c,Promise.all(a));bd();fc.style.visibility="visible";re.style.visibility="visible";se.style.visibility="visible";Cb.style.visibility="visible";te.style.visibility="hidden";da&&(bm.style.visibility="visible",cm.style.visibility="visible");b=document.getElementsByClassName("but");Qc(100).then(function(){for(Ve=
0;Ve<b.length;Ve++)b[Ve].style.visibility="visible"});c.V=0})))})();Va&&!ua&&setTimeout(bd,500);document.getElementById("buttonregion").addEventListener("mouseup",function(a){a||(a=window.event);a.preventDefault();a.stopPropagation();return!1},!1);document.getElementById("undo").addEventListener("click",function(){if("visible"===nf.style.visibility)return!1;Ac();ij();document.getElementById("undo").blur()},!1);document.getElementById("clear").addEventListener("click",function(){if("visible"===nf.style.visibility)return!1;
Z.clearRect(ta.b+1,ta.t+1,ta.c-2,ta.f-2);Ac();ui();document.getElementById("clear").blur()},!1);document.getElementById("smiles").addEventListener("click",function(){if("visible"===nf.style.visibility)return!1;Ac();jk();document.getElementById("smiles").blur()},!1);document.getElementById("sm2str").addEventListener("click",function(){if("visible"===mf.style.visibility)return!1;Cl();document.getElementById("sm2str").blur()},!1);document.getElementById("help").addEventListener("click",function(){var a=
window.screenX;cc=window.open("help/MOSFECCS_Help.html","Structural Formula Editor Help","dependent=yes,scrollbars=yes,resizable=yes");cc.resizeTo(900,900);cc.moveTo(a-cc.outerWidth-5,20);document.getElementById("help").blur()},!1);document.getElementById("shift").addEventListener("click",function(){10>pb?(pb+=10,document.getElementById("shift").className="shift selected"):(pb-=10,document.getElementById("shift").className="shift")},!1);document.getElementById("alt").addEventListener("click",function(){0===
pb%2?(pb+=1,document.getElementById("alt").className="alt selected"):(--pb,document.getElementById("alt").className="alt")},!1)};

function If(da){var va=0;return function(){return va<da.length?{done:!1,value:da[va++]}:{done:!0}}}function kg(da){var va="undefined"!=typeof Symbol&&Symbol.iterator&&da[Symbol.iterator];return va?va.call(da):{next:If(da)}}function Th(da){da=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,da];for(var va=0;va<da.length;++va){var Sa=da[va];if(Sa&&Sa.Math==Math)return Sa}return globalThis}
var Ej=Th(this),Fj="function"==typeof Object.defineProperties?Object.defineProperty:function(da,va,Sa){da!=Array.prototype&&da!=Object.prototype&&(da[va]=Sa.value)};function Gj(da,va){if(va){var Sa=Ej;da=da.split(".");for(var $b=0;$b<da.length-1;$b++){var Fc=da[$b];Fc in Sa||(Sa[Fc]={});Sa=Sa[Fc]}da=da[da.length-1];$b=Sa[da];va=va($b);va!=$b&&null!=va&&Fj(Sa,da,{configurable:!0,writable:!0,value:va})}}
Gj("Promise",function(da){function va(pb){this.aa=0;this.Ba=void 0;this.A=[];var xc=this.ka();try{pb(xc.resolve,xc.reject)}catch(od){xc.reject(od)}}function Sa(){this.A=null}function $b(pb){return pb instanceof va?pb:new va(function(xc){xc(pb)})}if(da)return da;Sa.prototype.aa=function(pb){if(null==this.A){this.A=[];var xc=this;this.ka(function(){xc.Ba()})}this.A.push(pb)};var Fc=Ej.setTimeout;Sa.prototype.ka=function(pb){Fc(pb,0)};Sa.prototype.Ba=function(){for(;this.A&&this.A.length;){var pb=this.A;
this.A=[];for(var xc=0;xc<pb.length;++xc){var od=pb[xc];pb[xc]=null;try{od()}catch(yd){this.va(yd)}}}this.A=null};Sa.prototype.va=function(pb){this.ka(function(){throw pb;})};va.prototype.ka=function(){function pb(yd){return function(Re){od||(od=!0,yd.call(xc,Re))}}var xc=this,od=!1;return{resolve:pb(this.nb),reject:pb(this.va)}};va.prototype.nb=function(pb){if(pb===this)this.va(new TypeError("A Promise cannot resolve to itself"));else if(pb instanceof va)this.ob(pb);else{a:switch(typeof pb){case "object":var xc=
null!=pb;break a;case "function":xc=!0;break a;default:xc=!1}xc?this.mb(pb):this.Na(pb)}};va.prototype.mb=function(pb){var xc=void 0;try{xc=pb.then}catch(od){this.va(od);return}"function"==typeof xc?this.pb(xc,pb):this.Na(pb)};va.prototype.va=function(pb){this.Oa(2,pb)};va.prototype.Na=function(pb){this.Oa(1,pb)};va.prototype.Oa=function(pb,xc){if(0!=this.aa)throw Error("Cannot settle("+pb+", "+xc+"): Promise already settled in state"+this.aa);this.aa=pb;this.Ba=xc;this.vb()};va.prototype.vb=function(){if(null!=
this.A){for(var pb=0;pb<this.A.length;++pb)pd.aa(this.A[pb]);this.A=null}};var pd=new Sa;va.prototype.ob=function(pb){var xc=this.ka();pb.Pa(xc.resolve,xc.reject)};va.prototype.pb=function(pb,xc){var od=this.ka();try{pb.call(xc,od.resolve,od.reject)}catch(yd){od.reject(yd)}};va.prototype.then=function(pb,xc){function od(qf,Wf){return"function"==typeof qf?function(uh){try{yd(qf(uh))}catch(vh){Re(vh)}}:Wf}var yd,Re,wh=new va(function(qf,Wf){yd=qf;Re=Wf});this.Pa(od(pb,yd),od(xc,Re));return wh};va.prototype.catch=
function(pb){return this.then(void 0,pb)};va.prototype.Pa=function(pb,xc){function od(){switch(yd.aa){case 1:pb(yd.Ba);break;case 2:xc(yd.Ba);break;default:throw Error("Unexpected state: "+yd.aa);}}var yd=this;null==this.A?pd.aa(od):this.A.push(od)};va.resolve=$b;va.reject=function(pb){return new va(function(xc,od){od(pb)})};va.race=function(pb){return new va(function(xc,od){for(var yd=kg(pb),Re=yd.next();!Re.done;Re=yd.next())$b(Re.value).Pa(xc,od)})};va.all=function(pb){var xc=kg(pb),od=xc.next();
return od.done?$b([]):new va(function(yd,Re){function wh(uh){return function(vh){qf[uh]=vh;Wf--;0==Wf&&yd(qf)}}var qf=[],Wf=0;do qf.push(void 0),Wf++,$b(od.value).Pa(wh(qf.length-1),Re),od=xc.next();while(!od.done)})};return va});function Hj(){Hj=function(){};Ej.Symbol||(Ej.Symbol=Ij)}function Jj(da,va){this.A=da;Fj(this,"description",{configurable:!0,writable:!0,value:va})}Jj.prototype.toString=function(){return this.A};
var Ij=function(){function da(Sa){if(this instanceof da)throw new TypeError("Symbol is not a constructor");return new Jj("jscomp_symbol_"+(Sa||"")+"_"+va++,Sa)}var va=0;return da}();function Kk(){Hj();var da=Ej.Symbol.iterator;da||(da=Ej.Symbol.iterator=Ej.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[da]&&Fj(Array.prototype,da,{configurable:!0,writable:!0,value:function(){return Lk(If(this))}});Kk=function(){}}
function Lk(da){Kk();da={next:da};da[Ej.Symbol.iterator]=function(){return this};return da}function Mk(){this.va=!1;this.A=null;this.Oa=void 0;this.aa=1;this.Na=0;this.ka=null}function Nk(da){if(da.va)throw new TypeError("Generator is already running");da.va=!0}Mk.prototype.Ba=function(da){this.Oa=da};function Ok(da,va){da.ka={qb:va,rb:!0};da.aa=da.Na}Mk.prototype.return=function(da){this.ka={return:da};this.aa=this.Na};function Xl(da,va){da.aa=2;return{value:va}}
function Yl(da){this.A=new Mk;this.aa=da}function Zl(da,va){Nk(da.A);var Sa=da.A.A;if(Sa)return $l(da,"return"in Sa?Sa["return"]:function($b){return{value:$b,done:!0}},va,da.A.return);da.A.return(va);return am(da)}function $l(da,va,Sa,$b){try{var Fc=va.call(da.A.A,Sa);if(!(Fc instanceof Object))throw new TypeError("Iterator result "+Fc+" is not an object");if(!Fc.done)return da.A.va=!1,Fc;var pd=Fc.value}catch(pb){return da.A.A=null,Ok(da.A,pb),am(da)}da.A.A=null;$b.call(da.A,pd);return am(da)}
function am(da){for(;da.A.aa;)try{var va=da.aa(da.A);if(va)return da.A.va=!1,{value:va.value,done:!1}}catch(Sa){da.A.Oa=void 0,Ok(da.A,Sa)}da.A.va=!1;if(da.A.ka){va=da.A.ka;da.A.ka=null;if(va.rb)throw va.qb;return{value:va.return,done:!0}}return{value:void 0,done:!0}}
function bm(da){this.next=function(va){Nk(da.A);da.A.A?va=$l(da,da.A.A.next,va,da.A.Ba):(da.A.Ba(va),va=am(da));return va};this.throw=function(va){Nk(da.A);da.A.A?va=$l(da,da.A.A["throw"],va,da.A.Ba):(Ok(da.A,va),va=am(da));return va};this.return=function(va){return Zl(da,va)};Kk();this[Symbol.iterator]=function(){return this}}
function cm(da){function va($b){return da.next($b)}function Sa($b){return da.throw($b)}return new Promise(function($b,Fc){function pd(pb){pb.done?$b(pb.value):Promise.resolve(pb.value).then(va,Sa).then(pd,Fc)}pd(da.next())})}Gj("globalThis",function(da){return da||Ej});Gj("Object.is",function(da){return da?da:function(va,Sa){return va===Sa?0!==va||1/va===1/Sa:va!==va&&Sa!==Sa}});
Gj("Array.prototype.includes",function(da){return da?da:function(va,Sa){var $b=this;$b instanceof String&&($b=String($b));var Fc=$b.length;Sa=Sa||0;for(0>Sa&&(Sa=Math.max(Sa+Fc,0));Sa<Fc;Sa++){var pd=$b[Sa];if(pd===va||Object.is(pd,va))return!0}return!1}});
function dm(da,va,Sa){if(null==da)throw new TypeError("The 'this' value for String.prototype."+Sa+" must not be null or undefined");if(va instanceof RegExp)throw new TypeError("First argument to String.prototype."+Sa+" must not be a regular expression");return da+""}Gj("String.prototype.includes",function(da){return da?da:function(va,Sa){return-1!==dm(this,va,"includes").indexOf(va,Sa||0)}});
Gj("Math.hypot",function(da){return da?da:function(va){if(2>arguments.length)return arguments.length?Math.abs(arguments[0]):0;var Sa,$b,Fc;for(Sa=Fc=0;Sa<arguments.length;Sa++)Fc=Math.max(Fc,Math.abs(arguments[Sa]));if(1E100<Fc||1E-100>Fc){if(!Fc)return Fc;for(Sa=$b=0;Sa<arguments.length;Sa++){var pd=Number(arguments[Sa])/Fc;$b+=pd*pd}return Math.sqrt($b)*Fc}for(Sa=$b=0;Sa<arguments.length;Sa++)pd=Number(arguments[Sa]),$b+=pd*pd;return Math.sqrt($b)}});
Gj("Array.prototype.fill",function(da){return da?da:function(va,Sa,$b){var Fc=this.length||0;0>Sa&&(Sa=Math.max(0,Fc+Sa));if(null==$b||$b>Fc)$b=Fc;$b=Number($b);0>$b&&($b=Math.max(0,Fc+$b));for(Sa=Number(Sa||0);Sa<$b;Sa++)this[Sa]=va;return this}});Gj("Number.isFinite",function(da){return da?da:function(va){return"number"!==typeof va?!1:!isNaN(va)&&Infinity!==va&&-Infinity!==va}});Gj("Number.isInteger",function(da){return da?da:function(va){return Number.isFinite(va)?va===Math.floor(va):!1}});
Gj("String.prototype.repeat",function(da){return da?da:function(va){var Sa=dm(this,null,"repeat");if(0>va||1342177279<va)throw new RangeError("Invalid count value");va|=0;for(var $b="";va;)if(va&1&&($b+=Sa),va>>>=1)Sa+=Sa;return $b}});Gj("Math.sign",function(da){return da?da:function(va){va=Number(va);return 0===va||isNaN(va)?va:0<va?1:-1}});
window.drawCanvas=function(da,va,Sa,$b,Fc){function pd(){cc.addEventListener("mousedown",Kj,!1);cc.addEventListener("mousemove",Pk,!1);cc.addEventListener("touchstart",Wf,!1);cc.addEventListener("touchmove",uh,!0);cc.addEventListener("touchend",Qk,!1);document.body.addEventListener("mouseup",Lj,!1);document.body.addEventListener("touchcancel",vh,!1);document.body.addEventListener("keydown",Re,!1);document.body.addEventListener("keypress",wh,!1);document.body.addEventListener("keyup",qf,!1);da||window.addEventListener("resize",
xc(yd,100),!1)}function pb(){cc.removeEventListener("mousedown",Kj,!1);cc.removeEventListener("mousemove",Pk,!1);cc.removeEventListener("touchstart",Wf,!1);cc.removeEventListener("touchmove",uh,!0);cc.removeEventListener("touchend",Qk,!1);document.body.removeEventListener("mouseup",Lj,!1);document.body.removeEventListener("touchcancel",vh,!1);document.body.removeEventListener("keydown",Re,!1);document.body.removeEventListener("keypress",wh,!1);document.body.removeEventListener("keyup",qf,!1)}function xc(a,
b){b=b||100;var c;return function(e){c&&clearTimeout(c);c=setTimeout(a,b,e)}}function od(a){return new Promise(function(b){return setTimeout(b,a)})}function yd(){var a=new zd(0,0,0,0),b=screen.height;if(90===Math.abs(window.orientation))if(screen.width<screen.height){var c=screen.height;b=screen.width}else c=screen.width,b=screen.height;else c=screen.width;1<g.length&&(Xc(),a=Fd(g,0,"s"));oe=va?90===Math.abs(window.orientation)?Sa?.6:.71:1:da?.9>c/window.innerWidth?window.innerWidth/c:1:1;da?va?90===
Math.abs(window.orientation)?(Tc.width=1.4*c,Tc.height=Sa?1.18*b:Math.min(1.4*b,window.innerHeight),cc.width=Tc.width,cc.height=Tc.height-Jf.clientHeight-10,Se.width=Tc.width,Se.height=cc.height,Te.width=Tc.width,Te.height=cc.height,Ue.width=Tc.width,Ue.height=Tc.height,Jf.style.marginTop="5px"):(Tc.width=1.6*c,Tc.height=1.2*b,cc.width=Tc.width,cc.height=Tc.height-Jf.clientHeight-10,Se.width=Tc.width,Se.height=cc.height,Te.width=Tc.width,Te.height=cc.height,Ue.width=Tc.width,Ue.height=Tc.height,Jf.style.marginTop=
"10px"):(Tc.width=Math.max(window.innerWidth-10,Math.max(a.b+a.c+20,590)),Se.width=Tc.width,Te.width=Tc.width,cc.width=Tc.width,Ue.width=Tc.width,90===Math.abs(window.orientation)?(Tc.height=window.innerHeight,cc.height=window.innerHeight-52):(Tc.height=window.innerHeight-20,cc.height=window.innerHeight-80),Se.height=cc.height,Te.height=cc.height,Ue.height=Tc.height):(Tc.width=Math.max(window.innerWidth-10,Math.max(a.b+a.c+20,590)),cc.width=Tc.width,Se.width=Tc.width,Te.width=Tc.width,Ue.width=Tc.width,
Tc.height=Math.max(window.innerHeight-10,Math.max(a.t+a.h+20,674)),cc.height=Math.max(window.innerHeight-94-10,Math.max(a.t+a.h+20,596)),Se.height=cc.height,Te.height=cc.height,Ue.height=Tc.height);Nc.b=10;Nc.t=42;Nc.c=34*oe;Nc.h=503*oe;hc.b=36*oe+14;hc.t=38;hc.c=532*oe;hc.h=36*oe;sc.b=10;sc.t=Math.max(cc.height-36*oe-10,Nc.t+Nc.h+5);sc.c=Uh?272*oe:5;sc.h=36*oe;dd.b=Uh?sc.b+sc.c+50:34*oe+14;dd.t=sc.t+4;dd.c=50;dd.h=sc.h-4;Kf.t=36;Kf.c=cc.width-20;Kf.h=sc.t+sc.h+5-36-2;za.b=34*oe+14;za.t=Kf.t+36*oe+
12;za.c=Kf.c-Nc.c-4;za.h=Kf.h-72*oe-16;ra.b=za.b+2*$a;ra.t=za.t+2*$a;ra.c=za.c-4*$a;ra.h=za.h-4*$a;Gd.x=dd.b+dd.c+30;Gd.y=dd.t+dd.h/2-4;ye.x=dd.b+dd.c+80;ye.y=dd.t+dd.h/2-4;Rk();Jf.style.top=String(cc.height+4)+"px";da?(90===Math.abs(window.orientation)&&(Xf.style.top="20px"),Jf.style.width=String(Tc.width-10)+"px",Jf.style.left="10px"):(Jf.style.width=document.getElementById("svg")?"580px":"550px",Jf.style.height="40px",Jf.style.marginLeft=String(sc.b)+"px");Sa&&va&&(Ze=.6,em.style.transform="scale("+
String(Ze)+","+String(Ze)+")");Mj()}function Re(a){a.shiftKey&&(0===zb?(zb=10,document.getElementById("shift").className="shift selected"):1===zb&&(zb=11,document.getElementById("shift").className="shift selected"));a.altKey&&(0===zb?(zb=1,document.getElementById("alt").className="alt selected"):10===zb&&(zb=11,document.getElementById("alt").className="alt selected"));if(a.which&&8===a.which&&!1===Vh)if(a.stopPropagation(),a.preventDefault(),ze||0<Uc.length){a=Uc.slice(0);if(0<sa.length&&0<a.length)for(var b=
0;b<a.length;b++){for(var c=0;c<sa.length;c++)if(sa[c].M.includes(a[b])||sa[c].L.includes(a[b]))Yg(c),c--;a.splice(b,1);b--}for(a=1;a<g.length;a++)g[a].v=0,Uc.includes(g[a].t)&&(g[a].v=1);Nj(1);Xc()}else Oj()}function wh(a){var b;a.charCode?b=a.charCode:b=a.keyCode;switch(b){case 113:td(0);qd(0);break;case 99:td(0);break;case 72:a=window.screenX;Fc=window.open("help/MOSFECCS_Help.html","Structural Formula Editor Help","dependent=yes,scrollbars=yes,resizable=yes");Fc.resizeTo(900,900);Fc.moveTo(a-
Fc.outerWidth-5,20);break;case 104:td(1);break;case 79:case 111:case 101:td(2);break;case 78:case 110:case 114:td(3);break;case 83:case 115:td(4);break;case 80:case 112:td(5);break;case 70:case 102:td(6);break;case 118:td(7);break;case 98:td(8);break;case 73:case 105:td(9);break;case 88:case 120:td(10);a.preventDefault();Pj("x");break;case 46:td(11);break;case 43:case 89:td(12);break;case 45:case 121:td(13);break;case 49:qd(0);break;case 50:qd(1);break;case 116:qd(2);break;case 117:case 60:qd(3);
break;case 100:case 62:qd(4);break;case 51:qd(5);break;case 52:qd(6);break;case 53:qd(7);break;case 54:qd(8);break;case 55:Wh("7");qd(10);break;case 56:Wh("8");qd(10);break;case 57:Wh("9");qd(10);break;case 97:qd(9);break;case 119:qd(11);break;case 109:qd(12);break;case 76:case 108:qd(13);break;case 103:if("visible"===Yf.style.visibility)return!1;Xc();a.preventDefault();Sk();break;case 107:Qj?(Tk(0),Qj=!1):(Tk(1),Qj=!0);break;case 69:Ga.clearRect(za.b+1,za.t+1,za.c-2,za.h-2);Xc();Ui();break;case 74:if(Xh=
Xh?!1:!0){if(a=Ga,Dg(a),Ud(),Dg(Ac),1!==Q.length){if(2<=Ka.length)for(b=1;b<Ka.length;b++){var c=Ka[b].f;var e=Ka[b].g;var l=Q[c].x;c=Q[c].y;var f=Q[e].x;e=Q[e].y;var t=Ka[b].B;xh(a,l,c,f,e,t,Ee,"black")}for(b=1;b<Q.length;b++)c=a,e=b,f=String(Q[e].U),c.save(),c.font=String(L)+"pt Arial, Helvetica, sans-serif",c.fillStyle="magenta",l=g[e].x-.5*c.measureText(f).width,e=g[e].y+L/2,c.clearRect(l,e-L,c.measureText(f).width,L),c.fillText(f,l,e),c.restore();yh=zh=$e=!1}}else wb(Ga,0,!0);break;case 48:Eg=
Eg?!1:!0;!0===Eg&&(Xh=!1);wb(Ga,0,!0);break;case 33:Mj();break;case 77:for(a=1;a<=rf;a++)Ae(a,String(a),"green",!0,"t")}}function qf(a){if(16===a.which||18===a.which||!0===da&&0<zb&&0===a.which)zb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt"}function Wf(a){a||(a=window.event);2===a.touches.length?Yh=!0:(a.preventDefault(),a.stopPropagation(),Md=(a.targetTouches[0].pageX-cc.offsetLeft)/Ze,Nd=(a.targetTouches[0].pageY-cc.offsetTop)/Ze,Ic(ra,Md,
Nd)&&(bb=hb=0,a=Yd(g,aa,Md,Nd),0<a?(hb=a,bb=0,Fg(g[hb].x,g[hb].y),sf=hb):0>a?(bb=-1*a,hb=0,Uk(bb),Zg=bb):bb=hb=0),Kj())}function uh(a){a||(a=window.event);if(!0!==Yh||2!==a.touches.length)a.preventDefault(),Md=(a.targetTouches[0].pageX-cc.offsetLeft)/Ze,Nd=(a.targetTouches[0].pageY-cc.offsetTop)/Ze,Vk()}function vh(a){Md=(a.changedTouches[0].pageX-cc.offsetLeft)/Ze;Nd=(a.changedTouches[0].pageY-cc.offsetTop)/Ze;Yh=!1}function Qk(a){a||(a=window.event);0===a.touches.length&&Yh?Yh=!1:(Md=(a.changedTouches[0].pageX-
cc.offsetLeft)/Ze,Nd=(a.changedTouches[0].pageY-cc.offsetTop)/Ze,Lj())}function Kj(){Vi=!0;vb="";dc=Md;ec=Nd;if(Ic(ra,dc,ec)){yc=zc=0;Rj=dc;Sj=ec;bb=hb=0;var a=Yd(g,aa,dc,ec);0<a?(hb=a,bb=0):0>a?(bb=-1*a,hb=0):bb=hb=0}Zh=!1}function Pk(a){a||(a=window.event);Md=(a.pageX-cc.offsetLeft)/Ze;Nd=(a.pageY-cc.offsetTop)/Ze;Vk()}function Vk(){var a,b,c;var e=a=c=b=0;var l=-1,f=-1;var t=0;zc=Md;zc>ra.b+ra.c&&(zc=ra.b+ra.c);zc<ra.b&&(zc=ra.b);yc=Nd;yc>ra.t+ra.h&&(yc=ra.t+ra.h);yc<ra.t&&(yc=ra.t);if(Ic(za,Md,
Nd)){"moveTree"!==vb&&"copyTree"!==vb&&"rotateTree"!==vb&&(e=Yd(g,aa,Md,Nd),l=0<Pa.length?Wk(Md,Nd):-1,f=0<sa.length?Xk(Md,Nd):-1);0<e?(pe=e,Gg=0):0>e?(Gg=-1*e,pe=0):Gg=pe=0;-1<l?Hg=l:Hg=-1;-1<f?$h=f:$h=-1;Zh=Math.sqrt((zc-Rj)*(zc-Rj)+(yc-Sj)*(yc-Sj))>Yk;if("moveAllMol"!==vb&&"moveTree"!==vb&&"copyTree"!==vb&&"rotateTree"!==vb&&!ze&&Zh)if(0<pe){if(0===sf){var q=g[pe].x;var D=g[pe].y;Fg(g[pe].x,g[pe].y);sf=pe}}else if(0<Gg&&Gg!==bb&&"provMeshDraw"!==vb&&"provChainDraw"!==vb&&"moveAtom"!==vb)0===Zg&&
(Uk(Gg),Zg=Gg);else if(-1<Hg){if(0>ai){var y=Pa[Hg].G,A=Pa[Hg].K,wa=Pa[Hg].crv,Ea=f=l=e=0;0>y?(e=(g[aa[-1*y].f].x+g[aa[-1*y].g].x)/2,l=(g[aa[-1*y].f].y+g[aa[-1*y].g].y)/2):0<y&&(e=g[y].x,l=g[y].y);0>A?(f=(g[aa[-1*A].f].x+g[aa[-1*A].g].x)/2,Ea=(g[aa[-1*A].f].y+g[aa[-1*A].g].y)/2):0<A&&(f=g[A].x,Ea=g[A].y);var fa=ld(e,l,f,Ea);var Na=Math.sqrt((f-e)*(f-e)+(Ea-l)*(Ea-l));A=.8*na/Na;y=-1*wa*A*Na*Math.sin(Math.PI*fa/180);fa=-1*wa*A*Na*Math.cos(Math.PI*fa/180);wa=e+y;A=l+fa;y=f+y;fa=Ea+fa;V.save();da&&(V.fillStyle=
"rgba(0,255,0,0.4)",V.beginPath(),V.arc((wa+y+e+f)/4+.25*(wa-e),(A+fa+l+Ea)/4+.25*(A-l),3*$a,0,2*Math.PI),V.fill());V.strokeStyle="green";V.bb=1.5;V.beginPath();V.arc((wa+y+e+f)/4+.25*(wa-e),(A+fa+l+Ea)/4+.25*(A-l),4,0,2*Math.PI);V.stroke();V.restore();ai=Hg}}else if(-1<$h){if(0>Wi){e=$h;l=(sa[e].W.x+sa[e].V.x)/2;f=(sa[e].W.y+sa[e].V.y)/2;V.save();da&&(V.fillStyle="LightGray",V.beginPath(),V.arc(l,f,3*$a,0,2*Math.PI),V.fill());V.fillStyle="DarkGray";V.beginPath();V.arc(l,f,Xi,0,2*Math.PI);V.fill();
V.restore();for(l=0;l<sa[e].M.length;l++)Ae(sa[e].M[l],"reactant","blue",!0,"t");for(l=0;l<sa[e].L.length;l++)Ae(sa[e].L[l],"product","green",!0,"t");Wi=$h}}else 0<sf&&(sf=0,Ud()),0<Zg&&(Zg=0,Ud()),-1<ai&&(ai=-1,Ud()),-1<Wi&&(Wi=-1,Ud());if(Vi){""===vb&&(e=Math.sqrt((zc-dc)*(zc-dc)+(yc-ec)*(yc-ec)),lg=e>.5*$a?!0:!1);if(lg&&""===vb&&0===hb&&0===bb&&1>=zb&&1<g.length&&Ic(ra,dc,ec)){if(1===Uc.length&&dc>H.b+H.c/2-Jc&&dc<H.b+H.c/2+Jc&&ec>H.t-2*Jc&&ec<H.t+2*Jc){vb="rotateTree";return}if(0===Zk(dc,ec)&&
0===zb)vb="spanSelRect",V.save(),V.clearRect(za.b,za.t,za.c,za.h),V.strokeStyle="magenta",V.setLineDash([2,3]),V.strokeRect(dc,ec,zc-dc,yc-ec),V.restore();else if(0<Zk(dc,ec)){$g(Uc,1);af=Fd(g,1,"s");Ud();V.save();V.strokeStyle="magenta";wb(V,1,!1);0===zb?Tj="MOVE":1===zb&&(Tj="COPY");for(e=0;e<Uc.length;e++)Ae(Uc[e],Tj,"magenta",!0,"t");mg=V.getImageData(af.b-2,af.t-L,af.c+4,af.h+L+2);V.strokeRect(af.b,af.t,af.c,af.h);V.restore();he=af.b-2;ie=af.t-L;0===zb?vb="moveSelMol":1===zb&&(vb="copySelMol")}}if(lg&&
""===vb&&(0<hb||0<bb||ze&&1>=zb||1===g.length||!ze&&0<zb)){switch(!0){case 0===zb&&ze&&dc>H.b&&dc<H.b+H.c&&ec>H.t&&ec<H.t+H.h:0<bb?t=aa[bb].f:0<hb&&(t=hb);if(0<bb||0<hb)Yi(t),H=Fd(g,1,"s");wb(V,1,!1);V.save();V.lineWidth=1;V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);mg=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("MOVE",H.b,H.t-4);V.restore();he=H.b;ie=H.t;vb="moveTree";return;case 1===zb&&(0<hb||0<bb):case 1===zb&&ze&&Ic(H,dc,ec):0<bb?t=aa[bb].f:
0<hb&&(t=hb);if(0<hb||0<bb)Yi(t),H=Fd(g,1,"s");wb(V,1,!1);V.save();V.lineWidth=1;V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);mg=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("COPY",H.b,H.t-4);V.restore();he=H.b;ie=H.t;vb="copyTree";break;case 10>zb&&0===bb&&tf&&(ng||uf):0<hb?(q=qe.indexOf(g[hb].o),0>q||0===g[hb].a.length?(vb="provBondDraw",bi=!0):(vb="",bi=!1)):(vb=1===g.length||1===zb%2?"provBondDraw":"",bi=!1);break;case 10>zb&&vf&&0===bb:vb="provChainDraw";
0<hb?(q=qe.indexOf(g[hb].o),0>q||0===g[hb].a.length?(ah=g[hb].x,bh=g[hb].y,ci=!0):(vb="",ci=!1)):(1===g.length||1===zb%2?(ah=dc,bh=ec):vb="",ci=!1);break;case 10>zb&&Lf&&0===bb:vb="provMeshDraw";0<hb?(q=qe.indexOf(g[hb].o),0>q||0===g[hb].a.length?(b=g[hb].x,c=g[hb].y,Ig=!0,Ah=-1):(vb="",Ig=!1)):1===g.length||1===zb%2?(b=dc,c=ec,Ig=!1,Ah=-1):vb="";break;case 0===zb&&bf&&0<bb:vb="provRingDraw";break;case 10===zb&&0<hb:vb="moveAtom";break;case 10===zb&&0<bb:je=dc;ke=ec;di=!0;Zg=0;vb="moveBond";break;
case 10===zb&&0===hb&&0===bb&&1<g.length:vb="moveAllMol";Xc();V.save();H=Fd(g,0,"s");wb(V,1,!1);V.lineWidth=1;V.strokeStyle="magenta";V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);mg=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("MOVE ALL",H.b,H.t-4);V.restore();he=H.b;ie=H.t;break;case 11===zb&&(0<hb||0<bb):0<bb?t=aa[bb].f:0<hb&&(t=hb);if(0<bb||0<hb)Yi(t),H=Fd(g,1,"s");wb(V,1,!1);V.save();V.lineWidth=1;V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,
H.h);mg=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("MOVE",H.b,H.t-4);V.restore();he=H.b;ie=H.t;V.putImageData(mg,he+10,ie+10);vb="moveTree";break;case (16===Xb||17===Xb)&&(0<hb||0<bb):vb="provArrowDraw";a=ld(dc,ec,zc,yc);ei=!1;0<hb?(q=g[hb].x,D=g[hb].y):0<bb&&(q=(g[aa[bb].f].x+g[aa[bb].g].x)/2,D=(g[aa[bb].f].y+g[aa[bb].g].y)/2);je=q;ke=D;break;default:Kb(),wb(Ga,0,!0)}""===vb&&Xc()}if(Zh&&""!==vb)switch(vb){case "provBondDraw":bi||1!==g.length&&1!==zb%
2?(q=g[hb].x,D=g[hb].y):(q=dc,D=ec);Zi&&($k(Ac,je,ke,fi,gi,"erase"),Zi=!1);a=ld(q,D,zc,yc);a=15*Math.floor(a/15);var ua=Math.cos(Math.PI*a/180)*na;a=-1*Math.sin(Math.PI*a/180)*na;Ic(ra,q+ua,D+a)&&($k(Ac,q,D,q+ua,D+a,"draw"),je=q,ke=D,fi=q+ua,gi=D+a,Zi=!0);break;case "provRingDraw":a=g[aa[bb].f].x;c=g[aa[bb].f].y;b=g[aa[bb].g].x;t=g[aa[bb].g].y;q=Md-(a+b)/2;D=Nd-(c+t)/2;D=Jg(b-a,t-c,q,D);4<Xb&&9>Xb||10===Xb?(10===Xb?ua=Ve:ua=Xb-2,Kd=wf(Ac,ua,bb,"bond",D,"test"),!0===Kd&&(Bh?(Kd=wf(Ac,ua,bb,"bond",
D,"erase"),Bh=!1):(Kd=wf(Ac,ua,bb,"bond",D,"draw"),Bh=!0))):9===Xb&&(Kd=wf(Ac,6,bb,"bond",D,"test"),!0===Kd&&(Bh?(Kd=wf(Ac,6,bb,"bond",D,"erase"),Bh=!1):(Kd=wf(Ac,6,bb,"bond",D,"draw"),Bh=!0)));Ch=D;break;case "moveAtom":0<hb&&($i&&(al(Ac,hb,je,ke,"erase"),$i=!1),al(Ac,hb,zc,yc,"draw"),je=zc,ke=yc,$i=!0);break;case "moveBond":0<bb&&(di&&(bl(Ac,bb,je-dc,ke-ec,"erase"),di=!1),bl(Ac,bb,zc-dc,yc-ec,"draw"),je=zc,ke=yc,di=!0);break;case "moveAllMol":ua=zc-dc;q=yc-ec;Ic(ra,he+ua+H.c,ie+q+H.h)&&Ic(ra,he+
ua,ie+q)&&(cc.style.cursor="move",V.save(),V.fillStyle="white",V.fillRect(za.b,za.t,za.c,za.h),V.restore(),V.putImageData(mg,he+ua,ie+q),V.font="8pt sans-serif",V.fillStyle="magenta",V.fillText("MOVE ALL",he+ua,ie+q-4),je=ua,ke=q);break;case "moveSelMol":case "copySelMol":ua=zc-dc;q=yc-ec;Ic(ra,he+ua+af.c,ie+q+af.h)&&Ic(ra,he+ua,ie+q)&&(cc.style.cursor="move",V.save(),V.fillStyle="white",V.fillRect(za.b,za.t,za.c,za.h),V.putImageData(mg,he+ua,ie+q),V.restore(),je=ua,ke=q);break;case "moveTree":case "copyTree":D=
new zd(H.b+zc-dc,H.t-Jc-2+yc-ec,H.c,H.h+2*Jc+2);Uj(D,ra)?(ua=zc-dc,q=yc-ec):(ua=zc-dc,q=yc-ec,D.b<ra.b&&(ua=ra.b+4-he),D.t<ra.t+1&&(q=ra.t+Jc+4-ie),D.b+D.c>ra.b+ra.c&&(ua=ra.b+ra.c-4-H.c-he),D.t+D.h>ra.t+ra.h&&(q=ra.t+ra.h-H.h-4-ie));cc.style.cursor="move";V.save();V.fillStyle="white";V.fillRect(Kf.b,Kf.t,Kf.c,Kf.h);V.restore();V.putImageData(mg,he+ua,ie+q);V.font="8pt sans-serif";V.fillStyle="magenta";"moveTree"===vb?V.fillText("MOVE",he+ua,ie+q-4):V.fillText("COPY",he+ua,ie+q-4);je=ua;ke=q;break;
case "rotateTree":V.save();V.fillStyle="white";V.fillRect(za.b,za.t,za.c,za.h);V.restore();Zd=H.b+H.c/2;Be=H.t+H.h/2;ua=Math.round(180*Math.atan2(zc-Zd,Be-yc)/Math.PI);V.save();V.translate(Zd,Be);V.rotate(Math.PI*ua/180);V.translate(-Zd,-Be);wb(V,1,!1);V.strokeStyle="magenta";V.fillStyle="magenta";V.beginPath();V.arc(Zd,Be,4,0,2*Math.PI);V.stroke();V.beginPath();V.arc(Zd,Be,2,0,2*Math.PI);V.fill();V.beginPath();V.strokeRect(Zd-H.c/2,Be-H.h/2,H.c,H.h);V.lineWidth="1";V.fillStyle="magenta";V.beginPath();
V.moveTo(H.b+H.c/2-Jc-4,H.t-Jc-2);V.lineTo(H.b+H.c/2-Jc+2,H.t-Jc+6);V.lineTo(H.b+H.c/2-Jc+4,H.t-Jc-4);V.closePath();V.fill();V.beginPath();V.moveTo(H.b+H.c/2+Jc-4,H.t-Jc-4);V.lineTo(H.b+H.c/2+Jc-2,H.t-Jc+6);V.lineTo(H.b+H.c/2+Jc+4,H.t-Jc-2);V.closePath();V.fill();V.lineWidth="1";V.beginPath();V.arc(Zd,H.t-Jc,Jc,0,2*Math.PI);V.stroke();V.font="10pt sans-serif";V.fillStyle="magenta";V.fillText(String(ua)+"\u00b0",Zd+Jc+4,H.t-Jc);V.restore();break;case "spanSelRect":if(Ic(ra,zc,yc)){V.save();V.clearRect(ra.b,
ra.t,ra.c,ra.h);if(0<Uc.length)for(e=0;e<Uc.length;e++)Ae(Uc[e],"","magenta",!1,"t");H.b=Math.min(dc,zc);H.t=Math.min(ec,yc);H.c=Math.abs(dc-zc);H.h=Math.abs(ec-yc);V.strokeStyle="magenta";V.setLineDash([2,3]);V.strokeRect(dc,ec,zc-dc,yc-ec);V.restore();xf&&(V.fillStyle="magenta","reactant"===Zf?V.fillText("arrow start",H.b,H.t-8):"product"===Zf&&V.fillText("arrow end",H.b,H.t-8))}else V.clearRect(za.b,za.t,za.c,za.h),vb="";break;case "provChainDraw":ua=Math.sqrt((zc-ah)*(zc-ah)+(yc-bh)*(yc-bh));
ua=Math.floor(ua/cl);D=ld(ah,bh,zc,yc);q=15*Math.floor(D/15);D=7.5<D%15?1:-1;(ua!=aj||bj!=q||cj!=D)&&1<=ua&&(dj&&(dl(Ac,aj,ah,bh,bj,cj,!0,"erase"),dj=!1),dl(Ac,ua,ah,bh,q,D,!0,"draw"),aj=ua,bj=q,cj=D,dj=!0);break;case "provMeshDraw":0===Aa.length&&(Aa.push(new Yc(b,c)),$d=!1);1===Aa.length&&(a=ld(Aa[Aa.length-1].x,Aa[Aa.length-1].y,zc,yc),q=ia(30*Math.floor(a/30)),ua=na*Math.cos(Math.PI*q/180),a=-1*na*Math.sin(Math.PI*q/180),Gc=Aa[Aa.length-1].x+ua,Hc=Aa[Aa.length-1].y+a,Ic(ra,Gc,Hc)?(q!=Ah&&(!0===
$d&&(We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,ch,dh,!0,"erase"),$d=!1),!1===$d&&(We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),ch=Gc,dh=Hc,Ah=q,$d=!0)),ua=Math.sqrt((zc-dc)*(zc-dc)+(yc-ec)*(yc-ec)),ua>na-$a?(!0===$d&&(We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,ch,dh,!0,"erase"),$d=!1),ua=0<sf?pe:Yd(g,aa,Gc,Hc),q=el(Gc,Hc),0<=q&&Fg(Aa.x,Aa.y),0<ua?(hi=ua,We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):0<=q?(Kg=q,We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),
$d=!0):Kg=-1,Aa.push(new Yc(Gc,Hc)),We(Ac,Aa[Aa.length-2].x,Aa[Aa.length-2].y,Gc,Hc,!0,"draw"),ii=dc,ji=ec,Od=Gc,Pd=Hc):(Gc=Aa[Aa.length-1].x,Hc=Aa[Aa.length-1].y)):(Gc=Aa[Aa.length-1].x,Hc=Aa[Aa.length-1].y));1<Aa.length&&(!1===Ig&&(Ga.font="12pt Calibri",Ga.fillStyle="white",Ga.fillText("C",Aa[0].x-6,Aa[0].y+6)),Od=Aa[Aa.length-1].x,Pd=Aa[Aa.length-1].y,ii=Aa[Aa.length-2].x,ji=Aa[Aa.length-2].y,a=ld(zc,yc,Od,Pd),q=ld(ii,ji,Od,Pd),ua=ia(a-q),90>ua||270<ua?($d&&We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-
1].y,ch,dh,!0,"erase"),We(Ac,Aa[Aa.length-2].x,Aa[Aa.length-2].y,Aa[Aa.length-1].x,Aa[Aa.length-1].y,!0,"erase"),Aa.pop()):(D=Jg(Od-ii,Pd-ji,zc-Od,yc-Pd),q=0<D?ia(q-60):ia(q+60),ua=na*Math.cos(Math.PI*q/180),a=-1*na*Math.sin(Math.PI*q/180),Gc=Od+ua,Hc=Pd+a,Ic(ra,Gc,Hc)?(q!=Ah&&(!0===$d&&(We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,ch,dh,!0,"erase"),$d=!1),!1===$d&&(We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),ch=Gc,dh=Hc,Ah=q,$d=!0)),ua=Math.sqrt((zc-Od)*(zc-Od)+(yc-Pd)*(yc-Pd)),ua>na-
$a?(!0===$d&&(We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,ch,dh,!0,"erase"),$d=!1),ua=0<sf?pe:Yd(g,aa,Gc,Hc),q=el(Gc,Hc),0<=q&&Fg(Aa.x,Aa.y),0<ua?(hi=ua,We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):0<=q?(Kg=q,We(Ac,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):Kg=-1,Aa.push(new Yc(Gc,Hc)),We(Ac,Od,Pd,Gc,Hc,!0,"draw"),ii=Od,ji=Pd,Od=Gc,Pd=Hc):(Gc=Od,Hc=Pd)):(Gc=Od,Hc=Pd)));break;case "provArrowDraw":ej=a,0!==fi&&0!==gi&&(a=ld(fi,gi,zc,yc),-1<ej&&0===og&&(q=Math.cos(Math.PI*
a/180),D=-1*Math.sin(Math.PI*a/180),ua=Math.cos(Math.PI*ej/180),a=-1*Math.sin(Math.PI*ej/180),og=-1*Jg(ua,a,q,D))),ei&&(Ac.clearRect(0,0,Te.width,Te.height),ei=!1),Ic(ra,zc,yc)&&(ua=Ac,q=je,D=ke,a=zc,b=yc,e=og,l=ld(q,D,a,b),c=ia(l-90*e),f=Math.sqrt((a-q)*(a-q)+(b-D)*(b-D)),t=-.5*e*f*Math.sin(Math.PI*l/180),f=-.5*e*f*Math.cos(Math.PI*l/180),e=q+t,l=D+f,t=a+t,f=b+f,ua.save(),ua.lineWidth=Ee,ua.strokeStyle="magenta",ua.fillStyle="magenta",ua.beginPath(),ua.moveTo(q,D),ua.bezierCurveTo(e,l,t,f,a,b),ua.stroke(),
ua.beginPath(),ua.moveTo(a,b),ua.lineTo(a-8*Math.cos(Math.PI*ia(c-30*og)/180),b+8*Math.sin(Math.PI*ia(c-30*og)/180)),16===Xb&&(ua.moveTo(a,b),ua.lineTo(a-8*Math.cos(Math.PI*ia(c+45*og)/180),b+8*Math.sin(Math.PI*ia(c+45*og)/180))),ua.stroke(),ua.restore(),fi=zc,gi=yc,Vj=og,ei=!0)}}}else Kb()}function Lj(){function a(){Zf="reactant";Fe=[];cf=[];Uc=[];Xc();Ud();Kb();vb=""}var b=0,c=0,e=0,l=0,f=0,t=-1;c=-1;e=0;e="";b=0;l=1;b=0;b=1;b=l=-1;var q=b=0;q=[];var D=[];q=[];q=b=0;b={};b=new zd(0,0,0,0);q=[];
Vi=!1;Vc=Md;Zc=Nd;if(""===vb||Ic(ra,Vc,Zc))if(Ic(Kf,Vc,Zc))if($e=!1,da&&(Ic(Nc,Vc,Zc)||Ic(hc,Vc,Zc)||Ic(sc,Vc,Zc)||Ic(dd,Vc,Zc))?18>Math.sqrt((Vc-dc)*(Vc-dc)+(Zc-ec)*(Zc-ec))&&($e=!0):Math.sqrt((Vc-dc)*(Vc-dc)+(Zc-ec)*(Zc-ec))<fl&&($e=!0),$e&&Ic(dd,Vc,Zc))V.save(),V.fillStyle="LightGrey",V.fillRect(dd.b+2,dd.t+2,dd.c-4,dd.h-4),V.restore(),setTimeout(function(){Mj();zb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt"},100);else if($e&&Math.hypot(Vc-
Gd.x,Zc-Gd.y)<Gd.r&&(V.save(),V.fillStyle="LightGray",V.beginPath(),V.arc(Gd.x,Gd.y,Gd.r-2,0,2*Math.PI),V.fill(),V.restore(),setTimeout(function(){gl("in")},100)),$e&&Math.hypot(Vc-ye.x,Zc-ye.y)<ye.r&&(V.save(),V.fillStyle="LightGray",V.beginPath(),V.arc(ye.x,ye.y,ye.r-2,0,2*Math.PI),V.fill(),V.restore(),setTimeout(function(){gl("out")},100)),$e&&Ic(Nc,Vc,Zc))b=Math.floor((Zc-Nc.t)/(Nc.h/14)),0>b&&(b=0),13<b&&(b=13),qd(b),(vf||Lf||Ge||bf)&&td(0),Xc(),Kb(),Ud();else if(Uh&&$e&&Ic(sc,Vc,Zc)&&(b=14+
Math.floor((Vc-sc.b)/(sc.c/8)),14>b&&(b=14),21<b&&(b=21),qd(b),td(0)),$e&&Ic(hc,Vc,Zc))b=Math.floor((Vc-hc.b)/(hc.c/14)),0>b&&(b=0),13<b&&(b=13),td(b),10===b&&Pj("x"),Xc(),Kb(),Ud();else{if(Ic(ra,Vc,Zc)){"moveTree"!==vb&&"copyTree"!==vb&&"rotateTree"!==vb&&(f=Yd(g,aa,Vc,Zc),t=Wk(Vc,Zc),c=Xk(Vc,Zc));0<f?(mb=f,ae=0):0>f?(ae=-1*f,mb=0):ae=mb=0;eh=pg=-1;-1<t&&(pg=t);-1<c&&(eh=c);fj=gj=yh=zh=!1;if($e){0<mb&&!1===lg&&(zh=!0,l=qe.indexOf(g[mb].o));0<ae&&!1===lg&&(yh=!0);-1<pg&&!1===lg&&(gj=!0);-1<eh&&!1===
lg&&(fj=!0);if(zh){if(Ge){if(0<sa.length&&(Dh(g,aa),rd.includes(mb)&&2<g[mb].a.length||!rd.includes(mb)&&1<g[mb].a.length))for(c=0;c<sa.length;c++)if(sa[c].M.includes(g[mb].t)||sa[c].L.includes(g[mb].t))Yg(c),c--;ki(g,aa,mb,!0);ed();Kb();wb(Ga,0,!0);return}if(qg){if(qe.includes(g[mb].o)){Kb();return}if(14===Xb){for(e=q=0;e<g[mb].a.length;e++){b=g[mb].a[e].t;if(4===b||5===b)b=1;q+=b}g[mb].H<5-q&&3>=g[mb].H&&(g[mb].H+=1)}else 15===Xb&&0<g[mb].H&&--g[mb].H;ed();Kb();wb(Ga,0,!0);return}if(bf){if(0<=l){Kb();
wb(Ga,0,!0);return}if(4<Xb&&9>Xb||10===Xb){if(10===Xb)if(0<Ve)b=Ve;else{Kb();return}else b=Xb-2;Kd=wf(Ac,b,mb,"atom",1,"test");!0===Kd&&Eh(b,mb,1,"atom")}else 9===Xb&&(Kd=wf(Ac,6,mb,"atom",1,"test"),!0===Kd&&Eh(-6,mb,1,"atom"));ed();Kb();wb(Ga,0,!0);return}if(ng&&(g[mb].o!==li[He]||0<g[mb].N)){if(1===g[mb].j)for(c=0;c<g[mb].a.length;c++)0===g[mb].N?--g[g[mb].a[c].p].C:2===g[mb].N?--g[g[mb].a[c].p].D:3===g[mb].N&&--g[g[mb].a[c].p].F;g[mb].o=li[He];g[mb].j=mi(li[He]);g[mb].H=0;if(1===g[mb].j)for(c=
0;c<g[mb].a.length;c++)g[g[mb].a[c].p].C+=1,3<g[mb].a[c].t&&(b=Ja(aa,g[mb].a[c].p,mb),aa[b].f===mb&&$c(g,aa,b,1,!0));g[mb].N=0;ed();Kb();wb(Ga,0,!0);return}if(uf&&"X"!==be){Wj();return}if(ni&&!qe.includes(g[mb].o)){11===He?g[mb].r=g[mb].r?!1:!0:12===He?g[mb].s+=1:13===He&&--g[mb].s;ed();Kb();wb(Ga,0,!0);return}wb(Ga,0,!0)}else if(gj){if(0===zb&&-1<pg&&Ic(ra,Md,Nd)&&Ge){hj(pg);ed();Kb();wb(Ga,0,!0);return}if(0===zb&&-1<pg&&Ic(ra,Md,Nd)){Pa[pg].crv=0<Pa[pg].crv?-1:1;ed();Kb();wb(Ga,0,!0);return}}else if(fj){if(0===
zb&&-1<eh&&Ic(ra,Md,Nd)&&Ge){Yg(eh);ed();Kb();wb(Ga,0,!0);return}0===zb&&-1<eh&&Ic(ra,Md,Nd)&&21===Xb&&fm(eh)}else{if(yh){if(10===zb&&0<ae&&Ic(ra,Md,Nd)){rg(g,aa,ae,1,!1);b=Fd(g,1,"s");Uj(b,ra)||rg(g,aa,ae,-1,!1);for(c=1;c<g.length;c++)1===g[c].v&&Mf(g,c);wb(Ga,0,!0);Xj();Xc();ed();Kb();da&&(Nd=Md=0)}else{if(tf)Xb+1!==aa[ae].B?$c(g,aa,ae,Xb+1,!0):(3===Xb||4===Xb)&&$c(g,aa,ae,-1,!0),ed();else if(Ge&&0<ae){if(0<sa.length&&(Dh(g,aa),!le(aa,aa[ae].f,aa[ae].g)))for(c=0;c<sa.length;c++)if(sa[c].M.includes(g[aa[ae].f].t)||
sa[c].M.includes(g[aa[ae].g].t)||sa[c].L.includes(g[aa[ae].f].t)||sa[c].L.includes(g[aa[ae].g].t))Yg(c),c--;hl(g,aa,ae);ed()}Kb();wb(Ga,0,!0)}return}if(ze&&1<g.length&&0===zb){Vc<H.b+H.c/2+20&&Vc>H.b+H.c/2-20&&Zc<H.t+H.h+30&&Zc>H.t+H.h&&fh(g,aa,"y",1);Vc<H.b+H.c+30&&Vc>H.b+H.c&&Zc<H.t+H.h/2+20&&Zc>H.t+H.h/2-20&&fh(g,aa,"x",1);ed();Kb();wb(Ga,0,!0);return}if(tf&&(ng||uf)&&(1===g.length||1===zb%2)){f=Vc;t=Zc;Kd=Ic(ra,f,t);!0===Kd&&(ng?e=li[He]:e="C",l=sg(g,e,f,t,!1),0<l&&uf&&Wj());uf||(ed(),wb(Ga,0,
!0));Kb();return}if(bf&&(1===g.length||1===zb%2)){if(4<Xb&&9>Xb||10===Xb){if(10===Xb)if(0<Ve)b=Ve;else{Kb();return}else b=Xb-2;Kd=wf(Ac,b,0,"freespace",1,"test");!0===Kd&&Eh(b,0,1,"atom")}else 9===Xb&&(Kd=wf(Ac,6,0,"freespace",1,"test"),!0===Kd&&Eh(-6,0,1,"atom"));ed();Kb();wb(Ga,0,!0);return}Ud()}Ud();Xc()}if(lg){switch(vb){case "provBondDraw":bi||1!==g.length&&1!==zb%2?(b=hb,l=g[hb].x,c=g[hb].y):(b=sg(g,"C",dc,ec,!1),l=dc,c=ec);t=ld(l,c,Vc,Zc);t=15*Math.floor(t/15);f=Math.cos(Math.PI*t/180)*na;
t=-1*Math.sin(Math.PI*t/180)*na;f=l+f;t=c+t;if(Ic(ra,f,t)){if(tf&&(ng||uf)&&!vf){if(0===mb)ng?e=li[He]:e="C",l=sg(g,e,f,t,!1),0<l&&(1!==g[l].j||1===g[hb].j||uf||(g[hb].C+=1),Xe(g,aa,b,l,Xb+1),uf&&Wj());else if(mb!=hb)if(e=oi(g,hb,mb),0<=e)l=mb,Nf(g,aa,hb,mb,"+");else{if(3===Xb&&-1===g[mb].z||4===Xb&&1===g[mb].z){wb(Ga,0,!0);Kb();return}Xe(g,aa,hb,mb,Xb+1);l=mb;if(0<sa.length&&g[hb].t!==g[mb].t)for(c=0;c<sa.length;c++)if(sa[c].M.includes(g[hb].t)||sa[c].M.includes(g[mb].t)||sa[c].L.includes(g[hb].t)||
sa[c].L.includes(g[mb].t))Yg(c),c--}else if(mb===hb){wb(Ga,0,!0);Kb();return}wb(Ga,0,!0);uf||ed();Kb();return}}else{wb(Ga,0,!0);Kb();return}wb(Ga,0,!0);ed();Kb();break;case "provChainDraw":gm(aj,dc,ec,bj,cj);ci=!1;wb(Ga,0,!0);ed();Kb();vb="";break;case "provMeshDraw":hm(Aa.length);Ig=!1;Aa.length=0;wb(Ga,0,!0);ed();Kb();vb="";break;case "provRingDraw":if(4<Xb&&9>Xb||10===Xb){if(10===Xb)if(0<Ve)b=Ve;else{Kb();return}else b=Xb-2;Kd=wf(Ac,b,bb,"bond",Ch,"test");!0===Kd&&Eh(b,bb,Ch,"bond")}else 9===Xb&&
(Kd=wf(Ac,6,bb,"bond",Ch,"test"),!0===Kd&&Eh(-6,bb,Ch,"bond"));wb(Ga,0,!0);ed();Kb();vb="";break;case "moveAtom":if(0<pe&&pe!==hb){if(0!==g[hb].z&&0!==g[pe].z&&g[pe].z!==g[hb].z){wb(Ga,0,!0);Kb();return}pi(pe,hb)}else g[hb].x=zc,g[hb].y=yc;ed();wb(Ga,0,!0);Kb();vb="";break;case "moveBond":e=g[aa[bb].f].x+Vc-dc;b=g[aa[bb].f].y+Zc-ec;f=g[aa[bb].g].x+Vc-dc;t=g[aa[bb].g].y+Zc-ec;c=Yd(g,aa,e,b);l=Yd(g,aa,f,t);0<c&&c!==aa[bb].f&&0<l&&l!==aa[bb].g&&0<=oi(g,c,l)?im(c,l,aa[bb].f,aa[bb].g):0<c&&c!==aa[bb].f?
(g[aa[bb].g].x=f,g[aa[bb].g].y=t,pi(c,aa[bb].f)):0<l&&l!==aa[bb].g?(g[aa[bb].f].x=e,g[aa[bb].f].y=b,pi(l,aa[bb].g)):(g[aa[bb].f].x=e,g[aa[bb].f].y=b,g[aa[bb].g].x=f,g[aa[bb].g].y=t);ed();wb(Ga,0,!0);Kb();vb="";break;case "moveAllMol":for(b=0;b<g.length;b++)g[b].x+=je,g[b].y+=ke;if(0<sa.length)for(b=0;b<sa.length;b++)sa[b].W.x+=je,sa[b].W.y+=ke,sa[b].V.x+=je,sa[b].V.y+=ke;wb(Ga,0,!0);ed();Kb();vb="";break;case "spanSelRect":f=new zd(Math.min(dc,Vc),Math.min(ec,Zc),Math.abs(Vc-dc),Math.abs(Zc-ec));
e=!1;b=1;for(Lg=[];b<g.length;)Ic(f,g[b].x,g[b].y)&&(Lg.push(b),e=!0),b++;if(0===Lg.length){Ud();Kb();return}if(!xf){il(Lg);if(1===Uc.length)jm(Lg[0]),ze=!0;else if(1<Uc.length){Ud();for(b=0;b<Uc.length;b++)Ae(Uc[b],"","magenta",!1,"t");ze=!0}if(Ge&&(ze||0<Uc.length)){q=Uc.slice(0);if(0<sa.length&&0<q.length)for(b=0;b<q.length;b++){for(c=0;c<sa.length;c++)if(sa[c].M.includes(q[b])||sa[c].L.includes(q[b]))Yg(c),c--;q.splice(b,1);b--}for(b=1;b<g.length;b++)g[b].v=0,Uc.includes(g[b].t)&&(g[b].v=1);Nj(1);
Xc()}break}if(xf&&e){if("reactant"===Zf){for(b=0;b<g.length;b++)g[b].v=0;Uc=[]}b=il(Lg);if(0<b)if("reactant"===Zf)V.clearRect(za.b,za.t,za.c,za.h),Fe=Uc.slice(0),$g(Fe,1),jl=Fd(g,1,"s"),V.clearRect(za.b,za.t,za.c,za.h),1===Xb-17?Ae(1,"reactant(s)","blue",!0,"s"):Ae(1,"arrow start","blue",!0,"s"),Zf="product";else if("product"===Zf)if(0<Fe.length&&Uc.length>Fe.length){cf=Uc.slice(Fe.length);if(0===cf.length){a();Kb();return}$g(cf,2);kl=Fd(g,2,"s");V.clearRect(za.b,za.t,za.c,za.h);1===Xb-17?(Ae(2,"reactant(s)",
"blue",!0,"s"),Ae(2,"product(s)","green",!0,"s")):(Ae(2,"arrow start","blue",!0,"s"),Ae(2,"arrow end","green",!0,"s"));V.restore();Zf="arrow"}else{a();Kb();return}else{a();Kb();return}else{a();Kb();return}if("arrow"===Zf&&0<Fe.length&&0<cf.length){V.clearRect(za.b,za.t,za.c,za.h);re=[];Yj(Fe,cf,jl,kl);1===Xb-17?(Ae(1,"reactant(s)","blue",!0,"s"),Ae(2,"product(s)","green",!0,"s")):(Ae(1,"arrow start","blue",!0,"s"),Ae(2,"arrow end","green",!0,"s"));sa.push(new ij(Fe,cf,Xb-17,"","",re[0],re[1],re[2],
re[3]));for(b=1;b<g.length;b++)1===g[b].v&&g[b].za.push(sa.length-1),2===g[b].v&&g[b].ya.push(sa.length-1),g[b].v=0;b=sa.length-1;b=0;Zf="reactant";Fe=[];cf=[];Uc=[];Xc();Ud();ed();wb(Ga,0,!0)}}else if(xf){a();Kb();return}Ge&&e&&(Nj(1),Xc());if(!e){V.clearRect(za.b,za.t,za.c,za.h);a();Kb();return}vb="";break;case "moveTree":case "moveSelMol":Uc=[];for(b=1;b<g.length;b++)1===g[b].v&&(g[b].x+=je,g[b].y+=ke,Uc.includes(g[b].t)||Uc.push(g[b].t));if(0<sa.length){q=[];Fe=[];cf=[];for(b=0;b<sa.length;b++)Fe=
Fh(sa[b].M,Uc),cf=Fh(sa[b].L,Uc),(0<Fe.length||0<cf.length)&&q.push(b);if(0<q.length)for(b=0;b<q.length;b++)ll(q[b])}V.clearRect(za.b,za.t,za.c,za.h);wb(Ga,0,!0);Xj();Xc();ed();Fe=[];cf=[];Uc=[];Kb();vb="";break;case "copyTree":case "copySelMol":q=[];D=[];f=g.length;t=aa.length;for(b=0;b<f;b++)1===g[b].v&&(e=g.length,qi(g,g,b,e),g[e].za=[],g[e].ya=[],q.push(b),D.push(e),g[e].x=g[b].x+je,g[e].y=g[b].y+ke);for(b=0;b<f;b++)if(1===g[b].v){e=c=-1;for(l=0;l<g[b].a.length;l++)e=g[b].a[l].p,c=q.indexOf(e),
e=q.indexOf(b),-1<c&&-1<e&&(c=D[c],g[D[e]].a[l].p=c);e=c=-1;for(l=0;l<t;l++)if(aa[l].f===b){var y=aa.length;ri(aa,aa,l,y);e=q.indexOf(b);aa[y].f=D[e];c=q.indexOf(aa[l].g);-1<c&&-1<e&&(aa[y].g=D[c])}}V.clearRect(za.b,za.t,za.c,za.h);vb="";Kb();wb(Ga,0,!0);Xj();Xc();ed();break;case "rotateTree":e=ia(180*Math.atan2(Vc-Zd,Be-Zc)/Math.PI);for(b=1;b<g.length;b++)1===g[b].v&&(t=ia(180*Math.atan2(g[b].x-Zd,Be-g[b].y)/Math.PI),c=Math.sqrt((g[b].x-Zd)*(g[b].x-Zd)+(g[b].y-Be)*(g[b].y-Be)),f=c*Math.sin(Math.PI*
ia(t+e)/180),t=-c*Math.cos(Math.PI*ia(t+e)/180),g[b].x=Zd+f,g[b].y=Be+t);V.clearRect(za.b,za.t,za.c,za.h);b=Fd(g,1,"s");Uj(b,ra)||Oj();for(c=1;c<g.length;c++)1===g[c].v&&Mf(g,c);wb(Ga,0,!0);ed();Kb();vb="";Xc();break;case "provArrowDraw":b=Yd(g,aa,Vc,Zc);q=Yd(g,aa,dc,ec);0!==q&&0!==b&&q!==b&&(0<q&&0<b&&(qe.includes(g[b].o)||qe.includes(g[q].o))||0>q&&(qe.includes(g[aa[Math.abs(q)].f].o)||qe.includes(g[aa[Math.abs(q)].g].o))||0>b&&(qe.includes(g[aa[Math.abs(b)].f].o)||qe.includes(g[aa[Math.abs(b)].g].o))?
(Ud(),Xc()):(b=new jj(q,b,"",0),b.ca=16===Xb?"f":"h",b.crv=Vj,Pa.push(b),ed()));wb(Ga,0,!0);Kb();vb="";break;default:Ud(),Xc()}Kb()}}}else Kb();else wb(Ga,0,!0),Kb()}function Kb(){cc.style.cursor="default";Mg("erase");Mg("mark");fj=gj=yh=zh=$e=ei=Ig=$d=dj=Zi=di=$i=!1;Vj=og=0;Vi=lg=Zh=!1;ai=-1;pe=Zg=sf=0;Hg=-1;Gg=mb=bb=hb=0;pg=-1;Be=Zd=ke=je=ae=0;Ch=1}function jm(a){var b=document.getElementById("igc").getContext("2d");Yi(a);H=Fd(g,1,"s");Ic(za,H.b,H.t-Jc-2)&&Ic(za,H.b+H.c,H.t+H.h)?(wb(b,1,!1),b.bb=
1,b.strokeRect(H.b,H.t,H.c,H.h),Zd=H.b+H.c/2,Be=H.t+H.h/2,b.lineWidth=da?2:1,b.strokeStyle="magenta",b.fillStyle="magenta",b.font="10px Arial",b.save(),b.beginPath(),b.arc(Zd,Be,4,0,2*Math.PI),b.stroke(),b.beginPath(),b.arc(Zd,Be,2,0,2*Math.PI),b.fill(),b.beginPath(),b.moveTo(H.b+H.c/2-Jc-4,H.t-Jc-2),b.lineTo(H.b+H.c/2-Jc+2,H.t-Jc+6),b.lineTo(H.b+H.c/2-Jc+4,H.t-Jc-4),b.closePath(),b.fill(),b.beginPath(),b.moveTo(H.b+H.c/2+Jc-4,H.t-Jc-4),b.lineTo(H.b+H.c/2+Jc-2,H.t-Jc+6),b.lineTo(H.b+H.c/2+Jc+4,H.t-
Jc-2),b.closePath(),b.fill(),b.beginPath(),b.arc(Zd,H.t-Jc,Jc,0,2*Math.PI),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c/2,H.t+H.h),b.lineTo(H.b+H.c/2,H.t+H.h+30),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c/2-20,H.t+H.h+15),b.bezierCurveTo(H.b+H.c/2-20,H.t+H.h+5,H.b+H.c/2+20,H.t+H.h+5,H.b+H.c/2+20,H.t+H.h+15),b.bezierCurveTo(H.b+H.c/2+20,H.t+H.h+25,H.b+H.c/2-20,H.t+H.h+25,H.b+H.c/2-20,H.t+H.h+15),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c/2+20,H.t+H.h+16),b.lineTo(H.b+H.c/2+16,H.t+H.h+24),b.lineTo(H.b+H.c/
2+12,H.t+H.h+16),b.closePath(),b.fill(),b.beginPath(),b.strokeStyle="white",b.lineWidth="3",b.moveTo(H.b+H.c/2,H.t+H.h+15),b.lineTo(H.b+H.c/2,H.t+H.h+22),b.stroke(),b.restore(),b.fillText("180\u00b0",H.b+H.c/2-10,H.t+H.h+38),b.beginPath(),b.moveTo(H.b+H.c,H.t+H.h/2),b.lineTo(H.b+H.c+30,H.t+H.h/2),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c+15,H.t+H.h/2-20),b.bezierCurveTo(H.b+H.c+5,H.t+H.h/2-20,H.b+H.c+5,H.t+H.h/2+20,H.b+H.c+15,H.t+H.h/2+20),b.bezierCurveTo(H.b+H.c+25,H.t+H.h/2+20,H.b+H.c+25,H.t+H.h/
2-20,H.b+H.c+15,H.t+H.h/2-20),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c+16,H.t+H.h/2+20),b.lineTo(H.b+H.c+24,H.t+H.h/2+16),b.lineTo(H.b+H.c+16,H.t+H.h/2+12),b.closePath(),b.fill(),b.beginPath(),b.strokeStyle="white",b.lineWidth="3",b.moveTo(H.b+H.c+15,H.t+H.h/2),b.lineTo(H.b+H.c+22,H.t+H.h/2),b.stroke(),b.fillStyle="magenta",b.font="10px Arial",b.fillText("180\u00b0",H.b+H.c+32,H.t+H.h/2+3),b.restore(),ze=!0):b.clearRect(za.b,za.t,za.c,za.h)}function $k(a,b,c,e,l,f){"erase"===f?Dg(a):(a.save(),a.strokeStyle=
"magenta",a.lineWidth=Ee,Ic(za,e,l)&&(a.beginPath(),a.moveTo(b,c),a.lineTo(e,l),a.stroke()),a.restore())}function al(a,b,c,e,l){var f;if("erase"===l)Dg(Ac);else{var t=Ee;for(f=0;f<g[b].a.length;){var q=g[b].a[f].p;var D=g[b].a[f].t;l=g[q].x;q=g[q].y;xh(a,l,q,c,e,D,t,"magenta");f++}}}function bl(a,b,c,e,l){var f;if("erase"===l)Dg(a);else{var t=Ee;l=aa[b].f;var q=aa[b].g;xh(a,g[l].x+c,g[l].y+e,g[q].x+c,g[q].y+e,aa[b].B,t,"magenta");b=Yd(g,aa,g[l].x+c,g[l].y+e);var D=Yd(g,aa,g[q].x+c,g[q].y+e);0<b&&
b!==l&&b!==q&&0===D?(Fg(g[b].x,g[b].y),sf=b):0<D&&D!==q&&D!==l&&0===b?(Fg(g[D].x,g[D].y),sf=D):0<D&&0<b&&b!==l&&D!==q?(Fg(g[D].x,g[D].y),Fg(g[b].x,g[b].y)):0===b&&0===D&&0<sf&&(sf=0,Ud());for(f=0;f<g[l].a.length;){if(g[l].a[f].p!==q){var y=g[l].a[f].p;D=g[l].a[f].t;b=g[y].x;y=g[y].y;xh(a,b,y,g[l].x+c,g[l].y+e,D,t,"magenta")}f++}for(f=0;f<g[q].a.length;)g[q].a[f].p!==l&&(y=g[q].a[f].p,D=g[q].a[f].t,b=g[y].x,y=g[y].y,xh(a,b,y,g[q].x+c,g[q].y+e,D,t,"magenta")),f++}}function wf(a,b,c,e,l,f){var t=!1;
var q=!0,D=[0,0,0,-.5*na,-.5*na,-.5*na,0,0,0,0,0,0,0],y=[0,0,0,-.28868*na,.5*na,-.80902*na,na,0,0,0,0,0,0];var A=0<l?!0:!1;if("erase"===f){var wa=Ee+2;var Ea="white"}else"draw"===f&&(wa=Ee,Ea="magenta");if(!(1<g.length&&"atom"===e&&c!=mb)){0>b&&(Ng=t=!0,b=Math.abs(b));var fa=b;"bond"===e&&(fa=b-1);l=360/b;var Na=(180-l)/2;var ua=Math.pow(-1,b)*Na;6===b&&(ua=90);if("freespace"===e&&"test"===f){var xb=dc+D[b];var Ua=ec+y[b]}if("atom"===e){if(0<c&&2===g.length)xb=g[c].x,Ua=g[c].y;else if(0<c&&1===g[c].a.length){xb=
g[c].x;Ua=g[c].y;t=g[c].a[0].p;var La=g[t].x;t=g[t].y;ua=ld(La,t,xb,Ua)}else if(0<c&&2===g[c].a.length&&!1===t)xb=g[c].x,Ua=g[c].y,ua=Gh(g,c);else return;La=c}"bond"===e&&0<aa[c].B&&(e=aa[c].f,La=aa[c].g,xb=g[e].x,Ua=g[e].y,ua=Ya(g,e,La),Na=180-360/b,A||(Na*=-1,l*=-1));b=ia(ua-Na);Od=xb;Pd=Ua;"test"!==f&&(a.save(),a.lineWidth=wa,a.strokeStyle=Ea,a.beginPath(),a.moveTo(Od,Pd));for(wa=0;wa<fa-1;wa++){Ea=na*Math.cos(Math.PI*b/180);c=-1*na*Math.sin(Math.PI*b/180);Gc=xb+Ea;Hc=Ua+c;if("test"===f){if(q=
Ic(ra,Gc,Hc),!1===q)return Ng=!1,q}else a.lineTo(Gc,Hc);b=ia(b+l);xb=Gc;Ua=Hc;Od=Gc;Pd=Hc}"test"!==f&&(a.lineTo(g[La].x,g[La].y),a.stroke(),a.restore());Ng=!1;return q}}function We(a,b,c,e,l,f,t){a.save();"draw"===t?(a.lineWidth=Ee,a.strokeStyle="black",a.fillStyle="black"):"erase"===t?(a.lineWidth=Ee+2,a.strokeStyle="white",a.fillStyle="white"):"prov"===t&&(a.lineWidth=Ee,a.strokeStyle="magenta",a.fillStyle="magenta");a.beginPath();a.moveTo(b,c);a.lineTo(e,l);a.stroke();if(f){f=Ig?String(Aa.length-
1):String(Aa.length);var q=Aa.length-1;if(Aa.length>q&&0<q){var D=ld(Aa[q].x,Aa[q].y,Aa[q-1].x,Aa[q-1].y);e=ld(Aa[q].x,Aa[q].y,e,l);e=ia(Zj(D,e)+180)}else e=1===Aa.length&&0===q?270:-1;l=2===f.length?2*L:1.5*L;e=ak(l,e);a.font="12pt Calibri";"erase"===t?a.strokeText(f,ml,nl):"prov"===t&&(a.fillText(f,b+e.x-si*f.length/2,c+e.y+L/2),ml=b+e.x-si*f.length/2,nl=c+e.y+L/2)}a.restore()}function dl(a,b,c,e,l,f,t,q){var D;var y=1;var A=na*Math.cos(Math.PI*ia(l+y*f*30)/180);y=-na*Math.sin(Math.PI*ia(l+y*f*
30)/180);a.save();"draw"===q?(a.lineWidth=Ee,a.strokeStyle="magenta",a.fillStyle="magenta"):"erase"===q&&(a.lineWidth=Ee+2,a.strokeStyle="white",a.fillStyle="white");a.beginPath();a.moveTo(c,e);for(D=0;D<b;D++)a.lineTo(c,e),y=0===D%2?1:-1,A=na*Math.cos(Math.PI*ia(l+y*f*30)/180),y=-na*Math.sin(Math.PI*ia(l+y*f*30)/180),c+=A,e+=y;a.stroke();t&&(l=0>A?-8:4,0<hb?D=b-1:D=b,a.font="12pt Calibri","erase"===q&&a.strokeText(D,c-A+l,e-y),a.fillText(D,c-A+l,e-y));a.restore()}function Yi(a){var b;for(b=0;b<g.length;b++)g[b].v=
0;lc=[];a=Hh(g,a);for(b=0;b<a;b++)g[lc[b]].v=1}function il(a){var b;for(b=0;b<a.length;b++)Uc.includes(g[a[b]].t)||Uc.push(g[a[b]].t);return Uc.length}function Ae(a,b,c,e,l){V.save();H=Fd(g,a,l);V.strokeStyle=c;e&&V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);V.fillStyle=c;V.fillText(b,H.b,H.t-2);V.restore()}function ol(a,b,c,e,l,f){var t;for(t=1;t<a.length;t++){if(-1===b||a[t].v===b)a[t].x=c+(a[t].x-c)*l,a[t].y=e+(a[t].y-e)*l;f&&(a[t].v=0)}}function pl(a,b,c,e){var l;if(0===a.length)return-1;
for(l=0;l<a.length;l++)a[l].W.x=b+(a[l].W.x-b)*e,a[l].W.y=c+(a[l].W.y-c)*e,a[l].V.x=b+(a[l].V.x-b)*e,a[l].V.y=c+(a[l].V.y-c)*e}function ql(a,b,c,e){var l;if(0===a.length)return-1;for(l=0;l<a.length;l++)a[l].b=b+(a[l].b-b)*e,a[l].t=c+(a[l].t-c)*e,a[l].c=a[l].c*e,a[l].h=a[l].h*e}function Pj(a){var b="";pb();ti=a;"x"===a?b="Enter Element Symbol:":"n"===a&&(b="Number of Atoms in ring:");document.getElementById("xheader").innerHTML=b;Ih.style.visibility="visible";Ih.addEventListener("click",function(c){c.preventDefault()},
!1);Ih.addEventListener("mouseup",function(c){c.preventDefault()},!1);Of.focus();"x"===Of.value&&(Of.value="",Of.blur());Of.focus();km.addEventListener("click",function(c){var e=Of.value;c.preventDefault();"x"===ti?rl(e):"n"===ti&&Wh(e);Of.value="";Of.blur();pd();Ih.style.visibility="hidden"},!1);Ih.addEventListener("keypress",function(c){if(13===c.which){var e=Of.value;c.preventDefault();"x"===ti?rl(e):"n"===ti&&Wh(e);Of.value="";Of.blur();pd();Ih.style.visibility="hidden"}},!1)}function fm(a){pb();
gh.style.visibility="visible";Jh.value=void 0===sa[a].na?"":sa[a].na;ui.value=void 0===sa[a].Aa?"":sa[a].Aa;Jh.focus();gh.addEventListener("click",function(b){b.preventDefault()},!1);gh.addEventListener("mouseup",function(b){b.preventDefault()},!1);sl.addEventListener("click",function e(c){tl(a,Jh.value+"|"+ui.value);c.preventDefault();Jh.blur();ui.blur();sl.removeEventListener("click",e,!1);pd();gh.style.visibility="hidden";ed();Kb();wb(Ga,0,!0)},!1);gh.addEventListener("keypress",function l(e){13===
e.which&&(tl(a,Jh.value+"|"+ui.value),e.preventDefault(),Jh.blur(),ui.blur(),gh.removeEventListener("keypress",l,!1),pd(),gh.style.visibility="hidden",ed(),Kb(),wb(Ga,0,!0))},!1)}function tl(a,b){var c=b.split("|");b=c[0];c=c[1];sa[a].na=b?b.trim():"";sa[a].Aa=c?c.trim():""}function Sk(){function a(l){pb();ce.rows=String(Math.floor(l.length/ce.cols)+2);ce.value=l;Yf.style.visibility="visible";Vh=!0;Yf.addEventListener("click",function(f){f.preventDefault();ce.select();ce.selectionStart=0;ce.selectionEnd=
ce.value.length},!1);Yf.addEventListener("mouseup",function(f){f.preventDefault()},!1);ce.addEventListener("onfocus",function(f){f.preventDefault();ce.select();ce.selectionStart=0;ce.selectionEnd=ce.value.length},!1);ce.focus();ce.selectionStart=0;ce.selectionEnd=ce.value.length;lm.addEventListener("click",function(){pd();Yf.style.visibility="hidden";Vh=!1},!1);Yf.addEventListener("keypress",function(f){13===f.which&&(ce.selectionStart=0,ce.selectionEnd=0,ce.blur(),pd(),Yf.style.visibility="hidden",
Vh=!1,td(0),qd(0))},!1)}var b=0,c=0,e=[];b=0;if(1<g.length)if(b=bk(),1===b&&0===Kc.length)a(Ld),Eg=!1,wb(Ga,0,!0);else if(1===b&&0<Kc.length){wb(Ga,0,!0);for(b=0;b<Kc.length;b++)vi(V,Q,Kc[b]);alert("WARNING:\nThe drawing of one or more stereogenic centres\nis ambiguous or inconsistent!\n\nCorrect the stereo-drawing of the centers marked by red squares and try again.\n\nThe red squares disappear with the next drawing action");Kc=[]}else{if(-1===b)if(0<wi.length)for(c=0;c<wi.length;c++){e=[];for(b=
0;b<cb[wi[c]].length;b++)e.push(Q[cb[wi[c]][b]].Ca);mm(g,aa,e);b=bk();if(1===b&&0===Kc.length){a(Ld);Eg=!1;wb(Ga,0,!0);break}else if(1===b&&0<Kc.length){wb(Ga,0,!0);for(b=0;b<Kc.length;b++)vi(V,Q,Kc[b]);alert("WARNING:\nThe drawing of one or more stereogenic centres\nis ambiguous or inconsistent!\n\nCorrect the stereo-drawing of the centers marked by red squares and try again.\n\nThe red squares disappear with the next drawing action");Kc=[];break}else alert("SMILES GENERATION FAILED because no ring closure over a single bond is possible in this structure!")}else alert("SMILES GENERATION FAILED because no ring closure over a single bond is possible in this structure!")}else alert("No atoms yet, empty SMILES code!")}
function nm(){pb();document.getElementById("smixheader").innerHTML="Enter SMILES Code";Xf.style.visibility="visible";Xf.addEventListener("click",function(a){a.preventDefault()},!1);Xf.addEventListener("mouseup",function(a){a.preventDefault()},!1);yf.focus();om.addEventListener("click",function(a){var b=yf.value;""===b?a.preventDefault():(a.preventDefault(),$f=b,td(0),qd(0),be="X",hh(be),ck($f.trim()));$f="";yf.value="";yf.blur();pd();Xf.style.visibility="hidden"},!1);pm.addEventListener("click",function(a){a.preventDefault();
$f="";yf.value="";yf.blur();pd();Xf.style.visibility="hidden"},!1);qm.addEventListener("click",function(a){var b=yf.value;""===b?a.preventDefault():(a.preventDefault(),$f=b,Ui(),td(0),qd(0),be="X",hh(be),wb(Ga,0,!0),ck($f.trim()));$f="";yf.value="";yf.blur();pd();Xf.style.visibility="hidden"},!1);Xf.addEventListener("keypress",function(a){if(13===a.which){var b=yf.value;""===b?a.preventDefault():(a.preventDefault(),$f=b,Ui(),td(0),qd(0),be="X",hh(be),ck($f.trim()));$f="";yf.value="";yf.blur();pd();
Xf.style.visibility="hidden"}},!1)}function Wh(a){null!==a&&""!==a&&(9<parseInt(a,10)||3>parseInt(a,10)?(alert("Only rings from 3 to 9 atoms supported by ring tools\n\nFor larger rings use general chain tool."),Ve=0):(Ve=parseInt(a,10),qd(10)))}function rl(a){var b=0,c=!1;if(null!==a&&""!==a){var e=qe.indexOf(a);-1<e&&(be=a,c=!0);e=dk.indexOf(a);-1<e&&(be=a,c=!0);c||(e=a.match(/(\d{1,3})([A-Z]{1}[a-z]{0,1}:{0,1})/),null!==e&&(a=e[2],b=parseInt(e[1],10)),2<a.length&&(a=a.substr(0,2)),a=a.match(rm),
null!==a&&(c=!0,be=0<b?String(b)+a[0]:a[0]));c?hh(be):alert("Not a valid symbol!")}}function Wj(){var a,b=0,c=be;""===vb?2===g.length||1===zb%2?a=g.length-1:a=mb:"provBondDraw"===vb&&(a=g.length-1);var e=c.match(/(\d{1,3})([A-Z]{1}[a-z]{0,1}:{0,1})/);null!==e&&(c=e[2],b=parseInt(e[1],10));"D"===c&&(b=2,g[a].j=1,c=g[a].o="H");"T"===c&&(b=3,g[a].j=1,c=g[a].o="H");if(c!==g[a].o||2===b||3===b)if(!qe.includes(c)||1>=g[a].a.length)if(""===vb&&0<g[a].a.length&&(1===g[a].j&&0===g[a].N&&1!==g[g[a].a[0].p].j&&
0<g[g[a].a[0].p].C&&--g[g[a].a[0].p].C,1===g[a].j&&2===g[a].N&&1!==g[g[a].a[0].p].j&&0<g[g[a].a[0].p].D&&--g[g[a].a[0].p].D,1===g[a].j&&3===g[a].N&&1!==g[g[a].a[0].p].j&&0<g[g[a].a[0].p].F&&--g[g[a].a[0].p].F),g[a].o=c,g[a].j=mi(c),1===g[a].j)if(0===b)for(e=0;e<g[a].a.length;e++)g[g[a].a[e].p].C+=1;else if(2===b)for(e=0;e<g[a].a.length;e++)g[g[a].a[e].p].D+=1;else if(3===b)for(e=0;e<g[a].a.length;e++)g[g[a].a[e].p].F+=1;g[a].N=b;1===zb%2&&(zb--,document.getElementById("alt").className="alt");ed();
Kb();wb(Ga,0,!0)}function qd(a){Mg("erase");10===Xb&&10!==a&&(ul("n"),Ve=0);Xb=a;0<=a&&4>=a?(tf=!0,xf=qg=Ge=Lf=vf=bf=!1):5<=a&&10>=a?(tf=!1,bf=!0,xf=qg=Ge=Lf=vf=!1):11===a?(vf=bf=tf=!1,Lf=!0,xf=qg=Ge=!1):12===a?(bf=tf=!1,vf=!0,xf=qg=Ge=Lf=!1):13===a?(Lf=vf=bf=tf=!1,Ge=!0,xf=qg=!1):14<=a&&17>=a?(Ge=Lf=vf=bf=tf=!1,qg=!0,xf=!1):18<=a&&21>=a&&(qg=Ge=Lf=vf=bf=tf=!1,xf=!0);(bf||vf||Lf||Ge)&&0!==He&&td(0);tf&&ni&&td(0);Mg("mark");10===a&&(0===Ve?Pj("n"):2<Ve&&10>Ve&&ul(String(Ve)))}function td(a){0!==a&&
(bf||Lf||vf||qg||xf)&&qd(0);10===He&&10!==a&&"X"!==be&&hh("X");He=a;0<=a&&10>a?(ng=!0,ni=uf=!1):10===a?(ng=!1,uf=!0,ni=!1):10<a&&(uf=ng=!1,ni=!0);Mg("erase");Mg("mark")}function Zk(a,b){var c;if(0===Uc.length)return 0;for(c=1;c<=rf;c++)if(Ic(sd[c],a,b)&&Uc.includes(c))return c;return 0}function Uj(a,b){return a.t>b.t&&a.b>b.b&&a.b+a.c<b.b+b.c&&a.t+a.h<b.t+b.h}function Xj(){var a,b,c=[];for(a=1;a<g.length;a++)if(1===g[a].v)for(b=1;b<g.length;b++)if(b!==a){var e=Math.sqrt((g[b].x-g[a].x)*(g[b].x-g[a].x)+
(g[b].y-g[a].y)*(g[b].y-g[a].y));e<=$a&&c.push(a)}if(0<c.length)for(a=0;a<c.length;a++)vi(Ga,g,c[a])}function el(a,b){var c;for(c=0;c<Aa.length;c++){var e=Math.sqrt((a-Aa[c].x)*(a-Aa[c].x)+(b-Aa[c].y)*(b-Aa[c].y));if(e<=$a)return c}return-1}function Wk(a,b){var c;for(c=0;c<Pa.length;c++){if(0<Pa[c].G){var e=g[Pa[c].G].x;var l=g[Pa[c].G].y}else 0>Pa[c].G&&(l=-1*Pa[c].G,e=(g[aa[l].f].x+g[aa[l].g].x)/2,l=(g[aa[l].f].y+g[aa[l].g].y)/2);if(0<Pa[c].K){var f=g[Pa[c].K].x;var t=g[Pa[c].K].y}else 0>Pa[c].K&&
(t=-1*Pa[c].K,f=(g[aa[t].f].x+g[aa[t].g].x)/2,t=(g[aa[t].f].y+g[aa[t].g].y)/2);var q=ld(e,l,f,t);var D=Math.sqrt((f-e)*(f-e)+(t-l)*(t-l));var y=.8*na/D;var A=-1*Pa[c].crv*y*D*Math.sin(Math.PI*q/180);D=-1*Pa[c].crv*y*D*Math.cos(Math.PI*q/180);q=e+A;y=l+D;A=f+A;D=t+D;A=(q+A+e+f)/4+.25*(q-e);y=(y+D+l+t)/4+.25*(y-l);y=Math.sqrt((a-A)*(a-A)+(b-y)*(b-y));if(y<$a)return c}return-1}function Xk(a,b){var c;for(c=0;c<sa.length;c++){var e=(sa[c].W.x+sa[c].V.x)/2;var l=(sa[c].W.y+sa[c].V.y)/2;e=Math.sqrt((a-e)*
(a-e)+(b-l)*(b-l));if(e<$a)return c}return-1}function Mg(a){var b=document.getElementById("can").getContext("2d");b.save();if("erase"===a)b.strokeStyle="white",b.lineWidth=7,b.beginPath(),b.moveTo(hc.b,hc.t+hc.h+4),b.lineTo(hc.b+hc.c,hc.t+hc.h+4),b.stroke(),b.beginPath(),b.moveTo(Nc.b-4,Nc.t),b.lineTo(Nc.b-4,Nc.t+Nc.h),b.stroke(),b.beginPath(),b.moveTo(sc.b,sc.t+sc.h+4),b.lineTo(sc.b+sc.c,sc.t+sc.h+4),b.stroke();else if("mark"===a){var c=He;var e=Xb;b.strokeStyle="red";b.lineWidth=5}b.beginPath();
b.moveTo(hc.b+hc.c/14*c,hc.t+hc.h+4);b.lineTo(hc.b+hc.c/14*(c+1),hc.t+hc.h+4);b.stroke();14<=e&&21>=e?(b.beginPath(),b.moveTo(sc.b+sc.c/8*(e-14),sc.t+sc.h+4),b.lineTo(sc.b+sc.c/8*(e-13),sc.t+sc.h+4)):(b.beginPath(),b.moveTo(Nc.b-5,Nc.t+e*Nc.h/14),b.lineTo(Nc.b-5,Nc.t+(e+1)*Nc.h/14-2));b.stroke();b.restore()}function Fg(a,b){V.save();da&&(V.fillStyle="rgba(255,0,0,0.1)",V.beginPath(),V.arc(a,b,3*ek,0,2*Math.PI),V.fill());V.lineWidth=da?2:1;V.strokeStyle="red";V.beginPath();V.arc(a,b,ek,0,2*Math.PI);
V.stroke();V.restore()}function Uk(a){var b=(g[aa[a].f].x+g[aa[a].g].x)/2;a=(g[aa[a].f].y+g[aa[a].g].y)/2;V.save();da&&(V.fillStyle="rgba(0,0,255,0.1)",V.beginPath(),V.arc(b,a,3*Xi,0,2*Math.PI),V.fill());V.lineWidth=da?2:1;V.strokeStyle="blue";V.beginPath();V.arc(b,a,Xi,0,2*Math.PI);V.stroke();V.restore()}function vi(a,b,c){var e=b[c].x;b=b[c].y;a.save();a.beginPath();a.lineWidth=2;a.strokeStyle="red";a.strokeRect(e-$a-2,b-$a-2,2*$a+4,2*$a+4);a.restore()}function ul(a){Ga.save();Ga.beginPath();Ga.arc(Nc.b+
34*oe/2,Nc.t+378*oe,8,0*Math.PI,2*Math.PI);Ga.fillStyle="white";Ga.fill();Ga.font="10pt sans-serif";Ga.fillStyle="black";Ga.fillText(a,Nc.b+34*oe/2-a.length/2*8,Nc.t+378*oe+4);Ga.restore()}function hh(a){var b=hc.b+10*hc.c/14+4,c=hc.t+hc.h-6,e=0,l=0;var f=a.match(/(\d{1,3})([A-Z]{1}[a-z]{0,1}:{0,1})/);null!==f?(a=f[2],f=f[1]):f="";Ga.save();Ga.fillStyle="white";Ga.fillRect(b,hc.t+3,hc.c/14-7,hc.h-6);Ga.fillStyle="X"===a?"black":"red";if(""!==f){Ga.font="9pt sans-serif";var t=Ga.measureText(f);e=2;
l=.5*(hc.h-6);Ga.fillText(f,b+e,c-l);e+=t.width;l=(hc.h-6-19)/2}Ga.font="14pt sans-serif";""===f&&(e=(hc.c/14-7-Ga.measureText(a).width)/2,l=(hc.h-6-19)/2);if(2<f.length||3<f.length+a.length)e=hc.c/14-6-Ga.measureText(a).width,l=0;Ga.fillText(a,b+e,c-l);Ga.restore()}function Rk(){var a,b=[7,7,7,7,7,7,7,10,10,5,7,5,7,7],c=hc.b,e=Nc.b+Nc.c+8;jd.save();jd.clearRect(0,0,Ue.width,Ue.height);jd.font="12pt Sans-Serif";jd.fillStyle="blue";for(a=0;a<fk.length;a++)jd.fillText(fk[a],c+38*a+18-b[a],hc.t+36+25);
for(a=0;a<fk.length;a++)jd.fillText(sm[a],c+38*a+18-b[a],hc.t+36+42);for(a=0;a<gk.length;a++)jd.font="l"===gk[a]?"italic 14pt serif":"12pt Sans-Serif",jd.fillText(gk[a],e,Nc.t+4+36*a+20);jd.font="12pt Sans-Serif";jd.fillText("q",Nc.b-3+18,Nc.t-12);da?(jd.fillText("E",60,sc.t+60),jd.fillText("backsp",115,sc.t+60),jd.fillText("g",220,sc.t+60),jd.fillText("H",400,sc.t+60),jd.fillText("!",dd.b-10,dd.t+20)):(jd.fillText("E",60,sc.t+110),jd.fillText("backsp",130,sc.t+110),jd.fillText("g",240,sc.t+110),
jd.fillText("H",445,sc.t+110),jd.fillText("!",dd.b+dd.c/2,sc.t+53));jd.save();jd.strokeStyle="blue";jd.lineWidth=1;jd.beginPath();jd.moveTo(Nc.b+18+8,hc.t-12);jd.lineTo(hc.b,hc.t);jd.moveTo(Nc.b-3+22,hc.t-10);jd.lineTo(Nc.b-3+22,hc.t+4);jd.stroke();jd.restore()}function Tk(a){0===a?Ue.style.visibility="hidden":1===a&&(Ue.style.visibility="visible")}function wb(a,b,c){var e;Dg(a);Ud();Dg(Ac);if(1!==g.length){var l=1===b?"magenta":"black";if(2<=aa.length)for(e=1;e<aa.length;e++){var f=aa[e].f;var t=
aa[e].g;if(1===b&&(1===g[f].v||1===g[t].v)||"moveAllMol"===vb||0===b){var q=g[f].x;f=g[f].y;var D=g[t].x;t=g[t].y;var y=aa[e].B;xh(a,q,f,D,t,y,Ee,l)}}q=1===b?"magenta":"black";for(e=1;e<g.length;e++)(1===b&&1===g[e].v||"moveMol"===vb||0===b)&&tm(a,e,q);if(0<Pa.length&&c)for(e=0;e<Pa.length;e++){b=a;var A=Pa[e].G;var wa=Pa[e].K;q=Pa[e].ca;l=Pa[e].crv;y=t=D=f=0;0>A?(f=(g[aa[-1*A].f].x+g[aa[-1*A].g].x)/2,D=(g[aa[-1*A].f].y+g[aa[-1*A].g].y)/2):0<A&&(f=g[A].x,D=g[A].y);0>wa?(t=(g[aa[-1*wa].f].x+g[aa[-1*
wa].g].x)/2,y=(g[aa[-1*wa].f].y+g[aa[-1*wa].g].y)/2):0<wa&&(t=g[wa].x,y=g[wa].y);var Ea=ld(f,D,t,y);A=ia(Ea-90*l);var fa=Math.sqrt((t-f)*(t-f)+(y-D)*(y-D));var Na=.8*na/fa;wa=-1*l*Na*fa*Math.sin(Math.PI*Ea/180);Na=-1*l*Na*fa*Math.cos(Math.PI*Ea/180);Ea=f+wa;fa=D+Na;wa=t+wa;Na=y+Na;b.save();b.lineWidth=Ee;b.strokeStyle="red";b.fillStyle="red";b.beginPath();b.moveTo(f,D);b.bezierCurveTo(Ea,fa,wa,Na,t,y);b.stroke();b.beginPath();b.moveTo(t,y);b.lineTo(t-8*Math.cos(Math.PI*ia(A-30*l)/180),y+8*Math.sin(Math.PI*
ia(A-30*l)/180));"f"===q&&(b.moveTo(t,y),b.lineTo(t-8*Math.cos(Math.PI*ia(A+45*l)/180),y+8*Math.sin(Math.PI*ia(A+45*l)/180)));b.stroke();b.restore()}if(0<sa.length&&c)for(e=0;e<sa.length;e++)c=a,b=e,q=new Yc(sa[b].W.x,sa[b].W.y),l=new Yc(sa[b].V.x,sa[b].V.y),y=sa[b].ca,t=new Yc(0,0),D=0,f=ld(q.x,q.y,l.x,l.y),2===y&&(t.x=-1*$a*Math.cos(Math.PI*ia(f-90)/180),t.y=$a*Math.sin(Math.PI*ia(f-90)/180),q=xi(q,t),l=xi(l,t)),c.save(),c.strokeStyle="black",c.fillStyle="black",c.lineWidth=2,c.beginPath(),3===
y&&(c.moveTo(q.x,q.y),c.lineTo(q.x+2*$a*Math.cos(Math.PI*ia(f+30)/180),q.y-2*$a*Math.sin(Math.PI*ia(f+30)/180)),c.moveTo(q.x,q.y),c.lineTo(q.x+2*$a*Math.cos(Math.PI*ia(f-30)/180),q.y-2*$a*Math.sin(Math.PI*ia(f-30)/180))),c.moveTo(q.x,q.y),c.lineTo(l.x,l.y),c.lineTo(l.x-2*$a*Math.cos(Math.PI*ia(f+30)/180),l.y+2*$a*Math.sin(Math.PI*ia(f+30)/180)),c.moveTo(l.x,l.y),c.lineTo(l.x-2*$a*Math.cos(Math.PI*ia(f-30)/180),l.y+2*$a*Math.sin(Math.PI*ia(f-30)/180)),c.stroke(),2===y&&(q=kj(q,t),l=kj(l,t),q=kj(q,
t),l=kj(l,t),c.beginPath(),c.moveTo(l.x,l.y),c.lineTo(q.x,q.y),c.lineTo(q.x+2*$a*Math.cos(Math.PI*ia(f+30)/180),q.y-2*$a*Math.sin(Math.PI*ia(f+30)/180)),c.moveTo(q.x,q.y),c.lineTo(q.x+2*$a*Math.cos(Math.PI*ia(f-30)/180),q.y-2*$a*Math.sin(Math.PI*ia(f-30)/180)),c.stroke(),q=xi(q,t),l=xi(l,t)),""!==sa[b].na&&3!==y&&(c.font=String(L)+"pt sans-serif",c.textBaseline="middle",A=1===y?2*$a:4*$a,D=c.measureText(sa[b].na).width,t=270<f||90>f?1:-1,A=Math.abs(D/2*Math.sin(Math.PI*f/180))+A,c.fillText(sa[b].na,
(q.x+l.x)/2-t*A*Math.sin(Math.PI*f/180)-D/2,(q.y+l.y)/2-t*A*Math.cos(Math.PI*f/180))),""!==sa[b].Aa&&3!==y&&(c.font=String(L)+"pt sans-serif",c.textBaseline="middle",A=1===y?2*$a:4*$a,y=c.measureText(sa[b].Aa).width,t=270<f||90>f?-1:1,A=Math.abs(y/2*Math.sin(Math.PI*f/180))+A,c.fillText(sa[b].Aa,(q.x+l.x)/2-t*A*Math.sin(Math.PI*f/180)-D/2,(q.y+l.y)/2-t*A*Math.cos(Math.PI*f/180))),c.restore();yh=zh=$e=!1}}function xh(a,b,c,e,l,f,t,q){var D=ld(b,c,e,l);var y=Math.PI/2+D/180*Math.PI;D=-1*yi*Math.sin(y);
y=yi*Math.cos(y);0!==f&&(1===f&&(a.beginPath(),a.strokeStyle=q,a.lineWidth=t,a.moveTo(b,c),a.lineTo(e,l),a.stroke()),2===f&&(a.beginPath(),a.strokeStyle=q,a.lineWidth=t,a.moveTo(b+y,c+D),a.lineTo(e+y,l+D),a.stroke(),a.beginPath(),a.moveTo(b-y,c-D),a.lineTo(e-y,l-D),a.stroke()),3===f&&(a.strokeStyle=q,a.lineWidth=t,a.beginPath(),a.moveTo(b,c),a.lineTo(e,l),a.stroke(),a.beginPath(),a.moveTo(b+2*y,c+2*D),a.lineTo(e+2*y,l+2*D),a.stroke(),a.beginPath(),a.moveTo(b-2*y,c-2*D),a.lineTo(e-2*y,l-2*D),a.stroke()),
4===f&&(a.beginPath(),a.fillStyle=q,a.moveTo(b,c),a.lineTo(e-1.5*y,l-1.5*D),a.lineTo(e+1.5*y,l+1.5*D),a.lineTo(b,c),a.fill()),5===f&&(hk?(a.beginPath(),a.strokeStyle=q,a.moveTo(b-y,c-D),a.lineTo(b+y,c+D),a.lineTo(e,l),a.lineTo(b-y,c-D),a.bb=t,a.stroke()):(a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(e-2*y,l-2*D),a.lineTo(e+2*y,l+2*D),a.lineTo(b,c),a.clip(),a.beginPath(),a.strokeStyle=q,a.setLineDash([2,3]),a.moveTo(b,c),a.lineWidth=vl,a.lineTo(e,l),a.stroke(),a.restore())))}function tm(a,b,c){function e(Sb,
Rb){var Lc,tb=.3*L,mc=String(g[Rb].H);Sb.save();Sb.fillStyle="blue";for(Lc=0;Lc<mc;Lc++){var Za=g[Rb].x+La[Lc]*Math.cos(Math.PI*ia(Ua[Lc])/180);var Lb=g[Rb].y-La[Lc]*Math.sin(Math.PI*ia(Ua[Lc])/180);var tc=Za+tb*Math.cos(Math.PI*ia(Ua[Lc]+90)/180);var Ad=Lb-tb*Math.sin(Math.PI*ia(Ua[Lc]+90)/180);Za+=tb*Math.cos(Math.PI*ia(Ua[Lc]-90)/180);Lb-=tb*Math.sin(Math.PI*ia(Ua[Lc]-90)/180);Sb.beginPath();Sb.arc(tc,Ad,2,0,2*Math.PI);Sb.fill();Sb.beginPath();Sb.arc(Za,Lb,2,0,2*Math.PI);Sb.fill()}Sb.restore()}
function l(Sb,Rb,Lc,tb){Sb.save();Sb.font=String(L+2)+"pt";Sb.strokeStyle="black";Sb.lineWidth=1;Sb.beginPath();Sb.arc(Rb,Lc,.6*Sb.measureText("+").width,0,2*Math.PI);Sb.moveTo(Rb-.6*Sb.measureText("+").width,Lc);Sb.lineTo(Rb+.6*Sb.measureText("+").width,Lc);"+"===tb&&(Sb.moveTo(Rb,Lc-.6*Sb.measureText("+").width),Sb.lineTo(Rb,Lc+.6*Sb.measureText("+").width));Sb.stroke();Sb.restore()}var f=0,t="",q=-1,D=new Yc(0,0),y=f=0,A=0,wa=0,Ea="",fa="",Na="",ua=D=0,xb=[];f=[];var Ua=[],La=[L,L,L,L],Oc=wa="";
fa="";var fc=L,Vb=L;y=0;var Bd=!1;a.save();a.font=String(L)+"pt Arial, Helvetica, sans-serif";a.fillStyle=c;fa=ik(g,b);0<g[b].N&&(Na=String(g[b].N));"H"===fa&&2===g[b].N&&(Na="",fa="D");"H"===fa&&3===g[b].N&&(Na="",fa="T");if(2>fa.length||Og.includes(fa)||fa.includes(":")||Eg||qe.includes(fa))t="simple";else if(xb=fa.match(/([A-Za-z]{1,2})H(\d{0,2})/))t="right";else if(xb=fa.match(/H(\d{0,2})([A-Za-z]{0,2})/))t="left";wa=a.measureText(g[b].o.charAt(0)).width/2;Ea=jk(g,b);""!==Ea&&(f=Ea.match(/(\d{1,2})/))&&
(Oc=f[1]);um(g,b,!0);"right"===t?q=wl(g,b,0):"left"===t&&(q=wl(g,b,180));Bd=!1;for(f=0;f<g[b].a.length;f++)if(y=Ya(g,b,g[b].a[f].p),"right"===t&&(30>y||330<y)||"left"===t&&150<y&&210>y)Bd=!0;"H"===g[b].o&&0===g[b].a.zb&&(A=60);if(g[b].r){if("simple"===t)switch(g[b].a.length){case 0:A=180;Ua=[ia(A+90),ia(A-90),ia(A+180),A];2===fa.length&&(La[2]+=.5*L);3<g[b].H&&(Vb+=L);break;case 1:A=qb[0];Ua=[ia(A+90),ia(A-90),A,ia(A+180)];""===fa?Vb=.6*L:1===fa.length?(La=[1.1*L,1.1*L,1.1*L,1.1*L],3>g[b].H?Vb=.9*
L:Vb=La[2]+.6*L):2===fa.length&&(La=[1.1*L,1.1*L,1.5*L,1.2*L],45>=A||315<=A?(La=[1.1*L,1.1*L,1.5*L,1.2*L],3>g[b].H?Vb=1.7*L:Vb=La[2]+.6*L):135<=A&&225>=A?(La=[1.1*L,1.1*L,1.2*L,1.2*L],Vb=3>g[b].H?.9*L:La[2]+.6*L):225<A&&315>A?(La=[1.5*L,L,1.1*L,1.2*L],Vb=3>g[b].H?1.2*L:La[2]+.6*L):45<A&&135>A?(La=[L,1.5*L,1.1*L,1.2*L],Vb=3>g[b].H?1.2*L:La[2]+.6*L):(Vb=1.6*L,La[2]=L));break;case 2:A=qb[0];0===g[b].H&&1===Ie(g,aa,b)&&(A=ia(A+180));if(1===g[b].H)Ua=[ia(A+180)],La[0]=0===fa.length?.8*L:1.1*L;else if(1<
g[b].H)if(Ua=[ia(A+135),ia(A-135),A],0===fa.length)La=[.8*L,.8*L,.8*L];else if(1===fa.length)La=[L,L,L];else if(2===fa.length)for(f=0;f<g[b].H;f++)if(30>Ua[f]||330<Ua[f])La[f]+=.7*L;else if(75>Ua[f]||285<Ua[f])La[f]+=.42*L;0===g[b].H?(Vb=L,1<=Ie(g,aa,b)?Vb=1.1*L:""===fa?Vb=.84*L:2===fa.length&&(60>A||300<A)&&(Vb+=.6*L)):2>=g[b].H?Vb=0<fa.length?(60>A||300<A)&&2===fa.length?1.6*L:1.1*L:.7*L:2<g[b].H&&(Vb=La[2]+.5*L);break;default:A=qb[qb.length-2],Vb=L,Ua=[qb[qb.length-1],qb[qb.length-3]],La=[1.3*
L,1.3*L],2===fa.length&&(Vb=60>A||300<A?1.5*L:L,La=[1.3*L,1.3*L]),""===fa&&(Vb=.8*L)}else if(0===g[b].a.length)Ua=[270,90,180,0],La=[1.2*L,1.2*L,1.2*L,a.measureText(fa).width],A=180,2<g[b].H&&(Vb=2*L);else if(1===g[b].a.length)A=qb[0],La=[1.2*L,1.2*L,1.2*L,1.2*L],Vb=1.1*L,45<A&&90>=A?(Ua=[180,90,270,0],A=90):90<A&&135>A?(Ua=[0,90,270,180],Vb=1.1*L,A=90):270<=A&&315>A?(Ua=[180,270,90,0],Vb=1.1*L,A=270):225<A&&270>A?(Ua=[0,270,90,180],Vb=1.1*L,A=270):45>=A||315<=A?(Ua=[90,270,180,0],Vb=1.1*L,A=270):
135<=A&&225>=A&&(Ua=[90,270,0,180],Vb=1.1*L,A=270),1<g[b].H&&(Vb+=.6*L);else if(2===g[b].a.length){A=qb[0];La[2]+=.6*L;Ua=45<A&&135>A?[A,"right"===t?ia(A+120):ia(A-120),"right"===t?ia(A-120):ia(A+120),ia(A-90)]:[A,"right"===t?ia(A-120):ia(A+120),"right"===t?ia(A+120):ia(A-120),ia(A-90)];if(45>A||315<A||135<A&&225>A)La[1]+=.6*L;A=Ua[1];2>g[b].H?Vb=1.3*L:(Vb=2*L,"right"===t&&0<A&&90>A&&(Vb=2*L,La[1]=Vb-.6*L));2<g[b].H&&(La[2]=a.measureText(fa).width,"left"===t&&(Ua=[270,90,180,0]))}else La=[1.2*L,1.2*
L,1.2*L],"simple"===t?(A=qb[qb.length-2],Ua=[qb[qb.length-1],qb[qb.length-2],qb[qb.length-3]]):q!==qb.length-1?(Ua=[qb[qb.length-1],qb[qb.length-2],qb[qb.length-3]],A=qb[qb.length-2]):(Ua=[qb[qb.length-2],qb[qb.length-3],qb[qb.length-1]],A=qb[qb.length-3]),Vb=1<g[b].H?La[1]+.6*L:1.3*L;D=ak(Vb,A);a.save();a.font=String(1.5*L)+"pt Arial, Helvetica, sans-serif";a.fillStyle="red";a.fillText("\u2022",g[b].x+D.x-a.measureText("\u2022").width/2,g[b].y+D.y+.7*L);a.restore()}else if(0<g[b].H)switch(g[b].a.length){case 0:A=
0;Ua=[ia(A+180),ia(A+90),ia(A-90),A];2===fa.length&&(La=[L,L,L,a.measureText(fa).width]);3<g[b].H&&(fc+=L);break;case 1:A=qb[0];if("simple"===t){if(Ua=2===g[b].a[0].t&&2>=g[b].H?[ia(A+60),ia(A-60),ia(A+180)]:3===g[b].a[0].t?[A,ia(A-90),ia(A-90)]:[ia(A+90),ia(A-90),A,ia(A+180)],La=[L,L,L,L],2===fa.length)for(f=0;f<g[b].H;f++)if(30>Ua[f]||330<Ua[f])La[f]+=.5*L;else if(75>Ua[f]||285<Ua[f])La[f]+=.3*L}else 45>A||315<A?(Ua=[90,270,180,0],La=[L,1.2*L,L,1.2*L]):135<=A&&225>=A?(Ua=[270,90,0,180],La=[1.2*
L,L,a.measureText(fa.charAt(0)).width]):45<=A&&90>=A?(Ua=[90,180,270,0],La=[a.measureText(fa.charAt(0)).width,L,1.2*L]):90<A&&135>A?(Ua=[90,0,270,180],La=[a.measureText(fa.charAt(0)).width,L,1.2*L]):270<=A&&315>=A?(Ua=[270,180,90,0],La=[1.2*L,L,1.3*L,1.2*L]):225<A&&270>A&&(Ua=[270,0,90,180],La=[1.2*L,L,1.3*L,1.2*L]);break;case 2:if("simple"===t)if(A=ia(qb[0]+180),1===g[b].H)Ua=[A],La[0]=2===fa.length?45>A||315<A?1.3*L:.9*L:L;else{if(1<g[b].H&&(Ua=[ia(A+45),ia(A-45),ia(A+180)],2===fa.length))for(f=
0;f<g[b].H;f++)(60>Ua[f]||300<Ua[f])&&2>f?La[f]+=.5*L:(80>Ua[f]||280<Ua[f])&&2===f&&(La[f]+=.25*L)}else if(A=qb[0],La[2]+=.6*L,Ua=45<A&&135>A?[A,"right"===t?ia(A+120):ia(A-120),"right"===t?ia(A-120):ia(A+120),ia(A-90)]:[A,"right"===t?ia(A-120):ia(A+120),"right"===t?ia(A+120):ia(A-120),ia(A-90)],45>A||315<A||135<A&&225>A)La[1]+=.6*L;break;default:if("simple"===t){if(Ua=[qb[qb.length-1],qb[qb.length-3],qb[qb.length-2]],La=[1.2*L,1.2*L,1.2*L],2===fa.length)for(f=0;f<g[b].H;f++)(60>Ua[f]||300<Ua[f])&&
2>f&&(La[f]+=.5*L)}else Ua=q!==qb.length-1?[qb[qb.length-1],qb[qb.length-2],qb[qb.length-3]]:[qb[qb.length-2],qb[qb.length-3],qb[qb.length-1]],La=[1.2*L,1.2*L,1.2*L]}"simple"===t&&""!==fa&&(f=g[b].x-wa,y=g[b].y+L/2,D=g[b].x-a.measureText(fa.charAt(0)).width/2,ua=y-1.2*L,fa.includes(":")?(xb=fa.match(/([CN]):(H)(\d{0,1})/))?(fa=xb[1]+xb[2]+xb[3],a.save(),a.font=String(L)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.clearRect(f,y-L,a.measureText(fa).width+0,L+0),a.fillText(xb[1],f,y),a.restore(),
f+=a.measureText(xb[1]).width,a.fillText(xb[2],f,y),""!==xb[3]&&(f+=a.measureText(xb[2]).width,y+=4,a.save(),a.font=String(L-2)+"pt Arial",a.fillText(xb[3],f,y),a.restore())):(xb=fa.match(/(\d{0,1}H)([CN]):/))?(fa=xb[2],a.clearRect(f,y-L,a.measureText(fa).width+0,L+0),a.save(),a.font=String(L)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.fillText(fa,f,y),a.restore(),fa=xb[1],f-=a.measureText(xb[1]).width,a.clearRect(f,y-L,a.measureText(fa).width+0,L+0),a.fillText(fa,f,y)):(fa=fa.replace(":",
""),a.save(),a.font=String(L)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.clearRect(f,y-L,a.measureText(fa).width+0,L+0),a.fillText(fa,f,y),a.restore()):(a.clearRect(f-1,y-L,a.measureText(fa).width+0+2,L+0+1),a.fillText(fa,f,y)),""!==Na&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",D-=a.measureText(Na).width-2,a.clearRect(D-1,ua-3*L/4,a.measureText(Na).width+2,3*L/4+1),a.fillText(Na,D,ua),a.restore()));if(""!==Ea&&("simple"===t||Bd)){switch(g[b].a.length){case 0:A=30;
fc=1===fa.length?1.2*L:1.6*L;2<g[b].H&&(fc+=.6*L);g[b].r&&2<g[b].H&&(fc=La[2]+.8*L);break;case 1:A=qb[0];if(150<A&&200>A)A=ia(A-15);else if(340<A||20>A)A=ia(A+15);2>fa.length&&!Bd?(fc=1.3*L,""===fa&&(fc=.8*L),""!==Oc&&120<A&&240>A&&(fc=a.measureText(Ea).width+.6*L),2<g[b].H&&(fc+=.8*L),0<g[b].H&&2===g[b].a[0].t&&(fc=La[0]+.6*L)):2===fa.length&&(45>A||315<A?fc=""!==Oc?1.2*L:1.8*L:135<A&&225>A?fc=""!==Oc?1.2*L:1.4*L:135>=A&&45<=A?fc=""!==Oc?.8*L:1.2*L:225<=A&&315>=A&&(fc=L),""!==Oc&&(fc+=.4*L),2<g[b].H&&
(fc+=1.2*L));g[b].r&&(fc=Vb+1.2*L);break;case 2:A=qb[0];g[b].r?0===g[b].H&&1===Ie(g,aa,b)?(A=ia(A+180),fc=1.4*L):fc=Vb+L:fc=1<fa.length&&(45>A||315<A)?1.8*L:""===fa?.8*L:1.4*L;2<g[b].H&&!g[b].r&&(fc=La[2]+.5*L);0===g[b].H&&180<Fa[1].$&&(A=ia(A+180));break;case 3:case 4:case 5:case 6:q===qb.length-2&&Bd?2>g[b].H?(A=qb[qb.length-3],fc=1.4*L):fc=La[1]+.6*L:(A=qb[qb.length-2],fc=1.4*L,2===fa.length&&(60>A||300<A)&&(fc+=.2*L)),g[b].r&&(fc=Vb+L),""===fa&&(fc-=.2*L)}D=ak(fc,A);f=g[b].x+D.x;y=g[b].y+D.y;
a.font=String(L+2)+"pt";0<Oc.length&&(f=g[b].x+D.x-.6*a.measureText("+").width,y=g[b].y+D.y+L/2,a.fillStyle="black",a.fillText(Oc,f,y),f+=a.measureText(Oc).width+L/2,y-=.6*a.measureText("+").width);l(a,f,y,0<g[b].s?"+":"\u2013")}if("right"===t||"left"===t)c="left"===t?-1*(a.measureText(fa).width-wa):-1*wa,(xb=fa.match(/([A-Za-z]{1,2})H(\d{1,2})/))?(fa=xb[1],wa=xb[2],f=g[b].x-a.measureText(fa.charAt(0)).width/2,y=g[b].y+L/2,D=f,ua=y-1.2*L,a.clearRect(f,y-L,a.measureText(fa+"H").width,L),a.fillText(fa+
"H",f,y),f+=a.measureText(fa+"H").width,y+=4,a.clearRect(f,y-L,a.measureText(wa).width,L),a.fillText(wa,f,y),f+=a.measureText(wa).width+2,y-=4,""==Ea||Bd||(y-=.6*L,0<Oc.length&&(a.fillStyle="black",a.fillText(Oc,f,y),f+=a.measureText(Oc).width+.2*L),y-=.6*a.measureText("+").width,l(a,f+4,y,0<g[b].s?"+":"\u2013")),""!==Na&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",D-=a.measureText(Na).width,a.clearRect(D-1,ua-3*L/4,a.measureText(Na).width+2,3*L/4+1),a.fillText(Na,D,ua),a.restore())):
(xb=fa.match(/H(\d{1,2})([A-Za-z]{1,2})/))?(fa=xb[2],wa=xb[1],f=g[b].x+c,y=g[b].y+L/2,D=g[b].x-a.measureText("M").width/2,ua=y-L,a.clearRect(f,y-L,a.measureText("H").width,L),a.fillText("H",f,y),f+=a.measureText("H").width,y+=4,a.clearRect(f,y-L,a.measureText(wa).width,L),a.fillText(wa,f,y),f+=a.measureText(wa).width,y-=4,a.clearRect(f,y-L,a.measureText(fa).width,L),a.fillText(fa,f,y),f=g[b].x+c,""==Ea||Bd||(y-=.6*L,f-=a.measureText("+").width,y-=.6*a.measureText("+").width,l(a,f,y,0<g[b].s?"+":"\u2013"),
0<Oc.length&&(a.fillStyle="black",y+=.6*a.measureText("+").width,f-=a.measureText(Oc).width+L/2,a.fillText(Oc,f,y))),""!==Na&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",D-=a.measureText(Na).width,a.clearRect(D,ua-3*L/4,a.measureText(Na).width+0+2,3*L/4+1),a.fillText(Na,D+1,ua),a.restore())):!fa.match(/^H/)||"H"===fa&&0===g[b].a.length?(f=g[b].x-a.measureText(fa.charAt(0)).width/2,y=g[b].y+L/2,D=f-1,ua=y-L,a.clearRect(f,y-L,a.measureText(fa).width,L),a.fillStyle="black",a.fillText(fa,
f,y),f+=a.measureText(fa).width+.5*L,""==Ea||Bd||(3<g[b].H&&(f+=.8*L),y-=4,0<Oc.length&&(f-=.4*L,a.fillStyle="black",a.fillText(Oc,f,y),f+=a.measureText(Oc).width+L/2),y-=.6*a.measureText("+").width,l(a,f,y,0<g[b].s?"+":"\u2013")),""!==Na&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",D=D-1-a.measureText(Na).width,a.clearRect(D-1,ua-3*L/4,a.measureText(Na).width+0+2,3*L/4+1),a.fillText(Na,D,ua),a.restore())):(f=g[b].x-a.measureText(fa).width+a.measureText(fa.charAt(0)).width/2,y=g[b].y+
L/2,D=g[b].x-a.measureText("M").width/2,ua=y-L,a.clearRect(f,y-L,a.measureText(fa).width,L),a.fillStyle="black",a.fillText(fa,f,y),""==Ea||Bd||(y-=.6*L,f-=a.measureText("+").width,y-=.6*a.measureText("+").width,l(a,f,y,0<g[b].s?"+":"\u2013"),0<Oc.length&&(a.fillStyle="black",f-=a.measureText(Oc).width+L/2,y+=.6*a.measureText("+").width,a.fillText(Oc,f,y))),""!==Na&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",D-=a.measureText(Na).width,a.clearRect(D,ua-3*L/4,a.measureText(Na).width+
0+2,3*L/4+1),a.fillText(Na,D+1,ua),a.restore()));a.restore();0<g[b].H&&e(a,b)}function ll(a){new zd(0,0,0,0);new zd(0,0,0,0);Xc();$g(sa[a].M,10);var b=Fd(g,10,"s");$g(sa[a].L,20);var c=Fd(g,20,"s");re=[];Yj(sa[a].M,sa[a].L,b,c);sa[a].W.x=re[0];sa[a].W.y=re[1];sa[a].V.x=re[2];sa[a].V.y=re[3];re=[];Xc()}function Dg(a){a.clearRect(za.b+2,za.t+2,za.c-4,za.h-4)}function Ud(){V.clearRect(0,0,Se.width,Se.height)}function Mj(){kk.fillStyle="white";kk.clearRect(0,0,Tc.width,Tc.height);V.clearRect(0,0,Se.width,
Se.height);Ac.clearRect(0,0,Te.width,Te.height);Ga.clearRect(0,0,cc.width,cc.height);var a=document.getElementById("can").getContext("2d");a.save();a.font="12pt Sans-Serif";a.fillStyle="black";a.fillText("Structural Formula Editor  MOSFECCS",50,28);a.fillStyle="black";a.font="10pt Sans-Serif";a.fillText("v6_240311(240311.2)",za.b+za.c-a.measureText("v6_240311(240311.2)").width,28);a.font="9pt Sans-Serif";a.fillText("\u00a9 B.Jaun ETHZ",za.b+za.c-90,za.t+za.h+15);a.restore();a.drawImage(lk,hc.b,hc.t,
hc.c,hc.h);a.drawImage(mk,Nc.b,Nc.t,Nc.c,Nc.h);Uh&&a.drawImage(nk,sc.b,sc.t,sc.c,sc.h);hh(be);a.save();a.strokeStyle="black";a.lineWidth=1.5;a.strokeRect(dd.b,dd.t,dd.c,dd.h);a.font="10pt Sans-Serif";a.fillStyle="black";a.fillText("redraw",dd.b+dd.c/2-a.measureText("redraw").width/2,dd.t+dd.h/2+4);a.restore();a.save();a.strokeStyle="black";a.lineWidth=1.5;a.beginPath();a.arc(Gd.x,Gd.y,Gd.r,0,2*Math.PI);a.stroke();a.font="14pt Sans-Serif";a.fillStyle="black";a.fillText("+",dd.b+dd.c+30-a.measureText("+").width/
2,dd.t+dd.h/2);a.restore();a.save();a.strokeStyle="black";a.lineWidth=1.5;a.beginPath();a.arc(ye.x,ye.y,ye.r,0,2*Math.PI);a.stroke();a.font="14pt Sans-Serif";a.fillStyle="black";a.fillText("\u2013",ye.x-a.measureText("\u2013").width/2,ye.y+5);a.restore();a.save();a.font="10pt Sans-Serif";a.fillStyle="black";a.fillText("Bondlength",Gd.x-7,Gd.y+26);a.fillText(String(Math.round(na)),(Gd.x+ye.x)/2-6,Gd.y+6);Mg("erase");Mg("mark");a.save();a.beginPath();a.strokeStyle="black";a.lineWidth=1;a.strokeRect(za.b,
za.t,za.c,za.h);a.restore();Kb();1<g.length&&xl();wb(Ga,0,!0);qd(0);td(0);be="X"}function sg(a,b,c,e,l){var f,t=0;for(f=1;f<a.length;f++)t=Yd(g,aa,c,e);if(0!==t)return-t;f=mi(b);l&&(b="("+b+")");l=a.length;a[l]=new kb(f,b,c,e,0,0,0);return a[l].Ca=l}function pi(a,b){var c;for(c=0;c<g[b].a.length;c++)Xe(g,aa,g[b].a[c].p,a,g[b].a[c].t);ki(g,aa,b,!0)}function hl(a,b,c){var e;for(e=0;e<Pa.length;e++)if(Pa[e].G===-1*c||Pa[e].K===-1*c)hj(e),e--;for(e=0;e<Pa.length;e++)0>Pa[e].G&&Math.floor(Math.abs(Pa[e].G))>
c&&(Pa[e].G+=1),0>Pa[e].K&&Math.floor(Math.abs(Pa[e].K))>c&&(Pa[e].K+=1);var l=b[c].f;var f=b[c].g;var t=-1;for(e=0;e<a[l].a.length;e++)a[l].a[e].p===f&&(t=e);0<=t&&a[l].a.splice(t,1);t=-1;for(e=0;e<a[f].a.length;e++)a[f].a[e].p===l&&(t=e);0<=t&&a[f].a.splice(t,1);b.splice(c,1)}function im(a,b,c,e){var l=g[b].x;var f=g[b].y;b=g[e].x;var t=g[e].y;e=Ja(aa,c,e);hl(g,aa,e);pi(a,c);a=Yd(g,aa,l,f);c=Yd(g,aa,b,t);pi(a,c)}function Eh(a,b,c,e){var l;var f=1;var t=!0;var q=[0,0,0,-.5*na,-.5*na,-.5*na,0,0,0,
0,0,0,0],D=[0,0,0,-.28868*na,.5*na,-.80902*na,na,0,0,0,0,0,0];-6===a&&(Ng=!0);0<c?t=!0:0>c&&(t=!1);var y=0<a?a:-a;c=360/Math.abs(a);var A=(180-c)/2;var wa=Math.pow(-1,y)*A;6===y&&(wa=90);if("atom"===e){if(1===g.length||1===zb%2){var Ea=Vc+q[y];var fa=Zc+D[y];var Na=sg(g,"C",Ea,fa,!1);0<Na&&(b=Na)}if(0<b&&0===g[b].a.length)Ea=g[b].x,fa=g[b].y;else if(0<b&&1===g[b].a.length)Ea=g[b].x,fa=g[b].y,wa=Gh(g,b);else if(0<b&&2===g[b].a.length&&1===g[b].a[0].t&&1===g[b].a[1].t&&0<a)Ea=g[b].x,fa=g[b].y,wa=Gh(g,
b);else return;Na=l=b}if("bond"===e){if(0===aa[b].B)return;y--;4!==aa[b].B&&5!==aa[b].B||$c(g,aa,b,1,!0);if(1===aa[b].B&&-6===a){Ea=aa[b].f;fa=aa[b].g;for(Na=f=0;Na<g[Ea].a.length;){if(2===g[Ea].a[Na].t){f+=1;break}Na++}for(Na=0;Na<g[fa].a.length;){if(2===g[fa].a[Na].t){f+=1;break}Na++}0===f&&$c(g,aa,b,2,!0)}else if(2<aa[b].B){Ng=!1;return}l=aa[b].f;Na=aa[b].g;Ea=g[l].x;fa=g[l].y;f=1;wa=Ya(g,l,Na);A=180-360/Math.abs(a);t||(A*=-1,c*=-1)}b=ia(wa-A);e=l;for(t=0;t<y-1;t++)f=na*Math.cos(Math.PI*b/180),
l=-1*na*Math.sin(Math.PI*b/180),Gc=Ea+f,Hc=fa+l,Ea=sg(g,"C",Gc,Hc,!1),0>Ea&&(Ea=Math.abs(Ea)),f=-6===a?t%2+1:1,Xe(g,aa,e,Ea,f),e=Ea,b=ia(b+c),Ea=Gc,fa=Hc;Xe(g,aa,e,Na,-6===a&&1===f?2:1);Ng=!1}function gm(a,b,c,e,l){var f;var t=1;ia(e+t*l*30);ia(e+t*l*30);if(ci)var q=hb;else if(q=sg(g,"C",b,c,!1),0< !q)return;b=g[q].x;c=g[q].y;Od=b;Pd=c;for(f=0;f<a-1;f++){t=0===f%2?1:-1;var D=na*Math.cos(Math.PI*ia(e+t*l*30)/180);t=-na*Math.sin(Math.PI*ia(e+t*l*30)/180);b+=D;c+=t;t=sg(g,"C",b,c,!1);0>t&&(t=Math.abs(t));
Xe(g,aa,q,t,1);q=t;Od=b;Pd=c}}function hm(a){var b,c=-1;if(!1===Ig){var e=Aa[0].x;var l=Aa[0].y;var f=sg(g,"C",e,l,!1);0>f&&(f=Math.abs(f));0<=Kg&&0===Kg&&(c=f)}else f=hb;e=g[f].x;l=g[f].y;Od=e;Pd=l;for(b=1;b<a;b++){e=Aa[b].x;l=Aa[b].y;var t=sg(g,"C",e,l,!1);0>t&&(t=Math.abs(t));0<=Kg&&b===Kg&&(c=t);Xe(g,aa,f,t,1);f=t;Od=e;Pd=l}0<hi&&(t=hi,Xe(g,aa,f,t,1),hi=0);0<=c&&Xe(g,aa,f,c,1)}function Nj(a){var b,c=0;for(b=1;b<g.length;)g[b].v===a&&(c=g[b].t,ki(g,aa,b,!0),b--),b++;for(b=1;b<g.length;)g[b].t>
c&&--g[b].t,b++;if(0<sa.length)for(b=0;b<sa.length;b++)if(1===sa[b].M.length&&sa[b].M[0]===c||1===sa[b].L.length&&sa[b].L[0]===c)Yg(b),b--;else{sa[b].M.includes(c)&&sa[b].M.splice(sa[b].M.indexOf(c),1);sa[b].L.includes(c)&&sa[b].L.splice(sa[b].L.indexOf(c),1);for(a=0;a<sa[b].M.length;a++)sa[b].M[a]>c&&--sa[b].M[a];for(a=0;a<sa[b].L.length;a++)sa[b].L[a]>c&&--sa[b].L[a]}if(0<sa.length)for(b=0;b<sa.length;b++)ll(b);Ud();Xc();ed();Kb();wb(Ga,0,!0)}function Yg(a){var b,c;if(void 0!==sa[a]){for(b=1;b<
g.length;b++)g[b].za.includes(a)&&g[b].za.splice(g[b].za.indexOf(a),1),g[b].ya.includes(a)&&g[b].ya.splice(g[b].ya.indexOf(a),1);for(b=1;b<g.length;b++){for(c=0;c<g[b].za.length;c++)g[b].za[c]>a&&--g[b].za[c];for(c=0;c<g[b].ya.length;c++)g[b].ya[c]>a&&--g[b].ya[c]}sa.splice(a,1)}}function yl(a){na*=a;L=Math.floor(6+8/30*(na-15));si=5+(na-15)/5;$a=na/5;ek=da?va?na/2:2*$a:$a+4;Jc=da?2*$a:$a+4;fl=na/10;Yk=na/10;zi=na/5;Xi=da?va?na/3:2*zi:zi+2;cl=.86603*na;yi=Math.round(150*na/24)/100;vl=6*yi;Ee=30<na?
2:1.5}function gl(a){var b=na,c=5*Math.floor(na/5);new zd(0,0,0,0);Ud();if(!(2>g.length)){"in"===a?(b=c+5,50<b&&(b=50)):"out"===a&&(b=c-5,20>b&&(b=20));a=b/na;if(1<a){for(zf=1;zf<g.length;zf++)g[zf].v=9;b=Fd(g,9,"s");for(zf=1;zf<g.length;zf++)g[zf].v=0;if(a*b.c>za.c||a*b.h>za.h)return}yl(a);Ga.save();Ga.fillStyle="white";Ga.fillRect(Gd.x+16,Gd.y-6,20,12);Ga.font="10pt Sans-Serif";Ga.fillStyle="black";Ga.fillText(String(Math.round(na)),(Gd.x+ye.x)/2-6,Gd.y+6);Ga.restore();new zd(0,0,0,0);for(b=1;b<
g.length;b++)g[b].v=9;b=Fd(g,9,"s");Ai(g,ra.b+ra.c/2-(b.b+b.c/2),ra.t+ra.h/2-(b.t+b.h/2),9);0<sa.length&&(zl(sa,ra.b+ra.c/2-(b.b+b.c/2),ra.t+ra.h/2-(b.t+b.h/2)),Al(ra.b+ra.c/2-(b.b+b.c/2),ra.t+ra.h/2-(b.t+b.h/2)));ol(g,9,ra.b+ra.c/2,ra.t+ra.h/2,a,!1);0<sa.length&&(pl(sa,ra.b+ra.c/2,ra.t+ra.h/2,a),ql(sb,ra.b+ra.c/2,ra.t+ra.h/2,a));Xc();wb(Ga,0,!0);Dg(Ga);wb(Ga,0,!0)}}function ed(){rf=ok();pk();Bl()}function Bl(){var a,b=g,c=aa,e=Pa,l=sa,f=new Cl;var t=f.na;var q=f.Za;var D=f.Ya;var y=f.hb;t.length=
1;q.length=1;D.length=0;y.length=0;for(a=1;a<b.length;a++)qi(b,t,a,a);for(a=1;a<c.length;a++)ri(c,q,a,a);for(a=0;a<e.length;a++)qk(e,D,a,a);for(a=0;a<l.length;a++)lj(l,y,a,a);f.aa=rf;f.A=Kh.length+1;f.Ja=Xb;f.Wa=He;f.Xa=be;Kh.push(f)}function Dl(){new Cl;var a;if(!(2>Kh.length)){Kh.pop();var b=Kh[Kh.length-1];var c=b.na;var e=b.Za;var l=b.Ya;var f=b.hb;var t=g;var q=aa;var D=Pa;var y=sa;t.length=1;q.length=1;D.length=0;y.length=0;for(a=1;a<c.length;a++)qi(c,t,a,a);for(a=1;a<e.length;a++)ri(e,q,a,
a);for(a=0;a<l.length;a++)qk(l,D,a,a);for(a=0;a<f.length;a++)lj(f,y,a,a);10===b.Ja?Xb=0:Xb=b.Ja;He=b.Wa;be=b.Xa;hh(be)}}function Oj(){Dl();qd(Xb);td(He);wb(Ga,0,!0)}function Cl(){this.na=[vm];this.Za=[wm];this.Ya=[];this.hb=[];this.Wa=this.Ja=this.aa=this.A=0;this.Xa="X"}function Ui(){g.length=1;Q.length=1;ag.length=1;df.length=1;Bc.length=0;aa.length=1;Ka.length=1;Bi.length=1;ef.length=1;vd.length=1;vd=[new rk(0,0)];Pa=[];oc=[];sa=[];ff=[];gf=[];Qc=[];me=[];ih=[];sk=[];qb=[];Je=[];Pg={};bg=[];hf=
[];Ye=[];sd=[];md=[];sb=[];cf=[];cg=[];Cc={};Fe=[];rd=[];se=[];Hd=[];cb=[];Fa=[];Lg=[];Uc=[];nc=[];lc=[];Kc=[];Ci=rf=0;Ng=Xh=Eg=hk=Lh=!1}function Xc(){var a;for(a=0;a<g.length;a++)g[a].v=0;Uc=[];Lg=[];ze=!1}function El(){var a,b;for(a=0;a<g.length;a++)g[a].t=0;var c=1;for(b=0;0<c;){c=0;for(a=1;a<g.length;a++)if(0===g[a].t){c=a;break}if(0===c)break;lc=[];var e=Hh(g,c);for(a=0;a<e;a++)g[lc[a]].t=b;b++}return b-1}function $g(a,b){var c,e;if(0===a.length)return-1;for(c=0;c<a.length;c++)for(e=1;e<g.length;e++)g[e].t===
a[c]&&g[e].v!==b&&(g[e].v=b)}function Fd(a,b,c){var e,l=0,f=0,t=0,q=0,D=-1E4,y=-1E4,A=1E4,wa=1E4;if(0<b)for(e=1;e<g.length;e++){var Ea="t"===c?g[e].t:g[e].v;Ea===b&&(a[e].x>D&&(D=a[e].x,t=e),a[e].y>y&&(y=a[e].y),a[e].x<A&&(A=a[e].x,q=e),a[e].y<wa&&(wa=a[e].y))}else for(e=1;e<g.length;e++)a[e].x>D&&(D=a[e].x,t=e),a[e].y>y&&(y=a[e].y),a[e].x<A&&(A=a[e].x,q=e),a[e].y<wa&&(wa=a[e].y);0<q&&0<t&&(l=ik(a,q)+jk(a,q),f=ik(a,t)+jk(a,t));a=si*l.length+8;return new zd(A-a,wa-3*L/2-4,D-A+a+(si*f.length+2)+4,y-
wa+3*L/2+18)}function ok(){var a;sd=[new zd(0,0,0,0)];if(1!==g.length){var b=El();for(a=1;a<=b;a++)sd.push(Fd(g,a,"t"));return b}}function pk(){var a;if(0===Qc.length)return-1;sb=[];for(a=0;a<Qc.length;a++)$g(Qc[a].ia,800),sb.push(Fd(g,800,"s")),Xc()}function mj(){var a;md=[];for(a=0;a<gf.length;a++)$g(gf[a],700),md.push(Fd(g,700,"s")),Xc()}function mi(a){var b;if(""===a||void 0===a)return-1;if("C:"===a)return 6;if("N:"===a)return 7;for(b=0;b<Og.length;b++)if(Og[b]===a)return b+1;return null!==a.match(xm)?
0:-1}function Ic(a,b,c){return b>a.b&&b<a.b+a.c&&c>a.t&&c<a.t+a.h?!0:!1}function Yd(a,b,c,e){var l;for(l=1;l<a.length;l++){var f=Math.sqrt((c-a[l].x)*(c-a[l].x)+(e-a[l].y)*(e-a[l].y));if(f<=$a)return l}for(l=1;l<b.length;l++){var t=b[l].f;var q=b[l].g;f=(a[t].x+a[q].x)/2;t=(a[t].y+a[q].y)/2;f=Math.sqrt((c-f)*(c-f)+(e-t)*(e-t));if(f<=$a)return-l}return 0}function oi(a,b,c){var e;for(e=0;e<a[b].a.length;e++)if(a[b].a[e].p===c)return e;return-1}function Fl(a){var b,c=0;for(b=0;b<g[a].a.length;b++){var e=
g[a].a[b].t;if(4===e||5===e)e=1;c+=e}return c}function ik(a,b){var c;var e="";if(Eg)return e=String(b);if(Xh)return e=String(a[b].U);if(!(c="C"!==a[b].o||a[b].a.length===a[b].C)){var l;for(l=c=0;c<a[b].a.length;)2===a[b].a[c].t&&l++,c++;c=2===l?!0:!1}if(c||"C"===a[b].o&&0<a[b].N)e=a[b].o;if("C"!==a[b].o&&"H"!==a[b].o&&0<Af[a[b].j]||"C"===a[b].o&&a[b].a.length===a[b].C)c=tk(a,b,!1),0<c&&(a=Gh(a,b),90<a&&270>a?(1<c&&(e=String(c)+e),e="H"+e):(e+="H",1<c&&(e+=String(c))));return e}function tk(a,b,c){var e=
0,l;if("H"!==a[b].o&&0<Af[a[b].j]){var f=Af[a[b].j];dk.includes(a[b].o)&&(f-=2);c=c?a[b].C:0;for(l=0;l<a[b].a.length;l++){e=a[b].a[l].t;if(4===e||5===e)e=1;c+=e}e=f-c+a[b].s;if(ym.includes(a[b].o)||"C"===a[b].o&&0<a[b].s)e=f-c-a[b].s;a[b].r&&e--}return Math.max(e,0)}function jk(a,b){var c="";1<Math.abs(a[b].s)&&(c+=String(Math.abs(a[b].s)));0<a[b].s?c+="+":0>a[b].s&&(c+="\u2013");return c}function Yj(a,b,c,e){a=new Yc(0,0);var l=new Yc(0,0);var f=4*$a;var t=c.b+c.c/2,q=c.t+c.h/2,D=e.b+e.c/2,y=e.t+
e.h/2,A=Math.sqrt((D-t)*(D-t)+(y-q)*(y-q)),wa=c.c/1.6,Ea=c.h/1.6,fa=e.c/1.6,Na=e.h/1.6,ua=c=0;e=ld(t,q,D,y);wa=wa*Ea/Math.sqrt(wa*wa*Math.sin(Math.PI*e/180)*Math.sin(Math.PI*e/180)+Ea*Ea*Math.cos(Math.PI*e/180)*Math.cos(Math.PI*e/180));fa=fa*Na/Math.sqrt(fa*fa*Math.sin(Math.PI*e/180)*Math.sin(Math.PI*e/180)+Na*Na*Math.cos(Math.PI*e/180)*Math.cos(Math.PI*e/180));if(A-wa-fa<f)for(0<A-wa-fa&&(c=1.05*Math.abs(f+wa+fa-A)*Math.cos(Math.PI*e/180),ua=-1.05*Math.abs(f+wa+fa-A)*Math.sin(Math.PI*e/180)),f=0;f<
b.length;f++)Mh(g,c,ua,b[f]);a.x=t+wa*Math.cos(Math.PI*e/180);a.y=q-wa*Math.sin(Math.PI*e/180);l.x=D-fa*Math.cos(Math.PI*e/180)+c;l.y=y+fa*Math.sin(Math.PI*e/180)+ua;Math.sqrt((l.x-t)*(l.x-t)+(l.y-q)*(l.y-q))<Math.sqrt((a.x-t)*(a.x-t)+(a.y-q)*(a.y-q))&&(b=a.x,a.x=l.x,l.x=b,b=a.y,a.y=l.y,l.y=b);re.push(a.x,a.y,l.x,l.y)}function Mh(a,b,c,e){var l;for(l=1;l<a.length;l++)a[l].t===e&&(a[l].x+=b,a[l].y+=c)}function Xe(a,b,c,e,l){var f;if(!(c>=a.length||e>=a.length)&&c!==e){for(f=1;f<b.length;f++)if(b[f].f===
c&&b[f].g===e||b[f].f===e&&b[f].g===c)return;var t=l;if(Ng){f=Fl(c);var q=Fl(e);if(4<f+l&&"C"===a[c].o||4<q+l&&"C"===a[e].o)t=1}4===t&&"H"===a[c].o?(l=c,c=e,e=l,t=5):5===t&&"H"===a[c].o&&(l=c,c=e,e=l,t=4);b[b.length]=new Ce(c,e,t);4===t&&(a[e].z=1);5===t&&(a[e].z=-1);a[c].a.push(new uk(e,t));a[e].a.push(new uk(c,t));a===g&&(Mf(a,c),Mf(a,e))}}function ki(a,b,c,e){function l(q,D){var y;for(y=0;y<q.length;y++)0>q[y].G&&Number.isInteger(q[y].G)&&-1*q[y].G>D&&(q[y].G+=1),0>q[y].K&&Number.isInteger(q[y].K)&&
-1*q[y].K>D&&(q[y].K+=1)}var f;var t=!1;if(2===a.length&&a===g)a.splice(1,1);else{if(e)for(f=0;f<Pa.length;f++){t=!1;if(Pa[f].G===c||Pa[f].K===c)t=!0;0>Pa[f].G&&Number.isInteger(Pa[f].G)&&(b[-1*Pa[f].G].f===c||b[-1*Pa[f].G].g===c)&&(t=!0);0>Pa[f].K&&Number.isInteger(Pa[f].K)&&(b[-1*Pa[f].K].f===c||b[-1*Pa[f].K].g===c)&&(t=!0);t&&(hj(f),f--)}for(f=1;f<b.length;f++)if(b[f].f===c||b[f].g===c){if(e){for(t=0;t<Pa.length;t++)Pa[t].G!==-1*f&&Pa[t].G!==-1*f||hj(t);l(Pa,f)}else b===ef&&0<oc.length&&l(oc,f);
b.splice(f,1);f--}for(f=1;f<b.length;f++)b[f].f>c&&--b[f].f,b[f].g>c&&--b[f].g;for(f=1;f<a.length;f++)if(f!==c)for(t=0;t<a[f].a.length;t++)a[f].a[t].p===c&&(1===a[c].j&&a===g&&(0===a[c].N?--a[f].C:2===a[c].N?--a[f].D:3===a[c].N&&--a[f].F),a[f].a.splice(t,1));for(f=1;f<a.length;f++)for(t=0;t<a[f].a.length;t++)f!==c&&a[f].a[t].p>c&&--a[f].a[t].p;if(e)for(f=0;f<Pa.length;f++)Pa[f].G>c&&--Pa[f].G,Pa[f].K>c&&--Pa[f].K;else if(b===ef&&0<oc.length)for(f=0;f<oc.length;f++)oc[f].G>c&&--oc[f].G,oc[f].K>c&&
--oc[f].K;a.splice(c,1);e&&wb(Ga,0,!0)}}function Nf(a,b,c,e,l){var f=0;var t=oi(a,c,e);var q=oi(a,e,c);if(0<=t&&0<=q){var D=a[c].a[t].t;var y=a[e].a[q].t;if(D===y){switch(l){case "+":if(1===D||2===D)f=D+1;else if(4===D||5===D)f=2;break;case "-":if(2===D||3===D)f=D-1}if(0<f)for(a[c].a[t].t=f,a[e].a[q].t=f,a=1;a<b.length;a++)0!==b[a].B&&(b[a].f===c&&b[a].g===e||b[a].g===c&&b[a].f===e)&&(b[a].B=f)}}}function $c(a,b,c,e,l){var f,t;var q=b[c].f;var D=b[c].g;var y=b[c].B;if((4===y||5===y)&&-1===e){if("H"!==
a[D].o){for(l=t=f=0;l<a[q].a.length;){if(4===a[q].a[l].t||5===a[q].a[l].t){var A=Ja(b,q,a[q].a[l].p);b[A].g===q&&(f++,4===a[q].a[l].t?t++:5===a[q].a[l].t&&t--)}l++}if(!(0<f&&Math.abs(t)!==f||0<t&&5===y||0>t&&4===y)){for(l=t=f=0;l<a[D].a.length;){if(4===a[D].a[l].t||5===a[D].a[l].t)A=Ja(b,D,a[D].a[l].p),b[A].g===D&&(f++,4===a[D].a[l].t?t++:5===a[D].a[l].t&&t--);l++}2>f&&(4===y||5===y)&&(a[D].z=0);e=q;q=D;D=e;a[D].z=4===b[c].B?1:-1;b[c].f=q;b[c].g=D}}}else if(y!==e){if(!0===l){for(l=t=f=0;l<a[D].a.length;){if(4===
a[D].a[l].t||5===a[D].a[l].t)A=Ja(b,D,a[D].a[l].p),b[A].g===D&&(f++,4===a[D].a[l].t?t++:5===a[D].a[l].t&&t--);l++}if(Math.abs(t)!==f||1<f&&(4===y&&5===e||5===y&&4===e)||1<f&&(0<t&&5===e||0>t&&4===e))return}4===e&&(a[D].z=1);5===e&&(a[D].z=-1);1===e&&2>f&&(a[D].z=0);b[c].B=e;for(l=0;l<a[q].a.length;)a[q].a[l].p===D&&(a[q].a[l].t=e),l++;for(l=0;l<a[D].a.length;)a[D].a[l].p===q&&(a[D].a[l].t=e),l++}}function mm(a,b,c){var e=c.slice(0);e.push(c[0]);for(c=0;c<e.length-1;c++)2===b[Ja(b,e[c],e[c+1])].B?
Nf(a,b,e[c],e[c+1],"-"):1===b[Ja(b,e[c],e[c+1])].B&&Nf(a,b,e[c],e[c+1],"+")}function zm(a,b,c,e,l,f,t){var q;var D=[];var y=[];var A=a.length;var wa=b.length;for(q=1;q<A;q++)if(-1===l||a[q].v===l){var Ea=c.length;qi(a,c,q,Ea);D.push(q);y.push(Ea);c[Ea].x=a[q].x+f;c[Ea].y=a[q].y+t;-1<l&&(c[Ea].t=l)}for(q=1;q<A;q++)if(-1===l||a[q].v===l){for(f=0;f<a[q].a.length;f++)t=a[q].a[f].p,Ea=D.indexOf(t),t=D.indexOf(q),-1<Ea&&-1<t&&(Ea=y[Ea],c[y[t]].a[f].p=Ea);for(f=1;f<wa;f++)if(b[f].f===q){var fa=e.length;
ri(b,e,f,fa);t=D.indexOf(q);e[fa].f=y[t];Ea=D.indexOf(b[f].g);-1<Ea&&-1<t&&(e[fa].g=y[Ea])}}}function hj(a){void 0!==Pa[a]&&Pa.splice(a,1)}function rg(a,b,c,e,l){var f=b[c].g,t=b[c].f;Dh(a,b);if(!le(b,b[c].f,b[c].g)&&2!==b[c].B&&3!==b[c].B){Nh(a,f,t);var q=lc.slice(0);var D=q.length;Nh(a,t,f);var y=lc.slice(0);f=y.length;f<D?(f=b[c].f,t=b[c].g,lc=y.slice(0)):(f=b[c].g,t=b[c].f,lc=q.slice(0));for(c=1;c<a.length;c++)a[c].v=0;for(c=1;c<lc.length;c++)a[lc[c]].v=1;D=a[f].x;q=a[f].y;c=ia(e*Ya(a,f,t));nj(a,
1,-1*D,-1*q,!1);Oh(a,1,a[f].x,a[f].y,e*c,!1);t=Ja(b,f,t);var A;for(y=1;y<a.length;y++)if(1===a[y].v&&(/x/.test("y")?a[y].x=-1*a[y].x:/y/.test("y")&&(a[y].y=-1*a[y].y),0!==a[y].z))for(A=0;A<a[y].a.length;A++)Ja(b,y,a[y].a[A].p)!==t&&(4===a[y].a[A].t?$c(a,b,Ja(b,y,a[y].a[A].p),5,!1):5===a[y].a[A].t&&$c(a,b,Ja(b,y,a[y].a[A].p),4,!1));Oh(a,1,a[f].x,a[f].y,-1*e*c,!1);nj(a,1,D,q,!1);for(a=1;a<g.length;a++)1===g[a].v&&Mf(g,a);l&&Xc()}}function Ai(a,b,c,e){var l;for(l=1;l<a.length;l++)if(-1===e||a[l].v===
e)a[l].x+=b,a[l].y+=c}function zl(a,b,c){var e;for(e=0;e<a.length;e++)a[e].W.x+=b,a[e].W.y+=c,a[e].V.x+=b,a[e].V.y+=c}function Al(a,b){if(0===sb.length)return-1;var c;for(c=0;c<sb.length;c++)sb[c].b+=a,sb[c].t+=b}function xl(){var a;new zd(0,0,0,0);var b=na;for(a=1;a<g.length;a++)g[a].v=9;var c=Fd(g,9,"s");Ai(g,ra.b+ra.c/2-(c.b+c.c/2),ra.t+ra.h/2-(c.t+c.h/2),9);0<sa.length&&(zl(sa,ra.b+ra.c/2-(c.b+c.c/2),ra.t+ra.h/2-(c.t+c.h/2)),Al(ra.b+ra.c/2-(c.b+c.c/2),ra.t+ra.h/2-(c.t+c.h/2)));a=c.c/ra.c;c=c.h/
ra.h;if(1<a||1<c)a=1/(1.1*Math.max(a,c)),a=5*Math.floor(b*a/5),a/=b,ol(g,9,ra.b+ra.c/2,ra.t+ra.h/2,a,!1),yl(a),L=Math.floor(6+8/30*(na-15)),Ga.save(),Ga.fillStyle="white",Ga.fillRect(Gd.x+16,Gd.y-6,20,12),Ga.font="10pt Sans-Serif",Ga.fillStyle="black",Ga.fillText(String(Math.round(na)),(Gd.x+ye.x)/2-6,Gd.y+6),Ga.restore(),0<sa.length&&(pl(sa,ra.b+ra.c/2,ra.t+ra.h/2,a),ql(sb,ra.b+ra.c/2,ra.t+ra.h/2,a));Xc()}function qi(a,b,c,e){new kb(0,"",0,0,0,0,0);var l=new kb(0,"",0,0,0,0,0);c=a[c];l.v=c.v;l.Ca=
c.Ca;l.j=c.j;l.o=c.o;l.N=c.N;l.x=c.x;l.y=c.y;l.s=c.s;l.C=c.C;l.Fa=c.Fa;l.Ga=c.Ga;l.ja=c.ja;l.D=c.D;l.wa=c.wa;l.xa=c.xa;l.ma=c.ma;l.F=c.F;l.Da=c.Da;l.ca=c.ca;l.tz=c.tz;l.z=c.z;l.r=c.r;l.U=c.U;l.X=c.X;l.I=c.I;l.H=c.H;l.t=c.t;l.za=c.za.slice(0);l.ya=c.ya.slice(0);for(a=0;a<c.a.length;a++)l.a.push(new uk(c.a[a].p,c.a[a].t));b[e]=l}function ri(a,b,c,e){new Ce(0,0,0);var l=new Ce(0,0,0);a=a[c];l.v=a.v;l.gb=a.gb;l.f=a.f;l.g=a.g;l.B=a.B;b[e]=l}function qk(a,b,c,e){new jj(0,0,"",0);var l=new jj(0,0,"",0);
a=a[c];l.G=a.G;l.K=a.K;l.ca=a.ca;l.crv=a.crv;b[e]=l}function lj(a,b,c,e){new ij([],[],0,"","",0,0,0,0);var l=new ij([],[],0,"","",0,0,0,0);a=a[c];l.M=a.M.slice(0);l.L=a.L.slice(0);l.ca=a.ca;l.na=a.na;l.Aa=a.Aa;l.W.x=a.W.x;l.W.y=a.W.y;l.V.x=a.V.x;l.V.y=a.V.y;b[e]=l}function vk(a,b,c,e){var l;b.length=1;for(l=e.length=1;l<a.length;l++)qi(a,b,l,l);for(l=1;l<c.length;l++)ri(c,e,l,l)}function Gl(a){var b,c,e,l=[];bg=[];cg=[];hf=[];for(b=1;b<a.length;b++)if("C"===a[b].o||2===a[b].a.length){for(c=e=0;c<
a[b].a.length;c++)2===a[b].a[c].t&&e++;2==e&&l.push(b)}for(b=0;b<l.length;b++)if(!bg.includes(l[b])){c=Hl(a,l[b]);if(1===a[c.u].a.length||1===a[c.l].a.length)if(1===a[c.u].a.length&&0===a[c.u].D&&0===a[c.u].F||1===a[c.l].a.length&&0===a[c.l].D&&0===a[c.l].F)continue;0===c.n%2?hf.push(c):cg.push(c)}}function Hl(a,b){var c,e=-1,l=-1,f=new oj(0,0,0,0);var t=[];var q=b;t.push(q);for(c=0;0>e&&20>=c;){var D=!1;for(b=0;b<a[q].a.length;b++)if(2===a[q].a[b].t&&!t.includes(a[q].a[b].p)){q=a[q].a[b].p;t.push(q);
D=!0;break}!1===D&&(e=q);c++}t=[];q=e;t.push(q);bg.push(q);for(c=0;0>l&&20>=c;){D=!1;for(b=0;b<a[q].a.length;b++)if(2===a[q].a[b].t&&!t.includes(a[q].a[b].p)){q=a[q].a[b].p;t.push(q);bg.push(q);D=!0;break}!1===D&&(l=q);c++}a=t.length;1!==a%2?f.s=0:(b=Math.floor(a/2),f.s=t[b]);f.u=e;f.l=l;f.n=a;return f}function wk(a,b,c,e){var l,f=new oj(0,0,0,0),t=0;var q=[];var D=[],y=0,A=0,wa=0,Ea=0,fa=0,Na=0,ua=0,xb=0,Ua=0,La=0,Oc=0,fc=0,Vb=0,Bd=0,Sb=0,Rb=0,Lc=0,tb=0,mc=0,Za=0,Lb=0,tc=0,Ad="";f.s=c.s;f.u=c.u;
f.l=c.l;f.n=c.n;var Dc=a[f.u].x-a[f.s].x;var Yb=a[f.u].y-a[f.s].y;var ad=a[f.l].x-a[f.s].x;var pc=a[f.l].y-a[f.s].y;c=[];var oa=[];var te=[];var jh=[];var Wb=[];var Id=[];for(l=0;l<a[f.u].a.length;l++){if(0!==a[f.u].z&&3<a[f.u].a[l].t){var Ke=Ja(b,f.u,a[f.u].a[l].p);b[Ke].g===f.u&&jh.push(a[f.u].a[l].p)}a[f.u].a[l].p===Ye[f.u]?2!==a[f.u].a[l].t&&(t=1,c.push(a[f.u].a[l].p)):2!==a[f.u].a[l].t&&c.push(a[f.u].a[l].p);2===a[f.u].a[l].t&&(Za=a[f.u].a[l].p);(Hd.includes(String(f.u)+":"+String(a[f.u].a[l].p))||
Hd.includes(String(a[f.u].a[l].p)+":"+String(f.u)))&&q.push(a[f.u].a[l].p)}for(l=0;l<a[f.l].a.length;l++)0!==a[a[f.l].a[l].p].z&&te.push(a[f.l].a[l].p),a[f.l].a[l].p===Ye[f.l]?2!==a[f.l].a[l].t&&(t=2,oa.push(a[f.l].a[l].p)):2!==a[f.l].a[l].t&&oa.push(a[f.l].a[l].p),2===a[f.l].a[l].t&&(mc=a[f.l].a[l].p),(Hd.includes(String(f.l)+":"+String(a[f.l].a[l].p))||Hd.includes(String(a[f.l].a[l].p)+":"+String(f.l)))&&D.push(a[f.l].a[l].p);2>c.length&&(1===a[f.u].F&&"gen"===e&&(Vb=a[f.u].Da,Bd=a[f.u].ca,Sb=a[f.u].tz,
c.unshift(-3)),1===a[f.u].D&&"gen"===e&&(ua=a[f.u].wa,xb=a[f.u].xa,Ua=a[f.u].ma,c.unshift(-2)),1===a[f.u].C&&(y=a[f.u].Fa,A=a[f.u].Ga,wa=a[f.u].ja,c.unshift(-1)),2>c.length&&(0<c[0]?(Lb=(a[Za].x+a[c[0]].x)/2,tc=(a[Za].y+a[c[0]].y)/2,wa=-1*a[c[0]].z):-2===c[0]?(Lb=(a[Za].x+ua)/2,tc=(a[Za].y+xb)/2,wa=-1*Ua):-3===c[0]&&(Lb=(a[Za].x+Vb)/2,tc=(a[Za].y+Bd)/2,wa=-1*Sb),b=a[f.u].x-Lb,Za=a[f.u].y-tc,l=Math.sqrt(b*b+Za*Za),y=a[f.u].x+na*b/l,A=a[f.u].y+na*Za/l,c.unshift(-1)));2>oa.length&&(1===a[f.l].F&&(Rb=
a[f.l].Da,Lc=a[f.l].ca,tb=a[f.l].tz,oa.unshift(-3)),1===a[f.l].D&&(La=a[f.l].wa,Oc=a[f.l].xa,fc=a[f.l].ma,oa.unshift(-2)),1===a[f.l].C&&(Ea=a[f.l].Fa,fa=a[f.l].Ga,Na=a[f.l].ja,oa.unshift(-1)),2>oa.length&&(0<oa[0]?(Lb=(a[mc].x+a[oa[0]].x)/2,tc=(a[mc].y+a[oa[0]].y)/2,Na=-1*a[oa[0]].z):-2===oa[0]?(Lb=(a[mc].x+La)/2,tc=(a[mc].y+Oc)/2,Na=-1*fc):-3===oa[0]&&(Lb=(a[mc].x+Rb)/2,tc=(a[mc].y+Lc)/2,Na=-1*tb),b=a[f.l].x-Lb,Za=a[f.l].y-tc,l=Math.sqrt(b*b+Za*Za),Ea=a[f.l].x+na*b/l,fa=a[f.l].y+na*Za/l,oa.unshift(-1)));
1<oa.length&&D.includes(oa[1])&&oa.reverse();Bc=[];Bc[0]=new kb(a[f.s].j,a[f.s].o,a[f.s].x,a[f.s].y,0,0,0);Wb.push(f.s);if(0===t)c.includes(-1)&&(Bc.push(new kb(1,"H",y-Dc,A-Yb,0,0,wa)),Wb.push(-1),Id.push(Bc.length-1)),c.includes(-2)&&(Bc.push(new kb(1,"H",ua-Dc,xb-Yb,0,0,Ua)),Wb.push(-2),Id.push(Bc.length-1)),c.includes(-3)&&(Bc.push(new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb)),Wb.push(-3),Id.push(Bc.length-1)),oa.includes(-1)&&(Bc.push(new kb(1,"H",Ea-ad,fa-pc,0,0,Na)),Wb.push(-1)),oa.includes(-2)&&(Bc.push(new kb(1,
"H",La-ad,Oc-pc,0,0,fc)),Wb.push(-2)),oa.includes(-3)&&(Bc.push(new kb(1,"H",Rb-ad,Lc-Yb,0,0,tb)),Wb.push(-3));else if(1===t)if(c[0]===Ye[f.u]?(Bc[1]=new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Dc,a[c[0]].y-Yb,0,0,a[c[0]].z),Wb.push(c[0]),Id.push(1),-1!==c[1]?(Bc[2]=new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Dc,a[c[1]].y-Yb,0,0,a[c[1]].z),Wb.push(c[1])):(Bc[2]=new kb(1,"H",y-Dc,A-Yb,0,0,wa),Wb.push(-1))):(Bc[1]=new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Dc,a[c[1]].y-Yb,0,0,a[c[1]].z),Wb.push(c[1]),Id.push(1),-1!==c[0]?
(Bc[2]=-2===c[0]?new kb(1,"H",ua-Dc,xb-Yb,0,0,Ua):-3===c[0]?new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb):new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Dc,a[c[0]].y-Yb,0,0,a[c[0]].z),Wb.push(c[0])):(Bc[2]=new kb(1,"H",y-Dc,A-Yb,0,0,wa),Wb.push(-1))),Id.push(2),-1===oa[0])Bc[3]=new kb(1,"H",Ea-ad,fa-pc,0,0,Na),Wb.push(-1),Bc[4]=-2===oa[1]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[1]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-ad,a[oa[1]].y-pc,0,0,a[oa[1]].z),Wb.push(oa[1]);else if("parse"===
e?(t=Math.min(oa[0],oa[1]),y=Math.max(oa[0],oa[1])):(t=nc.indexOf(oa[0]),y=nc.indexOf(oa[1])),t<y||D.includes(oa[0])||t===y)Bc[3]=-2===oa[0]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[0]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-ad,a[oa[0]].y-pc,0,0,a[oa[0]].z),Wb.push(oa[0]),Bc[4]=-2===oa[1]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[1]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-ad,a[oa[1]].y-pc,0,0,a[oa[1]].z),Wb.push(oa[1]);else{if(t>y||
D.includes(oa[1]))Bc[3]=-2===oa[1]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[1]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-ad,a[oa[1]].y-pc,0,0,a[oa[1]].z),Wb.push(oa[1]),Bc[4]=-2===oa[0]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[0]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-ad,a[oa[0]].y-pc,0,0,a[oa[0]].z),Wb.push(oa[0])}else if(2===t)if(oa[0]===Ye[f.l]?(Bc[1]=new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-ad,a[oa[0]].y-pc,0,0,a[oa[0]].z),Wb.push(oa[0]),
-1!==oa[1]?(Bc[2]=-2===oa[1]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[1]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-ad,a[oa[1]].y-pc,0,0,a[oa[1]].z),Wb.push(oa[1])):(Bc[2]=new kb(1,"H",Ea,fa,0,0,Na),Wb.push(-1))):(Bc[1]=new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-ad,a[oa[1]].y-pc,0,0,a[oa[1]].z),Wb.push(oa[1]),-1!==oa[0]?(Bc[2]=-2===oa[0]?new kb(1,"H",La-ad,Oc-pc,0,0,fc):-3===oa[0]?new kb(1,"H",Rb-ad,Lc-pc,0,0,tb):new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-ad,a[oa[0]].y-pc,
0,0,a[oa[0]].z),Wb.push(oa[0])):(Bc[2]=new kb(1,"H",Ea-ad,fa-pc,0,0,Na),Wb.push(-1))),-1===c[0])Bc[3]=new kb(1,"H",y-Dc,A-Yb,0,0,wa),Wb.push(-1),Id.push(3),Bc[4]=-2===c[1]?new kb(1,"H",ua-Dc,xb-Yb,0,0,Ua):-3===c[1]?new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb):new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Dc,a[c[1]].y-Yb,0,0,a[c[1]].z),Wb.push(c[1]),Id.push(4);else if("parse"===e?(t=Math.min(c[0],c[1]),y=Math.max(c[0],c[1])):(t=nc.indexOf(c[0]),y=nc.indexOf(c[1])),t<y||q.includes(c[0])||t===y)Bc[3]=-2===c[0]?new kb(1,
"H",ua-Dc,xb-Yb,0,0,Ua):-3===c[0]?new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb):new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Dc,a[c[0]].y-Yb,0,0,a[c[0]].z),Wb.push(c[0]),Id.push(3),Bc[4]=-2===c[1]?new kb(1,"H",ua-Dc,xb-Yb,0,0,Ua):-3===c[1]?new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb):new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Dc,a[c[1]].y-Yb,0,0,a[c[1]].z),Wb.push(c[1]),Id.push(4);else if(t>y||q.includes(c[1]))Bc[3]=-2===c[1]?new kb(1,"H",ua-Dc,xb-Yb,0,0,Ua):-3===c[1]?new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb):new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-
Dc,a[c[1]].y-Yb,0,0,a[c[1]].z),Wb.push(c[1]),Id.push(3),Bc[4]=-2===c[0]?new kb(1,"H",ua-Dc,xb-Yb,0,0,Ua):-3===c[0]?new kb(1,"H",Vb-Dc,Bd-Yb,0,0,Sb):new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Dc,a[c[0]].y-Yb,0,0,a[c[0]].z),Wb.push(c[0]),Id.push(4);if("gen"===e){for(l=1;l<Wb.length;l++)te.includes(Wb[l])&&(Bc[l].z=0);for(l=1;l<Wb.length;l++)jh.includes(Wb[l])&&(Bc[l].z=-1*a[f.u].z);if(Bc[Id[0]].z===Bc[Id[1]].z){Kc.push(Wb[0]);return}}q=Il(Bc,aa,[0,1,2,3,4],[0,0,0,0,0],[0,0,0,0,0],4110,e);q=Jl(q);if(0<q)Pg[String(f.s)]=
"@",Ad=a[f.s].I="@";else if(0>q)Pg[String(f.s)]="@@",Ad=a[f.s].I="@@";else if(0===q)return"";if("parse"===e)return Ad}function pj(a,b,c,e,l,f){var t,q=[],D=[],y=[],A="";var wa=[];var Ea=[];var fa=0;Kl(a,b,c,f);if("gen"===f){var Na=l.indexOf(c);var ua=-1;for(t=0;t<a[c].a.length;t++){var xb=l.indexOf(a[c].a[t].p);0<=xb&&xb<Na&&xb>ua&&(ua=xb)}0<=ua&&(fa=l[ua]);t=xk(a,c);Am.includes(e)&&wa.push(0);a[c].C+a[c].D+a[c].F<t&&wa.push(0);0<t&&0!==fa&&1===a[c].C&&wa.push(-1);if(void 0!==Cc[String(c)])for(e=
0;e<Hd.length;e++)ua=Hd[e].split(":"),xb=ua[0],ua=ua[1],xb=parseInt(xb,10),ua=parseInt(ua,10),xb===c&&ua!==fa?wa.push(ua):ua===c&&xb!==fa&&wa.push(xb);0<t&&(1===a[c].D&&wa.push(-2),1===a[c].F&&wa.push(-3));for(e=0;e<a[c].a.length;e++)a[c].a[e].p!==fa&&(wa.includes(a[c].a[e].p)||Ea.push(a[c].a[e].p));Ea=Bm(Ea,c,l);for(e=0;e<Ea.length;e++)wa.push(Ea[e]);0===Na&&0===wa[0]&&wa.shift();q.push(c,fa,wa[0],wa[1],wa[2])}else"parse"===f&&(q=l.slice(0),wa=q.slice(2));D.push(0);for(e=1;e<q.length;e++)0<q[e]?
(fa=Ja(b,c,q[e]),3<b[fa].B&&b[fa].g===c?D.push(1):D.push(0)):D.push(0);y.push(0);for(e=1;e<q.length;e++){Ea=Ja(b,q[e],q[0]);Na=!1;if(0<q[e])for(l=0;l<a[q[e]].a.length;l++)fa=Ja(b,q[e],a[q[e]].a[l].p),3<b[fa].B&&b[fa].g===q[e]&&b[fa].f!==q[0]&&(Na=!0),!0===Na&&3<b[Ea].B&&b[Ea].g===q[e]&&(Na=!1);!0===Na?y.push(1):y.push(0)}l=Kl(a,b,c,f);a=Il(a,b,q,D,y,l,f);if(null===a)return Kc.push(c),"";if(3===wa.length){A=b=0;for(wa=1;5>wa;wa++)0<a[wa].z?A++:0>a[wa].z&&b++;f=a=Cm(a,q,4E3+100*A+10*b);q=new Qd(0,0,
0);new Qd(0,0,0);new Qd(0,0,0);new Qd(0,0,0);new Qd(0,0,0);wa=Pf(f[0],f[1]);A=Pf(f[0],f[2]);a=Pf(f[0],f[3]);b=Pf(f[0],f[4]);f=qj(wa);D=qj(A);y=qj(a);l=qj(b);wa=rj(wa,na/f);A=rj(A,na/D);a=rj(a,na/y);b=rj(b,na/l);f=[];f.push(q);f.push(wa);f.push(A);f.push(a);f.push(b);b=a=f;q=sj(b,1,2,3,4,0);wa=sj(b,2,3,4,1,0);A=sj(b,3,4,1,2,0);b=sj(b,4,1,2,3,0);!1===(q&&wa&&A&&b)?(Kc.push(c),q=0):(q=Jl(a),null===q&&(Kc.push(c),q=0));A=0<q?"@":0>q?"@@":""}return A}function Kl(a,b,c,e){var l=0,f=0;var t=a[c].a.length;
"parse"===e||1!==a[c].C&&1!==a[c].D&&1!==a[c].F||(0<a[c].ja&&l++,0<a[c].ma&&l++,0<a[c].tz&&l++,0>a[c].ja&&f++,0>a[c].ma&&f++,0>a[c].tz&&f++,t+=a[c].C+a[c].D+a[c].F);for(e=0;e<a[c].a.length;e++){var q=Ja(b,c,a[c].a[e].p);4===a[c].a[e].t&&(b[q].f===c?l++:b[q].g===c&&f++);5===a[c].a[e].t&&(b[q].f===c?f++:b[q].g===c&&l++)}return 1E3*t+100*l+10*f}function Hh(a,b){var c=[],e,l,f;lc=[];c.push(b);for(l=0;0<c.length;){b=c.pop();(f=lc.includes(b))||lc.push(b);for(e=0;e<a[b].a.length;e++)(f=lc.includes(a[b].a[e].p))||
c.push(a[b].a[e].p);l++;if(200<l)break}return lc.length}function Nh(a,b,c){var e=[],l="";lc=[];var f=b;0<c&&(lc.push(c),lc.push(b),l+=String(a[c].U)+"-",l+=String(a[b].U));e.push(f);for(c=0;0<e.length;){f=e.pop();var t=lc.includes(f);t||(lc.push(f),0<c&&(l+="-"),l+=String(a[f].U));for(b=0;b<a[f].a.length;b++)(t=lc.includes(a[f].a[b].p))||e.push(a[f].a[b].p);c++;if(200<c)break}return l}function Bm(a,b,c){b=[];var e={},l=-1;b=a.slice(0);for(a=0;a<b.length;a++)l=c.indexOf(b[a]),0<=l&&(e[String(b[a])]=
l);b.sort(function(f,t){return e[String(f)]-e[String(t)]});return b}function xk(a,b){var c,e=0,l,f=!1;var t=Af[a[b].j];for(l=c=0;l<a[b].a.length;l++){var q=a[b].a[l].t;if(4===q||5===q)q=1;c+=q}c<=t&&(f=!0);0!==a[b].s&&(f=!1);"S"!==a[b].o||4!==c&&6!==c||(f=!1);"P"===a[b].o&&5===c&&(f=!1);"C"===a[b].o?e=t-c-Math.abs(a[b].s):kh.includes(a[b].o)&&f?e=t-c+a[b].s:0<a[b].C?e=a[b].C:e=0;return e}function Di(a,b){var c;for(c=0;c<a[b].a.length;c++)if(3===a[b].a[c].t)return a[b].a[c].p;return 0}function Ie(a,
b,c){var e=0;if(0<a[c].a.length)for(b=0;b<a[c].a.length;b++)2===a[c].a[b].t&&e++;return e}function Le(a){var b;for(b=0;b<hf.length;b++){if(a===hf[b].u)return hf[b].l;if(a===hf[b].l)return hf[b].u}return-1}function Ja(a,b,c){var e;for(e=1;e<a.length;e++)if(a[e].f===b&&a[e].g===c||a[e].f===c&&a[e].g===b)return e;return-1}function Dh(a,b){var c;se=[];rd=[];for(c=1;c<b.length;c++){var e=b[c].f;vk(a,ag,b,Bi);var l=Hh(ag,e);var f=c,t;var q=Bi[f].f;var D=Bi[f].g;var y=-1;for(t=0;t<ag[q].a.length;t++)ag[q].a[t].p===
D&&(y=t);0<=y&&ag[q].a.splice(y,1);y=-1;for(t=0;t<ag[D].a.length;t++)ag[D].a[t].p===q&&(y=t);0<=y&&ag[D].a.splice(y,1);Bi.splice(f,1);l===Hh(ag,e)&&(se.push(c),(l=rd.includes(b[c].f))||rd.push(b[c].f),(l=rd.includes(b[c].g))||rd.push(b[c].g))}}function le(a,b,c){var e,l=!1;for(e=0;e<se.length;e++){var f=se[e];if(a[f].f===b&&a[f].g===c||a[f].f===c&&a[f].g===b)l=!0}return l}function Ll(a){var b,c=0,e=0,l=0,f=0;for(b=0;b<a.length;b++)"("===a.charAt(b)&&c++,")"===a.charAt(b)&&e++,"["===a.charAt(b)&&l++,
"]"===a.charAt(b)&&f++;return c!==e?1:l!==f?-1:0}function tg(a,b){return a.length!==b.length?!1:a.join()===b.join()?!0:!1}function tj(a,b){b=b.slice(0);return tg(a.slice(0).sort(function(c,e){return c-e}),b.sort(function(c,e){return c-e}))?!0:!1}function dg(a){var b,c;for(b=0;b<a.length;++b)for(c=b+1;c<a.length;++c)a[b]===a[c]&&a.splice(c--,1);return a}function yk(a,b){var c=a.join();for(a=0;a<b.length;a++){var e=b[a].join();if(c===e)return!0}return!1}function Ei(a,b){var c=[];a=a.concat(b);b=a.length;
for(var e={};b--;){var l=a[b];e[l]||(c.unshift(l),e[l]=!0)}return c}function Fh(a,b){var c=[],e;for(e=0;e<b.length;e++)a.includes(b[e])&&c.push(b[e]);return c}function ia(a){a%=360;0>a&&(a+=360);return a%360}function ld(a,b,c,e){a=Math.atan2(e-b,c-a);0>a&&(a+=2*Math.PI);return ia(360-180*a/Math.PI)}function Ya(a,b,c){return ld(a[b].x,a[b].y,a[c].x,a[c].y)}function lh(a,b,c,e,l,f){c-=a;e-=b;a=l-a;b=f-b;b=(c*a+e*b)/(Math.sqrt(c*c+e*e)*Math.sqrt(a*a+b*b));1<b&&(b=1);-1>b&&(b=-1);return 180*Math.acos(b)/
Math.PI}function Dm(a,b,c,e){var l=Math.sqrt((a[b[e].f].x-a[c].x)*(a[b[e].f].x-a[c].x)+(a[b[e].f].y-a[c].y)*(a[b[e].f].y-a[c].y));a=Fi(a,b[e].f,b[e].g,c);return l*Math.sin(Math.PI*a/180)}function Gi(a,b){return ia(ia(b)-ia(a))}function Me(a,b,c){var e=0,l=[],f=[],t=0,q=0,D=0;Fa=[];for(e=0;e<a[b].a.length;e++)0!==a[a[b].a[e].p].x&&0!==a[a[b].a[e].p].y&&(l.push(Ya(a,b,a[b].a[e].p)),f.push(a[b].a[e].p));l.sort(function(y,A){return y-A});f.sort(function(y,A){return Ya(a,b,y)-Ya(a,b,A)});if(0<f.length){for(e=
0;e<f.length-1;e++)D=Gi(l[e],l[e+1]),t=f[e],q=f[e+1],Fa.push(new Ml(t,q,D));D=Gi(l[f.length-1],l[0]);t=f[f.length-1];q=f[0];Fa.push(new Ml(t,q,D));c&&Fa.sort(function(y,A){return y.$-A.$})}}function um(a,b,c){Fa=[];qb=[];Me(a,b,c);if(0!==Fa.length)for(a=0;a<Fa.length;a++){c=ia(Ya(g,b,Fa[a].ba)+Fa[a].$/2);if(180<Math.floor(Fa[a].$)||0===Math.floor(Fa[a].$))c=ia(180+c);qb.push(c)}}function wl(a,b,c){var e;if(0!==Fa.length){if(1===Fa.length)return 0;for(e=0;e<Fa.length;e++){var l=Ya(a,b,Fa[e].ba);var f=
Ya(a,b,Fa[e].fa);if(f<l||0===l&&f>l){if(c>l&&360>=c||c<f&&0<=c)return e}else if(c>l&&c<f)return e}}return-1}function Zj(a,b){return ia(a+Gi(a,b)/2)}function Qf(a,b,c,e,l){var f=new Yc(0,0),t=new Yc(0,0);new Yc(0,0);f.x=a[c].x-a[b].x;f.y=a[c].y-a[b].y;var q=Math.sqrt(f.x*f.x+f.y*f.y);f.x/=q;f.y/=q;t.x=a[e].x-a[b].x;t.y=a[e].y-a[b].y;q=Math.sqrt(t.x*t.x+t.y*t.y);t.x/=q;t.y/=q;e=xi(f,t);q=Math.sqrt(e.x*e.x+e.y*e.y);return 0===q?ia(Ya(a,b,c)+(!1===l?90:-90)):!1===l?ld(0,0,e.x,e.y):ld(e.x,e.y,0,0)}function Fi(a,
b,c,e){return lh(a[b].x,a[b].y,a[c].x,a[c].y,a[e].x,a[e].y)}function Mf(a,b){var c=a[b].a.slice(0);c.sort(function(e,l){return Ya(a,b,e.p)-Ya(a,b,l.p)});a[b].a=c.slice(0)}function Gh(a,b){var c,e=-1,l=0,f=[];if(0===a[b].a.length)return 0;if(0<a[b].a.length){for(c=0;c<a[b].a.length;){f.push(Ya(a,b,a[b].a[c].p));if(1===a[b].a.length)return ia(180+f[f.length-1]);if(0<c){var t=Gi(f[c-1],f[c]);var q=Zj(f[c-1],f[c]);t>e&&(e=t,l=q)}c++}1<a[b].a.length&&(t=Gi(f[f.length-1],f[0]),q=Zj(f[f.length-1],f[0]),
t>e&&(l=q))}return l}function ak(a,b){b=Math.PI*b/180;return{x:a*Math.cos(b),y:-1*a*Math.sin(b)}}function Em(a,b,c,e,l){var f,t=new Qd(0,0,0),q=[];q=0;var D=-1,y=0,A=f=0;D=0;var wa=q=-1;D=-1;y=0;A=[];y=[];var Ea=A=0,fa=0,Na=0;f=0;f=1;var ua=!1;0!==e[0].z&&(ua=!0);for(f=1;f<e.length;f++)0!==c[f]&&(Na=Math.sqrt((e[f].x-e[0].x)*(e[f].x-e[0].x)+(e[f].y-e[0].y)*(e[f].y-e[0].y)+(e[f].z-e[0].z)*(e[f].z-e[0].z)),A+=(e[f].x-e[0].x)*na/Na,Ea+=(e[f].y-e[0].y)*na/Na,fa+=(e[f].z-e[0].z)*na/Na);f=Math.sqrt(A*A+
Ea*Ea+fa*fa);0<f?(f=na/f,t.x=e[0].x-A*f,t.y=e[0].y-Ea*f,t.z=e[0].z-fa*f):ua=!0;switch(l){case 3100:case 3010:D=-1;A=[];for(f=1;5>f;f++)0!==c[f]&&(q=Ja(b,c[0],c[f]),0===e[f].z||0!==e[f].z&&0<q&&4!==b[q].B&&5!==b[q].B?A.push(f):y.push(f));1===y.length?D=y[0]:ua=!0;ua||(q=[],y=ia(lh(e[0].x,e[0].y,e[A[0]].x,e[A[0]].y,e[A[1]].x,e[A[1]].y)),f=ia(lh(e[0].x,e[0].y,e[D].x,e[D].y,e[A[0]].x,e[A[0]].y)),A=ia(lh(e[0].x,e[0].y,e[D].x,e[D].y,e[A[1]].x,e[A[1]].y)),q.push(y,f,A),q.sort(function(xb,Ua){return xb-Ua}),
180>=q[0]+q[1]?t.z=0:(t.x=e[D].x,t.y=e[D].y,t.z=-1*e[D].z));break;case 3110:for(f=1;5>f;f++)0!==c[f]&&0===e[f].z?D=f:0!==c[f]&&0!==e[f].z&&(0<e[f].z?q=f:0>e[f].z&&(wa=f));if(-1<q&&-1<wa&&-1<D)if(y=ia(lh(e[0].x,e[0].y,e[q].x,e[q].y,e[wa].x,e[wa].y)),f=ia(lh(e[0].x,e[0].y,e[D].x,e[D].y,e[q].x,e[q].y)),A=ia(lh(e[0].x,e[0].y,e[D].x,e[D].y,e[wa].x,e[wa].y)),D=Math.min(f,A),180<=y+D||y>f&&y>A)if(Dh(a,b),rd.includes(c[0])){D=0;for(f=1;f<c.length;f++)0===c[f]||rd.includes(c[f])||f!==q&&f!==wa||(D=f);0!==
D&&(t.z=-1*e[D].z,y=ia(ld(e[0].x,e[0].y,e[D].x,e[D].y)+30),t.x=e[0].x+na*Math.cos(Math.PI*y/180),t.y=e[0].y-na*Math.sin(Math.PI*y/180))}else ua=!0;else t.z=0;break;case 3200:case 3020:case 3300:case 3030:case 3210:case 3120:t.z=0}return!1===ua?t:null}function xi(a,b){var c=new Yc(0,0);c.x=b.x+a.x;c.y=b.y+a.y;return c}function kj(a,b){var c=new Yc(0,0);c.x=a.x-b.x;c.y=a.y-b.y;return c}function uj(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function Pf(a,b){var c=new Qd(0,0,0);c.x=b.x-a.x;c.y=b.y-a.y;c.z=
b.z-a.z;return c}function qj(a){return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)}function rj(a,b){var c=new Qd(0,0,0);c.x=a.x*b;c.y=a.y*b;c.z=a.z*b;return c}function ug(a,b,c,e){var l=Q[b].x;var f=Q[b].y;var t=Q[c].x;var q=Q[c].y;var D=Q[a].x;var y=Q[a].y;a=(t-l)*(y-f)-(D-l)*(q-f);a/=Math.abs(a);l=Q[c].x;f=Q[c].y;t=Q[b].x;q=Q[b].y;D=Q[e].x;y=Q[e].y;b=(t-l)*(y-f)-(D-l)*(q-f);b/=Math.abs(b);return a*b}function Hi(a,b,c,e,l,f,t,q){a=(l-c)*(b-e)-(a-c)*(f-e);a/=Math.abs(a);c=(c-l)*(q-f)-(t-l)*(e-f);c/=Math.abs(c);
return a*c}function Jg(a,b,c,e){a=a*e-c*b;return 0===Math.abs(a)?0:a/Math.abs(a)}function Il(a,b,c,e,l,f){new Qd(0,0,0);var t=[],q,D=!1;for(q=0;q<c.length;q++){if(0>c[q]){var y=a;var A=c[0],wa=Math.abs(c[q]),Ea=new Qd(0,0,0);1===wa?(Ea.x=y[A].Fa,Ea.y=y[A].Ga,Ea.z=.5*na*y[A].ja):2===wa?(Ea.x=y[A].wa,Ea.y=y[A].xa,Ea.z=.5*na*y[A].ma):3===wa&&(Ea.x=y[A].Da,Ea.y=y[A].ca,Ea.z=.5*na*y[A].tz);y=Ea}else 0<c[q]?(y=a,A=c[q],wa=new Qd(0,0,0),wa.x=y[A].x,wa.y=y[A].y,wa.z=.5*na*y[A].z,y=wa):y={x:0,y:0,z:0};t.push(y)}for(q=
1;q<c.length;q++)1===e[q]&&(t[q].z=-1*t[0].z,t[0].z=0);for(q=1;q<c.length;q++)1===l[q]&&(t[q].z=0);for(q=1;q<c.length;q++)0===c[q]&&(y=Em(a,b,c,t,f),null!==y?(t[q].x=y.x,t[q].y=y.y,t[q].z=y.z):D=!0);for(q=0;q<t.length;q++)0<t[q].z&&(t[q].z=.5*na),0>t[q].z&&(t[q].z=-.5*na);return D?null:t}function Cm(a,b,c){var e=b=0,l=0,f=0;f=0;var t=[],q=[1,2,3,4];switch(c){case 4100:case 4010:for(b=1;5>b;b++)0!==a[b].z&&(e=a[b].z,l=b);t.push(0);for(b=1;5>b;b++)f=ld(a[0].x,a[0].y,a[b].x,a[b].y),t.push(f);f=t[l];
for(b=1;5>b;b++)t[b]=ia(t[b]-f);q.sort(function(D,y){return t[D]-t[y]});for(b=1;5>b;b++)b!==l&&b!==q[2]&&(a[b].z=-1*e);a[q[2]].z=e;break;case 4200:for(b=1;5>b;b++)0===a[b].z&&(a[b].z=-.5*na);break;case 4020:for(b=1;5>b;b++)0===a[b].z&&(a[b].z=.5*na);break;case 4300:case 4030:for(b=1;5>b;b++)0===a[b].z?l=b:e=a[b].z;for(b=1;5>b;b++)b===l&&(a[b].x=a[0].x,a[b].y=a[0].y,a[b].z=0<e?-.5*na:.5*na);break;case 4310:for(b=1;5>b;b++)0>a[b].z&&(a[b].x=a[0].x,a[b].y=a[0].y);break;case 4130:for(b=1;5>b;b++)0<a[b].z&&
(a[b].x=a[0].x,a[b].y=a[0].y)}return a}function zk(a,b){return a.x*b.x+a.y*b.y+a.z*b.z}function Nl(a,b){var c=new Qd(0,0,0);c.x=a.y*b.z-a.z*b.y;c.y=a.z*b.x-a.x*b.z;c.z=a.x*b.y-a.y*b.x;return c}function sj(a,b,c,e,l,f){new Qd(0,0,0);new Qd(0,0,0);new Qd(0,0,0);new Qd(0,0,0);new Qd(0,0,0);c=Pf(a[b],a[c]);e=Pf(a[b],a[e]);l=Pf(a[b],a[l]);a=Pf(a[b],a[f]);f=Nl(c,e);b=zk(f,l);a=zk(f,a);f=b/Math.abs(b)===a/Math.abs(a);return 0==b||0==a?!1:f?!0:!1}function Jl(a){new Qd(0,0,0);new Qd(0,0,0);new Qd(0,0,0);new Qd(0,
0,0);var b=Pf(a[1],a[2]);var c=Pf(a[1],a[3]);a=Pf(a[1],a[4]);c=Nl(c,a);b=zk(b,c);return 0==b?null:b/Math.abs(b)}function Oh(a,b,c,e,l,f){var t,q=[];for(t=1;t<a.length;t++)if(a[t].v===b){q.push(t);var D=ia(180*Math.atan2(a[t].x-c,e-a[t].y)/Math.PI);var y=Math.sqrt((a[t].x-c)*(a[t].x-c)+(a[t].y-e)*(a[t].y-e));var A=y*Math.sin(Math.PI*ia(D+l)/180);D=-y*Math.cos(Math.PI*ia(D+l)/180);a[t].x=c+A;a[t].y=e+D;f&&(a[t].v=0)}}function fh(a,b,c,e){var l;new zd(0,0,0,0);var f=0,t=0;if(!1!==ze){var q=Fd(a,e,"s");
"y"===c?(f=-1*(q.b+q.c/2),t=0):"x"===c&&(t=-1*(q.t+q.h/2),f=0);Ai(a,f,t,e);for(q=1;q<a.length;q++)if(-1===e||a[q].v===e)if("y"===c?a[q].x*=-1:"x"===c&&(a[q].y*=-1),0!==a[q].z)for(l=0;l<a[q].a.length;l++)4===a[q].a[l].t?$c(g,aa,Ja(b,q,a[q].a[l].p),5,!1):5===a[q].a[l].t&&$c(g,aa,Ja(b,q,a[q].a[l].p),4,!1);Ai(a,-1*f,-1*t,e);for(l=1;l<a.length;l++)-1!==e&&a[l].v!==e||Mf(a,l);for(q=0;q<Pa.length;q++)if(0<Pa[q].G){if(g[Pa[q].G].v===e||-1===e)Pa[q].crv=0<Pa[q].crv?-1:1}else if(g[aa[-1*Pa[q].G].f].v===e||
-1===e)Pa[q].crv=0<Pa[q].crv?-1:1;Xc()}}function nj(a,b,c,e,l){var f;for(f=1;f<a.length;f++)if(a[f].v===b||0===b)a[f].x+=c,a[f].y+=e,l&&(a[f].v=0)}function Ph(a,b){a=String(a);if(a.length>=b)return a;for(;a.length<b;)a="0"+a;return a}function Fm(a,b){if(a.length>=b)return a;for(;a.length<b;)a="0"+a;return a}function Yc(a,b){this.x=a;this.y=b}function Qd(a,b,c){this.x=a;this.y=b;this.z=c}function Ml(a,b,c){this.ba=a;this.fa=b;this.$=c}function zd(a,b,c,e){this.b=a;this.t=b;this.c=c;this.h=e}function rk(a,
b){this.r=a;this.ab=b;this.ka=0;this.cb=[];this.pa=[];this.A=[];this.aa=[]}function oj(a,b,c,e){this.s=a;this.u=b;this.l=c;this.n=e}function uk(a,b){this.p=a;this.t=b}function kb(a,b,c,e,l,f,t){this.Ca=this.v=0;this.j=a;this.o=b;this.N=0;this.x=c;this.y=e;this.s=l;this.z=t;this.r=!1;this.U=0;this.C=f;this.tz=this.ca=this.Da=this.F=this.ma=this.xa=this.wa=this.D=this.ja=this.Ga=this.Fa=0;this.I="";this.X=!1;this.t=this.H=0;this.a=[];this.za=[];this.ya=[]}function Ce(a,b,c){this.gb=this.v=0;this.f=
a;this.g=b;this.B=c}function jj(a,b,c,e){this.G=a;this.K=b;this.ca=c;this.crv=e}function ij(a,b,c,e,l,f,t,q,D){this.M=a.slice(0);this.L=b.slice(0);this.ca=c;this.na=e;this.Aa=l;this.W=new Yc(f,t);this.V=new Yc(q,D)}function bk(){function a(m){var u;vk(df,Q,ef,Ka);for(u=1;u<Q.length;)Q[u].v!==m&&(ki(Q,Ka,u,!1),u--),u++}function b(m){var u,r,w,G=!1;for(u=1;u<m.length;u++){var K=qe.indexOf(m[u].o);if(0<=K)var B="1010600"+String(Math.min(K+10,99))+"00000";else{B=String(m[u].a.length);for(r=w=K=0;r<m[u].a.length;r++){var N=
m[u].a[r].t;if(4===N||5===N)N=1;K+=N}B+=Ph(K,2);B+=Ph(m[u].j,2);B=0===m[u].s?B+"0":0<m[u].s?B+"1":B+"2";B+=String(Math.abs(m[u].s));r=Af[m[u].j];K<=r&&(G=!0);0!==m[u].s&&(G=!1);m[u].r&&(G=!1);"S"!==m[u].o||4!==K&&6!==K||(G=!1);"P"===m[u].o&&5===K&&(G=!1);"C:"===m[u].o&&(r=2);"N:"===m[u].o&&(r=1);kh.includes(m[u].o)&&G?"C"===m[u].o?w=r-K-Math.abs(m[u].s):w=r-K+m[u].s:kh.includes(m[u].o)&&!G?("C"===m[u].o?w=r-K-Math.abs(m[u].s):w=r-K+m[u].s,m[u].r&&w--):kh.includes(m[u].o)||0===r?w=0:(w=r-K+m[u].s,
m[u].r&&w--);B+="0"+String(Math.max(Math.min(w,4),0));B+=Ph(m[u].N,3);B+=Ph(m[u].F,1)+Ph(m[u].D,1)}m[u].U=parseInt(B,10)}}function c(m,u,r){for(u=1;u<m.length;u++)m[u].U*=2;m[r].U--;e(m)}function e(m){var u,r=[],w=0,G={};r[0]=0;for(u=1;u<m.length;u++)r[u]=m[u].U;r.sort(function(K,B){return K-B});G={};w=0;for(u=1;u<r.length;u++)r[u]>r[u-1]&&(w++,G[String(r[u])]=w);for(u=1;u<m.length;u++)m[u].U=G[String(m[u].U)];return w}function l(m){var u=0,r;for(r=e(m);r!==u;){u=r;var w,G=m,K=[];for(w=1;w<G.length;w++){var B=
1;for(r=0;r<G[w].a.length;r++){var N=G[w].a[r].p;N=Ol[G[N].U];B*=N}K[w]=B}for(w=0;w<G.length;w++)G[w].U=parseInt(String(G[w].U)+Ph(K[w],12),10);r=e(m)}}function f(m){var u,r,w;for(u=1;u<m.length;u++){var G=w="";for(r=0;r<m[u].a.length;r++){var K=String(m[m[u].a[r].p].U);w=""===G?w+("["+String(m[u].a[r].p)):K===G?w+(","+String(m[u].a[r].p)):w+("];["+String(m[u].a[r].p));G=K}w+="]";mh[u]=w}}function t(m){var u,r,w=!1,G=1,K="";var B=mh[m].split(";");for(u=0;u<B.length;u++){var N=1;var ha=B[u].replace("[",
"");ha=ha.replace("]","");ha=ha.split(",");if(r=1<ha.length){a:{r=m;var Z=parseInt(ha[0],10),ka=parseInt(ha[1],10);if(2==ha.length){var ca=Wb(r);var Oa=Wb(Z);var nb=Wb(ka);if(ca===Oa&&ca===nb&&-1<ca&&(Z=Ja(Ka,r,Z),r=Ja(Ka,r,ka),-1<Z&&-1<r&&(2===Ka[Z].B&&1===Ka[r].B||1===Ka[Z].B&&2===Ka[r].B))){r=!0;break a}}r=!1}r=!r}if(r){w=!0;K+=B[u];for(r=1;r<=ha.length;r++)N*=r;G*=N}}w?(Zb.push(Number(m)),eg[m]=K):eg[m]="";return G}function q(){function m(ca){var Oa,nb=[];if(0===ca.length)return[[]];for(Oa=0;Oa<
ca.length;Oa++){var Qa=ca.slice(0);var xa=Qa.splice(Oa,1);var gc=m(Qa);for(Qa=0;Qa<gc.length;Qa++){var eb=xa.concat(gc[Qa]);nb.push(eb)}}return nb}function u(ca,Oa){var nb,Qa,xa=[];for(nb=0;nb<ca.length;nb++)for(Qa=0;Qa<Oa.length;Qa++){var gc=ca[nb];var eb=Oa[Qa];gc=gc+","+eb;xa.push(gc)}return xa}var r,w=[],G=[[]],K="";var B=[];var N="";var ha=[],Z=[],ka=[];for(r=0;r<Zb.length;r++){ha=[];N=eg[Zb[r]];N=N.replace("][",";");N=N.replace("[","");N=N.replace("]","");w=N.split(";");Z=[];for(N=0;N<w.length;N++){G=
[[]];ka=[];B=w[N].split(",");ha.push(B.length);G=m(B);for(B=0;B<G.length;B++)K=G[B].join(),ka.push(K);0<Z.length?Z=u(Z,ka):Z=ka}vg[r]=Z.slice(0);Ii[r]=Z.length}}function D(m){var u,r,w,G=m,K=Ii.slice(0);for(u=0;u<m;u++)Mb[u]=[];for(w=0;w<Zb.length;w++)for(G/=K[w],u=r=0;u<m;u++)Mb[u].push(r),0===(u+1)%G&&(r++,r===K[w]&&(r=0))}function y(m,u){var r=[],w=[],G=[];var K="";K=[];w=Zb.indexOf(m);var B=Q[m].a.slice(0);for(K=0;K<Q[m].a.length;K++)r[K]=Q[m].a[K].p;K=vg[w].slice();K=K[u];w=K.split(",");for(K=
0;K<w.length;K++)w[K]=Number(w[K]);for(K=u=0;K<r.length;K++)w.includes(r[K])?(G[K]=w[u],u++):G[K]=r[K];B.sort(function(N,ha){return G.indexOf(N.p)-G.indexOf(ha.p)});Q[m].a=B.slice(0)}function A(m,u){var r;Ab=[];for(r=0;r<u.length;r++)if(!(2!==u[r].B||bg.includes(u[r].f)&&bg.includes(u[r].g))){if(1<m[u[r].f].a.length&&1<m[u[r].g].a.length){if(11>m[u[r].f].j&&1<Ie(m,u,u[r].f)||11>m[u[r].g].j&&1<Ie(m,u,u[r].g))continue;if(11>m[u[r].f].j&&3<m[u[r].f].a.length||11>m[u[r].g].j&&3<m[u[r].g].a.length)continue;
if(2===m[u[r].f].a.length&&3===m[u[r].f].a[0].t||2===m[u[r].g].a.length&&3===m[u[r].g].a[0].t||2===m[u[r].f].a.length&&3===m[u[r].f].a[1].t||2===m[u[r].g].a.length&&3===m[u[r].g].a[1].t)continue;if(!bg.includes(u[r].f)&&!bg.includes(u[r].g))if(!le(u,u[r].f,u[r].g))Ab.push(r);else if(!m[u[r].f].X&&!m[u[r].g].X){var w=Wb(u[r].f);var G=Wb(u[r].g);w===G&&0<=w&&w<wg&&8<=cb[w].length&&Ab.push(r)}}(1<m[u[r].g].a.length&&(1===m[u[r].f].D||1===m[u[r].f].F)||1<m[u[r].f].a.length&&(1===m[u[r].g].D||1===m[u[r].g].F)||
!(1!==m[u[r].f].D&&1!==m[u[r].f].F||1!==m[u[r].g].D&&1!==m[u[r].g].F))&&Ab.push(r)}}function wa(m,u){var r;for(r=0;r<Ab.length;r++){var w=u[Ab[r]].f;var G=u[Ab[r]].g;var K;var B=m;var N,ha=0,Z=0,ka=0,ca=0;var Oa=Wb(w);var nb=Wb(G);if(-1<Oa&&-1===nb){for(K=N=0;K<B[w].a.length;K++)2!==B[w].a[K].t&&Wb(B[w].a[K].p)===Oa&&(0===N?ha=B[w].a[K].p:1===N&&(Z=B[w].a[K].p),N++);if(2===N){for(K=N=0;K<B[G].a.length;K++)2!==B[G].a[K].t&&(0===N?ka=B[G].a[K].p:1===N&&(ca=B[G].a[K].p),N++);B=ug(ha,w,G,ka);Wc[String(w)+
"-"+String(G)]={w:w,t:G,O:ha,P:Z,S:ka,R:ca,T:B,Ra:[Oa]};ue[Oa].includes(String(w)+"-"+String(G))||ue[Oa].push(String(w)+"-"+String(G))}}else if(-1===Oa&&-1<nb){for(K=N=0;K<B[G].a.length;K++)2!==B[G].a[K].t&&Wb(B[G].a[K].p)===nb&&(0===N?ha=B[G].a[K].p:1===N&&(Z=B[G].a[K].p),N++);if(2===N){for(K=N=0;K<B[w].a.length;K++)2!==B[w].a[K].t&&(0===N?ka=B[w].a[K].p:1===N&&(ca=B[w].a[K].p),N++);B=ug(ha,G,w,ka);Wc[String(G)+"-"+String(w)]={w:G,t:w,O:ha,P:Z,S:ka,R:ca,T:B,Ra:[nb]};ue[nb].includes(String(G)+"-"+
String(w))||ue[nb].push(String(G)+"-"+String(w))}}else if(-1<Oa&&-1<nb&&Oa!==nb){for(K=N=0;K<B[w].a.length;K++)2!==B[w].a[K].t&&Wb(B[w].a[K].p)===Oa&&(0===N?ha=B[w].a[K].p:1===N&&(Z=B[w].a[K].p),N++);if(2===N){for(K=N=0;K<B[G].a.length;K++)2!==B[G].a[K].t&&Wb(B[G].a[K].p)===nb&&(0===N?ka=B[G].a[K].p:1===N&&(ca=B[G].a[K].p),N++);2===N&&(B=ug(ha,G,w,ka),Wc[String(w)+"-"+String(G)]={w:w,t:G,O:ha,P:Z,S:ka,R:ca,T:B,Ra:[Oa,nb]},ue[nb].includes(String(w)+"-"+String(G))||ue[nb].push(String(w)+"-"+String(G)),
ue[Oa].includes(String(w)+"-"+String(G))||ue[Oa].push(String(w)+"-"+String(G)))}}}for(r=0;r<Ab.length;r++)if(w=u[Ab[r]].f,G=u[Ab[r]].g,""===m[w].I||""===m[G].I)void 0!==E[String(w)+"-"+String(G)]&&delete E[String(w)+"-"+String(G)],void 0!==E[String(G)+"-"+String(w)]&&delete E[String(G)+"-"+String(w)],Ea(m,u,w,G);Rb();if(0<W.length)for(r=0;r<W.length;r++){w=!0;B=W[r][W[r].length-1];B=B.split("-");G=parseInt(B[1],10);vd=[];if(3===m[G].a.length){Oa=[];for(B=0;B<m[G].a.length;B++)2!==m[G].a[B].t&&Oa.push(m[G].a[B].p);
Sb(m,Oa[0],G);Sb(m,Oa[1],G);B=Lc(m,u,0,1,!1);0===B&&(w=!1)}else 1===m[G].a.length&&(w=!1);B=W[r][0];B=B.split("-");G=parseInt(B[1],10);vd=[];if(3===m[G].a.length){Oa=[];for(B=0;B<m[G].a.length;B++)2!==m[G].a[B].t&&Oa.push(m[G].a[B].p);Sb(m,Oa[0],G);Sb(m,Oa[1],G);B=Lc(m,u,0,1,!1);0===B&&(w=!1)}else 1===m[G].a.length&&(w=!1);if(w)for(B=0;B<W[r].length;B++)w=m,G=W[r][B],void 0===E[G]&&void 0!==Wc[G]&&(E[G]={w:Wc[G].w,t:Wc[G].t,O:Wc[G].O,P:Wc[G].P,S:Wc[G].S,R:Wc[G].R,T:Wc[G].T},Oa=String(E[G].t)+"-"+
String(E[G].w),w[E[G].w].I=1===E[G].T?"t":"c",w[E[G].t].I=1===E[G].T?"t":"c",void 0===E[Oa]&&(E[Oa]={w:Wc[G].t,t:Wc[G].w,O:Wc[G].S,P:Wc[G].R,S:Wc[G].O,R:Wc[G].P,T:Wc[G].T}))}}function Ea(m,u,r,w){var G,K=[],B=[],N=0,ha=0,Z=0,ka=0,ca=0;for(G=0;G<m[r].a.length;G++)2!==m[r].a[G].t&&K.push(m[r].a[G].p);1===K.length?(N=K[0],ha=0):2===K.length&&(vd=[],Sb(m,K[0],r),Sb(m,K[1],r),G=Lc(m,u,0,1,!0),0===G?ha=N=0:(1===G&&(N=K[0],ha=K[1]),-1===G&&(N=K[1],ha=K[0])));for(G=0;G<m[w].a.length;G++)2!==m[w].a[G].t&&
B.push(m[w].a[G].p);1===B.length?(Z=B[0],ka=0):2===B.length&&(vd=[],Sb(m,B[0],w),Sb(m,B[1],w),G=Lc(m,u,0,1,!0),0===G?ka=Z=0:(1===G&&(Z=B[0],ka=B[1]),-1===G&&(Z=B[1],ka=B[0])));if(0!==N&&0!==Z){ca=ug(N,r,w,Z);if(0===ca||ca!=ca)Ya(m,N,r)===Ya(m,r,w)&&Kc.push(r),Ya(m,Z,w)===Ya(m,w,r)&&Kc.push(w),ca=0;2!==K.length||ug(N,r,w,Z)!==ug(ha,r,w,Z)&&Ya(m,ha,r)!==Ya(m,r,w)||Kc.push(r);2!==B.length||ug(Z,w,r,N)!==ug(ka,w,r,N)&&Ya(m,ka,w)!==Ya(m,w,r)||Kc.push(w)}else 0===K.length&&0<Z&&(1===m[r].D||1===m[r].F)?
1===m[r].D?ca=Hi(m[r].wa,m[r].xa,m[r].x,m[r].y,m[w].x,m[w].y,m[Z].x,m[Z].y):1===m[r].F&&(ca=Hi(m[r].Da,m[r].ca,m[r].x,m[r].y,m[w].x,m[w].y,m[Z].x,m[Z].y)):0===B.length&&0<N&&(1===m[w].D||1===m[w].F)?1===m[w].D?ca=Hi(m[N].x,m[N].y,m[r].x,m[r].y,m[w].x,m[w].y,m[w].wa,m[w].xa):1===m[w].F&&(ca=Hi(m[N].x,m[N].y,m[r].x,m[r].y,m[w].x,m[w].y,m[w].Da,m[w].ca)):0!==K.length||0!==B.length||1!==m[r].D&&1!==m[r].F||1!==m[w].D&&1!==m[w].F?ca=0:ca=Hi(m[r].wa,m[r].xa,m[r].x,m[r].y,m[w].x,m[w].y,m[w].wa,m[w].xa);
1===ca?(void 0===E[String(r)+"-"+String(w)]&&void 0===E[String(w)+"-"+String(r)]&&(E[String(r)+"-"+String(w)]={w:r,t:w,O:N,P:ha,S:Z,R:ka,T:ca},E[String(w)+"-"+String(r)]={w:w,t:r,O:Z,P:ka,S:N,R:ha,T:ca}),m[r].I="t",m[w].I="t"):-1!==ca||le(u,r,w)||(void 0===E[String(r)+"-"+String(w)]&&void 0===E[String(w)+"-"+String(r)]&&(E[String(r)+"-"+String(w)]={w:r,t:w,O:N,P:ha,S:Z,R:ka,T:ca},E[String(w)+"-"+String(r)]={w:w,t:r,O:Z,P:ka,S:N,R:ha,T:ca}),m[r].I="c",m[w].I="c")}function fa(m,u,r){for(var w in Wc)if(Wc.hasOwnProperty(w))switch(r){case "f":if(Wc[w].w===
u)return w;case "t":if(Wc[w].t===u)return w;case "fl1":if(Wc[w].O===u)return w;case "fl2":if(Wc[w].P===u)return w;case "tl1":if(Wc[w].S===u)return w;case "tl2":if(Wc[w].R===u)return w;case "rx":if(Wc[w].Ra===u)return w}return""}function Na(m,u){var r;for(r=0;r<hf.length;r++){var w=hf[r].u;var G=hf[r].l;""!==m[w].I&&""!==m[G].I&&m[w].I===m[G].I||Ea(m,u,w,G)}}function ua(m,u){var r,w,G=0,K=0,B,N;for(w=0;w<cg.length;w++){var ha={s:0,u:0,l:0,n:0};ha.s=cg[w].s;ha.u=cg[w].u;ha.l=cg[w].l;ha.n=cg[w].n;if(""===
m[ha.s].I){var Z=N=B=!1;for(r=0;r<m[ha.u].a.length;r++)4===m[ha.u].a[r].t&&(N=!0),5===m[ha.u].a[r].t&&(Z=!0);if(0<m[ha.u].C&&0<m[ha.u].ja||0<m[ha.u].D&&0<m[ha.u].ma||0<m[ha.u].F&&0<m[ha.u].tz)N=!0;if(0<m[ha.u].C&&0>m[ha.u].ja||0<m[ha.u].D&&0>m[ha.u].ma||0<m[ha.u].F&&0>m[ha.u].tz)Z=!0;if(Z||N)B=!0,K=ha.u,G=ha.l;Z=N=!1;for(r=0;r<m[ha.l].a.length;r++)4===m[ha.l].a[r].t&&(N=!0),5===m[ha.l].a[r].t&&(Z=!0);if(0<m[ha.l].C&&0<m[ha.l].ja||0<m[ha.l].D&&0<m[ha.l].ma||0<m[ha.l].F&&0<m[ha.l].tz)N=!0;if(0<m[ha.l].C&&
0>m[ha.l].ja||0<m[ha.l].D&&0>m[ha.l].ma||0<m[ha.l].F&&0>m[ha.l].tz)Z=!0;(Z||N)&&!1===B?(B=!0,K=ha.l,G=ha.u):(Z||N)&&!0===B&&(B=!1,Kc.push(ha.s));if(B){ha.u=K;ha.l=G;Z=m;var ka=u,ca=0,Oa=0;B=ha.u;r=ha.l;vd=[];for(N=0;N<Z[B].a.length;N++)4!==Z[B].a[N].t&&5!==Z[B].a[N].t||Sb(Z,Z[B].a[N].p,B);if(2===vd.length)ca=Lc(Z,ka,0,1,!0);else if(0===vd.length){if(1===Z[B].D||1===Z[B].F)ca=1}else ca=1;vd=[];for(N=0;N<Z[r].a.length;N++)1===Z[r].a[N].t&&Sb(Z,Z[r].a[N].p,r);2===vd.length?Oa=Lc(Z,ka,0,1,!0):Oa=0===
vd.length?1===Z[r].D||1===Z[B].F?1:0:1;(r=0!==ca&&0!==Oa?!0:!1)&&Mc.push(ha)}}}}function xb(m,u,r){var w;for(w=0;w<Mc.length;w++)wk(m,u,Mc[w],r)}function Ua(m,u,r){var w,G,K;"reset"===r&&(ac=[],Bf=[]);for(w=1;w<m.length;w++)if("add"!==r||""===m[w].I){var B=La(m,u,w);if(G=""!==B?!0:!1){a:{var N,ha=m,Z=u;var ka=w;vd=[];for(K=0;K<ha[ka].a.length;K++)Sb(ha,ha[ka].a[K].p,ka);for(K=0;K<vd.length-1;K++)for(N=K+1;N<vd.length;N++)if(ka=Lc(ha,Z,K,N,!0),0===ka){K=!1;break a}K=!0}!1===K&&(G=!1);G&&!ac.includes(w)&&
(ac.push(w),Cf[String(w)]="",Bf.push(B))}}}function La(m,u,r){var w,G="",K=!1;for(w=0;w<m[r].a.length;w++)if(4===m[r].a[w].t||5===m[r].a[w].t)K=!0;1===m[r].C&&0!==m[r].ja&&(K=!0);1===m[r].D&&0!==m[r].ma&&(K=!0);1===m[r].F&&0!==m[r].tz&&(K=!0);if(K){w=xk(m,r);G=m[r].o+":"+String(m[r].a.length)+":"+String(w)+":"+String(m[r].s);if("N:3:0:0"===G){var B=[];for(w=0;w<m[r].a.length;w++)le(u,r,m[r].a[w].p)&&B.push(m[r].a[w].p);2===B.length&&le(u,B[0],B[1])&&(G="N:3:0:az")}Gm.includes(G)||(K=!1);if(1<xk(m,
r)-(m[r].C+m[r].D+m[r].F)+m[r].C||1<m[r].D||1<m[r].F)K=!1;else if(2>=m[r].a.length)if(("P:2:1:0"===G&&2<=m[r].a.length||"As:2:1:0"===G&&2<=m[r].a.length)&&0<m[r].C)K=!0;else if("C:2:2:0"===G){if(1===m[r].C&&1===m[r].D||1===m[r].C&&1===m[r].F||1===m[r].D&&1===m[r].F||0===m[r].C&&1===m[r].D||0===m[r].C&&1===m[r].F)K=!0}else"C:1:3:0"===G?1===m[r].C&&1===m[r].D&&1===m[r].F&&(K=!0):K=!1}return K?G:""}function Oc(m,u){var r;for(r=0;r<ac.length;r++){var w=pj(m,u,ac[r],Bf[r],nc,"gen");m[ac[r]].I=w;Cf[String(ac[r])]=
w}}function fc(m){var u,r=0;for(u=1;u<m.length;u++)""!==m[u].I&&r++;return r}function Vb(m,u,r){u=[];var w;rb=[];nc=[];Ld="";u.push(r);for(w=0;0<u.length&&rb.length<m.length-1;){var G=u.pop();var K=rb.includes(G);if(!K){rb.push(G);var B="";0<Ca[Ye[G]]&&(B+="(",--Ca[Ye[G]]);B=G===r?B+String(G):B+("\u00b7"+String(G));nc.push(G);Ld+=B;1===m[G].a.length-Ib[G]&&rb.length<m.length-1&&G!==r&&(Ld+=")");for(B=0;B<m[G].a.length;B++)(K=rb.includes(m[G].a[B].p))||u.push(m[G].a[B].p)}w++;if(200<w)break}}function Bd(m,
u,r){var w=[],G,K,B=[];Hd=[];Ye=[];Ca=[];Ib=[];Ca[0]=0;Ib[0]=0;for(G=1;G<m.length;G++)Ca[G]=G===r&&1<m[G].a.length?Math.max(m[G].a.length-1,0):Math.max(m[G].a.length-2,0),Ib[G]=0;w.push(r);for(K=0;0<w.length&&B.length<m.length-1;){r=w.pop();var N=B.includes(r);if(!N){Ye[r]=0;if(0<B.length)for(G=B.length-1;0<=G;G--)if(0<=oi(Q,B[G],r)){Ye[r]=B[G];break}B.push(r);for(G=0;G<m[r].a.length;G++)if(N=B.includes(m[r].a[G].p)){if(m[r].a[G].p!==Ye[r]&&le(u,m[r].a[G].p,r)){N=String(m[r].a[G].p)+":"+String(r);
var ha;a:{for(ha=0;ha<Hd.length;ha++)if(Hd[ha]===N){ha=!0;break a}ha=!1}ha||(Hd.push(N),Ib[r]+=1,Ib[m[r].a[G].p]+=1,Ca[m[r].a[G].p]=Math.max(Ca[m[r].a[G].p]-1,0),Ca[r]=Math.max(Ca[r]-1,0))}}else w.push(m[r].a[G].p)}K++;if(200<K)break}}function Sb(m,u,r){var w=[],G=[],K=[],B={},N=[],ha=[],Z=new rk(0,0),ka;w.push(u);G.push(u);K.push(r);var ca=B[String(u)]=0;N.push(m[u].I);for(""!==m[u].I&&ca++;0<w.length;){var Oa=w.shift();for(ka=0;ka<m[Oa].a.length;ka++){var nb=m[Oa].a[ka].p;G.includes(nb)||nb===r||
(G.push(nb),N.push(m[nb].I),""!==m[nb].I&&ca++,K.push(Oa),B[String(nb)]=B[String(Oa)]+1,w.push(nb))}}for(ka=0;ka<G.length;ka++)ha[ka]=B[String(G[ka])];Z.r=u;Z.ab=r;Z.ka=ca;Z.cb=G.slice(0);Z.pa=ha.slice(0);Z.A=K.slice(0);Z.aa=N.slice(0);vd.push(Z)}function Rb(){var m=0,u=m=0;u="";var r=-1,w=0,G=0,K=[],B=[],N=[],ha=[];if(0!==jf.length){W=[];for(m=0;m<jf.length;m++)ha[m]=jf[m].split(",");K=jf.join().split(",");K=K.filter(function(Z,ka,ca){return ka===ca.indexOf(Z)});for(m=0;m<K.length;m++)for(B.push([]),
u=0;u<ha.length;u++)ha[u][0]!==K[m]&&ha[u][1]!==K[m]||B[B.length-1].push(u);G=w=m=0;u=ha[w][G];r=K.indexOf(u);W.push([]);for(N=[];""!==u&&20>m;){N.includes(u)||(W[W.length-1].push(u),N.push(u));if(N.length>=K.length)break;1===B[r].length?0!==G||N.includes(ha[w][1])?1!==G||N.includes(ha[w][0])?(G=0,w++,W.push([])):G=0:G=1:2===B[r].length&&(B[r][0]===w?(w=B[r][1],ha[w][0]===u?G=1:ha[w][1]===u&&(G=0)):B[r][1]===w&&(w=B[r][0],ha[w][0]===u?G=1:ha[w][1]===u&&(G=0)));if(N.length>=K.length)break;u="";if(void 0===
ha[w][G]||N.includes(ha[w][G]))break;else u=ha[w][G],r=K.indexOf(u);m++}0===W[W.length-1].length&&W.splice(-1,1)}}function Lc(m,u,r,w,G){function K(ka,ca,Oa,nb){var Qa=1;for(ca=0;vd[Oa].pa[ca]<nb;)ca++;for(;vd[Oa].pa[ca]===nb;)Qa*=Ol[ka[vd[Oa].cb[ca]].U],ca++;return Qa}var B=0;var N=vd[r].pa[vd[r].pa.length-1];var ha=vd[w].pa[vd[w].pa.length-1];for(B=0;B<=Math.min(N,ha);){var Z=K(m,u,r,B)-K(m,u,w,B);if(0!==Z){if(0<Z)return 1;if(0>Z)return-1}else{if(B===N&&B===ha&&0===Z)return B=tb(m,u,vd[r].r,vd[w].r,
vd[r].ab,G),0!==B?1:0;B++;if(B>N)return-1;if(B>ha)return 1}}}function tb(m,u,r,w,G,K){function B(ta,Va,lb,Bb){var Cb=[],uc=[],Jb=[],Nb=[];var jc=Va.slice(0);var Rd=jc.indexOf(lb);var fd=jc.indexOf(Bb);for(Va=0;Va<ta[lb].a.length;Va++)2!==ta[lb].a[Va].t&&(Cb.push(ta[lb].a[Va].p),Jb.push(jc.indexOf(ta[lb].a[Va].p)));if(2===Cb.length)Cb=Math.abs(Rd-Jb[0])<Math.abs(Rd-Jb[1])?Cb[0]:Cb[1];else if(1===Cb.length)Cb=Cb[0];else return"";for(Va=0;Va<ta[Bb].a.length;Va++)2!==ta[Bb].a[Va].t&&(uc.push(ta[Bb].a[Va].p),
Nb.push(jc.indexOf(ta[Bb].a[Va].p)));if(2===uc.length)uc=Math.abs(fd-Nb[0])<Math.abs(fd-Nb[1])?uc[0]:uc[1];else if(1===uc.length)uc=uc[0];else return"";if(-1===ug(Cb,lb,Bb,uc))return ta[lb].I="c",ta[Bb].I="c";ta[lb].I="t";return ta[Bb].I="t"}var N=[],ha=[],Z=0,ka=0,ca="",Oa="";Z=ka=Z=ka="";var nb=!1,Qa=!1,xa=!1,gc=!0,eb=!1;ka=Z="";N=0;Nh(m,r,G);N=lc.slice(0);Nh(m,w,G);ha=lc.slice(0);if(N.length===ha.length){for(r=1;r<N.length;r++)K&&N[r]===ha[r]?!1===eb&&(eb=!0,Z=fa(m,G,"f"),ka=fa(m,N[r],"f"),""===
Z||""===ka||jf.includes(Z+","+ka)||jf.includes(ka+","+Z)||jf.push(Z+","+ka)):eb=!1,Z=mc(N[r]),ka=mc(ha[r]),0<Z&&0<ka?(ca=m[N[r]].I,Oa=m[ha[r]].I,"c"===ca&&"c"===Oa||"t"===ca&&"t"===Oa||("c"===ca&&"t"===Oa||"t"===ca&&"c"===Oa?gc=!1:(ca=B(m,N,N[r],Z),Oa=B(m,ha,ha[r],ka),ca!==Oa&&(gc=!1)))):(ka=La(m,u,N[r]),Z=La(m,u,ha[r]),ka===Z&&""!==ka&&(ka=pj(m,u,N[r],ka,N,"gen"),Z=pj(m,u,ha[r],Z,ha,"gen"),""!==ka&&""!==Z&&(ka===Z?!1===nb&&!1===Qa?nb=!0:!0===Qa&&(xa=!0,Qa=nb=!1):!1===nb&&!1===Qa?Qa=!0:!0===nb&&(xa=
!0,Qa=nb=!1))));N=nb&&gc||gc&&!nb&&!Qa&&!xa?0:-1}else N=-1;return N}function mc(m){var u;if(0===m)return-1;for(u=0;u<Ab.length;u++){if(Ka[Ab[u]].f===m&&("c"===Q[m].I||"t"===Q[m].I))return Ka[Ab[u]].g;if(Ka[Ab[u]].g===m&&("c"===Q[m].I||"t"===Q[m].I))return Ka[Ab[u]].f}return-1}function Za(m){function u(ob,Wa){var Pc,F,Sd=0;if(3===ob[Wa].a.length)for(Pc=Sd=0;Pc<ob[Wa].a.length;Pc++)if(2===ob[Wa].a[Pc].t)Sd++;else if(1===ob[Wa].a[Pc].t)for(F=0;F<ob[ob[Wa].a[Pc].p].a.length;F++)2===ob[ob[Wa].a[Pc].p].a[F].t&&
Sd++;return 3===Sd?!0:!1}function r(ob,Wa){var Pc,F,Sd;for(Pc=Sd=0;Pc<ob[Wa].a.length;Pc++)if(1===ob[Wa].a[Pc].t)for(F=0;F<ob[ob[Wa].a[Pc].p].a.length;F++)2===ob[ob[Wa].a[Pc].p].a[F].t&&Sd++;return 2<=Sd?!0:!1}function w(ob,Wa){var Pc,F,Sd="",kf="";var ve=!1;var Ec=Af[ob[Wa].j];for(F=Pc=0;F<ob[Wa].a.length;F++){var de=ob[Wa].a[F].t;if(4===de||5===de)de=1;Pc+=de}Pc<=Ec&&0<Ec&&(ve=!0);0!==ob[Wa].s&&(ve=!1);ob[Wa].r&&(ve=!1);0<ob[Wa].N&&(kf=String(ob[Wa].N),ve=!1);0<Mc.length&&void 0!==Pg[String(Wa)]?
(de=Pg[String(Wa)],ve=!1):de="";0<ac.length&&ac.includes(Wa)&&(void 0!==Cf[String(Wa)]?(de=Cf[String(Wa)],""!==de&&(ve=!1)):de="");"S"!==ob[Wa].o||4!==Pc&&6!==Pc||(ve=!1);"P"===ob[Wa].o&&5===Pc&&(ve=!1);"C:"===ob[Wa].o&&(Ec=2);"N:"===ob[Wa].o&&(Ec=1);F=tk(ob,Wa,!0)+ob[Wa].C-ob[Wa].D-ob[Wa].F;F+Pc+ob[Wa].D+ob[Wa].F!==Ec&&(ve=!1);Ec=ob[Wa].X&&Hm.includes(ob[Wa].o)?ob[Wa].o.toLowerCase():dk.includes(ob[Wa].o)?ob[Wa].o.slice(0,1):ob[Wa].o;ve&&kh.includes(ob[Wa].o)?ob=Ec:(ve=0>=F?"":1===F?"H":"H"+String(F),
0===ob[Wa].s?Sd="":0<ob[Wa].s?(Sd="+"+String(ob[Wa].s),1===ob[Wa].s&&(Sd="+")):0>ob[Wa].s&&(Sd=String(ob[Wa].s),-1===ob[Wa].s&&(Sd="-")),ob="["+kf+Ec+de+ve+Sd+"]");return ob}function G(ob,Wa){var Pc="";0<ob[Wa].D&&0===ob[Wa].F&&(Pc=2>ob[Wa].a.length?0!==nc.indexOf(Wa)?"([2H])".repeat(ob[Wa].D-1)+"[2H]":"([2H])".repeat(ob[Wa].D):"([2H])".repeat(ob[Wa].D));1<=ob[Wa].F&&(Pc=2>ob[Wa].a.length?0!==nc.indexOf(Wa)?"([2H])".repeat(ob[Wa].D)+"([3H])".repeat(ob[Wa].F-1)+"[3H]":"([2H])".repeat(ob[Wa].D)+"([3H])".repeat(ob[Wa].F):
"([2H])".repeat(ob[Wa].D)+"([3H])".repeat(ob[Wa].F));return Pc}var K=0,B=0,N=/\u00b7(\d+)/,ha=[],Z="",ka="",ca="",Oa="",nb=ca="",Qa="",xa=0;K=-1;var gc="",eb="",ta=ka=0,Va="",lb=1,Bb=0,Cb=0,uc=0,Jb=0,Nb=0,jc=0,Rd=0,fd=0;B=0;fd=[];var bc=0,Td="",Ob={};jc=0;var Rf=bc="";Z=[];ka=Z=Ld;for(Vd in Ob)Ob.hasOwnProperty(Vd)&&delete Ob[Vd];if(2===nc.length&&1===m[nc[0]].j&&1===m[nc[1]].j&&(0<m[nc[0]].N||0<m[nc[1]].N)){ka=m[nc[0]].N+m[nc[1]].N;switch(ka){case 2:eb="[H][2H]";break;case 3:eb="[H][3H]";break;case 4:eb=
"[2H][2H]";break;case 5:eb="[2H][3H]";break;case 6:eb="[3H][3H]"}return eb}var Vd=Z.match(/^(\d+)/);if(null!==Vd){ca=String(Vd[0]);Z=Z.slice(Vd.index+ca.length);ta=parseInt(Vd[1],10);gc="";void 0!==Cc[String(ta)]&&(gc=Cc[String(ta)]);if(0<m[ta].D||0<m[ta].F)eb=G(m,ta);nb=w(m,ta);Qa="";K=mc(ta);-1===K&&(K=Le(ta));void 0!==E[String(ta)+"-"+String(K)]&&(Va=String(ta)+"-"+String(K),B=fd=0,Bb=E[Va].t,Cb=E[Va].O,uc=E[Va].P,Jb=E[Va].S,Nb=E[Va].R,Td=String(-1!==mc(Cb)||-1!==Le(Cb)?1:0),Td+=String(-1!==mc(uc)||
-1!==Le(uc)?1:0),Td+=String(-1!==mc(Jb)||-1!==Le(Jb)?1:0),Td+=String(-1!==mc(Nb)||-1!==Le(Nb)?1:0),void 0!==E[Va]&&0===Cb&&0===uc&&(lb=E[String(ta)+"-"+String(K)].T,1===m[ta].D&&0===m[ta].F||0===m[ta].D&&1===m[ta].F||1===m[ta].D&&1===m[ta].F))&&(Qa="",1===lb?bc="/":-1===lb&&(bc="\\"),eb=eb.replace(/\(\[/,"("+bc+"["),Ob[String(K)]=-1===lb?"\\"===bc?"\\":"/":"\\"===bc?"/":"\\");ka=nb+gc+Qa+eb+ka.slice(ca.length);ha.push(ta)}for(;0!==Z.length&&null!==Vd;)if(eb="",Vd=ka.match(N),null!==Vd){ca=String(Vd[0]);
Z=ka.slice(Vd.index+ca.length);ta=parseInt(Vd[1],10);Oa=ka.slice(0,Vd.index);ca=ka.slice(Vd.index+ca.length);if(0<m[ta].D||0<m[ta].F)eb=G(m,ta);for(K=0;K<m[ta].a.length;K++)if(m[ta].a[K].p===Ye[ta]||ha.includes(m[ta].a[K].p)){m[ta].X&&m[m[ta].a[K].p].X?xa=0:xa=m[ta].a[K].t;switch(xa){case 0:case 1:case 4:case 5:gc="";break;case 2:gc="=";break;case 3:gc="#"}if(0<gc.length)break}nb=w(m,ta);Qa="";K=mc(ta);-1===K&&(K=Le(ta));if(-1!==K&&""!==m[ta].I&&""!==m[K].I)if(ha.includes(K)){void 0!==E[Va]&&0===
Jb&&0===Nb&&(/\\\u00b7/.test(ka)||/\/\u00b7/.test(ka)||(eb=Ob[ta]+eb),eb=eb.replace(/\(\[/,"("+Ob[ta]+"["),eb=eb.replace(/\\\(/,"("),eb=eb.replace(/\/\(/,"("));if(void 0!==Cc[String(ta)])for(K=0;K<nc.length;K++)nc[K]!==ta&&void 0!==Cc[String(nc[K])]&&Cc[String(nc[K])]===Cc[String(ta)]&&(Jb!==nc[K]||0!==Nb&&"1"!==Td.charAt(2)?Nb===nc[K]&&(1===lb?Rf="\\"===bc?"/":"\\":Rf=bc,void 0!==Ob[String(Jb)]&&""!==Ob[String(Jb)]&&"0"===Td.charAt(2)&&(Ob[String(Jb)]="")):(1===lb?Rf=bc:Rf="\\"===bc?"/":"\\",void 0!==
Ob[String(Nb)]&&""!==Ob[String(Nb)]&&"0"===Td.charAt(3)&&(Ob[String(Nb)]="")));gc+=nb;gc+=Rf;Rf=""}else{if(void 0!==E[String(ta)+"-"+String(K)]){Va=String(ta)+"-"+String(K);Td="";B=fd=0;Bb=E[Va].t;Cb=E[Va].O;uc=E[Va].P;ha.includes(Cb)&&ha.includes(uc)&&(jc=ha.indexOf(Cb),Rd=ha.indexOf(uc),Cb=ha[Math.max(jc,Rd)],uc=ha[Math.min(jc,Rd)]);Td+=String(-1!==mc(Cb)||-1!==Le(Cb)?1:0);Td+=String(-1!==mc(uc)||-1!==Le(uc)?1:0);Jb=E[Va].S;Nb=E[Va].R;0!==Jb&&0!==Nb&&(jc=nc.indexOf(Jb),Rd=nc.indexOf(Nb),void 0!==
Cc[String(Jb)]&&void 0!==Cc[String(Bb)]&&Cc[String(Jb)]===Cc[String(Bb)]&&(fd=Jb),void 0!==Cc[String(Jb)]&&void 0!==Cc[String(Bb)]&&Cc[String(Jb)]===Cc[String(Bb)]&&(B=Nb),0===fd&&0===B?(Jb=nc[Math.min(jc,Rd)],Nb=nc[Math.max(jc,Rd)]):0!==B&&0===fd&&(Nb=Jb,Jb=B));Td+=String(-1!==mc(Jb)||-1!==Le(Jb)?1:0);Td+=String(-1!==mc(Nb)||-1!==Le(Nb)?1:0);lb=E[Va].T;Cb!==E[Va].O&&(lb*=-1);Jb!==E[Va].S&&(lb*=-1);switch(Td){case "0000":case "0001":case "0010":case "0011":if(!m[Cb].X&&u(m,Cb)){fd=[];for(B=jc=0;B<
m[Cb].a.length;B++)1===m[Cb].a[B].t?fd.push(m[Cb].a[B].p):2===m[Cb].a[B].t&&(jc=m[Cb].a[B].p);2===fd.length&&ha.includes(jc)&&ha.includes(Cb)?(nc.indexOf(fd[0])>nc.indexOf(fd[1])&&(bc=fd[0],fd[0]=fd[1],fd[1]=bc),bc=Qa=ta===fd[0]?"\\":ta===fd[1]&&void 0!==Ob[String(fd[0])]?"\\"===Ob[fd[0]]?"/":"\\":"\\",Ob[String(ta)]=Qa):(bc=Qa="\\",Ob[String(ta)]=Qa)}else if(r(m,Cb)){fd=[];for(B=jc=0;B<m[Cb].a.length;B++)1!==m[Cb].a[B].t||"c"!==m[m[Cb].a[B].p].I&&"t"!==m[m[Cb].a[B].p].I||nc.indexOf(Cb)<nc.indexOf(m[Cb].a[B].p)&&
fd.push(m[Cb].a[B].p);1<fd.length&&ha.includes(Cb)?(fd.sort(function(ob,Wa){return nc.indexOf(ob)-nc.indexOf(Wa)}),ta===fd[0]?(bc=Qa="\\",Ob[String(ta)]=Qa):0<fd.indexOf(ta)&&void 0!==Ob[String(fd[0])]&&(bc=Qa="\\"===Ob[fd[0]]?"/":"\\",Ob[String(ta)]=Qa)):(bc=Qa="\\",Ob[String(ta)]=Qa)}else bc=Qa="\\",Ob[String(ta)]=Qa;break;case "0100":void 0!==Cc[String(uc)]&&ha.includes(uc)&&(bc=Qa="\\",Ob[String(ta)]=Qa);break;case "1000":case "1001":case "1101":case "1010":case "1011":case "1100":case "1111":if(void 0!==
Ob[String(ta)])bc=Qa=Ob[String(ta)];else if(u(m,Cb))for(B=0;B<m[Cb].a.length;B++)1===m[Cb].a[B].t&&void 0!==Ob[String(m[Cb].a[B].p)]?(bc=Qa="\\"===Ob[String(m[Cb].a[B].p)]?"/":"\\",Ob[String(ta)]=Qa):1===m[Cb].a[B].t&&(bc=Qa="\\",Ob[String(ta)]=Qa);else bc=Qa="\\",Ob[String(ta)]=Qa}switch(Td){case "0100":case "0101":case "1101":case "0111":case "1111":case "1100":Ob[String(uc)]="\\";if("0100"===Td||"0101"===Td||"0111"===Td)bc="\\";break;case "0110":nc.indexOf(uc)<nc.indexOf(Jb)?(bc=Ob[String(uc)]=
"\\",Ob[String(Jb)]=1===lb?Ob[String(uc)]:"\\"===Ob[String(uc)]?"/":"\\"):(bc=Ob[String(Jb)]="\\",Ob[String(uc)]=1===lb?Ob[String(Jb)]:"\\"===Ob[String(Jb)]?"/":"\\")}switch(Td){case "0000":case "1000":case "1100":if(void 0===Cc[String(Jb)]||Cc[String(Jb)]!==Cc[String(Bb)])Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\";break;case "0011":case "0010":case "1111":Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\";break;case "1011":case "1010":Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\";break;case "0100":case "0111":Ob[String(Jb)]=
1===lb?bc:"\\"===bc?"/":"\\"}switch(Td){case "0000":case "1000":case "1100":void 0!==Cc[String(Jb)]&&Cc[String(Jb)]===Cc[String(Bb)]&&(Ob[String(Nb)]=-1===lb?bc:"\\"===bc?"/":"\\");break;case "0001":case "1001":case "1011":case "1101":Ob[String(Nb)]=-1===lb?bc:"\\"===bc?"/":"\\";break;case "0011":case "0111":case "1111":Ob[String(Nb)]="\\"===Ob[String(Jb)]?"/":"\\";break;case "0101":Ob[String(Nb)]=-1===lb?bc:"\\"===bc?"/":"\\"}}0===Jb&&0===Nb&&(/\\\u00b7/.test(ka)&&(bc="\\"),/\/\u00b7/.test(ka)&&
(bc="/"),Ob[String(K)]=1===lb?"\\"===bc?"\\":"/":"\\"===bc?"/":"\\");gc=/\\\u00b7/.test(ka)||/\/\u00b7/.test(ka)?gc+nb:gc+(Qa+nb)}else void 0!==Ob[String(ta)]&&""!==Ob[String(ta)]?Qa=Ob[String(ta)]:Qa="",gc+=Qa+nb;void 0!==Cc[String(ta)]&&(gc+=Cc[String(ta)]);ka=Oa+gc+eb+ca;ha.push(ta)}Z=ka.match(/\((\[\dH\])\)$/);null!==Z&&(ka=ka.substring(0,ka.length-6)+Z[1]);return ka}function Lb(m,u,r){var w=m=0,G=0,K="\u00bf";if(0<oc.length)oc.sort(function(B,N){return Math.abs(B.G)-Math.abs(N.G)});else return"";
for(m=0;m<oc.length;m++)G=w=0,0>oc[m].G?Number.isInteger(oc[m].G)?(w=r.indexOf(String(u[-1*oc[m].G].f))+1,G=r.indexOf(String(u[-1*oc[m].G].g))+1,K+=String(w)+"-"+String(G)+":"):(w=-1*(r.indexOf(String(Math.floor(-1*oc[m].G)))+1)-.5,K+=String(w)+":"):0<oc[m].G&&Number.isInteger(oc[m].G)&&(w=r.indexOf(String(oc[m].G))+1,K+=String(w)+":"),0>oc[m].K&&Number.isInteger(oc[m].K)?(w=r.indexOf(String(u[-1*oc[m].K].f))+1,G=r.indexOf(String(u[-1*oc[m].K].g))+1,K+=String(w)+"-"+String(G)+":"):0<oc[m].K&&(w=Number.isInteger(oc[m].K)?
r.indexOf(String(oc[m].K))+1:r.indexOf(String(Math.floor(oc[m].K)))+1.5,K+=String(w)+":"),K+=oc[m].ca+":",K+=0<oc[m].crv?"l":"r",m<oc.length-1&&(K+=";");return K+"\u00bf"}function tc(m){var u=0,r="\u00a7";if(0<m.length){for(u=0;u<m.length;u++)m[u].M.sort(function(w,G){return w-G}),m[u].L.sort(function(w,G){return w-G});m.sort(function(w,G){w=w.M.join()+w.L.join();G=G.M.join()+G.L.join();return w>G?1:G>w?-1:0})}else return"";for(u=0;u<m.length;u++)r+=m[u].M.join()+":"+m[u].L.join()+":"+String(m[u].ca)+
":"+m[u].na+":"+m[u].Aa,u<m.length-1&&(r+=";");return r+"\u00a7"}function Ad(){var m,u="",r="";r=u=0;r=[];var w=[],G="";if(0!==Hd.length){w=[];for(m=0;m<Hd.length;m++)r=Hd[m].split(":"),u=r[0],r=r[1],u=rb.indexOf(parseInt(u,10)),r=rb.indexOf(parseInt(r,10)),w[Hd[m]]=Math.min(u,r);Hd.sort(function(K,B){return w[K]-w[B]});Cc={};for(m=0;m<Hd.length;m++)r=Hd[m].split(":"),u=r[0],r=r[1],G=9<m+1?"%":"",Cc[u]=void 0!==Cc[u]?Cc[u]+(G+String(m+1)):G+String(m+1),Cc[r]=void 0!==Cc[r]?Cc[r]+(G+String(m+1)):G+
String(m+1)}}function Dc(m,u,r){var w=m[r].a.slice(0);w.sort(function(G,K){var B=G.t;var N=K.t;if(4===B||5===B)B=1;if(4===N||5===N)N=1;return m[r].X?m[K.p].U-m[G.p].U:le(u,r,G.p)&&le(u,r,K.p)&&B!==N?B-N:le(u,r,G.p)&&2===B&&!le(u,r,K.p)&&2===N?1:!le(u,r,G.p)&&2===B&&le(u,r,K.p)&&2===N?-1:le(u,r,G.p)&&1<B||le(u,r,K.p)&&1<N?B-N:m[K.p].U===m[G.p].U?(ba.push({m:r,xb:G.p,yb:K.p}),0):m[K.p].U-m[G.p].U});m[r].a=w.slice(0)}function Yb(m){var u;var r=2;for(u=1;u<m.length;u++)r+=m[u].a.length-2;return r/2}function ad(m,
u){var r;if(3>u.length)return!1;var w=u.slice(0);w.push(u[0]);for(u=0;u<w.length-1;u++){var G=!1;for(r=0;r<m[w[u]].a.length;r++)m[w[u]].a[r].p===w[u+1]&&(G=!0);if(!1===G)return!1}return!0}function pc(m,u){var r=m.slice(0).sort(function(K,B){return K-B}),w=u.slice(0).sort(function(K,B){return K-B}),G=0;if(m.length!==u.length)return!1;for(G=0;G<r.length;G++)if(r[G]!==w[G])return!1;return!0}function oa(m,u){function r(ta,Va,lb,Bb,Cb,uc){ta=-1;var Jb=[];var Nb=[];Nb.push(Bb);Nb.push(Cb);var jc=Pb.splice(lb,
1);Jb.push(jc);lb=0;for(Cb=Bb=!1;!Bb&&!Cb&&0<Pb.length;){if(0===uc)for(jc=0,ta=-1;jc<Pb.length;){if(Va[Pb[jc]].f===Nb[Nb.length-1]||Va[Pb[jc]].g===Nb[Nb.length-1]){ta=jc;break}jc++}else if(1===uc)for(jc=Pb.length-1,ta=-1;0<=jc;){if(Va[Pb[jc]].f===Nb[Nb.length-1]||Va[Pb[jc]].g===Nb[Nb.length-1]){ta=jc;break}jc--}0>ta?Cb=!0:Va[Pb[ta]].f===Nb[Nb.length-1]?Nb.includes(Va[Pb[ta]].g)?Va[Pb[ta]].g===Nb[0]&&2<Nb.length&&(Bb=!0,cb.push(Nb),jc=Pb.splice(ta,1),Jb.push(jc),ha.push(Jb)):(Nb.push(Va[Pb[ta]].g),
jc=Pb.splice(ta,1),Jb.push(jc)):Nb.includes(Va[Pb[ta]].f)?Va[Pb[ta]].f===Nb[0]&&2<Nb.length&&(Bb=!0,cb.push(Nb),jc=Pb.splice(ta,1),Jb.push(jc),ha.push(Jb)):(Nb.push(Va[Pb[ta]].f),jc=Pb.splice(ta,1),Jb.push(jc));lb++;if(20<lb)return}if(Bb)return!0;if(Cb)return!1}function w(ta,Va,lb){var Bb;for(Bb=0;Bb<ta.length;Bb++)if(aa[ta[Bb]].f===Va&&aa[ta[Bb]].g===lb||aa[ta[Bb]].f===lb&&aa[ta[Bb]].g===Va)return Bb;return-1}function G(ta,Va){var lb;for(lb=0;lb<Je.length;lb++)if(ta[se[Va]].f===Je[lb]||ta[se[Va]].g===
Je[lb])return!0;return!1}function K(ta){var Va,lb;for(lb=0;lb<Je.length;lb++){var Bb=[];for(Va=0;Va<se.length;Va++)ta[se[Va]].f===Je[lb]?Bb.push(ta[se[Va]].g):ta[se[Va]].g===Je[lb]&&Bb.push(ta[se[Va]].f);Z[lb]=Bb.slice(0)}}var B,N,ha=[],Z=[],ka=[];var ca=[];ka=0;var Oa=[],nb=[];ca=[];var Qa=[],xa=[];ka=ca=0;var gc=[],eb=[];Ci=Yb(m);Dh(m,u);(function(ta,Va){var lb,Bb;Je=[];for(lb=0;lb<rd.length;lb++){var Cb=0;if(2<ta[rd[lb]].a.length){for(Bb=0;Bb<ta[rd[lb]].a.length;Bb++)le(Va,rd[lb],ta[rd[lb]].a[Bb].p)&&
Cb++;3<=Cb&&Je.push(rd[lb])}}})(m,u);Pb=[];for(B=0;B<se.length;B++)G(u,B)||Pb.push(se[B]);cb=[];for(ha=[];0<Pb.length;)r(m,u,0,u[Pb[0]].f,u[Pb[0]].g,0);wg=cb.length;Da=cb.slice(0);if(0<Je.length){ka=[];for(B=0;B<se.length;B++)ka.push(se[B]);for(B=0;B<cb.length;B++){for(N=0;N<cb[B].length-1;N++)ca=w(ka,cb[B][N],cb[B][N+1]),ka.splice(ca,1);ca=w(ka,cb[B][0],cb[B][cb[B].length-1]);ka.splice(ca,1)}Z=[];K(u);for(ca=0;ca<Je.length;ca++)for(N=0;N<Z[ca].length;N++){Pb=[];for(B=0;B<ka.length;B++)Pb[B]=ka[B];
B=w(Pb,Je[ca],Z[ca][N]);r(m,u,B,Je[ca],Z[ca][N],0);r(m,u,B,Je[ca],Z[ca][N],1)}for(B=wg;B<cb.length-1;){for(N=B+1;N<cb.length;)N>B&&pc(cb[B],cb[N])&&(cb.splice(N,1),ha.splice(N,1),N--),N++;B++}for(B=wg;B<cb.length-1;){for(N=B+1;N<cb.length;){if(!pc(cb[B],cb[N])&&(cb[B].length>cb[N].length?(Oa=cb[B].slice(0),nb=cb[N].slice(0)):cb[N].length>cb[B].length&&(Oa=cb[N].slice(0),nb=cb[B].slice(0)),ca=[],ca=Fh(Oa,nb),pc(ca,nb))){Qa=[];for(ca=0;ca<Oa.length-1;ca++)Qa.push(Ja(u,Oa[ca],Oa[ca+1]));Qa.push(Ja(u,
Oa[Oa.length-1],Oa[0]));xa=[];for(ca=0;ca<nb.length-1;ca++)xa.push(Ja(u,nb[ca],nb[ca+1]));xa.push(Ja(u,nb[nb.length-1],nb[0]));for(ca=ka=0;ca<xa.length;ca++)Qa.includes(xa[ca])||(ka=xa[ca]);ca=Math.min(Oa.indexOf(u[ka].f),Oa.indexOf(u[ka].g));ka=Math.max(Oa.indexOf(u[ka].f),Oa.indexOf(u[ka].g));ca=nb.includes(Oa[ca+1])?Oa.slice(ka).concat(Oa.slice(0,ca+1)):Oa.slice(ca,ka-ca+1);gc.push(ca);eb.push(Oa)}N++}B++}for(B=0;B<gc.length-1;){for(N=B+1;N<gc.length;)N>B&&pc(gc[B],gc[N])&&(gc.splice(N,1),N--),
N++;B++}for(B=0;B<eb.length-1;){for(N=B+1;N<eb.length;)N>B&&pc(eb[B],eb[N])&&(eb.splice(N,1),N--),N++;B++}for(B=0;B<eb.length;B++)for(N=0;N<cb.length;N++)pc(eb[B],cb[N])&&(cb.splice(N,1),N--);for(ca=0;ca<gc.length;ca++)cb.push(gc[ca]);for(B=0;B<cb.length;B++)!1===ad(m,cb[B])&&(cb.splice(B,1),ha.splice(B,1),B--);for(B=0;B<cb.length-1;){for(N=B+1;N<cb.length;)N>B&&pc(cb[B],cb[N])&&(cb.splice(N,1),ha.splice(N,1),N--),N++;B++}cb.sort(function(ta,Va){return ta.length-Va.length})}}function te(m,u){var r,
w="";if(0!==u.length%2)return!1;var G=u.slice(0);G.push(u[0]);for(u=0;u<G.length-1;u++)for(r=0;r<m[G[u]].a.length;r++)m[G[u]].a[r].p===G[u+1]&&(w+=2===m[G[u]].a[r].t?"1":"0");return/00/.test(w)||/11/.test(w)?!1:!0}function jh(m,u){function r(ta,Va){var lb;for(lb=0;lb<Va.length;lb++)if(pc(Va[lb],ta))return!0}function w(ta,Va,lb){var Bb,Cb=ta,uc=[];var Jb=[];Jb.push(Va);uc.push(ta);for(Va=0;0<Jb.length;){ta=Jb.pop();var Nb=uc.includes(ta);if(!Nb){if(0<uc.length)for(Bb=uc.length-1;0<=Bb;Bb--)if(N[String(ta)].includes(uc[Bb])){Cb=
uc[Bb];break}uc.push(ta);var jc=[];for(Bb=0;Bb<N[String(ta)].length;Bb++)N[String(ta)][Bb]!==Cb&&((Nb=uc.includes(N[String(ta)][Bb]))||jc.push(N[String(ta)][Bb]));if(2===jc.length)Bb=parseInt(gc[lb].charAt(nb.indexOf(ta)),10),void 0===ha[String(Cb)+"-"+String(ta)]||0!==Bb&&1!==Bb||Jb.push(ha[String(Cb)+"-"+String(ta)][Bb][0]);else if(1===jc.length)Jb.push(jc[0]);else return uc.slice(0)}Va++;if(200<Va)break}}function G(ta){var Va;for(Va=0;Va<ta.length;Va++)if(!K.includes(ta[Va]))return!1;return!0}
var K=[],B=[],N={},ha={},Z=0,ka;var ca=ka=0;ca=[];var Oa=ka=0;ca=[];Oa=0;var nb=[];var Qa=[];var xa=1;var gc=[];Qa=!1;var eb=0;eb=0;for(Z=1;Z<m.length;Z++)m[Z].X=!1;lf=[];for(fb in N)N.hasOwnProperty(fb)&&delete N[fb];for(fb in ha)ha.hasOwnProperty(fb)&&delete ha[fb];for(xa=0;xa<rd.length;xa++){for(Z=ca=ka=Qa=0;Z<m[rd[xa]].a.length;Z++)2===m[rd[xa]].a[Z].t&&Qa++,2===m[rd[xa]].a[Z].t&&le(u,rd[xa],m[rd[xa]].a[Z].p)&&ka++,2!==m[rd[xa]].a[Z].t&&1===Ie(m,u,m[rd[xa]].a[Z].p)&&ca++;1===ka&&3>=m[rd[xa]].a.length&&
1===Qa&&K.push(rd[xa])}if(!(4>K.length)){for(xa=0;xa<Da.length;xa++)if(te(m,Da[xa])&&G(Da[xa]))for(lf.push(cb.indexOf(Da[xa])),Z=0;Z<Da[xa].length;Z++)m[Da[xa][Z]].X=!0,K.splice(K.indexOf(Da[xa][Z]),1);else for(Z=0;Z<Da[xa].length;Z++)K.includes(Da[xa][Z])&&K.splice(K.indexOf(Da[xa][Z]),1);Qa=[];for(xa=0;xa<K.length;xa++)3===m[K[xa]].a.length&&K.includes(m[K[xa]].a[0].p)&&K.includes(m[K[xa]].a[1].p)&&K.includes(m[K[xa]].a[2].p)&&Qa.push(K[xa]);for(xa=0;xa<K.length;xa++)for(Z=0;Z<m[K[xa]].a.length;Z++)K.includes(m[K[xa]].a[Z].p)&&
(void 0===N[String(K[xa])]?N[String(K[xa])]=[m[K[xa]].a[Z].p]:N[String(K[xa])].push(m[K[xa]].a[Z].p));if(0<Qa.length){for(xa=0;xa<Qa.length;xa++)for(ka=0;3>ka;ka++){Z=N[String(Qa[xa])][ka];fb=String(Z)+"-"+String(Qa[xa]);ha[fb]=[];ca=[];for(Z=0;Z<N[String(Qa[xa])].length;Z++)Z!==ka&&ca.push(N[String(Qa[xa])][Z]);ha[fb].push(ca.slice(0));ha[fb].push(ca.reverse().slice(0))}gc=[];xa=Math.pow(2,Qa.length-1)-1;Z=xa.toString(2).length;for(xa=0;xa<Z;xa++);for(xa=0;xa<Math.pow(2,Qa.length-1);xa++)gc[xa]=
Fm(xa.toString(2),Z);for(Z=0;Z<Qa.length;Z++)for(eb=Qa[Z],nb=Qa.slice(0),nb.splice(nb.indexOf(eb),1),xa=Oa=0;xa<N[String(eb)].length;xa++)for(ka=0;ka<gc.length;ka++)ca=w(eb,N[String(eb)][xa],ka),Oa++,ad(m,ca)&&!r(ca,B)&&B.push(ca)}else{for(xa=eb=0;xa<K.length;xa++)if(!m[K[xa]].X&&void 0!==N[String(K[xa])]&&1<N[String(K[xa])].length){eb=K[xa];break}if(0!==eb)for(Z=0;Z<N[String(eb)].length;Z++)if(void 0!==N[String(N[String(eb)][Z])]&&1<N[String(N[String(eb)][Z])].length&&(ca=w(eb,N[String(eb)][Z],-1),
ad(m,ca)&&!r(ca,B))){B.push(ca);break}}for(xa=0;xa<B.length;xa++)if(te(m,B[xa]))for(ka=0;ka<B[xa].length;ka++)m[B[xa][ka]].X=!0;for(xa=0;xa<cb.length;xa++)if(8>=cb[xa].length&&0===cb[xa].length%2){Qa=!1;for(Z=ka=0;Z<cb[xa].length-1;Z++)2===u[Ja(u,cb[xa][Z],cb[xa][Z+1])].B&&ka++;2===u[Ja(u,cb[xa][cb[xa].length-1],cb[xa][0])].B&&ka++;ka===cb[xa].length/2&&(Qa=!0);for(Z=0;Z<cb[xa].length;Z++){for(ca=Oa=eb=0;ca<m[cb[xa][Z]].a.length;ca++){ka=m[cb[xa][Z]].a[ca].t;if(4===ka||5===ka)ka=1;1<ka&&Oa++;eb+=
ka}if(4<eb||1<Oa){Qa=!1;break}}for(ca=0;ca<cb[xa].length;ca++)1<Ie(Q,Ka,rd[ca])&&(Qa=!1);if(Qa)for(Z=0;Z<cb[xa].length;Z++)m[cb[xa][Z]].X=!0}}}function Wb(m){var u;for(u=0;u<cb.length;u++)if(cb[u].includes(m))return u;return-1}function Id(m,u){var r=[];for(m=0;m<cb.length;m++)cb[m].includes(u)&&r.push(m);return r}function Ke(m,u){var r,w,G=[];for(r=0;r<cb.length;r++){var K=cb[r].slice(0);K.push(cb[r][0]);for(w=0;w<K.length-1;w++){var B=Ja(m,K[w],K[w+1]);0<B&&B===u&&G.push(r)}}return G}var S,qc,Qb,
we="",ic=-1,fb,Ji="",ee=0,Qg=1,wg=0,Rc="",vc=0,Df=0,fe=0,Db=-1,De="",gb=[],Cd=0,Dd=1,Ed=0,bd=0,xg="",P=0,fg=[],kc=[],Rg=[],mh=[],lf=[],ue=[],Wc={},jf=[],W=[],E={},ba=[],Da=[],Ra=[],yb=[],ab=[],Gb=[],Ib=[],Ca=[],Ab=[],Mb=[],Pb=[],Eb=[],ac=[],Mc=[],Cf={},Bf=[],Zb=[],eg=[],vg=[],Ii=[],rb=[],Ne=[],yg=0,Sf=0;Kc=[];Ld="";oc=[];for(S=0;S<Pa.length;S++)qk(Pa,oc,S,S);vk(g,df,aa,ef);(function(m,u){var r,w;for(r=1;r<m.length;){if(1===m[r].j&&0<m[r].a.length&&1!==m[m[r].a[0].p].j){if(0<oc.length)for(w=0;w<oc.length;w++)0>
oc[w].G&&Number.isInteger(oc[w].G)&&(u[-1*oc[w].G].f===r||u[-1*oc[w].G].g===r)&&(oc[w].G=-1*m[r].a[0].p-.5),0<oc[w].K&&Number.isInteger(oc[w].K)&&oc[w].K===r&&(oc[w].K=m[r].a[0].p+.5);0===m[r].N?(m[m[r].a[0].p].Fa=m[r].x,m[m[r].a[0].p].Ga=m[r].y,m[m[r].a[0].p].ja=m[r].z):2===m[r].N?(m[m[r].a[0].p].wa=m[r].x,m[m[r].a[0].p].xa=m[r].y,m[m[r].a[0].p].ma=m[r].z):3===m[r].N&&(m[m[r].a[0].p].Da=m[r].x,m[m[r].a[0].p].ca=m[r].y,m[m[r].a[0].p].tz=m[r].z);ki(m,u,r,!1);r--}r++}})(df,ef);for(S=1;S<df.length;S++)df[S].Ca=
S;for(S=1;S<ef.length;S++)ef[S].Ca=S;var Ef=1;for(P=0;P<df.length-1;){lc=[];ee=0;for(S=1;S<df.length;S++)if(0===df[S].v){ee=S;break}if(0===ee)break;Ed=Hh(df,ee);P+=Ed;for(S=0;S<lc.length;S++)for(df[lc[S]].v=Ef,qc=0;qc<ef.length;qc++)if(lc.includes(ef[qc].f)||lc.includes(ef[qc].g))ef[qc].v=Ef;Ef++}Ef--;Qg=Ef;Ra=[];Df=0;for(Ef=1;Ef<=Qg;Ef++){a(Ef);for(S=1;S<Q.length;S++)Q[S].I="",void 0!==Pg[String(S)]&&(Pg[String(S)]=""),void 0!==Cf[String(S)]&&(Cf[String(S)]="");wg=Ci=0;Ld="";Ki=nh=1;fg=[];kc=[];
mh=[];Je=[];Pg=[];bg=[];lf=[];jf=[];W=[];hf=[];ba=[];Ye=[];Ib=[];Ca=[];Df=0;Ab=[];cg=[];Cc=[];Mb=[];rd=[];se=[];Pb=[];Hd=[];cb=[];ac=[];Mc=[];Cf={};Bf=[];nc=[];Zb=[];eg=[];Ii=[];vg=[];rb=[];lc=[];for(fb in E)E.hasOwnProperty(fb)&&delete E[fb];for(fb in Wc)Wc.hasOwnProperty(fb)&&delete Wc[fb];Df=Q[1].t;Ki=nh=1;Ci=Yb(Q);0<Ci&&(oa(Q,Ka),jh(Q,Ka));for(S=0;S<cb.length;S++)ue[S]=[];b(Q);l(Q);for(S=1;S<Q.length;S++)Dc(Q,Ka,S);Gl(Q);ua(Q,Ka);Na(Q,Ka);A(Q,Ka);wa(Q,Ka);l(Q);Lh=!1;for(S=1;S<Q.length;S++)Dc(Q,
Ka,S),""!=Q[S].I&&(Lh=!0);Ua(Q,Ka,"reset");0<ac.length&&(Lh=!0);gb=[];for(S=1;S<Q.length;S++)1===Q[S].U&&gb.push(S);if(gb.length===Q.length-1||!1===Lh)for(gb.length=1,c(Q,Ka,gb[0]),l(Q),S=1;S<Q.length;S++)Dc(Q,Ka,S);f(Q);nh=1;Zb=[];for(S=1;S<Q.length;S++)nh*=t(S);if(0<Zb.length&&!1===Lh)for(Bd(Q,Ka,gb[0]),Vb(Q,Ka,gb[0]),S=0;S<rb.length;S++)if(-1<(ic=Zb.indexOf(rb[S]))){Db=Zb[ic];Zb.splice(ic,1);nh/=t(Db);break}q();D(nh);for(qc=0;qc<gb.length;qc++)for(Dd=gb[qc],Ki=nh,fe=0;0<Ki;){for(S=0;S<Zb.length;S++)y(Zb[S],
Mb[fe][S]);Bd(Q,Ka,Dd);Vb(Q,Ka,Dd);Ad();for(S=Sf=0;S<Hd.length;S++)Ne=Hd[S].split(":"),yg=Ja(Ka,parseInt(Ne[0],10),parseInt(Ne[1],10)),Q[Ka[yg].f].X||Q[Ka[yg].g].X||!(0<yg)||2!==Ka[yg].B&&3!==Ka[yg].B||(Sf=yg);if(0<Sf)for(Eb=Ke(Ka,Sf),Eb=Eb.concat(Id(Q,Ka[Sf].f)),Eb=Eb.concat(Id(Q,Ka[Sf].g)),dg(Eb),S=0;S<cb.length;S++)Eb.includes(S)&&te(Q,cb[S])&&wi.push(S);else{0<ac.length&&Oc(Q,Ka);0<Mc.length&&xb(Q,Ka,"gen");vc=0;for(Cd=fc(Q);vc!==Cd;)vc=Cd,wa(Q,Ka),Na(Q,Ka),Ua(Q,Ka,"add"),0<ac.length&&Oc(Q,Ka),
ua(Q,Ka),0<Mc.length&&xb(Q,Ka,"gen"),Cd=fc(Q);for(fb in E)E.hasOwnProperty(fb)&&(0!==E[fb].P&&void 0!==Cc[String(E[fb].w)]?void 0!==Cc[String(E[fb].w)]&&Cc[String(E[fb].O)]===Cc[String(E[fb].w)]&&(bd=E[fb].O,E[fb].O=E[fb].P,E[fb].P=bd,E[fb].T*=-1):0!==E[fb].P&&nc.indexOf(E[fb].O)>nc.indexOf(E[fb].P)&&(bd=E[fb].O,E[fb].O=E[fb].P,E[fb].P=bd,E[fb].T*=-1),0!==E[fb].R&&void 0!==Cc[String(E[fb].t)]?void 0!==Cc[String(E[fb].t)]&&Cc[String(E[fb].R)]===Cc[String(E[fb].t)]&&(bd=E[fb].S,E[fb].S=E[fb].R,E[fb].R=
bd,E[fb].T*=-1):0!==E[fb].R&&nc.indexOf(E[fb].S)>nc.indexOf(E[fb].R)&&(bd=E[fb].S,E[fb].S=E[fb].R,E[fb].R=bd,E[fb].T*=-1));Rc="";for(S=0;S<nc.length;S++)0<S&&(Rc+=","),Rc+=String(Q[nc[S]].Ca);Ld=Za(Q);kc.includes(Ld)||(kc.push(Ld),fg.push(Rc))}fe++;Ki--}if(0===kc.length)return-1;1<kc.length&&(Rg=kc.slice(0),kc.sort(function(m,u){return m.length===u.length?m>u?-1:m<u?1:0:m.length-u.length}));for(S=0;S<Rg.length;S++)if(kc[0]===Rg[S]){Rc=fg[S];break}Ld=kc[0];Ra.push(Ld);yb.push(Rc);ab.push(Df)}Gb=[];
for(S=0;S<Ra.length;S++)Gb.push(Ra[S]+"!"+yb[S]+"!"+String(ab[S]));Gb.sort(function(m,u){m=m.split("!");u=u.split("!");return m[0]===u[0]?0:m[0].length===u[0].length?m[0]>u[0]?-1:m[0]<u[0]?1:0:u[0].length-m[0].length});xg=Rc=Ld="";for(S=0;S<Gb.length;S++){var Jd=Gb[S].split("!");0<S&&(Ld+=".",Rc+=".",xg+=".");Ld+=Jd[0];Rc+=Jd[1];xg+=Jd[2]}nc=Rc.split(/[,.]/);0<Pa.length&&(we=Lb(df,ef,nc));Ji=function(m,u){var r,w="";for(r=0;r<u.length;r++)0<m[u[r]].H&&(w+=String(r+1)+":"+String(m[u[r]].H)+";");return""!==
w?w="!"+w.slice(0,-1)+"!":""}(df,nc);if(0<sa.length){ff=[];for(S=0;S<sa.length;S++)lj(sa,ff,S,S);ab=[];ab=xg.split(".");for(qc=0;qc<ff.length;qc++){for(Qb=0;Qb<ff[qc].M.length;Qb++)ab.includes(String(ff[qc].M[Qb]))&&(ff[qc].M[Qb]=ab.indexOf(String(ff[qc].M[Qb]))+1);for(Qb=0;Qb<ff[qc].L.length;Qb++)ab.includes(String(ff[qc].L[Qb]))&&(ff[qc].L[Qb]=ab.indexOf(String(ff[qc].L[Qb]))+1)}De=tc(ff)}Ld=Ld+we+Ji+De;return 1}function ck(a){function b(){var W,E;var ba=ra.b+10;var Da=ra.t+10;var Ra=[];var yb=
[];for(E=W=0;E<md.length;E++){ba>ra.b+ra.c-10-md[E].c&&(ba=ra.b+10,Da+=10+W,W=0);W=Math.max(W,md[E].h);var ab=ba+md[E].c+20;Ra.push(ba-md[E].b+20);yb.push(Da-md[E].t+10);ba=ab+10}for(E=0;E<md.length;E++)Ua(E,Ra[E],yb[E]),md[E].b+=Ra[E],md[E].t+=yb[E]}function c(W){var E,ba;var Da=ra.b;W+=10;for(ba=E=0;ba<gf.length;ba++)if(sk.includes(ba)){Da>ra.b+ra.c-10-md[ba].c&&(Da=ra.b,W+=10+E,E=0);E=Math.max(E,md[ba].h);var Ra=Da+md[ba].c+20;Da-=md[ba].b;var yb=W-md[ba].t;Ua(ba,Da,yb);md[ba].b+=Da;md[ba].t+=
yb;Da=Ra+10}}function e(W){var E,ba,Da,Ra=[],yb=[];for(E=0;E<W.length;E++)for(ba=0;ba<W.length;ba++)if(E!==ba&&!tj(W[E].M,W[ba].L)){var ab=!1;for(Da=0;Da<W[ba].L.length;Da++)W[E].M.includes(W[ba].L[Da])&&(ab=!0);ab&&(Da=Ei(W[ba].L,W[E].M),W[ba].L=Da.slice(0),W[E].M=Da.slice(0))}for(E=0;E<W.length;)yk(W[E].M,Ra)||Ra.push(W[E].M),yk(W[E].L,yb)||yb.push(W[E].L),E++;for(E=0;E<Ra.length;)Qc.push(new Bd(Ra[E])),E++;for(E=0;E<yb.length;)yk(yb[E],Ra)||Qc.push(new Bd(yb[E])),E++;for(E=0;E<W.length;)ba=Oc(W[E].L,
Qc),Ra=Oc(W[E].M,Qc),-1<ba&&-1<Ra&&(Qc[ba].eb.push(new Sb(Ra,E+ue)),Qc[Ra].Qa.push(new Sb(ba,E+ue))),E++;for(E=0;E<Qc.length;)0!==Qc[E].eb.length||Id.includes(E)||Id.push(E),0!==Qc[E].Qa.length||Wb.includes(E)||Wb.push(E),E++}function l(W){var E,ba,Da=ra.b+ra.c/2;for(E=0;E<Qc.length;E++){var Ra=q(E);var yb=ra.b;ih=ih.concat(Ra);for(ba=0;ba<Ra.length;ba++){var ab=yb+md[Ra[ba]].c/2;Ua(Ra[ba],ab-Da,0);yb+=md[Ra[ba]].c+W}}mj();pk()}function f(){var W;ih=[];for(W=0;W<Qc.length;W++){var E=q(W);ih=ih.concat(E)}}
function t(){var W,E=[];for(W=0;W<gf.length;W++)ih.includes(W)||E.push(W);return E}function q(W){var E,ba=Qc[W].ia.slice(0),Da=[];for(W=0;W<ba.length;W++)for(E=0;E<gf.length;E++)gf[E].includes(ba[W])&&!Da.includes(E)&&Da.push(E);return Da}function D(W){var E;for(E=0;E<Id.length;E++)fb.push({G:Id[E],path:y(W,Id[E],E)})}function y(W,E,ba){var Da=[],Ra={},yb=0,ab=[];Da.push(E);ab.push(E);for(Ra[String(E)]=0;0<Da.length;){var Gb=Da.shift();for(E=0;E<W[Gb].Qa.length;E++){var Ib=W[Gb].Qa[E].tb;ab.includes(Ib)||
(ab.push(Ib),Ra[String(Ib)]=Ra[String(Gb)]+1,Da.push(Ib))}}for(E=0;E<ab.length;E++)W[ab[E]].path=ba,W[ab[E]].pa=Ra[String(ab[E])],0<E&&W[ab[E]].pa===W[ab[E-1]].pa?yb++:yb=1,W[ab[E]].Va=yb;return ab.slice(0)}function A(W){var E,ba=fb[W].path,Da=[];for(W=1;W<ba.length;W++)for(E=0;E<sa.length;E++)if(tg(sa[E].M,Qc[ba[W-1]].ia)&&tg(sa[E].L,Qc[ba[W]].ia)||tg(sa[E].L,Qc[ba[W-1]].ia)&&tg(sa[E].M,Qc[ba[W]].ia)){Da.push(E);break}return Da}function wa(){var W=!1,E=1,ba,Da=0,Ra,yb=ra.t,ab=0,Gb,Ib=0,Ca=[],Ab=
18*$a;for(Ra=0;Ra<fb.length;Ra++){var Mb=0;for(W=!1;Mb<fb[Ra].path.length;)Da=fb[Ra].path[Mb],1<Qc[Da].Va&&(W=!0),Mb++}for(Ra=0;Ra<fb.length;Ra++){for(Mb=0;Mb<fb[Ra].path.length;)Da=fb[Ra].path[Mb],ab=Math.max(ab,sb[Da].h),Mb++;var Pb=ra.b;var Eb=yb+3*$a+ab/2;Mb=ba=0;var ac=-1;for(Gb=0;Mb<fb[Ra].path.length;){var Mc=fb[Ra].path[Mb];Ib=Math.max(Ib,Mc);var Cf=sb[Mc].b+sb[Mc].c/2;var Bf=sb[Mc].t+sb[Mc].h/2;var Zb=Eb-sb[Mc].h/2;if(Qc[Mc].pa!==ba){ba++;1===E?Gb=1.125*sb[ac].c+Ab+.125*sb[Mc].c:-1===E&&
(Gb=-1*(1.125*sb[Mc].c+Ab+.125*sb[ac].c));var eg=1.125*sb[ac].c+Ab+1.125*sb[Mc].c;var vg=.125*sb[ac].c+Ab+1.125*sb[Mc].c;if(!1===W&&1===E&&sb[ac].b+eg>ra.b+ra.c){for(Eb=0;Eb<Ca.length;Eb++)sb[Ca[Eb]].t+sb[Ca[Eb]].h>yb&&(yb=sb[Ca[Eb]].t+sb[Ca[Eb]].h);Gb=(sb[ac].c-sb[Mc].c)/2;Eb=yb+Ab+3*$a;Zb=Eb-sb[Mc].h/2;E=0}else if(!1===W&&0===E)E=Math.abs(ra.b+ra.c-Pb)<Math.abs(ra.b-Pb)?-1:1,-1===E?Gb=-1*(.125*sb[ac].c+Ab+1.125*sb[Mc].c):1===E&&(Gb=.125*sb[ac].c+Ab+1.125*sb[Mc].c);else if(!1===W&&-1===E&&sb[ac].b-
vg<za.b){for(Eb=0;Eb<Ca.length;Eb++)sb[Ca[Eb]].t+sb[Ca[Eb]].h>yb&&(yb=sb[Ca[Eb]].t+sb[Ca[Eb]].h);Gb=(sb[ac].c-sb[Mc].c)/2;Eb=yb+Ab+3*$a;Zb=Eb-sb[Da].h/2;E=0}}else 1<Qc[Mc].Va&&(Zb+=sb[ac].h+3*$a,Eb+=sb[ac].h+3*$a,Gb=0);Pb+=Gb;eg=Pb+sb[Mc].c/2;vg=Zb+sb[Mc].h/2;for(ac=0;ac<Qc[Mc].ia.length;ac++)Mh(g,eg-Cf,vg-Bf,Qc[Mc].ia[ac]);sb[Mc].b=Pb;sb[Mc].t=Zb;Ca.push(Mc);ac=Mc;Mb++}for(Eb=0;Eb<Ca.length;Eb++)sb[Ca[Eb]].t+sb[Ca[Eb]].h>yb&&(yb=sb[Ca[Eb]].t+sb[Ca[Eb]].h)}if(Qc.length>Ib)for(Pb=ra.b,Zb=yb+3*$a,Eb=
Ib+1;Eb<Qc.length;Eb++)for(E=Qc[Eb].ia.slice(0),ac=0;ac<Qc[Eb].ia.length;ac++)W=E[ac],-1<xb(W)?Mh(g,me[xb(W)].kb,me[xb(W)].lb,W):Mh(g,Pb-sb[Eb].b,Zb-sb[Eb].t,Qc[Eb].ia[ac]),sb[Eb].b=Pb,sb[Eb].t=Zb,Pb+=sb[Eb].c+3*$a,Pb>ra.b+ra.c&&(Pb=ra.b,Zb+=yb+3*$a)}function Ea(W){var E,ba=[],Da=new Yc(0,0),Ra=new Yc(0,0),yb=new Yc(0,0),ab=new Yc(0,0);ok();for(E=1;E<g.length;E++)g[E].t===W&&ba.push(E);var Gb=[];for(E=0;E<ba.length;E++)Gb.push(g[ba[E]].j);var Ib=ld(g[ba[0]].x,g[ba[0]].y,g[ba[ba.length-1]].x,g[ba[ba.length-
1]].y);ab.x=0;for(E=ab.y=0;E<ba.length;E++)ab.x+=g[ba[E]].x,ab.y+=g[ba[E]].y;ab.x=ab.x/ba.length;ab.y=ab.y/ba.length;for(E=0;E<ba.length;E++)Da.y+=g[ba[E]].j*Math.pow(g[ba[E]].x-ab.x,2),Da.x+=g[ba[E]].j*Math.pow(g[ba[E]].y-ab.y,2),0<g[ba[E]].x-ab.x?Ra.y+=g[ba[E]].j*Math.pow(g[ba[E]].x-ab.x,2):0>g[ba[E]].x-ab.x&&(yb.y+=g[ba[E]].j*Math.pow(g[ba[E]].x-ab.x,2)),0<g[ba[E]].y-ab.y?Ra.x+=g[ba[E]].j*Math.pow(g[ba[E]].y-ab.y,2):0>g[ba[E]].y-ab.y&&(yb.x+=g[ba[E]].j*Math.pow(g[ba[E]].y-ab.y,2));void 0===Db[String(W)]?
Db[String(W)]={ub:W,Ea:ab,sb:Da,da:Ra,ha:yb,Ka:Ib,La:Gb}:(Db[String(W)].ub=W,Db[String(W)].Ea=ab,Db[String(W)].sb=Da,Db[String(W)].da=Ra,Db[String(W)].ha=yb,Db[String(W)].Ka=Ib,Db[String(W)].La=Gb)}function fa(W,E){var ba=W.split(";");for(W=0;W<ba.length;W++){var Da=ba[W].split(":");g[te[parseInt(Da[0],10)]+E].H=parseInt(Da[1],10)}}function Na(W,E){var ba,Da=0,Ra=0,yb=1;var ab=W.split(";");for(W=0;W<ab.length;W++){var Gb=ab[W].split(":");if(4===Gb.length){if(/\d-\d/.test(Gb[0])){var Ib=Gb[0].split("-");
var Ca=te[parseInt(Ib[0],10)]+E;Ib=te[parseInt(Ib[1],10)]+E;Ca=Ja(aa,Ca,Ib);0<Ca&&(Da=-1*Ca)}else if(Number(Gb[0]))if(Number.isInteger(Number(Gb[0])))Da=te[parseInt(Gb[0],10)]+E;else if(Da=Number(Gb[0]),0>Da){Ca=te[Math.floor(-1*Da)]+E;for(Ib=ba=0;Ib<g[Ca].a.length;Ib++)if(1===g[Ca].a[Ib].t&&1===g[g[Ca].a[Ib].p].j){ba=g[Ca].a[Ib].p;break}0===ba?(Mf(g,Ca),Ib=1===g[Ca].a.length?ia(Ya(g,g[Ca].a[0].p,Ca)+60):Gh(g,Ca),fc(g,aa,Ca,Ib,1),Ca=Ja(aa,Ca,g.length-1)):Ca=Ja(aa,Ca,ba);Da=-1*Ca}if(/\d-\d/.test(Gb[1]))Ib=
Gb[1].split("-"),Ca=te[parseInt(Ib[0],10)]+E,Ib=te[parseInt(Ib[1],10)]+E,Ca=Ja(aa,Ca,Ib),0<Ca&&(Ra=-1*Ca);else if(Number(Gb[1]))if(Number.isInteger(Number(Gb[1])))Ra=te[parseInt(Gb[1],10)]+E;else if(Ra=Number(Gb[1]),0<Ra){Ca=te[Math.floor(Ra)]+E;for(Ib=ba=0;Ib<g[Ca].a.length;Ib++)if(1===g[Ca].a[Ib].t&&1===g[g[Ca].a[Ib].p].j){ba=g[Ca].a[Ib].p;break}0===ba?(Mf(g,Ca),Ib=1===g[Ca].a.length?ia(Ya(g,g[Ca].a[0].p,Ca)+60):Gh(g,Ca),fc(g,aa,Ca,Ib,1),Ra=g.length-1):Ra=ba}Ca=Gb[2];"l"===Gb[3]?yb=1:"r"===Gb[3]&&
(yb=-1);Gb=new jj(Da,Ra,Ca,yb);Pa.push(Gb)}}}function ua(){var W,E,ba=0,Da=0,Ra=0,yb=0,ab,Gb="";ok();for(W=0;W<Pa.length;W++){var Ib=ab=0;var Ca=Pa[W].G;var Ab=Pa[W].K;0>Ca&&(Ca=aa[-1*Ca].f);0>Ab&&(Ab=aa[-1*Ab].f);if(g[Ca].t!==g[Ab].t){var Mb=g[Ca].t;Ca=g[Ab].t;var Pb=E=0;for(Ab=1;Ab<g.length;Ab++)g[Ab].t===Mb&&E++,g[Ab].t===Ca&&Pb++;Ab=E>Pb?Ca:Mb;Ca=E>Pb?Mb:Ca;E=Ca===Mb?Pa[W].G:Pa[W].K;Mb=Ab===Mb?Pa[W].G:Pa[W].K;0<E?(ba=g[E].x,Da=g[E].y):0>E&&(ba=(g[aa[Math.abs(E)].f].x+g[aa[Math.abs(E)].g].x)/2,
Da=(g[aa[Math.abs(E)].f].y+g[aa[Math.abs(E)].g].y)/2);E=Math.abs(ba-sd[Ca].b);Pb=Math.abs(Da-sd[Ca].t);var Eb=Math.abs(sd[Ca].b+sd[Ca].c-ba);var ac=Math.abs(sd[Ca].t+sd[Ca].h-Da);var Mc=Math.min(E,Pb,Eb,ac);E=[E,Pb,Eb,ac].indexOf(Mc);0<Mb?(Ra=g[Mb].x,yb=g[Mb].y):0>Mb&&(Ra=(g[aa[Math.abs(Mb)].f].x+g[aa[Math.abs(Mb)].g].x)/2,yb=(g[aa[Math.abs(Mb)].f].y+g[aa[Math.abs(Mb)].g].y)/2);Mb=Math.abs(Ra-sd[Ab].b);Pb=Math.abs(yb-sd[Ab].t);Eb=Math.abs(sd[Ab].b+sd[Ab].c-ba);ac=Math.abs(sd[Ab].t+sd[Ab].h-Da);Mc=
Math.min(Mb,Pb,Eb,ac);Mb=[Mb,Pb,Eb,ac].indexOf(Mc);switch(E){case 0:ab=sd[Ca].b-(sd[Ab].b+sd[Ab].c);Ib=Da-yb;0===Mb&&(Gb="y");break;case 1:ab=ba-Ra;Ib=sd[Ca].t-(sd[Ab].t+sd[Ab].h);1===Mb&&(Gb="x");break;case 2:ab=sd[Ca].b+sd[Ca].c-sd[Ab].b;Ib=Da-yb;2===Mb&&(Gb="y");break;case 3:ab=ba-Ra,Ib=sd[Ca].t+sd[Ca].h-sd[Ab].t,3===Mb&&(Gb="x")}me.push({wb:W,jb:Ca,Ma:Ab,kb:ab,lb:Ib,fb:Gb})}}}function xb(W){var E;for(E=0;E<me.length;E++)if(me[E].Ma===W)return E;return-1}function Ua(W,E,ba){var Da=gf[W].slice(0);
for(W=0;W<Da.length;W++)Mh(g,E,ba,Da[W]);Xc()}function La(W,E){var ba;fg=[];var Da=W.split(";");for(W=0;W<Da.length;){var Ra=[];var yb=[];var ab=Da[W].split(":");var Gb=ab[0].split(",");for(ba=0;ba<Gb.length;)Ra.push(parseInt(Gb[ba],10)+E),ba++;Gb=ab[1].split(",");for(ba=0;ba<Gb.length;)yb.push(parseInt(Gb[ba],10)+E),ba++;ba=parseInt(ab[2],10);Gb=void 0!==ab[3]?ab[3]:"";ab=void 0!==ab[4]?ab[4]:"";fg.push(new ij(Ra,yb,ba,Gb,ab,0,0,0,0));W++}}function Oc(W,E){for(var ba=0;ba<E.length;){if(tj(W,E[ba].ia))return ba;
ba++}return-1}function fc(W,E,ba,Da,Ra){var yb=W[ba].x+na*Math.cos(Math.PI*Da/180);Da=W[ba].y+-1*na*Math.sin(Math.PI*Da/180);W[W.length]=new kb(1,"H",yb,Da,0,0,0);W[W.length-1].t=W[ba].t;W[ba].C+=1;W[ba].Fa=yb;W[ba].Ga=Da;W[ba].ja=0;3<Ra&&(W[ba].ja=4===Ra?1:-1);Xe(W,E,ba,W.length-1,Ra)}function Vb(W){function E(d,k,n,p){var h=0,U=0,x="",z=0,O=!1;n=0;var C,I="",R=0;if(C=p.match(Im))""!==C[1]&&(x=C[1],h=0);else if(C=p.match(Pl)){""!==C[1]&&(R=parseInt(C[1],10));if(""!==C[2]){x=C[2];zg.includes(x)&&
(O=!0,x=x[0].toUpperCase()+x.substring(1));if(!Og.includes(x))return Dd="invalidElement",-1;h=mi(x)}""!==C[6]&&(U="+"===C[6]?1:"-"===C[6]?-1:parseInt(C[6],10));""!==C[3]&&("@"===C[3]?I="@":"@@"===C[3]&&(I="@@"));"H"===C[4]&&(z=""!==C[5]?parseInt(C[5],10):1)}else{x=p;zg.includes(p)&&(O=!0,x=x[0].toUpperCase()+x.substring(1));if(!Og.includes(x))return Dd="invalidElement",-1;h=mi(x)}p=d.length;d[p]=new kb(h,x,0,0,U,z,0);d[p].Ca=p;!0===O&&(d[p].X=!0);""!==I&&(d[p].I=I,kc.push(p));0<R&&(d[p].N=R);for(h=
0;h<Ke[p].length;h++){for(U=1;U<bd.length;U++)if(bd[U].f===p&&bd[U].g===Ke[p][h]||bd[U].g===p&&bd[U].f===Ke[p][h]){n=bd[U].B;break}void 0!==d[Ke[p][h]]&&(2===d[p].N?d[Ke[p][h]].D++:3===d[p].N&&d[Ke[p][h]].F++);Xe(d,k,p,Ke[p][h],n)}return p}function ba(d,k){var n;for(n=0;n<d.length;n++)if(d[n].i.includes(k))return n;return-1}function Da(d,k,n,p){var h,U={},x=[],z=[];Hb=[];z.push(n);for(x.push(n);0<x.length;){var O=x.shift();if(O===p)break;for(h=0;h<d[O].a.length;h++)n=d[O].a[h].p,z.includes(n)||(z.push(n),
U[String(n)]=O,x.push(n))}h=p;Hb=[];for(Hb.push(p);void 0!==U[String(h)];)U.hasOwnProperty(String(h))&&(Hb.push(U[String(h)]),h=U[String(h)]);Hb.reverse();ud=[];for(Fb=1;Fb<Hb.length-2;Fb++)0<xa(Hb[Fb],Hb[Fb+1])||1!==k[Ja(k,Hb[Fb],Hb[Fb+1])].B||ud.push(Ja(k,Hb[Fb],Hb[Fb+1]))}function Ra(d,k,n){var p=0;if(ge.includes(n)){for(k=0;k<d[n].a.length;k++)Q[n].X&&2===Q[n].a[k].t&&p++;return p}return-1}function yb(d,k,n,p){k=[];var h=[];kf=[];k.push(n);var U=1;for(n=0;0<k.length;){var x=k.pop();var z=h.includes(x);
if(!z){h.push(x);kf.push(x);if(x===p)return 1;for(z=0;z<d[x].a.length;z++)h.includes(d[x].a[z].p)||d[x].a[z].t===U&&d[d[x].a[z].p].X&&k.push(d[x].a[z].p)}U=1===U?2:1;n++;if(200<n)break}}function ab(d,k,n,p){var h;k={};var U=[],x=[];kf=[];x.push(n);for(U.push(n);0<U.length;){var z=U.shift();if(z===p)break;for(h=0;h<d[z].a.length;h++)d[d[z].a[h].p].X&&(n=d[z].a[h].p,x.includes(n)||(x.push(n),k[String(n)]=z,U.push(n)))}h=p;kf=[];for(kf.push(p);void 0!==k[String(h)];)k.hasOwnProperty(String(h))&&(kf.push(k[String(h)]),
h=k[String(h)]);kf.reverse();return kf.slice(-1)[0]===p?1:-1}function Gb(d,k,n,p){var h,U=[];for(h=0;h<d[k].a.length;h++)!n.includes(d[k].a[h].p)||0!==p&&d[k].a[h].t!==p||U.push(d[k].a[h].p);return U.slice(0)}function Ib(d,k,n){var p,h="+";if(1===n.length%2)return-1;for(p=0;p<n.length-1;p++)Nf(d,k,n[p],n[p+1],h),h="+"===h?"-":"+";return 0}function Ca(d,k,n,p){var h=[],U,x=0,z=Math.floor(ra.c/(.866*na))-3;new Yc(0,0);var O="",C=0,I=0,R=1,ya=0,ea=[210,330,150,30,90,270];var T=F[n].i.slice(0);0<p?x=
p:n!==fe&&(x=F[n].m);for(U=0;U<T.length;U++){p=T[U];void 0!==S[String(x)+"-"+String(p)]&&(O=String(x)+"-"+String(p));Le(p)&&""===O&&void 0!==S[String(p)+"-"+String(Le(p))]&&(O=String(p)+"-"+String(Le(p)));var v=d;var pa=k,Ta=n,ma=U,la=qc[p],M=x,X,Y=0,ja=0,qa,Ba=new Yc(0,0);for(X=qa=0;X<v[la].a.length;X++)void 0!==oa[String(v[la].a[X].p)]&&qa++;if(0===ma)if(Ta===fe||0===Tb)Ba.x=za.b+20,Ba.y=za.t+za.h/2;else if(0===wc.length&&ee.includes(Ta))Ba.x=za.b+za.c/2-(F[Ta].i.length-1)*na*.866/2,Ba.y=za.t+za.h/
2;else if(6===v[M].a.length){for(X=la=0;X<v[M].a.length;X++)rb(v,v[M].a[X].p)&&la++;pa=ea[la];Ba.x=v[M].x+na*Math.cos(Math.PI*pa/180);Ba.y=v[M].y-na*Math.sin(Math.PI*pa/180)}else pa=Cf(v,pa,M),Ba.x=v[M].x+na*Math.cos(Math.PI*pa/180),Ba.y=v[M].y-na*Math.sin(Math.PI*pa/180),""!==Eb(M)&&(O=Eb(M),S[O].t!==T[ma]&&(O=""));else{if(1===ma){if(Ta===fe||0===wc.length&&(lf.includes(Ta)||ee.includes(Ta))){if(!(Y=3===v.length)){ja=v;Ta=T;X=!0;for(Y=1;Y<Ta.length-1;Y++)Di(ja,Ta[Y])||Pb(ja,Ta[Y])||(X=!1);Y=X}Y=
Y||2<T.length&&0<Di(v,T[ma])&&Di(v,T[ma])!==T[0]?300:330}else rb(v,M)&&rb(v,la)?Y=Ya(v,M,la):Y=270;X=Ja(pa,M,la);Ta=Ja(pa,la,T[ma]);0<X&&2===pa[X].B?void 0!==S[String(M)+"-"+String(la)]?(O=String(M)+"-"+String(la),ja=Bf(v,O,T[ma])):2===pa[Ta].B&&2===v[la].a.length?(h[0]=M,h.push(la),h.push(T[ma]),ja=0):ja=60:3===pa[Ta].B?ja=3===v.length?60:0:(void 0!==S[String(T[ma-1])+"-"+String(T[ma])]&&(O=String(T[ma-1])+"-"+String(T[ma])),ja=4===v[la].a.length&&(!kc.includes(la)||1<qa)?0:2===pa[Ja(pa,la,T[ma])].B&&
6===v[la].j&&2===v[la].a.length&&1===v[la].s&&6<v[T[ma]].j?0:1===ma%2?60:-60,ya++)}else if(1<ma)switch(Y=Ya(v,T[ma-2],la),Ta=Ja(pa,la,T[ma]),X=Ja(pa,T[ma-2],la),pa=String(pa[Ta].B)+"."+String(pa[X].B),pa){case "1.1":if(2<ma)if(Y=Ya(v,T[ma-3],T[ma-2]),ya>=z){Y=Ya(v,T[ma-2],T[ma-1]);if(180<Y&&0===I)I=1,C++,R=270<Y?-1:1;else if(0===I){Y=Ya(v,T[ma-3],T[ma-2]);ja=0;ya++;break}0<I&&4>I?(ja=60*R,ya++,I++):4===I&&(Y=Ya(v,T[ma-3],T[ma-2]),I=ja=0,z+=1===C%2?-1:1,ya=3)}else 4===v[la].a.length&&(!kc.includes(la)||
1<qa)?(Y=Ya(v,T[ma-2],T[ma-1]),ja=0):(pa=Ya(v,T[ma-2],T[ma-1]),M=Ya(v,T[ma-3],T[ma-2]),2<Math.abs(pa-M)?(Ya(v,T[ma-3],T[ma-2]),ja=0):3<ma?(pa=Ya(v,T[ma-4],T[ma-3]),2<Math.abs(M-pa)?(Y=Ya(v,T[ma-4],T[ma-3]),ja=0):(Y=Ya(v,T[ma-2],T[ma-1]),ja=1===ma%2?60:-60)):(Y=Ya(v,T[ma-2],T[ma-1]),ja=1===ma%2?60:-60),ya++);else ja=1===ma%2?60:-60,ya++;break;case "1.2":""!==O?(Y=Ya(v,T[ma-2],T[ma-1]),ja=Bf(v,O,T[ma]),O=""):(Y=Ya(v,T[ma-2],T[ma-1]),ja=90<Y&&270>Y?60:-60,h=[]);break;case "1.3":ja=0;break;case "2.1":void 0!==
S[String(la)+"-"+String(T[ma])]&&(O=String(la)+"-"+String(T[ma]));if(16===v[la].j&&4===v[la].a.length){Y=Ya(v,T[ma-2],T[ma-1]);ja=0;break}if(6===v[la].j&&2===v[la].a.length&&1===v[la].s&&6<v[T[ma]].j){Y=Ya(v,T[ma-2],T[ma-1]);ja=0;break}2<ma?(Y=Ya(v,T[ma-3],T[ma-2]),ja=2<Math.abs(Ya(v,T[ma-3],T[ma-2])-Ya(v,T[ma-2],T[ma-1]))?0:1===ma%2?60:-60):2===ma&&0<M&&rb(v,M)?(Y=Ya(v,M,T[0]),ja=0):ja=1===ma%2?60:-60;break;case "2.2":2===v[la].a.length?(0===h.length&&(h.push(T[ma-2]),h.push(T[ma-1])),h.push(T[ma]),
ja=0):ja=1===ma%2?60:-60;break;case "3.1":case "2.3":case "3.2":ja=2===v[la].a.length?0:1===ma%2?60:-60;break;default:ja=1===ma%2?60:-60}pa=ia(Y+ja);ma=na*Math.cos(Math.PI*pa/180);M=-1*na*Math.sin(Math.PI*pa/180);Ba.x=v[la].x+ma;Ba.y=v[la].y+M}v=Ba;if(""!==O&&"="!==Qb[p]&&0!==S[O].R&&S[O].R===p||""!==O&&"="!==Qb[p]&&0===S[O].R&&S[O].S===p)""!==Eb(p)?O=Eb(p):O="";d[p].x=v.x;d[p].y=v.y}wc.push(n)}function Ab(d,k,n,p,h,U){var x=0;x=[];var z=na,O=0,C="",I=0,R=0,ya=0;I=0;R=-1;var ea=0,T=0,v=0,pa=1;pa=
0;pa=1;var Ta=0,ma=[],la=0;ea=[];var M=[];pa=0;R=[];la=0;ya=-1;if(!Ql.includes(n)){if(0<U&&Ma[n].includes(U)){for(;0<Ma[n].indexOf(U);)Ma[n]=Ma[n].splice(1,Ma[n].length).concat(Ma[n][0]);0<h&&(I=Ma[n][0],R=P[U].indexOf(h),Mb(d,k,Ma[n][0],h,p,"chend","",1,R,0,0,"",na),ma.push(Ma[n][0]))}else{if(3<=Ma[n].length&&!Ma[n].includes(Qh)){for(ea=0;ea<Ma[n].length;ea++)R=R.concat(P[Ma[n][ea]].slice(0));dg(R);Bb(k);Dh(d,k);for(ea=0;ea<R.length;ea++){for(T=la=0;T<d[R[ea]].a.length;T++)le(k,R[ea],d[R[ea]].a[T].p)&&
la++;void 0!==oa[String(R[ea])]&&2<oa[String(R[ea])].length&&(Cb(R[ea])||x.push(R[ea]))}Ma[n].sort(function(X,Y){return lb(X)>lb(Y)?-1:lb(Y)>lb(X)?1:0});I=Ma[n][0]}else for(Ma[n].sort(function(X,Y){return P[Y].length-P[X].length}),I=Ma[n][0],ea=0;ea<Ma[n].length;ea++)if(d[P[Ma[n][ea]][0]].X){-1===Qh&&(I=Ma[n][ea]);break}Mb(d,k,I,0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);ma.push(I)}ea=Ma[n].slice(0);ea.splice(ea.indexOf(I),1);ea.sort(function(X,Y){return m(d,X)!==m(d,Y)?m(d,X)?-1:1:P[Y].length-
P[X].length});ea.unshift(I);Ma[n]=ea.slice(0);0<Ag&&(rc.push(Ag),ma.push(Ag));for(la=0;20>la&&ma.length<Ma[n].length;){for(ea=0;ea<ma.length;ea++)if(ma[ea]!==Ag)for(T=0;T<Ma[n].length;T++)if(!ma.includes(Ma[n][T])&&Ma[n][T]!==Ag&&(R=-1,M=[],!ma.includes(Ma[n][T])&&(R=Sf(ma[ea],Ma[n][T]),-1<R&&(Ta=ma[ea],pa=Ma[n][T],C=String(Math.min(Ta,pa))+"-"+String(Math.max(Ta,pa)),void 0===ib[C])))){r([gb[R].ta,gb[R].ua],P[pa])?(I=gb[R].ta,ya=gb[R].ua):(I=gb[R].ua,ya=gb[R].ta);R=0;M=P[pa].slice(0);M.push(P[pa][0]);
for(v=0;v<M.length-1;v++)if(M[v]===I){R=v;break}for(v=0;v<d[ya].a.length;v++)d[ya].a[v].p!==I&&P[Ta].includes(d[ya].a[v].p)&&!P[pa].includes(d[ya].a[v].p)&&(O=d[ya].a[v].p);pa=B(d,I,ya,O);pa=-1*pa;Mb(d,k,Ma[n][T],I,ya,"bond","",pa,R,0,0,"",na);ma.push(Ma[n][T])}for(ea=0;ea<ma.length;ea++)for(T=0;T<Ma[n].length;T++)if(R=-1,M=[],!ma.includes(Ma[n][T])&&(R=Sf(ma[ea],Ma[n][T]),-1<R&&(Ta=ma[ea],pa=Ma[n][T],C=String(Math.min(Ta,pa))+"-"+String(Math.max(Ta,pa)),void 0!==ib[C]))){r(ib[C],P[pa])?(I=ib[C][0],
ya=ib[C][ib[C].length-1],x=ib[C][ib[C].length-2]):(I=ib[C][ib[C].length-1],ya=ib[C][0],x=ib[C][1]);R=0;M=P[pa].slice(0);M.push(P[pa][0]);for(v=0;v<M.length-1;v++)if(M[v]===I){R=v;break}for(v=0;v<d[ya].a.length;v++)d[ya].a[v].p!==I&&P[Ta].includes(d[ya].a[v].p)&&!P[pa].includes(d[ya].a[v].p)&&(O=d[ya].a[v].p);pa=B(d,O,ya,x);3<ib[C].length&&(P[Ma[n][T]].length-ib[C].length<ib[C].length?z=.8*na:P[Ma[n][T]].length-ib[C].length>=ib[C].length&&(z=1.25*na));Mb(d,k,Ma[n][T],I,ya,"bridge","",pa,R,0,0,C,z);
ma.push(Ma[n][T])}for(ea=0;ea<ma.length;ea++)for(T=0;T<Ma[n].length;T++)if(ya=-1,M=[],!(ma.includes(Ma[n][T])||(ya=yg(ma[ea],Ma[n][T]),-1===ya||-1<Va(Cd[ya].Ja)))){R=0;Ta=ma[ea];pa=Ma[n][T];I=Cd[ya].Ja;M=P[pa].slice(0);for(v=0;v<M.length;v++)if(M[v]===I){R=v;break}Mb(d,k,Ma[n][T],I,0,"atom","",1,R,0,0,"",na);ma.push(Ma[n][T])}la++}if("m2porphin"===gg&&Ma[n].includes(Ag))for(jb in Oe){Oe.hasOwnProperty(jb)&&(d[Oe[jb].Ua].x=(d[Oe[jb].Sa].x+d[Oe[jb].Ta].x)/2,d[Oe[jb].Ua].y=(d[Oe[jb].Sa].y+d[Oe[jb].Ta].y)/
2);break}Ql.push(n)}}function Mb(d,k,n,p,h,U,x,z,O,C,I,R,ya){var ea=0,T=0;ea=0;var v="",pa=0,Ta=v=0,ma=pa=0,la=pa=0;ma=0;var M=1;pa=0;pa=[];la="";var X=0,Y=!1,ja=0,qa=0,Ba=0;T=0;var Ha=!1,Ia=[],Ub=[];Ub=[];var gd=[];var Xa=[];var wd=[],Pe=[];wd="";var Qe="normal";Ba="";var Li=[],Mi=[];Pe=Xa=0;wd=1;var Ni=0,Ak=!0,vj=!1,mf=0,Ff=0;T=0;var Oi=[];Pe=[0,0,0,-.5*ya,-.5*ya,-.5*ya,0,0,0,0,0,0,0,0,0,0,0];Ni=[0,0,0,-.28868*ya,.5*ya,-.80902*ya,ya,0,0,0,0,0,0,0,0,0];var Jm=[0,0,0,300,270,252,270,231.43,225,220,
270,270,270,270,270,338.5,0,330,330,330,332];Ha=[[[45,45,45,45,45,45,45,45],[45,45,45,45,90,-45,90,45],[72,72,72,-36,72,72,72,-36]],[[60,60,60,-48,72,72,72,-48,60],[60,40,40,40,40,40,40,60,-60]],[[60,60,60,-60,60,60,60,60,-60,60],[60,60,60,-36,72,72,-36,72,72,-36],[36,36,36,36,36,36,36,36,36,36],[45,60,60,60,-90,60,60,60,45,0]],[[60,60,60,-60,60,60,60,-38.53,68.53,68.53,-38.53],[45,45,45,-63,72,72,72,-63,45,45,45],[72,-63,45,45,45,45,45,45,-63,72,72],[51.43,51.43,51.43,51.43,51.43,-68.57,60,60,60,
60,-68.57],[60,60,60,-30,-18,72,72,72,-18,-30,60],[32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73]],[[60,60,60,-60,60,60,60,-60,60,60,60,-60],[72,72,-54,72,72,-54,72,72,-54,72,72,-54],[60,60,60,-48,-36,72,72,72,-36,72,-48,60]],[[60,60,60,-60,60,-48,72,72,72,-48,60,-60,60],[68.53,68.53,-47.06,68.53,68.53,-68.53,60,60,60,-68.53,68.53,68.53,-47.06]],[[60,60,60,-60,60,-60,60,60,60,60,-60,60,-60,60],[60,60,60,-60,60,-60,60,60,60,60,-60,60,-60,60]],[[68.53,68.53,-68.53,60,60,60,-90,60,
60,60,-90,60,60,60,-68.53],[72,72,-72,72,72,-72,72,72,-72,72,72,-72,72,72,-72]],[[60,60,-90,60,60,60,-90,60,60,60,-90,60,60,60,-90,60],[60,60,60,-60,60,-60,60,60,60,-60,60,60,-60,60,60,-60],[45,45,-45,45,45,45,45,-45,45,45,-45,45,45,45,45,-45]],[[-60,60,-60,60,60,60,-60,60,-45,75,75,-45,60,-60,60,60,60]],[[-60,60,60,-60,60,60,-60,60,60,-60,60,60,-60,60,60,-60,60,60]],[[-60,60,60,-60,60,60,-60,60,-45,75,75,-45,60,-60,60,60,-60,60,60]],[[-63,72,72,-63,72,-63,72,72,-63,72,-63,72,72,-63,72,-63,72,72,
-63,72]]];Ba=[];Ia=[0,0,0,1,2,2,2,3,0,0,0,0,0,0,3,1,2];qa=[[75,69.735,70.53],[75,30,75,75]];var Km=[[.89658,.89658,.89658],[.89658,.89658,1,.89658]],Lm=[[30,131.93,36.136],[30,120,30,30]],Mm=[[.75,1.2091,1.2091],[.75,.75,1,.75]],Nm=[[140],[120,60],[75,90.964,33.148],[75,69.896,35.104,75],[75,38,42.2,41,58.5],[65,55.2,27.3,32.5,65,55.2]],Om=[[1.3054],[.6666,1],[.59771,1.1902,.88169],[.58232,.97813,1,.58232],[.6666,.75,.75,1,.75],[.58333,.86667,.975,1,.88333,.86667]];if(!rc.includes(n))if("m2porphin"===
gg&&n===Ag)rc.push(Ag);else{x=P[n].length;for(Xa=0;Xa<P[n].length;Xa++)6!==d[P[n][Xa]].j&&(pa.push(Xa),la+=d[P[n][Xa]].o);if(0<pa.length&&0===O&&"first"===U){if(15===P[n].length&&"NNNN"===la)for(Xa=1;Xa<pa.length;Xa++){if(3===pa[Xa]-pa[Xa-1]){X=pa[Xa]-1-x;break}}else"m2porphin"===gg||"porphin"===gg?X=pa[0]:X=pa[0]-Ia[x];O=X}Ia=P[n].slice(O,P[n].length).concat(P[n].slice(0,O));Qg[n]&&(Y=!0);if(7<x&&21>x&&""===gg){for(Xa=1;Xa<Ia.length;Xa++)if(Ba=Ja(k,Ia[Xa],Ia[Xa-1]),2===k[Ba].B)Ub[Xa-1]=1,void 0!==
S[String(Ia[Xa-1])+"-"+String(Ia[Xa])]?(Ba=String(Ia[Xa-1])+"-"+String(Ia[Xa]),Ia.includes(S[Ba].O)&&Ia.includes(S[Ba].S)||!Ia.includes(S[Ba].O)&&!Ia.includes(S[Ba].S)?Ub[Xa-1]="t"===S[Ba].T?-1:1:Ub[Xa-1]="t"===S[Ba].T?1:-1):Ef(k,Ba,3)?Ub[Xa-1]=-1:Ub[Xa-1]=1;else if(Ef(k,Ba,3))Ub[Xa-1]=-1;else if(-1<Va(Ia[Xa-1])&&Va(Ia[Xa])===Va(Ia[Xa-1]))Ub[Xa-1]=1;else if(2<d[Ia[Xa]].a.length)for(O=0;O<d[Ia[Xa]].a.length;O++)P[n].includes(d[Ia[Xa]].a[O].p)||(10<P[n].length&&(2!==d[Ia[Xa]].a[O].t||1!==d[d[Ia[Xa]].a[O].p].a.length)?
0<ca(d[Ia[Xa]].a[O].p)&&ca(d[Ia[Xa]].a[O].p)!==n?Ub[Xa-1]=0:Ub[Xa-1]=1:Ub[Xa-1]=0);Ub[Ia.length-1]=0;vj=!1;Ff=0;Ba=Ha[x-8][Ff].slice(0);if(7<x&&21>x)for(;!vj&&Ff<Ha[x-8].length;){gd=[];for(O=0;O<Ha[x-8][Ff].length-1;O++)gd.push(Math.sign(Ha[x-8][Ff][O])*Math.sign(Ha[x-8][Ff][O+1]));gd.push(Math.sign(Ha[x-8][Ff][Ha[x-8][Ff].length-1])*Math.sign(Ha[x-8][Ff][0]));Oi=gd.slice(0);for(mf=0;mf<Oi.length;){Ak=!0;for(Xa=0;Xa<Ub.length;Xa++)if(0!==Ub[Xa]&&-1===Math.sign(Ub[Xa]*Oi[Xa])){Ak=!1;break}if(!0===
Ak){vj=!0;break}else mf++,Oi=gd.slice(mf,gd.length).concat(gd.slice(0,mf))}if(vj){T=Ff;Ba=Ha[x-8][T].slice(mf,Oi.length).concat(Ha[x-8][T].slice(0,mf));break}Ff++;Ff>=Ha[x-8].length&&(T=0)}}else if(16===x&&"m2porphin"===gg)T=0,mf=2,Ba=Ha[x-8][T].slice(mf,x).concat(Ha[x-8][T].slice(0,mf));else if(16===x&&"porphin"===gg)T=0,mf=2,Ba=Ha[x-8][T].slice(mf,x).concat(Ha[x-8][T].slice(0,mf));else if(20<x)for(Ba=[],Xa=0;Xa<x;Xa++)0===Xa%2?Ba.push(60):Ba.push(-1*(60-720/x));if("first"===U){ma=0;v=360/Math.abs(x);
ea=(180-v)/2*Math.pow(-1,x);6===x&&(ea=90);8===x&&(ea=90);var Tf=C;var Uf=I;9>x?(Tf+=Pe[x],Uf+=Ni[x]):20<x&&(Uf=Tf=400);d[Ia[0]].x=Tf;d[Ia[0]].y=Uf;21>x?""===gg&&16===x&&(la="NNNN")?Ta=30:Ta=Jm[x]:Ta=0;ma++}if("chend"===U){ma=0;Pb(d,h)&&Pb(d,p)?ea=Ya(d,qc[h],h):""!==Eb(h)&&""!==ac(p)&&Eb(h)===ac(p)?(v=Eb(h),rb(d,S[v].w)&&rb(d,S[v].O)&&rb(d,S[v].P)&&!rb(d,S[v].t)?ea=Qf(d,S[v].w,S[v].O,S[v].P,!0):rb(d,S[v].w)&&rb(d,S[v].O)&&!rb(d,S[v].t)?ea=ia(Ya(d,S[v].O,S[v].w)+60):rb(d,S[v].w)&&rb(d,S[v].P)&&!rb(d,
S[v].t)?ea=ia(Ya(d,S[v].P,S[v].w)-60):ea=30):""!==ac(h)?(v=ac(h),ea=rb(d,S[v].w)&&rb(d,S[v].t)&&(rb(d,S[v].O)||rb(d,S[v].P))?ia(Ya(d,S[v].w,S[v].t)+Bf(d,v,p)):rb(d,S[v].w)&&rb(d,S[v].t)?ia(Ya(d,S[v].w,S[v].t)+60):ea+Bf(d,v,p)):ea=0<Di(d,h)?Ya(d,Di(d,h),h):Cf(d,k,h);Tf=d[h].x+ya*Math.cos(Math.PI*ea/180);Uf=d[h].y+-1*ya*Math.sin(Math.PI*ea/180);d[Ia[0]].x=Tf;d[Ia[0]].y=Uf;if(""!==ac(p))v=ac(p),pa=Math.sign(Bf(d,v,Ia[1])),Ta=ea+pa*(180-360/Math.abs(x))/2,v=-360*pa/Math.abs(x),z=-1*pa;else if(3<d[p].a.length&
1===w(d,p)){for(C=pa=0;C<d[p].a.length;C++)pa+=d[p].a[C].t;v=0<Af[d[p].j]&&pa>Af[d[p].j]&&2<eb(d,p)?-360/Math.abs(x):360/Math.abs(x);Ta=ia(ia(ea+30)-(180-v/2))}else 7<x?(v=360/Math.abs(x),Ta=ia(ea-(180-Ba[ma])/2)):(v=360/Math.abs(x),Ta=ia(ea-(180-v)/2));ma++}if("atom"===U){Ub=Ia.slice(1,Ia.length);Ub.reverse();Ia=Ia.slice(0,1);Ia=Ia.concat(Ub);Tf=d[p].x;Uf=d[p].y;for(C=la=pa=ma=0;C<d[p].a.length;C++)0!==d[d[p].a[C].p].x&&0!==d[d[p].a[C].p].y&&(ma+=d[d[p].a[C].p].x,pa+=d[d[p].a[C].p].y,la++);0<la&&
(ma/=la,pa/=la);ea=ld(ma,pa,d[p].x,d[p].y);v=360/x;Ta=ia(ea-(180-v)/2);ma=1}if("bond"===U){pa=Ja(k,p,h);if(3<eb(d,p)&&3<eb(d,h)&&(Xa=oa[String(p)].slice(0),wd=oa[String(h)].slice(0),Xa.sort(function(Bk,Ck){return Bk-Ck}),wd.sort(function(Bk,Ck){return Bk-Ck}),tg(Xa,wd))){Ni=0;Pe=[];wd="";for(C=0;C<Xa.length;C++)rc.includes(Xa[C])&&(Ni++,Pe.push(Xa[C]),wd+=String(P[Xa[C]].length));if(2===Ni){wd+=String(x);Xa=P[Pe[0]].length>=P[Pe[1]].length?Pe[0]:Pe[1];Pe=P[Pe[0]].length<=P[Pe[1]].length?Pe[0]:Pe[1];
Qe="normal";switch(!0){case "333"===wd||"444"===wd||"777"===wd||"888"===wd:Qe="squew";break;case "3"===wd.charAt(2):Qe="normal";break;case "4"===wd.charAt(2):Qe="normal";break;case "5"===wd.charAt(2):Qe=700>parseInt(wd,10)?"wide":"normal";break;case "6"===wd.charAt(2):Qe=770>parseInt(wd,10)?"wide":"shrunk";break;case 6<parseInt(wd.charAt(2),10):Qe="squew";break;default:Qe="normal"}"squew"===Qe?(Li=Nm[x-3].slice(0),Mi=Om[x-3].slice(0)):"wide"===Qe?(Li=Lm[x-5].slice(0),Mi=Mm[x-5].slice(0)):"shrunk"===
Qe&&(Li=qa[x-5].slice(0),Mi=Km[x-5].slice(0));for(C=0;C<d[h].a.length;C++)P[Xa].includes(d[h].a[C].p)&&d[h].a[C].p!==p&&"wide"!==Qe?z=B(d,p,h,d[h].a[C].p):P[Pe].includes(d[h].a[C].p)&&d[h].a[C].p!==p&&"wide"===Qe&&(z=B(d,p,h,d[h].a[C].p))}}if(1===k[pa].B&&Y){for(C=qa=0;C<d[p].a.length;){if(2===d[p].a[C].t){qa+=1;break}C++}for(C=0;C<d[h].a.length;){if(2===d[h].a[C].t){qa+=1;break}C++}ja=0<qa?1:0}else 2===k[pa].B&&Y&&(ja=1);Tf=d[h].x;Uf=d[h].y;ea=Ya(d,p,h);"normal"===Qe?(v=9>x?360/x:Ha[x-8][T][1],wd=
1):(v=Li[0],wd=Mi[0]);0>z&&(v=-1*v);Ta=ia(ea+v);ma=2}"bridge"===U&&(Tf=d[h].x,Uf=d[h].y,M=1,ea=Ya(d,p,h),v=z*u(d,k,x,R,ya,M),Ta=ia(ea+v),ma=ib[R].length);for(;ma<Ia.length;){ea=wd*ya*Math.cos(Math.PI*Ta/180);T=wd*ya*-1*Math.sin(Math.PI*Ta/180);Gc=Tf+ea;Hc=Uf+T;if(0===d[Ia[ma]].x&&0===d[Ia[ma]].y){if(0<Yd(Q,Ka,Gc,Hc)&&(T=Yd(Q,Ka,Gc,Hc),void 0!==oa[String(T)])){Ha=!1;for(O=0;O<oa[String(T)].length;O++)if(-1<Sf(n,oa[String(T)][O])){Ha=!0;break}Ha&&(ea=ya*Math.cos(Math.PI*ia(30+Ta)/180),T=-1*ya*Math.sin(Math.PI*
ia(30+Ta)/180),Gc=Tf+ea,Hc=Uf+T)}d[Ia[ma]].x=Gc;d[Ia[ma]].y=Hc}7<x&&(v=Ba[ma]);""!==R&&(M++,v=z*u(d,k,x,R,ya,M));"normal"!==Qe&&(v=z*Li[ma-1],wd=Mi[ma-1]);Ta=ia(Ta+v);Tf=Gc;Uf=Hc;Y&&0===Ie(d,k,Ia[ma])&&0===Ie(d,k,Ia[ma-1])&&ma%2===ja&&Nf(d,k,Ia[ma],Ia[ma-1],"+");ma++}if(Y)for(0===Ie(d,k,Ia[ma-1])&&0===Ie(d,k,Ia[0])&&(ma-1)%2===ja&&Nf(d,k,Ia[0],Ia[ma-1],"+"),Ia.push(Ia[0]),Xa=1;Xa<Ia.length;Xa++)0===Ie(d,k,Ia[Xa])&&0===Ie(d,k,Ia[Xa-1])&&Nf(d,k,Ia[Xa],Ia[Xa-1],"+");rc.push(n)}}function Pb(d,k){var n,
p=0;for(n=0;n<d[k].a.length;n++)2===d[k].a[n].t&&p++;return 2===p?!0:!1}function Eb(d){var k="",n;for(n in S)if(S.hasOwnProperty(n)&&S[n].w===d){k=n;break}return k}function ac(d){var k="",n;for(n in S)if(S.hasOwnProperty(n)&&S[n].t===d){k=n;break}return k}function Mc(d){var k="";"0"!==d.charAt(0)&&"0"!==d.charAt(2)?k=d.charAt(0)===d.charAt(2)?"t":"c":"0"!==d.charAt(0)&&"0"!==d.charAt(3)?k=d.charAt(0)===d.charAt(3)?"c":"t":"0"!==d.charAt(1)&&"0"!==d.charAt(2)?k=d.charAt(1)===d.charAt(2)?"t":"c":"0"!==
d.charAt(1)&&"0"!==d.charAt(3)&&(k=d.charAt(1)===d.charAt(3)?"t":"c");return k}function Cf(d,k,n){var p=0,h=0;h=d[n].a.length;var U=p=0,x=[],z=[];z=-1;var O=0;O="";var C=0,I=0;O=I=0;var R=-1;p=0;C=1;var ya=[];R=[];for(p=0;p<h;p++)0!==d[d[n].a[p].p].x&&0!==d[d[n].a[p].p].y&&x.push(d[n].a[p].p);if(void 0===oa[String(n)])for(p=0;p<h;p++)void 0!==oa[String(d[n].a[p].p)]&&U++;p=x.length;x.sort(function(ea,T){return ba(F,ea)-ba(F,T)});switch(h){case 0:z=270;break;case 1:0===p?z=30:1===p&&(h=Ya(d,x[0],n),
z=ia(h+60));break;case 2:0===p?z=30:1===p?(R=ba(F,n),h=Ya(d,x[0],n),2<F[R].i.length?F[R].i[0]===n?(p=Ja(k,F[R].i[0],F[R].i[1]),2===k[p].B?C=G(d,k,p):O=B(d,F[R].i[2],F[R].i[1],F[R].i[0])):F[R].i.slice(-1)===n&&(z=F[R].i.slice(-3),p=Ja(k,z[1],z[2]),2===k[p].B?C=G(d,k,p):O=B(d,z[0],z[1],z[2])):2===F[R].i.length&&(F[R].i[1]===n?0<F[R].m&&rb(d,F[R].m)&&(p=Ja(k,F[R].i[0],n),2===k[p].B?C=G(d,k,p):O=B(d,F[R].m,F[R].i[0],n)):0<F[R].J&&rb(d,F[R].J)&&(p=Ja(k,F[R].i[1],n),2===k[p].B?C=G(d,k,p):O=B(d,F[R].J,F[R].i[1],
n))),0!==O||Pb(d,n)||(O=0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?1:-1),z=ia(h-C*O*60)):2===p&&2===x.length&&(h=Ya(d,x[0],n),z=ia(h-60));break;case 3:0===p?z=30:1===p?(h=Ya(d,x[0],n),0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?z=h-60:z=h+60):2===p&&(z=Qf(d,n,x[0],x[1],!0));break;case 4:if(0===p)z=30;else if(1===p)h=Ya(d,x[0],n),kc.includes(n)&&2>U?0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?z=h-60:z=h+60:16===d[n].j?z=h:0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?z=h-90:
z=h+90;else if(2===p)void 0!==oa[String(n)]||140>Fi(d,n,x[0],x[1])?(z=Qf(d,n,x[0],x[1],!0),z=ia(z+30)):(h=Ya(d,x[0],n),z=ia(h-90));else if(3===p)if(3===eb(d,n))if(""!==Jd(d,n))for(O=Jd(d,n),p=0;p<x.length;p++)Jd(d,x[p])===O&&(z=ib[String(O)][0]===n?Ya(d,ib[String(O)][ib[O].length-1],n):Ya(d,ib[String(O)][0],n));else for(p=0;p<x.length;p++){if(void 0!==oa[String(x[p])]&&1<oa[String(x[p])].length){z=Ya(d,x[p],n);break}}else{ya=[];R=[];for(p=0;p<x.length;p++)ba(F,x[p])===ba(F,n)?ya.push(x[p]):R.push(x[p]);
if(2===ya.length)175<Fi(d,n,ya[0],ya[1])&&185>Fi(d,n,ya[0],ya[1])?z=Ya(d,R[0],n):(O=Qf(d,n,ya[0],ya[1],!0),C=Ya(d,n,R[0]),I=Math.abs(C-O),z=O+I,2>Math.abs(z-C)&&(z=O-I));else if(Me(d,n,!0),175<Fa[Fa.length-1].$){for(p=0;p<x.length;p++)if(x[p]!==Fa[Fa.length-1].ba&&x[p]!==Fa[Fa.length-1].fa){I=x[p];break}z=Ya(d,I,n)}else z=Qf(d,n,Fa[Fa.length-1].ba,Fa[Fa.length-1].fa,!1)}}return z}function Bf(d,k,n){var p=0,h=0,U=!1,x=1;"0"!==S[k].ea.charAt(0)?rb(d,S[k].O)?(p=S[k].O,h=S[k].ea.charAt(0),U=!1):rb(d,
S[k].P)&&(p=S[k].P,h=S[k].ea.charAt(0),U=!0):"0"!==S[k].ea.charAt(1)&&(rb(d,S[k].P)?(p=S[k].P,h=S[k].ea.charAt(1),U=!0):rb(d,S[k].O)&&(p=S[k].O,h=S[k].ea.charAt(1),U=!1));n===S[k].S?x="0"!==S[k].ea.charAt(2)?U?S[k].ea.charAt(2)===h?-1:1:S[k].ea.charAt(2)===h?1:-1:U?S[k].ea.charAt(3)===h?1:-1:S[k].ea.charAt(3)===h?-1:1:n===S[k].R&&(x="0"!==S[k].ea.charAt(3)?U?S[k].ea.charAt(3)===h?-1:1:S[k].ea.charAt(3)===h?1:-1:U?S[k].ea.charAt(2)===h?1:-1:S[k].ea.charAt(2)===h?-1:1);rb(d,p)&&rb(d,S[k].w)&&rb(d,S[k].t)?
(n=d[p].x-d[S[k].w].x,p=d[p].y-d[S[k].w].y,h=d[S[k].t].x-d[S[k].w].x,d=d[S[k].t].y-d[S[k].w].y,d=Jg(n,p,h,d)):rb(d,S[k].S)&&rb(d,S[k].w)&&rb(d,S[k].t)?(n=d[S[k].S].x-d[S[k].w].x,p=d[S[k].S].y-d[S[k].w].y,h=d[S[k].t].x-d[S[k].w].x,d=d[S[k].t].y-d[S[k].w].y,d=Jg(n,p,h,d)):rb(d,S[k].R)&&rb(d,S[k].w)&&rb(d,S[k].t)?(n=d[S[k].R].x-d[S[k].w].x,p=d[S[k].R].y-d[S[k].w].y,h=d[S[k].t].x-d[S[k].w].x,d=d[S[k].t].y-d[S[k].w].y,d=Jg(n,p,h,d)):d=1;return-1*x*d*60}function Zb(d,k,n,p){function h(la,M,X,Y){la=M[X].f;
var ja=M[Y].f;X=M[X].g;M=M[Y].g;return la===ja||X===M||la===M||ja==X?!0:!1}function U(la,M,X,Y){var ja=!1;var qa=la[M[X].f].x;var Ba=la[M[X].f].y;var Ha=la[M[X].g].x;var Ia=la[M[X].g].y;var Ub=la[M[Y].f].x;X=la[M[Y].f].y;var gd=la[M[Y].g].x;la=la[M[Y].g].y;Ha-=qa;Ia-=Ba;gd-=Ub;M=la-X;la=Ha*M-gd*Ia;if(1E-8>Math.abs(la))return 0;0<la&&(ja=!0);qa-=Ub;Ba-=X;X=Ha*Ba-Ia*qa;if(0>X===ja)return 0;Ba=gd*Ba-M*qa;return 0>Ba===ja||X>la===ja||Ba>la===ja?0:1}var x=1E3,z=0,O=0,C=0,I=0,R=0,ya=0,ea=0;ea=ya=ea=0;ea=
[];I=[];I=[];var T=[],v=[],pa=[],Ta=[];C=[];x=[];var ma=[];O=[];R=n/2;ya=n;O=n/2;x=new zd(0,0,0,0);for(z=1;z<d.length-1;z++)for(C=z+1;C<d.length;C++)if(0!==d[z].x||0!==d[z].y||0!==d[C].x||0!==d[C].y)ea=Math.sqrt((d[z].x-d[C].x)*(d[z].x-d[C].x)+(d[z].y-d[C].y)*(d[z].y-d[C].y)),void 0!==oa[String(z)]&&void 0!==oa[String(C)]?ya=R:ya=n,ea<ya&&(ea=[z,C],T.push(ea));if(0<T.length){if(1<De.length){for(z=0;z<De.length;z++){for(C=ea=ya=0;C<P[De[z]].length;C++)ya+=d[P[De[z]][C]].x,ea+=d[P[De[z]][C]].y;ya/=
P[De[z]].length;ea=ya/P[De[z]].length;I.push({r:De[z],x:ya,y:ea})}for(z=0;z<I.length-1;z++)for(C=z+1;C<I.length;C++)ea=Math.sqrt(Math.pow(I[z].x-I[C].x,2)+Math.pow(I[z].y-I[C].y,2)),ea<R&&ma.push([I[z].r,I[C].r])}for(z=0;z<T.length-1;z++)for(C=z+1;C<T.length;C++)I=Ja(k,T[z][0],T[C][0]),R=Ja(k,T[z][1],T[C][1]),ya=Ja(k,T[z][1],T[C][0]),ea=Ja(k,T[z][0],T[C][1]),0<I&&0<R?v.push([I,R]):0<ya&&0<ea&&v.push([ya,ea])}for(C=1;C<k.length;C++)for(x.b=Math.min(d[k[C].f].x,d[k[C].g].x),x.t=Math.min(d[k[C].f].y,
d[k[C].g].y),x.c=Math.abs(d[k[C].f].x-d[k[C].g].x),x.h=Math.abs(d[k[C].f].y-d[k[C].g].y),z=1;z<d.length;z++)z!==k[C].f&&z!==k[C].g&&Ic(x,d[z].x,d[z].y)&&Dm(d,k,z,C)<O&&pa.push([z,C]);for(z=1;z<d.length;z++)if(!(2>d[z].a.length))for(O=0;O<d[z].a.length-1;O++)for(C=O+1;C<d[z].a.length;C++)x=ia(Ya(d,z,d[z].a[C].p)-Ya(d,z,d[z].a[O].p)),10>x&&Ta.push([z,d[z].a[O].p,d[z].a[C].p]);C=[];for(z=1;z<k.length-1;z++)for(O=z+1;O<k.length;O++)h(d,k,z,O)||(0<ka(d,k,z)||0<ka(d,k,O))&&-1<Ne(ka(d,k,z))&&-1<Ne(ka(d,
k,O))||1===U(d,k,z,O)&&C.push([z,O]);x=[];for(z=1;z<P.length;z++)if(!(7<P[z].length||!0===Qa(z)))for(I=P[z].slice(0),I.push(P[z][0]),I.unshift(P[z][P[z].length-1]),O=1;O<I.length-1;O++)2<eb(d,I[O])||165<Fi(d,I[O],I[O-1],I[O+1])&&x.push([z,I[O]]);O=[];for(z=1;z<d.length;z++)4===d[z].a.length&&(Me(d,z,!0),180<Fa[Fa.length-1].$&&O.push(z));if(0===p){kd=[];for(z=0;z<T.length;z++)kd.push(T[z]);oh=[];for(z=0;z<v.length;z++)oh.push(v[z]);Wd=[];for(z=0;z<pa.length;z++)Wd.push(pa[z]);Sg=[];for(z=0;z<Ta.length;z++)Sg.push(Ta[z]);
nf=[];for(z=0;z<C.length;z++)nf.push(C[z]);hg=[];for(z=0;z<x.length;z++)hg.push(x[z]);Rh=[];for(z=0;z<ma.length;z++)Rh.push(ma[z]);Sh=[];for(z=0;z<O.length;z++)Sh.push(O[z])}return 1===p?T.length+v.length+pa.length+Ta.length+C.length+x.length+O.length:kd.length+oh.length+Wd.length+Sg.length+nf.length+hg.length+Sh.length}function eg(d,k,n){var p=new oj(0,0,0,0),h;if(d===Q)for(h=1;h<d.length;h++)Mf(Q,h);Kc=[];var U=[];var x=[];h=[];p.s=0;p.u=0;p.l=0;p.n=0;Fa=[];var z="@"===d[n].I?1:-1;p=Hl(d,n);if(p.u>
p.l){var O=p.u;p.u=p.l;p.l=O}for(O=0;O<d[p.u].a.length;O++)1===d[p.u].a[O].t&&(x.push(d[p.u].a[O].p),U.push(d[p.u].a[O].p));for(O=0;O<d[p.l].a.length;O++)1===d[p.l].a[O].t&&(h.push(d[p.l].a[O].p),U.push(d[p.l].a[O].p));for(O=0;O<U.length;O++);$c(d,k,Ja(k,p.l,h[0]),4,!0);k[Ja(k,p.l,h[0])].g===p.l&&$c(d,k,Ja(k,p.l,h[0]),-1,!0);1<h.length&&($c(d,k,Ja(k,p.l,h[1]),5,!0),k[Ja(k,p.l,h[1])].g===p.l&&$c(d,k,Ja(k,p.l,h[1]),-1,!0));x=wk(d,k,p,"parse");d[p.s].I="";if(""!==x&&x!==(1===z?"@":"@@")){if(d[p.s].I=
"",$c(d,k,Ja(k,p.l,h[0]),5,!0),k[Ja(k,p.l,h[0])].g===p.l&&$c(d,k,Ja(k,p.l,h[0]),-1,!0),1<h.length&&($c(d,k,Ja(k,p.l,h[1]),4,!0),k[Ja(k,p.l,h[1])].g===p.l&&$c(d,k,Ja(k,p.l,h[1]),-1,!0)),x=wk(d,k,p,"parse"),""===x||x!==(1===z?"@":"@@"))$c(d,k,Ja(k,p.l,h[0]),1,!0),1<h.length&&$c(d,k,Ja(k,p.l,h[1]),1,!0),Kc.push(n)}else if(""===x||void 0===x)$c(d,k,Ja(k,p.l,h[0]),1,!0),1<h.length&&$c(d,k,Ja(k,p.l,h[1]),1,!0),Kc.push(n)}function vg(d,k){var n=[];n=[];var p=new oj(0,0,0,0),h=0,U=0,x=0,z=n=0,O=0,C=h=h=0,
I=0,R=[];I=C=O=h=0;U="";var ya=[],ea=0;ea=ea=0;ea=[];var T=0,v=0,pa={};n=0;var Ta="";U=!0;var ma=T=0;n=0;h=[];var la="",M=0,X=0,Y=0;if(d===Q)for(z=1;z<d.length;z++)Mf(Q,z);Kc=[];for(z=0;z<kc.length;z++){v=kc[z];O=d[v].a.length;for(h=I=C=0;h<O;h++)0<ka(d,k,Ja(k,v,d[v].a[h].p))&&C++,kc.includes(d[v].a[h].p)&&I++;pa[String(v)]=100*O+10*I+C}kc.sort(function(ja,qa){return pa[String(qa)]-pa[String(ja)]});for(z=0;z<kc.length;z++){v=kc[z];R=[];ya=[];ea=[];T=0;n=[];U="";h=n=O=I=C=0;U=!0;Ta="";h=[];p.s=0;p.u=
0;p.l=0;x=U=h=p.n=0;Fa=[];ma="@"===d[v].I?1:-1;if(2!==Ie(d,k,kc[z])){for(h=0;h<d[v].a.length;h++)U=N(v,d[v].a[h].p),""!==U?ya.push([d[v].a[h].p,parseInt(U,10)]):R.push(d[v].a[h].p);R.sort(function(ja,qa){return ja-qa});if(0<ya.length)for(ya.sort(function(ja,qa){return parseInt(ja[1],10)-parseInt(qa[1],10)}),h=ya.length-1;0<=h;h--)R.unshift(ya[h][0]);for(h=0;h<R.length;h++)R[h]<v&&(O=R[h])}for(h=U=ya=0;h<R.length;h++)ya+=d[R[h]].N,1===d[R[h]].j&&U++;if(4===R.length&&5===ya&&3===U){for(h=ya=h=U=ya=
h=T=ea=n=Ta=0;4>h;h++)if(2===d[R[h]].N&&1===d[R[h]].j){Ta=R[h];break}for(h=0;4>h;h++)if(3===d[R[h]].N&&1===d[R[h]].j){n=R[h];break}for(h=0;4>h;h++)if(0===d[R[h]].N&&1===d[R[h]].j){ea=R[h];break}0!==O?T=Ya(d,O,v):T=210;h=ia(T+60);ya=ia(T-75);U=ia(T-45);d[ea].x=d[v].x+na*Math.cos(Math.PI*h/180);d[ea].y=d[v].y-na*Math.sin(Math.PI*h/180);d[ea].z=0;d[Ta].x=d[v].x+na*Math.cos(Math.PI*ya/180);d[Ta].y=d[v].y-na*Math.sin(Math.PI*ya/180);d[n].x=d[v].x+na*Math.cos(Math.PI*U/180);d[n].y=d[v].y-na*Math.sin(Math.PI*
U/180);if(-1===ma&&0!==O||1===ma&&0===O)C=Ta,I=n;else if(1===ma&&0!==O||-1===ma&&0===O)C=n,I=Ta;h=Ja(k,v,C);ya=Ja(k,v,I);k[h].g===v&&(k[h].f=v,k[h].g=C);k[ya].g===v&&(k[ya].f=v,k[ya].g=I);$c(d,k,Ja(k,v,C),4,!1);$c(d,k,Ja(k,v,I),5,!1)}else{Me(d,v,!0);if(4===R.length){if(0===p.s){if(0===C&&0<eb(d,v)){for(h=ea=0;h<R.length;h++)ka(d,k,Ja(k,v,R[h]))?ea++:(C=R[h],I=0);if(4===ea)if(Fa=[],Me(d,v,!0),4===Fa.length&&180<=Fa[3].$)for(h=Fa[3].ba,kc.includes(Fa[3].ba)&&(h=Fa[3].fa),kc.includes(Fa[3].fa)&&(h=Fa[0].ba),
ea=ia(180+ld(d[v].x,d[v].y,(d[Fa[3].ba].x+d[Fa[3].fa].x)/2,(d[Fa[3].ba].y+d[Fa[3].fa].y)/2)),ea=-1*Jg(d[h].x-d[v].x,d[h].y-d[v].y,Math.cos(Math.PI*ea/180),-1*Math.sin(Math.PI*ea/180)),T=0;170<Fa[Fa.length-1].$&&6>T;)Ii(d,v,h,15*ea),Fa=[],Me(d,v,!0),T++;else if(4===Fa.length)for(h=0;h<R.length;h++)0<eb(d,R[h])||0!==X||(C=R[h],X=xa(v,C),Y=C);if(0!==C){for(h=0;h<R.length;h++)-1<eb(d,R[h])&&(n=R[h]);0===n&&(C=0)}if(0===C){for(h=0;h<d[v].a.length;h++)if(""!==la&&Jd(d,d[v].a[h].p)===la&&Jd(d,v)===la){C=
d[v].a[h].p;la="";M=0;break}for(h=0;h<d[v].a.length;h++)if(0===C&&0<X&&P[X].includes(v)&&-1===eb(d,d[v].a[h].p)&&P[X].includes(d[v].a[h].p)){C=d[v].a[h].p;Y=X=0;break}}if(0===C){for(h=0;h<d[v].a.length;h++)if(""===la&&""!==Jd(d,d[v].a[h].p)&&Jd(d,v)===Jd(d,d[v].a[h].p)){la=Jd(d,d[v].a[h].p);M=d[v].a[h].p;break}for(h=0;h<d[v].a.length;h++)if(0===X&&-1===eb(d,d[v].a[h].p)&&xa(v,d[v].a[h].p)&&""===Jd(d,d[v].a[h].p)){X=xa(v,d[v].a[h].p);Y=d[v].a[h].p;break}if(0!==X&&""!==la){if(ib[la][0]===M&&ib[la][ib[la].length-
1].includes(kc)||ib[la][ib[la].length-1]===M&&ib[la][0].includes(kc))kc.includes(M)?C=0:C=M;if(0!==C||kc.includes(Fa[0].ba))if(kc.includes(Fa[0].fa)){for(h=0;h<R.length;h++)if(P[X].includes(R[h])&&!kc.includes(R[h])){C=R[h];break}la=""}else C=Fa[0].fa,Y=X=0,la="",M=0;else C=Fa[0].ba,Y=X=0,la="",M=0}else if(0!==X&&xa(v,Y))for(h=0;h<R.length;h++){if(P[X].includes(R[h])){C=R[h];break}}else""!==la&&Jd(d,v)===la&&(C=M);0===C&&(la="",Y=X=M=0)}if(0===C)for(h=0;h<R.length;h++)0<eb(d,R[h])||(C=R[h],I=0)}if(0===
C&&void 0!==oa[String(v)]){n=[];for(h=0;h<R.length;h++)ka(d,k,Ja(k,v,R[h]))||n.push(R[h]);0<n.length&&(C=n[0],1<n.length?I=n[1]:I=0)}if(0===C){U=!0;Me(d,v,!0);for(h=0;h<Fa.length;h++)if(88>Fa[h].$||92<Fa[h].$){U=!1;break}if(!0===U)for(h=0;h<R.length;h++)if(!kc.includes(R[h])&&void 0===oa[String(R[h])]){C=R[h];break}}if(0===C)for(Me(d,v,!0),n=0;4>n;){C=Fa[n].ba;I=Fa[n].fa;if(kc.includes(C)||kc.includes(I)||void 0!==oa[String(C)]||void 0!==oa[String(I)])I=C=0;else break;n++}0===C&&(kc.includes(R[0])||
kc.includes(R[2])?kc.includes(R[1])||kc.includes(R[3])||(C=R[1],I=R[3]):(C=R[0],I=R[2]));if(0!==C)h=Ja(k,v,C),1===k[h].B&&(k[h].f===v?$c(d,k,h,4,!0):(n=k[h].f,k[h].f=k[h].g,k[h].g=n,0<=d[C].z?$c(d,k,h,4,!0):$c(d,k,h,5,!0))),0!==I&&1===k[Ja(k,v,I)].B&&($c(d,k,Ja(k,v,I),5,!0),k[Ja(k,v,I)].g===v&&$c(d,k,Ja(k,v,I),-1,!0));else{Kc.push(v);continue}}}else if(4>R.length&&0===p.s){0===C&&2===R.length&&(h=Qf(d,v,R[0],R[1],!1),U=d[v].x+na*Math.cos(Math.PI*h/180),x=d[v].y+-1*na*Math.sin(Math.PI*h/180),d[d.length]=
new kb(1,"H",U,x,0,0,1),d[v].C+=1,Xe(d,k,v,d.length-1,4),C=d.length-1,I=0,R.unshift(d.length-1));if(0===C){if(void 0!==oa[String(v)]){for(h=0;h<d[v].a.length;h++)ta(d,v,d[v].a[h].p)&&ea.push(d[v].a[h].p);0<ea.length&&(T=ea[0])}if(0<eb(d,v)||0<ea.length)if(Me(d,v,!0),175>ia(Fa[0].$+Fa[1].$)&&0===nb(v)){for(h=0;h<d[v].a.length;h++)if(""!==la&&Jd(d,d[v].a[h].p)===la){C=d[v].a[h].p;la="";break}if(0===C)for(h=0;h<d[v].a.length;h++)if(0===C&&0<X&&""===Jd(d,d[v].a[h].p)&&-1===eb(d,d[v].a[h].p)&&P[X].includes(d[v].a[h].p)){C=
d[v].a[h].p;X=0;break}if(0===C){for(h=0;h<d[v].a.length;h++)if(""===la&&""!==Jd(d,d[v].a[h].p)&&Jd(d,v)===Jd(d,d[v].a[h].p)){la=Jd(d,d[v].a[h].p);M=d[v].a[h].p;break}for(h=0;h<d[v].a.length;h++)if(0===X&&-1===eb(d,d[v].a[h].p)&&xa(v,d[v].a[h].p)&&""===Jd(d,d[v].a[h].p)){X=xa(v,d[v].a[h].p);Y=d[v].a[h].p;break}0!==X&&""!==la?kc.includes(M)?kc.includes(Y)?C=0:(C=Y,la=""):(C=M,X=0):0!==X?C=Y:""!==la&&(C=M);0===C&&(la="",X=0)}}else{n=[];for(h=0;h<R.length;h++)(0<eb(d,R[h])||Dk.includes(R[h]))&&n.push(R[h]);
if(0<T)for(h=0;h<R.length;h++)if(R[h]!==T){I=R[h];break}1!==n.length||0!==I||180<=Fa[Fa.length-1].$?0===I&&(I=-1):I=n[0];0!==I&&(h=0<I?ia(180+Ya(d,v,I)):K(d,v),I=0,U=d[v].x+na*Math.cos(Math.PI*h/180),x=d[v].y+-1*na*Math.sin(Math.PI*h/180),0<Yd(Q,Ka,U,x)&&(h=ia(h+120),U=d[v].x+na*Math.cos(Math.PI*h/180),x=d[v].y+-1*na*Math.sin(Math.PI*h/180)),0<Yd(Q,Ka,U,x)&&(h=ia(h-240),U=d[v].x+na*Math.cos(Math.PI*h/180),x=d[v].y+-1*na*Math.sin(Math.PI*h/180)),d[d.length]=new kb(1,"H",U,x,0,0,1),d[v].C+=1,Xe(d,k,
v,d.length-1,4),C=d.length-1,I=0,R.unshift(d.length-1))}}if(0===C)for(h=0;h<R.length;h++)if(1===d[R[h]].a.length&&R[h]!==O){C=R[h];break}if(0===C)for(h=0;h<R.length;h++)if(1===d[R[h]].a.length){C=R[h];break}if(0===C)for(h=0;h<R.length;h++)if(0< !ca(R[h])&&1===k[Ja(k,v,R[h])].B&&R[h]!==O){C=R[h];break}if(0===C)for(h=0;h<R.length;h++)if(0< !ca(R[h])&&1===k[Ja(k,v,R[h])].B){C=R[h];break}if(0===C)for(h=0;h<R.length;h++)if(1===k[Ja(k,v,R[h])].B&&R[h]!==O){C=R[h];break}if(0===C)for(h=0;h<R.length;h++)if(1===
k[Ja(k,v,R[h])].B){C=R[h];break}0===C&&(C=R[1]);kc.includes(C)&&(Me(d,v,!0),h=180<Fa[Fa.length-1].$?Qf(d,v,Fa[Fa.length-1].fa,Fa[Fa.length-1].ba,!0):ia(30+Ya(d,v,C)),fc(d,k,v,h,4),C=Q.length-1,R.push(C));if(0!==C&&0<Ja(k,v,C))h=Ja(k,v,C),1===k[h].B&&(k[h].f===v?$c(d,k,h,4,!0):(n=k[h].f,k[h].f=k[h].g,k[h].g=n,0<=d[C].z?$c(d,k,h,4,!0):$c(d,k,h,5,!0)));else{Kc.push(v);continue}}""===la&&(M=0);0===X&&(Y=0);0===p.s&&(R.splice(R.indexOf(O),1),3>R.length&&R.unshift(0),h=[v,O,R[0],R[1],R[2]],Ta=pj(d,k,v,
"",h,"parse"));""!==Ta&&Ta!==(1===ma?"@":"@@")?0===p.s&&($c(d,k,Ja(k,v,C),5,!1),4===d[v].a.length&&0!==I&&$c(d,k,Ja(k,v,I),4,!1)):""===Ta&&0===p.s&&($c(d,k,Ja(k,v,C),1,!0),4===d[v].a.length&&0!==I&&$c(d,k,Ja(k,v,I),1,!0),Kc.push(v))}}dg(Kc)}function Ii(d,k,n,p){var h=Math.sqrt((d[n].x-d[k].x)*(d[n].x-d[k].x)+(d[n].y-d[k].y)*(d[n].y-d[k].y));d[n].x=d[k].x+h*Math.cos(Math.PI*p/180);d[n].y=d[k].y-h*Math.sin(Math.PI*p/180)}function rb(d,k){return 0!==d[k].x&&d[k].x==d[k].x&&0!==d[k].y&&d[k].y==d[k].y?
!0:!1}function Ne(d){var k;if(0===Ma.length)return-1;for(k=0;k<Ma.length;k++)if(Ma[k].includes(d))return k;return-1}function yg(d,k){var n;for(n=0;n<Cd.length;n++)if(Cd[n].Y===d&&Cd[n].Z===k||Cd[n].Z===d&&Cd[n].Y===k)return n;return-1}function Sf(d,k){var n;for(n=0;n<gb.length;n++)if(gb[n].Y===d&&gb[n].Z===k||gb[n].Z===d&&gb[n].Y===k)return n;return-1}function Ef(d,k,n){var p="";for(p in ib)if(ib.hasOwnProperty(p)&&ib[p].length===n&&ib[p].includes(d[k].g)&&ib[p].includes(d[k].f))return p}function Jd(d,
k){d="";for(d in ib)if(ib.hasOwnProperty(d)&&ib[d].includes(k))return d;return""}function m(d,k){for(J=0;J<P[k].length;J++)if(""!==Jd(d,P[k][J]))return!0;return!1}function u(d,k,n,p,h,U){k=0;var x=ib[p].length,z=n-x;var O=ib[p][0];p=ib[p][x-1];d=Math.sqrt((d[p].x-d[O].x)*(d[p].x-d[O].x)+(d[p].y-d[O].y)*(d[p].y-d[O].y));switch(!0){case 1===U:switch(z){case 1:k=180-180*Math.acos(Math.min(d/(2*h),1))/Math.PI;break;case 2:k=180-180*Math.acos(Math.min(Math.abs((d-h)/(2*h)),1))/Math.PI;break;case 3:U=2*
h*Math.cos(Math.PI/6);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;break;case 4:U=h*(2*Math.cos(2*Math.PI/7)+1);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;break;case 5:U=2*h*(Math.cos(Math.PI/8)+Math.cos(3*Math.PI/8));k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;break;default:k=0}break;case 2===U:switch(z){case 2:k=180*Math.acos(Math.min(Math.abs((d-h)/(2*h)),1))/Math.PI;break;case 3:U=2*h*Math.cos(Math.PI/6);k=180-180*Math.acos(Math.min(Math.abs(d-
U)/(2*h),1))/Math.PI;k=k-90+360/n;break;case 4:U=h*(2*Math.cos(2*Math.PI/7)+1);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;k=180-k-360/n;break;case 5:U=2*h*(Math.cos(Math.PI/8)+Math.cos(3*Math.PI/8));k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;k=90-k+1080/(2*n);break;default:k=0}break;case 2<U:k=360/n}return k}function r(d,k){var n=k.slice(0);n.push(k[0]);for(k=0;k<n.length-1&&d[0]!==n[k];k++);return d[1]===n[k+1]?!0:!1}function w(d,k){var n,p=0;for(n=0;n<d[k].a.length;n++)0!==
d[d[k].a[n].p].x&&0!==d[d[k].a[n].p].y&&p++;return p}function G(d,k,n){var p,h="",U="",x=1;if(2!==k[n].B)return 1;if(null!==Qb[k[n].g].match(/[\\|/]/))for(h=Qb[k[n].g].match(/[\\|/]/)[0],p=0;p<d[k[n].f].a.length;p++){var z=d[k[n].f].a[p].p;if(z!==k[n].g&&/[\\|/]/.test(Qb[z])){U=Qb[z].match(/[\\|/]/)[0];break}}else if(null!==Qb[k[n].f].match(/[\\|/]/))for(h=Qb[k[n].f].match(/[\\|/]/)[0],p=0;p<d[k[n].g].a.length;p++)if(z=d[k[n].g].a[p].p,z!==k[n].f&&/[\\|/]/.test(Qb[z])){U=Qb[z].match(/[\\|/]/)[0];
break}""!==h&&""!==U&&(x=h===U?1:-1);return x}function K(d,k){var n,p=new Yc(0,0);if(void 0!==oa[String(k)]&&0<oa[String(k)].length){for(n=0;n<oa[String(k)].length;n++)p.x+=Ek[oa[String(k)][n]].x-d[k].x,p.y+=Ek[oa[String(k)][n]].y-d[k].y;return ld(p.x,p.y,0,0)}return-1}function B(d,k,n,p){return-1*Jg(d[n].x-d[k].x,d[n].y-d[k].y,d[p].x-d[n].x,d[p].y-d[n].y)}function N(d,k){for(var n in ic)if(ic.hasOwnProperty(n)&&(ic[n].ra===d&&ic[n].oa===k||ic[n].ra===k&&ic[n].oa===d))return n;return""}function ha(d,
k,n){var p=-1,h=k[k.length-1],U=-1;var x=db[k[0]].i.indexOf(ic[d].ra);var z=db[n[0]].i.indexOf(ic[d].oa),O=[],C=[],I=[];k=k[0];if(k===h)U=db[h].i.indexOf(ic[d].ra);else for(;-1<x&&k!==h;)if(C.push(db[k].i[x]),x--,0>x){var R=db[k].m;k=db[k].qa;x=db[k].i.indexOf(R);if(k===h){U=x;break}x=db[k].i.indexOf(R)}k=n[0];if(k===h)p=db[h].i.indexOf(ic[d].oa);else for(x=z;-1<x&&k!==h;)if(I.unshift(db[k].i[x]),x--,0>x&&(R=db[k].m,k=db[k].qa,x=db[k].i.indexOf(R),k===h)){p=x;break}for(x=p;x>=U;x--)O.unshift(db[h].i[x]);
P.push(O.concat(I,C))}function Z(d){var k,n=Ed.length,p=Ed.length,h=[];for(k=0;k<P[d].length;k++)P[d][k]<n&&(n=P[d][k]);for(k=0;k<P[d].length;k++)P[d][k]<p&&P[d][k]!==n&&(p=P[d][k]);if(P[d].indexOf(n)>P[d].indexOf(p)){for(k=P[d].length-1;0<=k;k--)h.push(P[d][k]);P[d]=h.slice(0)}for(k=0;0<P[d].indexOf(n)&&!(p=P[d].shift(),P[d].push(p),k++,20<k););}function ka(d,k,n){for(d=1;d<P.length;d++)if(P[d].includes(k[n].f)&&P[d].includes(k[n].g))return d;return 0}function ca(d){var k;for(k=1;k<P.length;k++)if(P[k].includes(d))return k;
return 0}function Oa(d){for(J=1;J<P.length;J++)P[J].includes(d)&&(void 0===oa[String(d)]&&(oa[String(d)]=[]),oa[String(d)].push(J))}function nb(d){for(J=1;J<P.length;J++)if(3===P[J].length&&P[J].includes(d))return J;return 0}function Qa(d){var k,n=!0;for(k=0;k<P[d].length;k++){var p=Ed[P[d][k]].match(/^\[([a-z]{0,2})(H{0,1})([0-9]{0,2})([-|+]{0,1}\d{0,2})\]$/);null!==p?""!==p[1]&&(zg.includes(p[1])?ge.includes(P[d][k])||ge.push(P[d][k]):n=!1):zg.includes(Ed[P[d][k]])?ge.includes(P[d][k])||ge.push(P[d][k]):
n=!1}return n}function xa(d,k){var n,p=0;for(n=1;n<P.length;n++)if(P[n].includes(d)&&P[n].includes(k)){p=n;break}return p}function gc(d,k){var n,p=new Yc(0,0),h=0,U=0;for(n=0;n<P[k].length;n++)h+=d[P[k][n]].x,U+=d[P[k][n]].y;p.x=h/P[k].length;p.y=U/P[k].length;return p}function eb(d,k){var n=0,p;for(p=0;p<d[k].a.length;p++)0<ca(d[k].a[p].p)&&!ta(d,k,d[k].a[p].p)&&n++;return 2<n?n:-1}function ta(d,k,n){for(d=0;d<xe.length;d++)if(xe[d].Ha===k&&xe[d].Ia===n||xe[d].Ha===n&&xe[d].Ia===k)return!0;return!1}
function Va(d){var k;for(k=0;k<gb.length;k++)if(d===gb[k].ta||d===gb[k].ua)return k;return-1}function lb(d){var k,n=0;for(k=0;k<gb.length;k++)gb[k].Y!==d&&gb[k].Z!==d||n++;return n}function Bb(){var d,k;for(d=0;d<gb.length-1;d++)for(k=d+1;k<gb.length;k++)if(gb[d].ta===gb[k].ta&&gb[d].ua===gb[k].ua){var n=String(gb[d].ta)+"-"+String(gb[d].ua);void 0===Gf[n]?Gf[n]=[gb[d].Y,gb[d].Z,gb[k].Y,gb[k].Z]:Gf.hasOwnProperty(n)&&Gf[n].push(gb[d].Y,gb[d].Z,gb[k].Y,gb[k].Z)}for(jb in Gf)Gf.hasOwnProperty(jb)&&
dg(Gf[jb])}function Cb(d){for(jb in Gf)if(Gf.hasOwnProperty(jb)){var k=jb.split("-");if(k[0]===String(d)||k[1]===String(d))return!0}return!1}function uc(){function d(ea,T){var v,pa;for(v=0;v<U[ea].length;v++){var Ta=!1;for(pa=0;pa<U[T].length;pa++)if(U[ea][v].w===U[T][pa].w&&U[ea][v].t===U[T][pa].t||U[ea][v].w===U[T][pa].t&&U[ea][v].t===U[T][pa].w)z.push(new Wa(U[ea][v].w,U[ea][v].t)),Ta=!0;Ta||h.push(new Wa(U[ea][v].w,U[ea][v].t))}}function k(ea,T){ea=ea.slice(0);var v=[],pa=new Wa(ea[T].w,ea[T].t);
v.push(new Wa(pa.w,pa.t));ya.push(pa.w);for(ea.splice(T,1);0<ea.length;){var Ta=!1;for(T=0;T<ea.length;T++)if(pa.t===ea[T].w){pa.w=ea[T].w;pa.t=ea[T].t;v.push(new Wa(pa.w,pa.t));ya.push(pa.w);Ta=!0;ea.splice(T,1);break}else if(pa.t===ea[T].t){pa.t=ea[T].w;pa.w=ea[T].t;v.push(new Wa(pa.w,pa.t));ya.push(pa.w);Ta=!0;ea.splice(T,1);break}if(!Ta)return!1}for(R=0;R<v.length;R++);return!0}var n=!1,p=[],h=[];n=[];var U=[[]],x=0,z=[];p=[];var O=[!1],C=[!1],I=0,R=0,ya=[];x=[];I=[];x=P.slice(1,P.length);x.sort(function(ea,
T){return ea.length-T.length});P=[[0]];P=P.concat(x);for(x=1;x<P.length;x++){U[x]=[];for(I=0;I<P[x].length-1;I++)U[x].push(new Wa(P[x][I],P[x][I+1]));U[x].push(new Wa(P[x][P[x].length-1],P[x][0]))}for(x=1;x<P.length-1;x++)for(I=x+1;I<P.length;I++)p=Fh(P[x],P[I]),p.length===P[x].length&&p.length===P[I].length?(P.splice(I,1),I--):(z=[],h=[],n=[],d(x,I),n=h.slice(0),z=[],h=[],d(I,x),p=[],p=n.concat(h),0<p.length&&(ya=[],n=!1,n=k(p,0),!0===n&&ya.length<P[I].length&&(P[I]=ya)));for(x=1;x<P.length;x++)Z(x);
P.sort(function(ea,T){return ea[0]-T[0]});for(x=1;x<P.length;x++){U[x]=[];for(I=0;I<P[x].length-1;I++)U[x].push(new Wa(P[x][I],P[x][I+1]));U[x].push(new Wa(P[x][P[x].length-1],P[x][0]));for(I=0;I<U[x].length;I++);}for(R=1;R<P.length;R++)for(I=[],x=0;x<P[R].length;x++)I.push(Ed[P[R][x]]);De=[];Cd=[];gb=[];for(x=1;x<P.length-1;x++)for(I=x+1;I<P.length;I++)if(p=[],p=Fh(P[x],P[I]),z=[],d(I,x),1===p.length)Cd.push({Y:x,Z:I,Ja:p[0]}),C[x]=!0,C[I]=!0;else if(0<z.length)for(R=0;R<z.length;R++)gb.push({Y:x,
Z:I,ta:Math.min(z[R].w,z[R].t),ua:Math.max(z[R].w,z[R].t)}),O[x]=!0,O[I]=!0;for(x=1;x<P.length;x++)void 0!==O[x]&&!1!==O[x]||void 0!==C[x]&&!1!==C[x]||De.push(x);for(x=1;x<Ed.length;x++)oa[String(x)]=void 0,Oa(x)}function Jb(d,k,n){var p=0,h=0;h=-1;h="";var U=-1;p=P[d].slice(0);h=P[k].slice(0);var x=n[0],z=n[n.length-1],O=p.indexOf(x),C=h.indexOf(x),I=[];n=[];n=[];var R=[];p=p.slice(O,p.length).concat(p.slice(0,O));h=h.slice(C,h.length).concat(h.slice(0,C));if(p[0]!==h[0]||p[1]!==h[1])h.reverse(),
C=h.indexOf(x),h=h.slice(C,h.length).concat(h.slice(0,C));I.push(z);I=I.concat(p.slice(p.indexOf(z)+1));I.push(x);n=h.slice(h.indexOf(z)+1);n.reverse();I=I.concat(n);P[d]=[];P[d]=I.slice(0);for(p=0;p<Tg.length;p++){h=-1;h=Sf(k,Tg[p]);-1<h&&(gb[h].Y=d);n=Fh(P[d],P[Tg[p]]);if(3===n.length&&7!==Q[n[1]].j){for(h=0;h<n.length;h++)if(7===Q[n[h]].j){U=h;break}R=[];0===P[d].indexOf(n[U])?(R.push(P[d][P[d].length-1]),R.push(n[U]),R.push(P[d][1])):(R.push(P[d][P[d].indexOf(n[U])-1]),R.push(n[U]),R.push(P[d][P[d].indexOf(n[U])+
1]));n=R.splice(0)}else n.sort(function(ya,ea){return P[d].indexOf(ea)-P[d].indexOf(ya)}),n.reverse();h=String(Math.min(k,Tg[p]))+"-"+String(Math.max(k,Tg[p]));void 0!==ib[h]&&delete ib[h];h=String(Math.min(d,Tg[p]))+"-"+String(Math.max(d,Tg[p]));void 0===ib[h]&&(ib[h]=n)}}function Nb(d,k,n){var p,h;for(p=0;p<F[n].i.length;p++){var U=F[n].i[p];for(h=0;h<d[U].a.length;h++)if(!F[n].i.includes(d[U].a[h].p)){var x=Ja(k,U,d[U].a[h].p);if(0<x)return x}}return-1}function jc(d){var k;fe=-1;ee=[];lf=[];Wc=
[];Pi=-1;for(k=0;k<d.length;k++)if(0===d[k].m&&0===d[k].J)fe=k;else if(0<d[k].m&&0<d[k].J&&void 0!==oa[String(d[k].m)]&&void 0!==oa[String(d[k].J)])ee.push(k);else if(0<d[k].J&&void 0!==oa[String(d[k].J)])lf.push(k);else if(0<d[k].m&&0===d[k].J&&(Wc.push(k),0===d[k].ga))for(Fb=1;Fb<P.length;Fb++)P[Fb].includes(d[k].m)&&(Pi=Fb)}function Rd(d,k){d[k].i.reverse();d[k].sa.reverse();var n=d[k].J;d[k].J=d[k].m;d[k].m=n;for(n=d[k].i.length-1;0<n;n--)Qb[d[k].i[n]]=Qb[d[k].i[n-1]],qc[d[k].i[n]]=d[k].i[n-1];
qc[d[k].i[0]]=0;Qb[d[k].i[0]]="";Qb[d[k].i[0]]=Qb[d[k].m];qc[d[k].i[0]]=d[k].m;qc[d[k].m+1]===d[k].m&&(Qb[d[k].m]=Qb[d[k].m+1],qc[d[k].m]=d[k].m+1)}function fd(d,k){F[d].i=F[d].i.concat(F[k].i);F[d].J=F[k].J}function bc(d,k,n){var p=new Pc(d[k].ga,d[k].i[n-1],k,d[k].J);1>n||2>d[k].i.length||(p.i=d[k].i.slice(n),p.sa=d[k].sa.slice(n),d[k].i=d[k].i.slice(0,n),d[k].sa=d[k].sa.slice(0,n),d[k].J=p.i[0],Rd(d,k),d.push(p))}function Td(d,k){var n=[],p,h;var U=new Pc(0,0,-1,0);if(0!==F.length){for(h=0;h<F.length;h++)h===
fe&&(n.push(F[h].i[0]),n.push(F[h].i[F[h].i.length-1])),0<Wc.length&&Wc.includes(h)&&!ca(0<F[h].m)&&n.push(F[h].i[F[h].i.length-1]),0<lf.length&&lf.includes(h)&&n.push(F[h].i[F[h].i.length-1]),0<ee.length&&ee.includes(h)&&(n.push(F[h].i[0]),n.push(F[h].i[F[h].i.length-1]));dg(n);hd=[];if(1<n.length){for(h=0;h<n.length-1;h++)for(p=h+1;p<n.length;p++){var x=!1;Da(d,k,n[h],n[p]);for(Sc=0;Sc<Hb.length;Sc++)if(0<ca(Hb[Sc])){x=!0;break}if(x)break;if(Hb.length>hd.length)hd=Hb.slice(0);else if(Hb.length===
hd.length)if(0<Vd(d,Hb[0])&&0<Vd(d,Hb[Hb.length-1])&&(0===Vd(d,hd[0])||0===Vd(d,hd[hd.length-1])))hd=Hb.slice(0);else if(Ob(d,Hb)>Ob(d,hd))hd=Hb.slice(0);else if(8===d[Hb[0]].j&&8===d[Hb[Hb.length-1]].j&&8===d[hd[0]].j&&8===d[hd[hd.length-1]].j){x=Rf(d,Hb[0])+Rf(d,Hb[Hb.length-1]);var z=Rf(d,hd[0])+Rf(d,hd[hd.length-1]);2<z&&2===x&&(hd=Hb.slice(0))}}if(3<hd.length){d=[];n=ba(F,hd[0]);k=F[n].i.indexOf(hd[0]);for(h=1;h<hd.length;h++)ba(F,hd[h])!==n&&(p=F[ba(F,hd[h-1])].i.indexOf(hd[h-1]),d.push({s:n,
v:k,e:p}),n=ba(F,hd[h]),k=F[n].i.indexOf(hd[h]));d.push({s:n,v:k,e:F[ba(F,hd[hd.length-1])].i.indexOf(hd[hd.length-1])});for(h=0;h<d.length;h++){if(d[h].v>d[h].e)for(p=d[h].v,d[h].v=d[h].e,d[h].e=p,k=F[d[h].s].i.slice(d[h].v,d[h].e+1),k.reverse(),p=k.length-1;0<p;p--)Qb[k[p]]=Qb[k[p-1]],qc[k[p]]=k[p-1];else k=F[d[h].s].i.slice(d[h].v,d[h].e+1);U.i=U.i.concat(k)}ub=[];ub[ub.length]=new Pc(U.ga,U.m,U.qa,U.J);ub[ub.length-1].i=U.i.slice(0);for(h=0;h<F.length;h++){U=-1;for(p=0;p<d.length;p++)if(d[p].s===
h){U=p;break}-1<U?(0<d[U].v&&(ub[ub.length]=new Pc(F[h].ga+1,F[h].m,0,F[h].i[d[U].v]),ub[ub.length-1].i=F[h].i.slice(0,d[U].v),Rd(ub,ub.length-1)),d[U].e<F[h].i.length-1&&(ub[ub.length]=new Pc(F[h].ga+1,F[h].i[d[U].e],0,F[h].J),ub[ub.length-1].i=F[h].i.slice(d[U].e+1))):-1<ba(F,F[h].m)?(ub[ub.length]=new Pc(F[ba(F,F[h].m)].ga,F[h].m,ba(F,F[h].m),F[h].J),ub[ub.length-1].i=F[h].i.slice(0),ub[0].i.includes(ub[ub.length-1].m)&&(ub[ub.length-1].qa=0,ub[ub.length-1].ga=1)):(ub[ub.length]=new Pc(F[h].ga,
F[h].m,F[h].qa,F[h].J),ub[ub.length-1].i=F[h].i.slice(0))}ub[0].i[0]>ub[0].i[ub[0].i.length-1]&&Rd(ub,0);for(p=0;p<ub[0].i.length;p++)ub[0].sa.push(Ed[ub[0].i[p]]);qc[ub[0].i[0]]=0<ub[0].m?ub[0].m:0;for(p=1;p<ub[0].i.length;p++)qc[ub[0].i[p]]=ub[0].i[p-1];for(h=1;h<ub.length;h++){0<ub[h].m&&0===ca(ub[h].m)?(ub[h].qa=ba(ub,ub[h].m),ub[h].ga=ub[ub[h].qa].ga+1):(ub[h].qa=-2,ub[h].ga=-1);for(p=0;p<ub[h].i.length;p++)ub[h].sa.push(Ed[ub[h].i[p]]);qc[ub[h].i[0]]=0<ub[h].m?ub[h].m:0;for(p=1;p<ub[h].i.length;p++)qc[ub[h].i[p]]=
ub[h].i[p-1]}F=[];F=ub;for(h=1;h<F.length;h++)ba(F,F[h].m)}else hd=[]}else hd=[]}}function Ob(d,k){var n=0,p;for(p=0;p<k.length;p++)6===d[k[p]].j&&n++;return n}function Rf(d,k){return 1===d[k].a.length&&1===d[k].a[0].t?1:1===d[k].a.length&&2===d[k].a[0].t?2:0}function Vd(d,k){var n,p;for(n=0;n<d[k].a.length;n++)for(p=1;p<P.length;p++)if(P[p].includes(d[k].a[n].p))return p;return 0}function ob(d,k,n,p){this.ib=d;this.ra=k;this.$a=n;this.oa=p}function Wa(d,k){this.w=d;this.t=k}function Pc(d,k,n,p){this.ga=
d;this.m=k;this.qa=n;this.J=p;this.i=[];this.la="";this.sa=[]}var F=[],Sd="",kf=[],ve=-1,Ec=[],de=[],Wd=[],Sg=[],Qi=0,oh=[],Fk=[],nf=[],hg=[],Rh=[],Vf=0,db=[],Ug=[],Vg=[],Wg=0,of=-1,ne={},Gf={},J=0,ig=0,wj=0,Fb=0,Sc=0,jb,Qh=0,xj=0,Ri=-1,hd=[],Pi=0,Hf="",ub=[],Gk=0,Si=0,Rl="",Bg=0,Sh=[],Dk=[],Xg=[],Sl=[],ge=[],Ti=[],yj="",zj=[[]],ph=[],qh=[],wc=[],rc=[],Ql=[],Tb=0,Oe={},xe=[],Hk=[],ib={},Tl=new Yc(0,0),Ek=[{x:0,y:0}],Ma=[],Ag=0,Tg=[],jg=1,Ik=0,Hb=[],ud=[],gg="",rh=[],Aj=0,sh=-1,kd=[],id=0,nd=0,Bj=
!1,Cj=!1,cd=[],xd=[],pf=0,Cg=0,Xd="",Ul="",th="",Pl=/^\[(\d{0,3})([A-Z]{0,1}[a-z]{0,2})(@{0,2})(H{0,1})([0-9]{0,2})([-|+]{0,1}\d{0,2})\]$/,Im=/^\[(R{1,1}\d{0,1})\]$/;if(0!==W.length){Q.length=1;Ka.length=1;F=[];ee=[];Qg=[];Pi=0;fe=-1;Ed=[];bd=[new Ce(0,0,0)];De=[];wc=[];rc=[];ib={};gb=[];P=[[0]];kc=[];Cd=[];lf=[];Wc=[];for(jb in ic)ic.hasOwnProperty(jb)&&delete ic[jb];for(jb in oa)oa.hasOwnProperty(jb)&&delete oa[jb];for(jb in S)S.hasOwnProperty(jb)&&delete S[jb];for(jb in ib)ib.hasOwnProperty(jb)&&
delete ib[jb];for(jb in Oe)Oe.hasOwnProperty(jb)&&delete Oe[jb];for(jb in Gf)Gf.hasOwnProperty(jb)&&delete Gf[jb];(function(d){var k,n=0,p=0,h=0,U=!1,x=!1,z=0,O="",C=1,I,R=!1,ya="";db[p]=new Pc(0,0,-1,0);var ea=I="";/^\[\d{0,1}H[+-]{0,1}\]/.test(d)&&(x=!0);for(k=0;k<d.length;k++){var T=d.charAt(k);k<d.length-1&&(O=T+d.charAt(k+1));if((U||!kh.includes(O.charAt(0))||!zg.includes(O.charAt(1)))&&k<d.length-1&&(Og.includes(O)||zg.includes(O)||qe.includes(O)))n++,db[p].i.push(n),I+=O,U||(db[p].sa[n]=I,
Ed[n]=I,Qb[n]=ea,we[n]="",db[p].la+=O,ea=I=""),1<n?(1<db[p].i.length?(qc[n]=db[p].i[db[p].i.length-2],bd.push(new Ce(db[p].i[db[p].i.length-2],db[p].i[db[p].i.length-1],C))):(qc[n]=db[p].m,bd.push(new Ce(db[p].m,db[p].i[db[p].i.length-1],C))),C=1):qc[n]=0,k++,O="";else if("H"===T&&U&&!x&&"[2"!==I&&"[3"!==I||!Og.includes(T)&&!zg.includes(T)&&"R"!==T)if(U||null===T.match(/%{1}/))if(U||null===T.match(/[0-9]{1}/))if("("===T)z++,h++,db[h]=new Pc(z,db[p].i[db[p].i.length-1],p,0),p=h;else if(")"===T)z--,
p=db[p].qa;else if("["===T)U=!0,I="[";else if("]"===T)I+="]",/^\[H[+-]{0,1}\]/.test(I)&&!1===x&&n++,db[p].sa[n]=I,Ed[n]=I,"[H][H]"===d&&2===n&&(qc[n]=1,db[p].i.push(2),bd.push(new Ce(1,2,1))),Qb[n]=ea,we[n]="",db[p].la+=I,ea=I="",x=U=!1;else if("="===T)db[p].la+=T,ea+=T,C=2;else if("#"===T)db[p].la+=T,ea+=T,C=3;else if("\\"===T||"/"===T)db[p].la+=T,ea+=T;else{if(!U||"H"!==T)if(!U||Og.includes(T)||zg.includes(T))return Dd='invalidSymbol in SMILES:"'+T+'"',-1;I+=T}else ya=R?ya+T:T,R&&2!==ya.length||
(void 0!==ic[String(ya)]?(ic[String(ya)].$a=p,ic[String(ya)].oa=n):(ic[String(ya)]=new ob(p,n,0,0),ic[String(ya)].ib=p,ic[String(ya)].ra=n),db[p].la+=ya,""!==ea&&(we[n]=ea,ea=""),ya="",R=!1);else!1===U&&(R=!0,ya="");else n++,db[p].i.push(n),I+=T,U||(db[p].sa[n]=I,Ed[n]=I,Qb[n]=ea,we[n]="",db[p].la+=T,ea=I=""),1<n?(1<db[p].i.length?(qc[n]=db[p].i[db[p].i.length-2],bd.push(new Ce(db[p].i[db[p].i.length-2],db[p].i[db[p].i.length-1],C))):(qc[n]=db[p].m,bd.push(new Ce(db[p].m,db[p].i[db[p].i.length-1],
C))),C=1):qc[n]=0}Hd=[];for(var v in ic)ic.hasOwnProperty(v)&&Hd.push(String(ic[v].ra)+":"+String(ic[v].oa))})(W);for(jb in ic)if(ic.hasOwnProperty(jb)){bd.push(new Ce(ic[jb].ra,ic[jb].oa,1));Ug=[];Vg=[];for(ig=ic[jb].ib;0<=ig;)Ug.push(ig),ig=db[ig].qa;for(ig=ic[jb].$a;0<=ig;)Vg.push(ig),ig=db[ig].qa;for(;0<Ug.length&&0<Vg.length;)if(Ug[Ug.length-1]===Vg[Vg.length-1])Ri=Ug.pop(),Ri=Vg.pop();else break;-1<Ri&&(Ug.push(Ri),Vg.push(Ri));ha(jb,Ug,Vg)}for(Fb=1;Fb<Ed.length;Fb++)Ke[Fb]=[];for(J=1;J<bd.length;J++)Ke[bd[J].f].push(bd[J].g),
Ke[bd[J].g].push(bd[J].f);for(J=1;J<Ed.length;J++)if(xj=E(Q,Ka,qc[J],Ed[J]),0>xj)return;hf=[];cg=[];Gl(Q);for(J=1;J<Q.length;J++)if("="===Qb[J]){Cj=Bj=!1;cd=[];xd=[];Xd="";Cg=pf=0;id=qc[J];nd=0<Le(id)?Le(id):J;for(jb in ic)ic.hasOwnProperty(jb)&&(ic[jb].ra===id?pf=ic[jb].oa:ic[jb].oa===id&&(pf=ic[jb].ra),ic[jb].ra===nd?Cg=ic[jb].oa:ic[jb].oa===nd&&(Cg=ic[jb].ra));/[\\|/]/.test(Qb[id])&&(Bj=!0);for(Fb=0;Fb<Q[id].a.length;Fb++)2!==Q[id].a[Fb].t&&(cd.push(Q[id].a[Fb].p),/[\\|/]/.test(Qb[Q[id].a[Fb].p])||
/[\\|/]/.test(we[Q[id].a[Fb].p]))&&(Bj=!0);0===pf&&2===cd.length?cd.sort(function(d,k){return d-k}):0<pf&&2===cd.length&&(/[\\|/]/.test(Qb[id])?pf===cd[0]&&(cd[0]=id[1],cd[1]=pf):/[\\|/]/.test(we[pf])&&pf!==cd[0]?(cd[1]=cd[0],cd[0]=pf):/[\\|/]/.test(Qb[pf])&&pf!==cd[1]&&(cd[0]=cd[1],cd[1]=pf));/[\\|/]/.test(we[nd])&&(Cj=!0);for(Fb=0;Fb<Q[nd].a.length;Fb++)2!==Q[nd].a[Fb].t&&(xd.push(Q[nd].a[Fb].p),/[\\|/]/.test(Qb[Q[nd].a[Fb].p])&&(Cj=!0));0===Cg&&2===xd.length?xd.sort(function(d,k){return d-k}):
0<Cg&&2===xd.length&&(/[\\|/]/.test(we[nd])?xd[0]===Cg&&(xd[0]=xd[1],xd[1]=Cg):Cg!==xd[0]&&(xd[1]=xd[0],xd[0]=Cg));!1!==Bj&&!1!==Cj&&(Xd=/[\\|/]/.test(Qb[id])?Xd+("\\"===Qb[id]?"1":"2"):2===cd.length&&/[\\|/]/.test(we[cd[0]])?Xd+("\\"===we[cd[0]]?"1":"2"):"0",Xd=2===cd.length&&/[\\|/]/.test(Qb[cd[1]])?Xd+("\\"===Qb[cd[1]]?"1":"2"):2===cd.length&&/[\\|/]/.test(Qb[cd[0]])?Xd+("\\"===Qb[cd[0]]?"2":"1"):1===cd.length&&/[\\|/]/.test(Qb[cd[0]])?Xd+("\\"===Qb[cd[0]]?"2":"1"):Xd+"0",Xd=/[\\|/]/.test(we[nd])?
2===xd.length?Xd+("\\"===we[nd]?"2":"1"):Xd+("\\"===we[nd]?"1":"2"):/[\\|/]/.test(Qb[xd[0]])?Xd+("\\"===Qb[xd[0]]?"1":"2"):Xd+"0",Xd=/[\\|/]/.test(we[nd])?Xd+"0":2===xd.length&&/[\\|/]/.test(Qb[xd[1]])?Xd+("\\"===Qb[xd[1]]?"1":"2"):Xd+"0",Ul=Mc(Xd),void 0===S[String(id)+"-"+String(nd)]&&(S[String(id)+"-"+String(nd)]={w:id,t:nd,O:cd[0],P:0,S:xd[0],R:0,ea:Xd,T:Ul},2===cd.length&&(S[String(id)+"-"+String(nd)].P=cd[1]),2===xd.length&&(S[String(id)+"-"+String(nd)].R=xd[1])),void 0===S[String(nd)+"-"+String(id)]&&
(th=S[String(id)+"-"+String(nd)].T,S[String(nd)+"-"+String(id)]={w:nd,t:id,O:0,P:0,S:0,R:0,ea:"",T:""},2===xd.length?(S[String(nd)+"-"+String(id)].O=xd[1],S[String(nd)+"-"+String(id)].P=xd[0],th="t"===th?"c":"t"):S[String(nd)+"-"+String(id)].O=xd[0],2===cd.length?(S[String(nd)+"-"+String(id)].S=cd[1],S[String(nd)+"-"+String(id)].R=cd[0],th="t"===th?"c":"t"):S[String(nd)+"-"+String(id)].S=cd[0],S[String(nd)+"-"+String(id)].T=th,S[String(nd)+"-"+String(id)].ea="t"===th?"1010":"1020"))}Hf="";for(J=1;J<
P.length;J++)Hf=Hf+"-"+P[J].length;Hf=Hf.slice(1);for(Sc=0;Hf!==Rl&&20>Sc;){Rl=Hf;uc();Hf="";for(J=1;J<P.length;J++)Hf=Hf+"-"+P[J].length;Hf=Hf.slice(1);Sc++}Hk[0]=0;for(J=1;J<bd.length;J++)Hk.push(xa(bd[J].f,bd[J].g));Qg=[];for(J=1;J<P.length;J++)if(!0===Qa(J))for(Qg[J]=!0,Sc=0;Sc<P[J].length;Sc++)1===Sc%2&&(Qb[P[J][Sc]]="=");else Qg[J]=!1;if(0<gb.length)for(J=0;J<gb.length;J++)void 0===ne[String(gb[J].Y)]&&(ne[String(gb[J].Y)]=[]),ne[String(gb[J].Y)].push(gb[J].Z),void 0===ne[String(gb[J].Z)]&&
(ne[String(gb[J].Z)]=[]),ne[String(gb[J].Z)].push(gb[J].Y);if(0<Cd.length)for(J=0;J<Cd.length;J++)void 0===ne[String(Cd[J].Y)]&&(ne[String(Cd[J].Y)]=[]),ne[String(Cd[J].Y)].push(Cd[J].Z),void 0===ne[String(Cd[J].Z)]&&(ne[String(Cd[J].Z)]=[]),ne[String(Cd[J].Z)].push(Cd[J].Y);jg=0;for(jb in ne)if(ne.hasOwnProperty(jb)){Ma[jg]=[];Ma[jg]=Ei(Ma[jg],ne[jb]);for(J=0;J<ne[jb].length;J++)Ma[jg]=Ei(Ma[jg],ne[String(ne[jb][J])]);Ma[jg]=dg(Ma[jg]);Ma[jg].sort(function(d,k){return parseInt(d,10)-parseInt(k,10)});
jg++}if(1<Ma.length){for(J=0;J<Ma.length-1;J++)for(Fb=J+1;Fb<Ma.length;Fb++)!0===tg(Ma[J],Ma[Fb])&&Ma.splice(Fb--,1);for(J=0;J<Ma.length-1;J++)for(Fb=J+1;Fb<Ma.length;Fb++)for(Sc=0;Sc<Ma[J].length;Sc++)if(Ma[Fb].includes(Ma[J][Sc])){Ma[J]=Ei(Ma[J],Ma[Fb]);Ma.splice(Fb--,1);break}}Ma.sort(function(d,k){var n,p=0,h=0;if(k.length===d.length){for(n=0;n<d.length;n++)p+=P[d[n]].length,h+=P[k[n]].length;return h-p}return k.length-d.length});for(J=0;J<Ma.length;J++)Ma[J].sort(function(d,k){return P[k].length-
P[d].length});(function(d,k){var n=0,p=0,h=0,U=0,x=p=n=U=h=0;x=[];var z=!1;for(h=0;h<db.length;h++)for(n=p=U=0;U<db[h].i.length;)0<ca(db[h].i[U])?(0<U&&0<n&&(F[F.length-1].J=db[h].i[U],n=0),p=db[h].i[U]):(0===U?F[F.length]=new Pc(db[h].ga,db[h].m,db[h].qa,0):0<p&&(F[F.length]=new Pc(0,p,-2,0),p=0),F[F.length-1].i.push(db[h].i[U]),F[F.length-1].sa.push(Ed[db[h].i[U]]),n=db[h].i[U]),U++;Ma.sort(function(O,C){return C.length-O.length});F.sort(function(O,C){return O.ga-C.ga});for(h=0;h<F.length;h++)0===
F[h].m&&0<F[h].J&&(Rd(F,h),x.push(h));if(0<F.length){for(h=0;h<F.length;h++){if(0===F[h].ga&&0===F[h].J&&0!==F[h].m)for(U=0;U<F.length;U++)if(h!==U&&0<F[U].m&&0<F[U].J&&void 0!==oa[String(F[U].J)]&&(n=F[h].i[F[h].i.length-1],p=F[U].i[0],Ke[n].includes(p))){fd(h,U);F.splice(U,1);z=!0;break}if(!0===z)break}jc(F);Td(d,k);for(h=0;h<F.length;h++)0===F[h].m&&0<F[h].J&&(Rd(F,h),x.push(h));if(1<d[F[0].i[0]].a.length)for(h=0;h<d[F[0].i[0]].a.length;h++)if(ca(d[F[0].i[0]].a[h].p)){F[0].m=d[F[0].i[0]].a[h].p;
break}for(h=0;h<F.length;h++)if(x=F[h].i[F[h].i.length-1],1<d[x].a.length)for(U=0;U<d[x].a.length;U++)if(0===F[h].J&&ca(d[x].a[U].p)){F[h].J=d[x].a[U].p;break}-1===fe&&3<F[0].i.length&&0<F[0].m&&0===F[0].J&&void 0!==oa[String(F[0].m)]&&1===oa[String(F[0].m)].length&&Rd(F,0);jc(F)}})(Q,Ka);xe=[];for(J=1;J<bd.length;J++)void 0!==oa[String(bd[J].f)]&&void 0!==oa[String(bd[J].g)]&&0===Hk[J]&&xe.push({Ab:J,Ha:bd[J].f,Ia:bd[J].g});for(jb in ic)ic.hasOwnProperty(jb)&&Xe(Q,Ka,ic[jb].ra,ic[jb].oa,1);(function(d){var k,
n,p=0;Dk=[];for(n=0;n<gb.length-1;n++){var h=gb[n].Y;var U=gb[n].Z;for(k=n+1;k<gb.length;k++)if(h===gb[k].Y&&U===gb[k].Z||h===gb[k].Z&&U===gb[k].Y){var x=String(Math.min(h,U))+"-"+String(Math.max(h,U));void 0!==ib[x]?ib[x]=Ei(ib[x],[gb[k].ta,gb[k].ua,gb[n].ta,gb[n].ua]):(ib[x]=[gb[k].ta,gb[k].ua,gb[n].ta,gb[n].ua],ib[x]=dg(ib[x]))}}for(var z in ib)if(ib.hasOwnProperty(z)){k=[];for(n=0;n<ib[z].length;n++)if(2<eb(d,ib[z][n])){p=ib[z][n];k.push(p);break}for(x=0;k.length<ib[z].length;){for(n=0;n<d[p].a.length;n++)ib[z].includes(d[p].a[n].p)&&
!k.includes(d[p].a[n].p)&&(p=d[p].a[n].p,k.push(p));x++;if(20<x)break}ib[z]=k.slice(0);n=z.split("-");h=P[parseInt(n[0],10)].length>=P[parseInt(n[1],10)].length?parseInt(n[0],10):parseInt(n[1],10);r(ib[z],P[h])||ib[z].reverse()}dg(Dk)})(Q);var Vl=0;for(jb in ib)ib.hasOwnProperty(jb)&&3===ib[jb].length&&7===Q[ib[jb][0]].j&&7===Q[ib[jb][2]].j&&!kh.includes(Q[ib[jb][1]].o)&&(yj=jb,Oe[jb]={Y:jb.split("-")[0],Z:jb.split("-")[1],Ua:ib[jb][1],Sa:ib[jb][0],Ta:ib[jb][2]},Vl++);var Dj=0,Jk=0;for(J=1;J<P.length;J++)if(5===
P[J].length){for(Fb=Jk=0;Fb<P[J].length;Fb++)7===Q[P[J][Fb]].j&&Jk++;1===Jk&&(Dj++,Tg.push(J))}if(0<Ma.length&&10<=P[Ma[0][0]].length&&4<=Dj&&0<F.length&&0===F[0].m&&0===F[0].J&&(Bg=Nb(Q,Ka,0),0<Bg))if(F[0].i.includes(Ka[Bg].f)){var Pm=Ka[Bg].g;bc(F,0,Math.min(F[0].i.indexOf(Ka[Bg].f)+1,F[0].i.length-1));F[0].m=Pm;fe=-1}else if(F[0].i.includes(Ka[Bg].g)){var Qm=Ka[Bg].f;bc(F,0,Math.min(F[0].i.indexOf(Ka[Bg].g)+1,F[0].i.length-1));F[0].m=Qm;fe=-1}1===Vl&&4<=Dj?(gg="m2porphin",fe=-1,0<F.length&&0===
F[0].m&&0===F[0].J&&(Bg=Nb(Q,Ka,0)),0<Ma.length&&10===P[Ma[0][0]].length&&10===P[Ma[0][1]].length&&(Jb(Ma[0][0],Ma[0][1],[Oe[yj].Sa,Oe[yj].Ua,Oe[yj].Ta]),Ag=Ma[0][1])):4<=Dj&&5<=Ma[0].length&&16===P[Ma[0][0]].length&&(gg="porphin");Ye=qc.slice(0);(function(d,k){var n;var p=-1;var h="",U=0;var x=F.length+P.length-1;if(1<P.length){var z=1;for(n=2;n<P.length;n++)P[n].length>P[z].length&&(z=n);Qh=8<P[z].length?z:-1}0<Ma.length&&(p=0);switch(!0){case -1<fe||lf.includes(0):Ca(d,k,0,0);h=0===fe?"mchain":
"achain";Tb=rc.length+wc.length;break;case 0<F.length&&0<ee.length:Ca(d,k,ee[0],0);qh.push(ee[0]);p=ca(F[ee[0]].m);ca(F[ee[0]].J);var O=F[ee[0]].m;var C=F[ee[0]].i[0];z=Ne(p);-1!==z?Ab(d,k,z,C,O,p):Mb(d,k,p,O,C,"chend","",1,P[p].indexOf(O),0,0,"",na);h="cchain";Tb=rc.length+wc.length;break;case 0<Ma.length:Ab(d,k,p,0,0,0);h="ringSys";Tb=rc.length+wc.length;break;case 1<P.length&&0<Qh&&8<P[Qh].length:Mb(d,k,Qh,0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);h="ring";Tb=rc.length+wc.length;break;
case 0<F.length&&0>fe&&0===F[0].ga:Ca(d,k,0,0);h="achain";Tb=rc.length+wc.length;break;case 0<F.length&&0>fe&&0<lf.length:Ca(d,k,lf[0],0);h="achain";Tb=rc.length+wc.length;break;case 0<F.length&&0===F[0].ga&&0<Pi:Mb(d,k,Pi,0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);h="ring";Tb=rc.length+wc.length;break;case 0<De.length:Mb(d,k,De[0],0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);h="ring";Tb=rc.length+wc.length;break;case 0<F.length:Ca(d,k,0,0),h="achain",Tb=rc.length+wc.length}for(;Tb<x&&
20>U;)if(U++,p=!1,"cchain"===h){if(O=F[qh[qh.length-1]].J,C=F[qh[qh.length-1]].i.slice(-1)[0],p=ca(F[qh[qh.length-1]].J),z=Ne(p),-1!==z?(Ab(d,k,z,C,O,p),h="ringSys"):(z=P[p].indexOf(O),Mb(d,k,p,O,C,"chend","",1,z,0,0,"",na),h="ring"),Tb=rc.length+wc.length,Tb===x)return}else{if("achain"===h){var I=wc[wc.length-1];O=F[I].J;C=F[I].i.slice(-1)[0];switch(!0){case 0<O&&void 0!==C&&0<ca(O)&&!rc.includes(ca(O)):n=ca(O);z=Ne(n);0<=z?(Ab(d,k,z,C,O,n),Tb=rc.length+wc.length,h="ringSys"):(z=P[n].indexOf(O),
Mb(d,k,n,O,C,"chend","",1,z,0,0,"",na),Tb=rc.length+wc.length,h="ring");if(Tb===x)return;break;case 0<O&&!rb(d,O):z=ba(F,O);if(-1<z&&(O===F[z].i[0]?Ca(d,k,z,C):O===F[z].i.slice(-1)[0]?(Rd(F,z),Ca(d,k,z,F[z].m)):(bc(F,z,F[z].i.indexOf(O)),rb(d,F[F.length-1].m)||(F[F.length-1].m=F[I].i.slice(-1)[0]),x++,Ca(d,k,F.length-1,F[F.length-1].m)),Tb=rc.length+wc.length,h="achain",Tb===x))return;break;case 0<F[I].m&&!rb(d,F[I].m):z=ba(F,F[I].m);if(-1<z){if(F[I].m===F[z].i[0]?Ca(d,k,z,F[I].i[0]):F[I].m===F[z].i.slice(-1)[0]?
(Rd(F,z),Ca(d,k,z,F[I].i[0])):(bc(F,z,F[z].i.indexOf(F[I].m)),rb(d,F[F.length-1].m)||(F[F.length-1].m=F[I].i[0]),x++,Ca(d,k,F.length-1,F[F.length-1].m)),Tb=rc.length+wc.length,h="achain",Tb===x)return}else if(n=ca(F[I].m),0<n&&(z=Ne(n),0<=z?(Ab(d,k,z,F[I].i[0],F[I].m,n),Tb=rc.length+wc.length,h="ringSys"):(z=P[n].indexOf(F[I].m),Mb(d,k,n,F[I].m,F[I].i[0],"chend","",1,z,0,0,"",na),Tb=rc.length+wc.length,h="ring"),Tb===x))return;break;case (0===F[I].J||rb(d,F[I].J))&&(0===F[I].m||rb(d,F[I].m)):n=!1;
if(0<wc.length)for(I=0;I<F.length;I++)if(!wc.includes(I)){if(0<F[I].m&&rb(d,F[I].m)&&(Ca(d,k,I,F[I].m),Tb=rc.length+wc.length,h="achain",n=!0,Tb===x)||!n&&0<F[I].J&&rb(d,F[I].J)&&(Rd(F,I),Ca(d,k,I,F[I].m),Tb=rc.length+wc.length,h="achain",n=!0,Tb===x))return;if(!n)for(C=F[I].i[0],O=0;O<d[C].a.length;O++)if(rb(d,d[C].a[O].p)&&(Ca(d,k,I,d[C].a[O].p),Tb=rc.length+wc.length,h="achain",n=!0,Tb===x))return;if(!n)for(C=F[I].i.slice(-1)[0],O=0;O<d[C].a.length;O++)if(rb(d,d[C].a[O].p)&&(Ca(d,k,I,d[C].a[O].p),
Tb=rc.length+wc.length,h="achain",n=!0,Tb===x))return;if(!n)for(z=1;z<F[I].i.length-1&&!n;){C=F[I].i[z];for(O=0;O<d[C].a.length;O++)if(rb(d,d[C].a[O].p)&&(Ca(d,k,I,d[C].a[O].p),Tb=rc.length+wc.length,h="achain",n=!0,Tb===x))return;z++}}if(!n&&0<rc.length)for(I=1;I<P.length;I++)if(!rc.includes(I))for(z=0;z<P[I].length;z++)for(C=P[I][z],O=0;O<d[C].a.length;O++)if(rb(d,d[C].a[O].p)&&(-1<Ne(I)?(Ab(d,k,Ne(I),d[C].a[O].p,C,I),h="ringSys"):(Mb(d,k,I,C,d[C].a[O].p,"chend","",1,z,0,0,"",na),h="ring"),Tb=rc.length+
wc.length,Tb===x))return;break;default:for(O=F[wc.slice(-1)[0]].i.slice(-1)[0],z=0;z<d[O].a.length;z++)if(!1===rb(d,d[O].a[z].p))if(C=ba(F,d[O].a[z].p),-1<C&&F[C].i[0]===d[O].a[z].p){Ca(d,k,C,O);Tb=rc.length+wc.length;h="achain";if(Tb===x)return;p=!0;break}else if(-1<C&&F[C].i.slice(-1)[0]===d[O].a[z].p){Rd(F,C);Ca(d,k,C,O);Tb=rc.length+wc.length;h="achain";if(Tb===x)return;p=!0;break}}}else if("ring"===h||"ringSys"===h){if(0<xe.length){for(I=C=n=O=0;I<xe.length;I++)if(rb(d,xe[I].Ha)&&!rb(d,xe[I].Ia)?
(O=xe[I].Ia,n=ca(O),C=xe[I].Ha):rb(d,xe[I].Ia)&&!rb(d,xe[I].Ha)&&(O=xe[I].Ha,n=ca(O),C=C=xe[I].Ia),0<O){z=Ne(n);0<=z?(Ab(d,k,z,C,O,n),Tb=rc.length+wc.length,h="ringSys"):(z=P[n].indexOf(O),Mb(d,k,n,O,C,"chend","",1,z,0,0,"",na),Tb=rc.length+wc.length,h="ring");if(Tb===x)return;p=!0;break}if(p)continue}n=!1;for(I=0;I<F.length;I++)if(!wc.includes(I)&&("ring"===h||"ringSys"===h)){0<ca(F[I].m)&&rc.includes(ca(F[I].m))?(Ca(d,k,I,F[I].m),h="achain",Tb=rc.length+wc.length,n=!0):0<ca(F[I].J)&&rc.includes(ca(F[I].J))&&
(Rd(F,I),Ca(d,k,I,F[I].m),h="achain",Tb=rc.length+wc.length,n=!0);if(Tb===x)return;if(n)break}if(p)continue}for(n=0;n<F.length;n++)if(!wc.includes(n)&&0<F[n].m&&rb(d,F[n].m)){Ca(d,k,n,0);h="achain";Tb=rc.length+wc.length;if(Tb===x)return;break}for(n=1;n<P.length;n++)if(!rc.includes(n)){for(I=0;I<P[n].length;I++){for(z=0;z<d[P[n][I]].a.length;z++)if(0===ca(d[P[n][I]].a[z].p)&&!0===rb(d,d[P[n][I]].a[z].p)){O=P[n][I];C=d[P[n][I]].a[z].p;-1<Ne(n)?(Ab(d,k,Ne(n),C,O,n),h="ringSys"):(Mb(d,k,n,O,C,"chend",
"",1,I,0,0,"",na),h="ring");Tb=rc.length+wc.length;if(Tb===x)return;p=!0;break}if(p)break}if(p)break}if(!p)for(n=0;n<F.length;n++)if(!wc.includes(n)){for(I=1;I<P.length;I++)if(rc.includes(I)){for(z=0;z<P[I].length;z++)if(-1<Ja(k,P[I][z],F[n].i[0])){z=P[I][z];Ca(d,k,n,z);h="achain";Tb=rc.length+wc.length;if(Tb===x)return;p=!0;break}if(p)break}if(p)break}}Tb!==x&&(xg="Not all components plotted")})(Q,Ka);zj[0]=[[0,120,240],[0,120,240],[0,120,240],[0,120,180,240],[30,120,180,240,330]];zj[1]=[[120,240],
[120,240],[120,180,240],[60,150,210,270]];xj=Q.length-1;for(J=1;J<=xj;J++)if(Qi=tk(Q,J,!1),0<Q[J].C){Q[J].C<=Qi&&(Q[J].C=Math.max(Q[J].C-Qi,0));ph=[];for(Sc=0;Sc<Q[J].a.length;Sc++)ph.push(Ya(Q,J,Q[J].a[Sc].p));if(Q[J].C>Qi&&1<Q[J].C){if(wj=Q[J].C,Fa=[],Me(Q,J,!0),1===Fa.length&&0===Fa[0].$&&(Fa[0].$=360),90<=Fa[Fa.length-1].$){var Rm=Ya(Q,J,Fa[Fa.length-1].ba),Wl=Fa[Fa.length-1].$/(wj+1);of=ia(Rm+Wl);for(Fb=0;Fb<wj;Fb++)fc(Q,Ka,J,of,1),of=ia(of+Wl);Q[J].C-=wj}}else for(Sc=0;Sc<Q[J].C;Sc++){if(0===
ph.length&&6>Q[J].C)of=zj[0][Q[J].C-1][Sc];else if(1===ph.length&&5>Q[J].C)of=ia(ph[0]+zj[1][Q[J].C-1][Sc]);else for(Fa=[],Me(Q,J,!0),of=Qf(Q,J,Fa[Fa.length-1].fa,Fa[Fa.length-1].ba,!0),Fb=0;Fb<ph.length;Fb++)5>Math.abs(ia(ph[Fb]-of))&&(of=ia(of+180));fc(Q,Ka,J,of,1);--Q[J].C}1===Qi&&/@{1,2}/.test(Q[J].I)&&1===Q[J].D&&1===Q[J].F&&(Fa=[],Me(Q,J,!0),of=Qf(Q,J,Fa[Fa.length-1].fa,Fa[Fa.length-1].ba,!0),fc(Q,Ka,J,of,1))}ge=[];for(J=1;J<Q.length;J++)if(Q[J].X)for(ge.push(J),Lb=0;Lb<Q[J].a.length;Lb++)2===
Q[J].a[Lb].t&&Nf(Q,Ka,J,Q[J].a[Lb].p,"-");if(1<ge.length)for(Sl=[],Xg=ge.slice(0),sh=Xg[0],Sd="+",Ik=1;0<Xg.length&&Ik<=ge.length;)Fk=[],Xg.splice(Xg.indexOf(sh),1),Fk=Gb(Q,sh,Xg,1),Si=Fk[0],void 0!==Si&&-1<Si?("+"===Sd?(Nf(Q,Ka,sh,Si,"+"),Sd="-"):Sd="+",Sl.push(sh),sh=Si):0<Xg.length&&(sh=Xg[0],Sd="+"),Ik++;(function(d,k,n){Ti=[];for(d=1;d<Ka.length;d++)n.includes(Ka[d].f)&&n.includes(Ka[d].g)&&2===Ka[d].B&&Ti.push(d)})(Q,Ka,ge);de=[];Ec=[];for(J=0;J<ge.length;J++)1===Ra(Q,Ka,ge[J])?de.push(ge[J]):
Ec.push(ge[J]);if(0<Ec.length)for(J=0;J<Ec.length-1;J++){for(Sc=J+1;Sc<Ec.length;Sc++)if(ve=yb(Q,Ka,Ec[J],Ec[Sc]),1===ve&&0===Ib(Q,Ka,kf)){Ec.splice(Ec.indexOf(Ec[J]),1);Ec.splice(Ec.indexOf(Ec[Sc]),1);de.push(Ec[J]);de.push(Ec[Sc]);break}if(0===Ec.length)break}de=[];Ec=[];for(J=0;J<ge.length;J++)1===Ra(Q,Ka,ge[J])?de.push(ge[J]):Ec.push(ge[J]);if(0<Ec.length){for(J=1;J<Q.length;J++)if(Q[J].X)for(Lb=0;Lb<Q[J].a.length;Lb++)2===Q[J].a[Lb].t&&Q[Q[J].a[Lb].p].X&&Nf(Q,Ka,J,Q[J].a[Lb].p,"-");for(J=0;J<
Ti.length;J++)Nf(Q,Ka,Ka[Ti[J]].f,Ka[Ti[J]].g,"+");for(J=0;J<Ec.length-1;J++){for(Sc=J+1;Sc<Ec.length;Sc++)if(ve=ab(Q,Ka,Ec[J],Ec[Sc]),1===ve&&0===Ib(Q,Ka,kf)){Ec.splice(Ec.indexOf(Ec[J]),1);Ec.splice(Ec.indexOf(Ec[Sc]),1);de.push(Ec[J]);de.push(Ec[Sc]);break}if(0===Ec.length)break}}(function(d,k){function n(M,X,Y,ja){var qa=!1;switch(!0){case 0===ca(Y)&&0===ca(ja):ba(F,Y)<ba(F,ja)&&(qa=!0);break;case 0<ca(Y)&&0===ca(ja):qa=!0;break;case 0<ca(Y)&&0<ca(ja):P[ca(Y)].length>P[ca(ja)].length&&(qa=!0)}qa&&
(qa=ja,ja=Y,Y=qa);Da(M,X,Y,ja)}function p(M,X,Y,ja){var qa=la,Ba=la,Ha;n(M,X,Y,ja);if(0<ud.length){Y=0;for(Ha=-1;Y<ud.length;)rg(M,X,ud[Y],1,!0),ja=Zb(M,X,Rb,1,""),rg(M,X,ud[Y],-1,!0),ja<qa&&(Ha=Y,qa=ja),Y++;qa<Ba&&-1!==Ha&&(rg(M,X,ud[Ha],1,!0),la=Zb(M,X,Rb,0,"inside fixAtomAtomCollisionsByFlip: after flipBranch after bestFlip"))}}function h(M,X,Y,ja){var qa,Ba=0,Ha=0,Ia=[];var Ub=[];for(qa=0;qa<P[Y].length;qa++)3===M[P[Y][qa]].a.length&&Ub.push(P[Y][qa]);for(qa=0;qa<P[ja].length;qa++)3===M[P[ja][qa]].a.length&&
Ia.push(P[ja][qa]);for(qa=0;qa<F.length;qa++)P[Y].includes(F[qa].m)?Ba=F[qa].m:P[Y].includes(F[qa].J)&&(Ba=F[qa].J),P[ja].includes(F[qa].m)?Ha=F[qa].m:P[ja].includes(F[qa].J)&&(Ha=F[qa].J);switch(!0){case 0<Ba&&0<Ha:p(M,X,Ba,Ha);break;case 0<Ba&&0===Ha&&0<Ia.length:for(Ub=0;Ub<Ia.length;Ub++)if(Da(M,X,Ia[Ub],Ba),0<ud.length){Ha=Ia[Ub];break}break;case 0<Ha&&0===Ba&&0<Ub.length:for(Y=0;Y<Ub.length;Y++)if(Da(M,X,Ub[Y],Ha),0<ud.length){Ba=Ub[Y];break}case 0===Ba&&0===Ha&&0<Ub.length&&0<Ia.length:Y=!1;
for(ja=0;ja<Ub.length;ja++){for(qa=0;qa<Ia.length;qa++)if(Da(M,X,Ub[ja],Ia[qa]),0<ud.length){Ba=Ub[ja];Ha=Ia[qa];Y=!0;break}if(Y)break}break;default:return}0<Ba&&0<Ha&&p(M,X,Ba,Ha)}function U(M,X,Y,ja){var qa,Ba=0,Ha=0;var Ia=qa=0;var Ub=ka(M,X,Y);var gd=ka(M,X,ja);if(0<Ub&&0<gd){for(T=0;T<P[Ub].length;T++)Ba+=M[P[Ub][T]].x,Ha+=M[P[Ub][T]].y;Ba/=P[Ub].length;Ha/=P[Ub].length;var Xa=(M[X[Y].f].x+M[X[Y].g].x)/2;Ub=(M[X[Y].f].y+M[X[Y].g].y)/2;for(T=0;T<P[gd].length;T++)qa+=M[P[gd][T]].x,Ia+=M[P[gd][T]].y;
qa/=P[gd].length;Ia/=P[gd].length;var wd=(M[X[ja].f].x+M[X[ja].g].x)/2;gd=(M[X[ja].f].y+M[X[ja].g].y)/2;Ba-=Xa;Ha-=Ub;qa-=wd;Ia-=gd;gd=Math.sqrt(Ba*Ba+Ha*Ha);Ub=Math.sqrt(qa*qa+Ia*Ia);Ba=$a*Ba/gd;Ha=$a*Ha/gd;qa=$a*qa/Ub;Ia=$a*Ia/Ub;M[X[Y].f].x+=Ba;M[X[Y].f].y+=Ha;M[X[Y].g].x+=Ba;M[X[Y].g].y+=Ha;M[X[ja].f].x+=qa;M[X[ja].f].y+=Ia;M[X[ja].g].x+=qa;M[X[ja].g].y+=Ia}else 0===Ub&&0===gd&&(Ia=ba(F,X[Y].f),Y=ba(F,X[Y].g),qa=ba(F,X[ja].f),ja=ba(F,X[ja].g),Ia===Y&&qa===ja&&(0<F[Ia].m?rg(M,X,Ja(X,F[Ia].m,F[Ia].i[0]),
1,!0):0<F[Ia].J&&rg(M,X,Ja(X,F[Ia].J,F[Ia].i.slice(-1)[0]),1,!0)))}function x(M,X,Y,ja){var qa=new Yc(M[X[ja].g].x-M[X[ja].f].x,M[X[ja].g].y-M[X[ja].f].y);var Ba=new Yc(M[Y].x-M[X[ja].f].x,M[Y].y-M[X[ja].f].y);qa=new Yc(qa.x/uj(qa),qa.y/uj(qa));qa=new Yc(qa.x*(Ba.x*qa.x+Ba.y*qa.y),qa.y*(Ba.x*qa.x+Ba.y*qa.y));var Ha=new Yc(0,0);Ba=new Yc(0,0);Ha.x=M[Y].x-(M[X[ja].f].x+qa.x);Ha.y=M[Y].y-(M[X[ja].f].y+qa.y);Ba.x=Ha.x*Rb/uj(Ha);Ba.y=Ha.y*Rb/uj(Ha);for(qa=0;0<Wd.length&&Wd[0][0]===Y&&Wd[0][1]===ja&&4>
qa;)M[Y].x+=Ba.x,M[Y].y+=Ba.y,Zb(M,X,Rb,0," inside fixAtBondCollisions after atom move"),qa++}function z(M,X,Y){var ja=Sg[Y][0],qa=Sg[Y][1],Ba=Sg[Y][2],Ha,Ia=Y=0,Ub=!1;Fa=[];Me(M,ja,!0);var gd=ka(M,X,Ja(X,ja,qa));var Xa=ka(M,X,Ja(X,ja,Ba));if(0===gd&&0===Xa)Y=qa,Ia=Ba;else if(0===gd&&0<Xa)Y=qa,Ia=Ba;else if(0<gd&&0===Xa)Y=Ba,Ia=qa;else if(0<gd&&0<Xa){for(Ha=0;Ha<kd.length;Ha++)if(kd[Ha][0]===qa&&kd[Ha][1]===Ba||kd[Ha][0]===Ba&&kd[Ha][1]===qa){Ub=!0;break}if(Ub)P[gd].length<P[Xa].length?(Ha=ld(M[qa].x,
M[qa].y,gc(M,gd).x,gc(M,gd).y),I(M,qa,Ha,1.1*Rb)):(Ha=ld(M[Ba].x,M[Ba].y,gc(M,Xa).x,gc(M,Xa).y),I(M,Ba,Ha,1.1*Rb));else for(Ha=0;Ha<M[ja].a.length;Ha++)if(M[ja].a[Ha].p!==qa&&M[ja].a[Ha].p!==Ba){Ha=Ya(M,ja,M[ja].a[Ha].p);I(M,ja,Ha,.3*na);return}}qa=Fa.length-1;for(Ha=Fa.length-1;0<=Ha;Ha--)if(0<xa(Fa[Ha].ba,Fa[Ha].fa))qa--;else if(Fa[Ha].ba===Y||Fa[Ha].fa===Y)qa--;else break;0>qa&&(qa=Fa.length-1);0!=Y&&0!=Ia&&void 0!==Fa[qa]&&(Ia=Ya(M,ja,Y),Ha=Qf(M,ja,Fa[qa].ba,Fa[qa].fa,180<Fa[qa].$?!0:!1),ya(M,
X,ja,Y,Ia,1),ya(M,X,ja,Y,Ha,-1))}function O(M,X,Y){var ja=-1,qa=0;Me(M,Y,!0);180<Fa[Fa.length-1].$&&Qf(M,Y,Fa[Fa.length-1].ba,Fa[Fa.length-1].fa,!0);for(J=0;J<M[Y].a.length;J++){var Ba=Ja(X,Y,M[Y].a[J].p);if(!(0<ka(M,X,Ba))){ja=Ya(M,Y,M[Y].a[J].p);qa=M[Y].a[J].p;break}}-1!==ja&&0<qa&&ya(M,X,Y,qa,180,-1)}function C(M,X,Y,ja){Da(M,X,X[Y].f,X[ja].f);var qa=Hb.slice(0);var Ba=ud.slice(0);Da(M,X,X[Y].g,X[ja].f);Hb.length>qa.length&&(qa=Hb.slice(0),Ba=ud.slice(0));Da(M,X,X[Y].f,X[ja].g);Hb.length>qa.length&&
(qa=Hb.slice(0),Ba=ud.slice(0));Da(M,X,X[Y].g,X[ja].g);Hb.length>qa.length&&(qa=Hb.slice(0),Ba=ud.slice(0));Hb=qa.slice(0);ud=Ba.slice(0);for(J=0;J<ud.length&&(rg(M,X,ud[J],1,!0),la=Zb(M,X,Rb,0," inside fixCrossingBonds: after flipBranch"),0!==nf.length);J++)rg(M,X,ud[J],-1,!0)}function I(M,X,Y,ja){var qa=ja*Math.sin(Math.PI*Y/180);M[X].x+=ja*Math.cos(Math.PI*Y/180);M[X].y=M[X].y-qa}function R(M,X,Y,ja){var qa=na*ja;if(!(void 0===Y||1>Y||Y>X.length)){var Ba=Hb[Math.min(Hb.indexOf(X[Y].f),Hb.indexOf(X[Y].g))];
var Ha=Hb[Math.max(Hb.indexOf(X[Y].f),Hb.indexOf(X[Y].g))];Y=Math.sqrt((M[Ha].x-M[Ba].x)*(M[Ha].x-M[Ba].x)+(M[Ha].y-M[Ba].y)*(M[Ha].y-M[Ba].y));var Ia=Ya(M,Ba,Ha);X=qa*Math.cos(Math.PI*Ia/180);qa=-1*qa*Math.sin(Math.PI*Ia/180);Nh(M,Ha,Ba);Ba=M[lc[1]].x+X;Ha=M[lc[1]].y+qa;Ba=Math.sqrt((M[lc[0]].x-Ba)*(M[lc[0]].x-Ba)+(M[lc[0]].y-Ha)*(M[lc[0]].y-Ha));if(Ba<Y&&0<ja||Ba>Y&&0>ja)X*=-1,qa*=-1;for(ja=1;ja<lc.length;ja++)M[lc[ja]].x+=X,M[lc[ja]].y+=qa}}function ya(M,X,Y,ja,qa,Ba){X=Hb[0];Nh(M,ja,Y);for(ja=
0;ja<M.length;ja++)M[ja].v=0;for(ja=0;ja<lc.length;ja++)M[lc[ja]].v=1;0===qa&&0<X&&(qa=Math.sqrt((M[Y].x-M[X].x)*(M[Y].x-M[X].x)+(M[Y].y-M[X].y)*(M[Y].y-M[X].y)),qa=180*Math.asin(2*$a/qa)/Math.PI);ja=M[Y].x;X=M[Y].y;nj(M,1,-1*ja,-1*X,!1);Oh(M,1,M[Y].x,M[Y].y,Ba*qa,!1);nj(M,1,ja,X,!1);Xc()}function ea(M,X,Y,ja){var qa=P[Y].indexOf(ja);X=new Yc(M[ja].x,M[ja].y);var Ba=new Yc(0,0);new Yc(0,0);-1<qa&&(Y=gc(M,Y),Y=ld(Y.x,Y.y,X.x,X.y),Ba.x=2*$a*Math.cos(Math.PI*Y/180),Ba.y=-2*$a*Math.sin(Math.PI*Y/180),
M[ja].x=X.x+Ba.x,M[ja].y=X.y+Ba.y)}var T=0,v=0,pa=0,Ta=v=0,ma=0,la=0;Ta=-1;la=Zb(d,k,Rb,0," After first checkCollisions");if(0<Sg.length)for(pa=0;0<Sg.length&&6>pa;)z(d,k,0),la=Zb(d,k,Rb,0," after fixLigDirSame"),pa++;if(0!==la&&0<Sh.length)for(pa=0;0<Sh.length&&4>pa;)O(d,k,Sh[0]),la=Zb(d,k,Rb,0,"after fix_parapluie"),pa++;if(0!==la&&0<hg.length)for(pa=0;0<hg.length&&3>pa;)ea(d,k,hg[0][0],hg[0][1]),la=Zb(d,k,Rb,0,"after fix_pRingAngle"),pa++;if(0<Rh.length)for(pa=0;0<Rh.length&&6>=pa;){h(d,k,Rh[0][0],
Rh[0][1]);la=Zb(d,k,Rb,0," after fixIsoRingsColl");if(0===la)return;pa++}if(0<oh.length)for(pa=0;0<oh.length&&6>=pa;){U(d,k,oh[0][0],oh[0][1]);la=Zb(d,k,Rb,0," after fixBondColl");if(0===la)return;pa++}if(0<nf.length)for(pa=0;0<nf.length&&6>pa;){C(d,k,nf[0][0],nf[0][1]);la=Zb(d,k,Rb,0,"after fixCrossingBonds");if(0===la)return;pa++}if(0<Wd.length)for(pa=0;0<Wd.length&&6>pa;){for(T=0;T<Wd.length;T++){p(d,k,Wd[0][0],k[Wd[0][1]].f);la=Zb(d,k,Rb,0,"atBondTooClose after fixAtomAtomCollisonByFlip with fra");
if(0===la)return;if(0===Wd.length)break;else{p(d,k,Wd[0][0],k[Wd[0][1]].g);la=Zb(d,k,Rb,0,"atBondTooClose after fixAtomAtomCollisonByFlip with toa");if(0===la)return;if(0===Wd.length)break}x(d,k,Wd[T][0],Wd[T][1])}la=Zb(d,k,Rb,0," after fixAtBondCollisions by moving atom");pa++}for(pa=0;0<kd.length&&10>=pa;){p(d,k,kd[0][0],kd[0][1]);la=Zb(d,k,Rb,0," after fixAtomAtomCollisonByFlip inside tooClose() while loop");if(0===la)return;if(0<kd.length)if(n(d,k,kd[0][0],kd[0][1]),0<ud.length){if(0===ud.length%
2){Ta=ud[Math.floor(ud.length/2)-1];ma=ud[Math.floor(ud.length/2)];for(v=0;0<kd.length&&6>v;)R(d,k,Ta,$a/na),la=Zb(d,k,Rb,0," after stretch bond1 even number"),v++;if(0===la)return;R(d,k,Ta,-1*(v+1)*$a/na);for(v=0;0<kd.length&&6>v;)R(d,k,ma,$a/na),la=Zb(d,k,Rb,0," after stretch bond2 even number"),v++;if(0===la)return;R(d,k,ma,-1*(v+1)*$a/na);la=Zb(d,k,Rb,0," after stretch bond");if(0===la)return;for(v=0;0<kd.length&&6>v;)R(d,k,Ta,$a/na),R(d,k,ma,$a/na),la=Zb(d,k,Rb,0," after stretch 2bonds even number"),
v++;if(0===la)return;R(d,k,Ta,-1*(v+1)*$a/na);R(d,k,ma,-1*(v+1)*$a/na)}else{Ta=ud[Math.floor(ud.length/2)];for(v=0;0<kd.length&&6>v;)R(d,k,Ta,2*$a/na),la=Zb(d,k,Rb,0," after stretch bond odd number"),v++;if(0===la)return;R(d,k,Ta,-2*(v+1)*$a/na)}for(v=1;v<Hb.length-2;v++)if(ud.includes(Ja(k,Hb[v],Hb[v+1]))){Ta=B(d,Hb[v+1],Hb[v],Hb[v-1]);ya(d,k,Hb[v+1],Hb[v],0,Ta);la=Zb(d,k,Rb,0," after bending bond");if(0===la)return;ya(d,k,Hb[v+1],Hb[v],0,-1*Ta)}}else 0<kd.length&&-1!==ba(F,kd[0][0])&&1===F[ba(F,
kd[0][0])].i.length?ya(d,k,F[ba(F,kd[0][0])].m,kd[0][0],30,1):0<kd.length&&-1!==ba(F,kd[0][1])&&1===F[ba(F,kd[0][1])].i.length&&ya(d,k,F[ba(F,kd[0][1])].m,kd[0][1],30,1);pa++}la=Zb(d,k,Rb,0," after while loop");0!==la&&0<hg.length&&(ea(d,k,hg[0][0],hg[0][1]),la=Zb(d,k,Rb,0," after while loop: after fix_pRingAngle"));0!==la&&la!=nf.length&&0!=kd.length&&(n(d,k,kd[0][0],kd[0][1]),1<Hb.length&&(Ta=Ja(k,Hb[0],Hb[1]),R(d,k,Ta,-2*$a/na),la=Zb(d,k,Rb,0," after while loop: after stretchBond")));if(0!==la&&
la===nf.length)for(pa=0;0<nf.length&&6>pa;)C(d,k,nf[0][0],nf[0][1]),la=Zb(d,k,Rb,0," after while loop: after fixCrossingBonds"),pa++;0!==la&&la===Wd.length&&(x(d,k,Wd[0][0],Wd[0][1]),la=Zb(d,k,Rb,0," after while loop: after fixAtBondCollisions"))})(Q,Ka);if(1<P.length)for(J=1;J<P.length;J++)Tl=gc(Q,J),Ek[J]=Tl;for(J=1;J<Q.length;J++)if(void 0===Ed[J]||0===Af[Q[J].j]||1===Q[J].j)/\[\d{0,1}H\]/.test(Ed[J])&&2===Q.length&&(Q[J].r=!0);else{Aj=0;rh=[];rh=Ed[J].match(Pl);if(null!==rh)"H"===rh[4]&&(Aj=""!==
rh[5]?parseInt(rh[5],10):1);else if("[H]"===Ed[J])Aj=1;else continue;for(Fb=Vf=Gk=Wg=0;Fb<Q[J].a.length;Fb++)Vf=4===Q[J].a[Fb].t||5===Q[J].a[Fb].t?Vf+1:Vf+Q[J].a[Fb].t,1===Q[Q[J].a[Fb].p].j&&Gk++;Vf+=Aj-Gk;Vf+=Q[J].D+Q[J].F;Wg=Af[Q[J].j]+Q[J].s-Vf;1===Math.abs(Wg)%2&&10<Q[J].j?(Q[J].r=!0,(17===Q[J].j||35===Q[J].j||53===Q[J].j)&&1<Vf&&0===Q[J].s&&(Q[J].r=!1)):1===Math.abs(Wg)%2&&0<Wg?Q[J].r=!0:2===Wg&&0===Q[J].s?(6===Q[J].j&&(Q[J].o="C:"),7===Q[J].j&&(Q[J].o="N:")):2===Wg&&1===Vf-Q[J].s?7===Q[J].j&&
(Q[J].o="N:"):"[N]"===Ed[J]&&0===Math.abs(Wg)%2&&7===Q[J].j&&0===Q[J].s&&3===Vf&&(Q[J].r=!0);zg.includes(rh[2])&&0!==Af[Q[J].j]&&Af[Q[J].j]===Vf&&(Q[J].r=!0)}if(0<kc.length){for(J=0;J<kc.length;J++)2===Ie(Q,Ka,kc[J])&&(Rg.push(kc[J]),kc.splice(J,1),J--);0<kc.length&&vg(Q,Ka);if(0<Rg.length)for(J=0;J<Rg.length;J++)eg(Q,Ka,Rg[J])}for(J=1;J<Q.length;J++)Mf(Q,J)}}function Bd(W){this.ia=W.slice(0);this.eb=[];this.Qa=[];this.Va=this.pa=this.path=0}function Sb(W,E){this.tb=W;this.Ra=E}var Rb=2*$a,Lc=0,tb=
0,mc=new zd(0,0,0,0),Za=0,Lb=0,tc=0,Ad=0;mc=0;var Dc=!1,Yb=0,ad=0,pc=[],oa={},te={};Ad=[];var jh=[],Wb=[],Id=[],Ke=[[0]],S={},qc=[],Qb=[],we=[],ic={},fb=[],Ji=[],ee=[],Qg=[],wg=!1,Rc=0,vc=0,Df=[];tb=[];tb=[];var fe=-1,Db={};Yb=Rc=0;new Yc(0,0);var De=[],gb=[],Cd=[],Dd="";Za=-1;vc="";var Ed=[],bd=[new Ce(0,0,0)],xg="";pc=-1;Df="";var P=[[0]],fg=[];Yb=-1;tc="";var kc=[],Rg=[],mh=Dc=mc=0,lf=[];tb=[];tb=[];var ue=0,Wc=[],jf=0;tb=0;tb=[];if(""!==a)if(ed(),tb=a.match(/!(.+)!/),null!==tb?(Df=tb[1],pc=tb.index):
a.includes("!")&&(Dd="unmatched ! (lone pairs section)"),tb=[],tb=a.match(/\u00bf(.+)\u00bf/),null!==tb?(vc=tb[1],Za=tb.index):a.includes("\u00bf")&&(Dd="unmatched \u00bf (curved arrows section)"),tb=[],tb=a.match(/\u00a7(.+)\u00a7/),null!==tb?(tc=tb[1],Yb=tb.index):a.includes("\u00a7")&&(Dd="unmatched \u00a7 (reaction arrows section)"),""!==Dd)alert("Parse-SMILES Error:\n"+Dd+"\nin SMILES: "+a);else{-1<Za?a=a.substring(0,Za):-1<pc?a=a.substring(0,pc):-1<Yb&&(a=a.substring(0,Yb));if(/^\./.test(a)||
/\.$/.test(a)||/\.\./.test(a))Dd="illegal dot at start and/or end or multiple dots";/^\d/.test(a)&&(Dd="illegal digit at start");if(""!==Dd)alert("Parse-SMILES Error:\n"+Dd+"\nin SMILES: "+a);else{tb=a.split(".");pc=[];if(1<g.length){Rc=g.length-1;rf=El();for(Za=1;Za<=rf;Za++)mc=Fd(g,Za,"t"),pc.push(mc);Yb=rf;0<Pa.length&&(ua(),me=[],gf=[],md=[]);0<sa.length?(ue=0,Qc=[],e(sa),ue=sa.length):ue=0}else ue=Yb=0;""!==tc&&La(tc,Yb);Za=0;for(Yb=1+Yb;Za<tb.length&&""!==tb[Za];){1===Ll(tb[Za])?Dd="unbalanced ()":
-1===Ll(tb[Za])&&(Dd="unbalanced []");if(""!==Dd){alert("Parse-SMILES Error:\n"+Dd+"\nin SMILES: "+tb[Za]);zb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt";return}Vb(tb[Za]);""!=xg&&(Dd=""===Dd?xg:Dd+("\n"+xg));if(""!==Dd){alert("Parse-SMILES Error:\n"+Dd+"\nin SMILES: '"+tb[Za]+"'");Dl();return}for(tc=1;tc<Q.length;tc++)Q[tc].v=Yb,Q[tc].t=Yb;for(tc=1;tc<Ka.length;tc++)Ka[tc].v=Yb;mc=0;Dc=!1;if(1!==Q[1].j)for(tc=1;tc<Q.length;tc++)1===Q[tc].j&&
mc++;else for(Dc=!0,tc=1;tc<Q.length;)1!==Q[tc].j&&(Dc=!1),tc++;jh.push(mc);zm(Q,Ka,g,aa,Yb,0,0);Ji.push(g.length-1);if(Dc)Ad.push(g.length-1);else{for(tc=g.length-1;0<tc&&1===g[tc].j;)tc--;Ad.push(tc)}mc=Fd(g,Yb,"s");Ai(g,ra.b+ra.c/2-(mc.b+mc.c/2),ra.t+ra.h/2-(mc.t+mc.h/2),Yb);mc.b=0;mc.t=0;pc.push(mc);Yb++;Za++}rf=Yb-1;Za=tb=0;for(tc=Lb=1;Za<rf;){for(;tc<=Ad[Za];)te[Lb]=Lb+tb,Lb++,tc++;tb+=jh[Za];Za<rf-1&&(tc=Ji[Za]+1);Za++}if(0<fg.length)for(e(fg),Lb=0;Lb<fg.length;)lj(fg,sa,Lb,Lb+ue),Lb++;""!==
Df&&fa(Df,Rc);""!==vc&&(Na(vc,Rc),0<Pa.length&&ua());(function(){var W,E=[];gf=[];for(W=0;W<me.length;W++){E.push(me[W].jb,me[W].Ma);Mh(g,me[W].kb,me[W].lb,me[W].Ma);if(""!==me[W].fb){var ba,Da;for(Da=0;Da<g.length;Da++)g[Da].v=0;var Ra=1;for(ba=0;0<Ra;){Ra=0;for(Da=1;Da<g.length;Da++)if(0===g[Da].v){Ra=Da;break}if(0===Ra)break;lc=[];var yb=Hh(g,Ra);for(Da=0;Da<yb;Da++)g[lc[Da]].v=ba;ba++}ze=!0;fh(g,aa,me[W].fb,me[W].Ma);Xc()}gf.push([me[W].jb,me[W].Ma])}for(W=1;W<=rf;W++)E.includes(W)||(gf.push([W]),
E.push(W))})();mj();(function(){var W,E=ra.b+ra.c/2,ba=ra.t+ra.h/2;for(W=0;W<gf.length;W++)Ua(W,E-(md[W].b+md[W].c/2),ba-(md[W].t+md[W].h/2))})();if(0<sa.length){D(Qc);l($a);f();sk=t();mj();for(Za=0;Za<fb.length;Za++){tb=A(Za);for(Lb=0;Lb<tb.length;Lb++)wg=!0,3!==sa[tb[Lb]].ca&&(wg=!1);if(wg){tb=[];for(Lb=0;Lb<fb[Za].path.length;Lb++)tb.push(Qc[fb[Za].path[Lb]].ia[0]),Ea(Qc[fb[Za].path[Lb]].ia[0]);Rc=tb[0];for(Lb=1;Lb<tb.length;Lb++)if(vc=tb[Lb],Df=Db[vc].La.slice(0),Df.reverse(),!(tg(Db[Rc].La,Db[vc].La)&&
10>Math.abs(Db[Rc].Ka-Db[vc].Ka)))if(tg(Db[Rc].La,Df)&&10>Math.abs(Db[Rc].Ka-Db[vc].Ka)){for(Ad=1;Ad<g.length;Ad++)g[Ad].v=g[Ad].t===vc?999:0;ze=!0;Oh(g,999,Db[vc].Ea.x,Db[vc].Ea.y,180,!1);Ea(vc);Db[Rc].da.x!=Db[vc].da.x&&(fh(g,aa,"x",999),Ea(vc),Xc())}else{for(Ad=1;Ad<g.length;Ad++)g[Ad].v=g[Ad].t===vc?999:0;ze=!0;mc=Math.abs(Db[Rc].da.x-Db[vc].da.x)+Math.abs(Db[Rc].da.y-Db[vc].da.y)+Math.abs(Db[Rc].ha.x-Db[vc].ha.x)+Math.abs(Db[Rc].ha.y-Db[vc].ha.y);jf=0;Dc=1E6;for(Ad=mh=0;16>Ad;Ad++)Oh(g,999,Db[vc].Ea.x,
Db[vc].Ea.y,15,!1),jf+=15,Ea(vc),mc=Math.abs(Db[Rc].da.x-Db[vc].da.x)+Math.abs(Db[Rc].da.y-Db[vc].da.y)+Math.abs(Db[Rc].ha.x-Db[vc].ha.x)+Math.abs(Db[Rc].ha.y-Db[vc].ha.y),mc<Dc&&(Dc=mc,mh=jf);10>Dc?Oh(g,999,Db[vc].Ea.x,Db[vc].Ea.y,mh-jf,!1):(fh(g,aa,"y",999),Ea(vc),mc=Math.abs(Db[Rc].da.x-Db[vc].da.x)+Math.abs(Db[Rc].da.y-Db[vc].da.y)+Math.abs(Db[Rc].ha.x-Db[vc].ha.x)+Math.abs(Db[Rc].ha.y-Db[vc].ha.y),10<mc&&(fh(g,aa,"y",999),fh(g,aa,"x",999)));Ea(vc);mc=Math.abs(Db[Rc].da.x-Db[vc].da.x)+Math.abs(Db[Rc].da.y-
Db[vc].da.y)+Math.abs(Db[Rc].ha.x-Db[vc].ha.x)+Math.abs(Db[Rc].ha.y-Db[vc].ha.y)}}}pk();wa();mj();for(Za=0;Za<sa.length;Za++){for(Lb=0;Lb<Qc.length;Lb++)tj(Qc[Lb].ia,sa[Za].M)&&(ad=Lb),tj(Qc[Lb].ia,sa[Za].L)&&(Lc=Lb);re=[];Yj(sa[Za].M,sa[Za].L,sb[ad],sb[Lc]);sa[Za].W.x=re[0];sa[Za].W.y=re[1];sa[Za].V.x=re[2];sa[Za].V.y=re[3]}for(Za=tb=0;Za<sb.length;Za++)tb=Math.max(tb,sb[Za].t+sb[Za].h);c(tb)}else b();xl();if(0<Kc.length){dg(Kc);wb(Ga,0,!0);for(Za=0;Za<Kc.length;Za++)vi(V,g,Kc[Za]);alert("WARNING:\nParsing of SMILES failed at one or more \nambiguous or inconsistent stereogenic centres!\n\nStereo up/down bonds at centers marked by red squares were replaced by normal single bonds.\n\nThe red squares disappear with the next drawing action");
Kc=[]}else if(bk(),Ld=Ld.trim(),a=a.trim(),Ld.includes(a))wb(Ga,0,!0),zb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt",ed(),Kb();else if(0<Kc.length){dg(Kc);wb(Ga,0,!0);for(Za=0;Za<Kc.length;Za++)vi(V,g,Kc[Za]);alert("WARNING:\nParsing of SMILES produced one or more \nambiguous or inconsistent stereogenic centres!\n\nCheck the stereo-drawing of the centers marked by red squares.\n\nThe red squares disappear with the next drawing action");zb=0;
document.getElementById("shift").className="shift";document.getElementById("alt").className="alt";Kc=[]}else wb(Ga,0,!0),zb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt",alert("Parsing failed!\nentered SMILES:\n"+a+"\n"+Ld+"\nSMILES of parsed structure"),ed(),Kb();tb=[];zb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt"}}}var Uh="yes"===$b?!0:!1,na=da?45:30,L=Math.floor(6+8/30*(na-15)),si=5+(na-
15)/5,$a=na/5,ek=da?va?na/2:2*$a:$a+4,Jc=da?2*$a:$a+4,fl=na/10,Yk=na/10,zi=na/5,Xi=da?va?na/3:2*zi:zi+2,cl=.86603*na,yi=Math.round(150*na/24)/100,vl=6*yi,Ee=30<na?2:1.5,fk=" c;h;o;n;s;p;f;C;b;i;x;.;+;-".split(";"),sm=" ;;e;r; ; ; ;v; ; ; ; ;Y;y".split(";"),gk="1;2;t;u or <;d or >;3;4;5;6;a;7-9;w;m;l".split(";"),li="C H O N S P F Cl Br I X \u2022 + \u2013".split(" "),rm=/^Ac|Ag|Al|Am|Ar|As|At|Au|Ba|Be|Bh|Bi|Bk|Br|Ca|Cd|Ce|Cf|Cl|Cm|Co|Cr|Cs|Cu|D|Db|Ds|Dy|Er|Es|Eu|Fe|Fm|Fr|Ga|Gd|Ge|He|Hf|Hg|Ho|Hs|In|Ir|K|Kr|La|Li|Lr|Lu|Md|Mg|Mn|Mo|Mt|Na|Nb|Nd|Ne|Ni|No|Np|Os|Pa|Pb|Pd|Pm|Po|Pr|Pt|Pu|Ra|Rb|Re|Rf|Rg|Rh|Rn|Ru|Sb|Sc|Se|Sg|Si|Sm|Sn|Sr|T|Ta|Tb|Tc|Te|Th|Ti|Tl|Tm|Xe|Yb|Zn|Zr|B|C|F|H|I|N|O|P|S|U|V|W|Y$/g,
xm=/^R[1234]?$/g,qe=["R","R1","R2","R3","R4"],dk=["C:","N:"],Og="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu".split(" "),Af=[0,1,0,0,0,3,4,3,2,1,0,0,0,3,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,3,2,1,0,1,2,0,0,0,0,0,0,0,0,1,2,3,4,3,2,1,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ym=["B","Al"],Ol=[1,2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,
653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217],kh="B C N O P S F Cl Br I Si".split(" "),Hm="B C N O P S As Se".split(" "),zg="b c n o p s as se".split(" "),Gm="C:4:0:0 C:3:1:0 Si:4:0:0 Si:3:1:0 Ge:4:0:0 Ge:3:1:0 Sn:4:0:0 Sn:3:1:0 N:4:0:1 P:4:0:1 B:4:0:-1 B:3:1:-1 P:4:0:0 As:4:0:1 N:3:0:az P:3:0:0 As:3:0:0 P:2:1:0 As:2:1:0 S:4:0:0 S:4:0:1 S:3:0:0 S:3:0:1 Se:4:0:0 Se:4:0:1 Se:3:0:0 Se:3:0:1".split(" "),
Am="N:3:0:az P:3:0:0 P:2:1:0 As:3:0:0 As:2:1:0 S:3:0:0 S:3:0:1 Se:3:0:0 Se:3:0:1".split(" "),zf=0,Ze=1,oe=1,lk=new Image,mk=new Image,nk=new Image,Nc=new zd(10,42,34,503),hc=new zd(38,38,532,36),sc=new zd(10,549,136,36),Kf=new zd(10,0,10,10),za=new zd(48,0,10,10),ra=new zd(0,0,10,10),dd=new zd(0,0,0,0),H=new zd(0,0,0,0),af=new zd(0,0,0,0),jl=new zd(0,0,0,0),kl=new zd(0,0,0,0),Gd={x:0,y:0,r:12},ye={x:0,y:0,r:12},vm=new kb(0,"",0,0,0,0,0),g=[new kb(0,"",0,0,0,0,0)],Q=[new kb(0,"",0,0,0,0,0)],ag=[new kb(0,
"",0,0,0,0,0)],df=[new kb(0,"",0,0,0,0,0)],Bc=[new kb(0,"",0,0,0,0,0)],wm=new Ce(0,0,0),aa=[new Ce(0,0,0)],Ka=[new Ce(0,0,0)],Bi=[new Ce(0,0,0)],ef=[new Ce(0,0,0)],Pa=[],oc=[],sk=[],me=[],$f="",vd=[new rk(0,0)],Aa=[],gf=[],Qc=[],ih=[],ff=[],sa=[],Kh=[],qb=[],Je=[],Pg={},bg=[],hf=[],Ye=[],sd=[],md=[],sb=[],cf=[],cg=[],Cc={},Fe=[],rd=[],se=[],Hd=[],cb=[],wi=[],Fa=[],Lg=[],Uc=[],nc=[],lc=[],Kc=[],He=0,be="X",Xb=0,ti="",Tj="",zb=0,rf=0,Ci=0,Ve=0,hi=0,Zd=0,Be=0,ah=0,bh=0,og=0,ai=-1,sf=0,Zg=0,Wi=-1,he=
0,ie=0,Vj=0,ej=-1,ml=0,nl=0,je=0,fi=0,ke=0,gi=0,hb=0,bb=0,dc=0,ec=0,pe=0,Hg=-1,$h=-1,Gg=0,zc=0,yc=0,mb=0,pg=-1,eh=-1,ae=0,Vc=0,Zc=0,Kg=-1,Gc=0,Hc=0,bj="",cj=1,Rj=0,Sj=0,Ah=0,aj=0,ch=0,dh=0,Od=0,Pd=0,ii=0,ji=0,vb="",Ki=1,nh=1,Yh=!1,re=[],Zf="reactant",Ld="",Ch=1,Md,Nd,bi=!1,dj=!1,ci=!1,$e=!1,zh=!1,yh=!1,gj=!1,fj=!1,Kd=!0,Lh=!1,lg=!1,$d=!1,Ig=!1,Zh=!1,Vi=!1,hk=!1,ei=!1,Zi=!1,$i=!1,di=!1,Bh=!1,Vh=!1,ze=!1,Qj=!1,Eg=!1,Xh=!1,Ng=!1,ni=!1,ng=!1,uf=!1,tf=!0,vf=!1,Ge=!1,qg=!1,Lf=!1,bf=!1,xf=!1;var em=document.getElementById("container");
var Tc=document.getElementById("bgc");var Se=document.getElementById("igc");var Te=document.getElementById("pdc");var cc=document.getElementById("can");var Ue=document.getElementById("sho");var kk=Tc.getContext("2d");var V=Se.getContext("2d");var Ac=Te.getContext("2d");var Ga=cc.getContext("2d");var jd=Ue.getContext("2d");Ga.setLineDash||(hk=!0);kk.save();V.save();Ac.save();Ga.save();jd.save();var Jf=document.getElementById("buttonregion");Jf.style.position="absolute";var Sm=document.getElementById("shift");
var Tm=document.getElementById("alt");var mg=Ga.getImageData(0,0,1,1);var Ih=document.getElementById("xbox");var km=document.getElementById("xok");var Of=document.getElementById("xtxa");var gh=document.getElementById("abox");var Jh=document.getElementById("atxa");var ui=document.getElementById("btxa");var sl=document.getElementById("aok");var Yf=document.getElementById("smilesbox");var lm=document.getElementById("smilesok");var ce=document.getElementById("smitxa");Vh=!1;var Xf=document.getElementById("smixbox");
var yf=document.getElementById("smixtxa");var pm=document.getElementById("smixcancel");var om=document.getElementById("smixadd");var qm=document.getElementById("smixok");Rk();Bl();window.addEventListener("focus",function(){zb=0});window.addEventListener("blur",function(){zb=0});pd();da&&window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){setTimeout(yd,500);setTimeout(yd,100);setTimeout(function(){window.scrollTo(0,0)},500)},!1);(function(){var a,b;return cm(new bm(new Yl(function(c){if(1==
c.aa)return a=[],a.push(new Promise(function(e){lk.onload=function(){e()};lk.src="elebar.svg"})),a.push(new Promise(function(e){mk.onload=function(){e()};mk.src="toolbar.svg"})),Uh&&a.push(new Promise(function(e){nk.onload=function(){e()};nk.src="lewis_rxnarrows.svg"})),Xl(c,Promise.all(a));yd();Tc.style.visibility="visible";Se.style.visibility="visible";Te.style.visibility="visible";cc.style.visibility="visible";Ue.style.visibility="hidden";da&&(Sm.style.visibility="visible",Tm.style.visibility=
"visible");b=document.getElementsByClassName("but");od(100).then(function(){for(zf=0;zf<b.length;zf++)b[zf].style.visibility="visible"});c.aa=0})))})();Sa&&!va&&setTimeout(yd,500);document.getElementById("buttonregion").addEventListener("mouseup",function(a){a||(a=window.event);a.preventDefault();a.stopPropagation();return!1},!1);document.getElementById("undo").addEventListener("click",function(){if("visible"===Yf.style.visibility)return!1;Xc();Oj();document.getElementById("undo").blur()},!1);document.getElementById("clear").addEventListener("click",
function(){if("visible"===Yf.style.visibility)return!1;Ga.clearRect(za.b+1,za.t+1,za.c-2,za.h-2);Xc();Ui();td(0);qd(0);be="X";document.getElementById("clear").blur()},!1);document.getElementById("smiles").addEventListener("click",function(){if("visible"===Yf.style.visibility)return!1;Xc();Sk();document.getElementById("smiles").blur()},!1);document.getElementById("sm2str").addEventListener("click",function(){if("visible"===Xf.style.visibility)return!1;nm();document.getElementById("sm2str").blur()},
!1);document.getElementById("help").addEventListener("click",function(){var a=window.screenX;Fc=window.open("help/MOSFECCS_Help.html","Structural Formula Editor Help","dependent=yes,scrollbars=yes,resizable=yes");Fc.resizeTo(900,900);Fc.moveTo(a-Fc.outerWidth-5,20);document.getElementById("help").blur()},!1);document.getElementById("shift").addEventListener("click",function(){10>zb?(zb+=10,document.getElementById("shift").className="shift selected"):(zb-=10,document.getElementById("shift").className=
"shift")},!1);document.getElementById("alt").addEventListener("click",function(){0===zb%2?(zb+=1,document.getElementById("alt").className="alt selected"):(--zb,document.getElementById("alt").className="alt")},!1)};

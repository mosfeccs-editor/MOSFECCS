<!-- START MOSFECCS_SVG FRAME -->
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, user-scalable=no" />
    
    <title>MOSFECCS_v6_240305(build 240305.1)</title>

<!-- script1 -->
    <script type="text/javascript">
           "use strict";
//GLOBAL
      var helpWindow;
      // call of the drawCanvas function upon page-load 
      if(window.addEventListener){
        window.addEventListener("unload", closeHelp, false);
      }

      function closeHelp() {
        if ((helpWindow) && (!helpWindow.closed)) {
          helpWindow.close();
        }
      }

      var svgWindow;
      // call of the drawCanvas function upon page-load 
      if(window.addEventListener){
        window.addEventListener("unload", closeSVG, false);
      }

      function closeSVG() {
        if ((svgWindow) && (!svgWindow.closed)) {
          svgWindow.close();
        }
      }
      
//parameter dependent style sheet and variable pad
      function getUrlParam(parameter, defaultvalue){
          var urlparameter = defaultvalue;
          if(window.location.href.indexOf(parameter) > -1) {
              urlparameter = getUrlVars()[parameter];
          }
          return urlparameter;
      }
      
      function getUrlVars() {
          var vars = {};
          window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
              vars[key] = value;
          });
          return vars;
      }

      var device = getUrlParam('device','std');
      
      var arrows = getUrlParam('arrows','yes');

      var pad = false;
      
      var fileref=document.createElement("link");
      
      fileref.setAttribute("rel", "stylesheet");
      fileref.setAttribute("type", "text/css");
      fileref.setAttribute("media", "screen");
      if (device === 'std') {
        fileref.setAttribute("href", "std_min_rs.css");
//         fileref.setAttribute("href", "std_min_rs.css");
        pad = (screen.width > 1390)? false:true; // for automatic tablet recognition
      } else if (device === 'tablet') {
        pad = true;
        fileref.setAttribute("href", "tablet_min_rs.css");
//         fileref.setAttribute("href", "tablet_min_rs.css");
      } else if (device === 'desktop') {
        fileref.setAttribute("href", "desktop_min_rs.css");
//         fileref.setAttribute("href", "desktop_min_rs.css");
        pad = false;
      }        

      if (typeof fileref!="undefined") {
          document.getElementsByTagName("head")[0].appendChild(fileref);
      }
      
      const uag = navigator.userAgent;
      var app = false;
      if (/ethmoodle|MoodleMobile/.test(uag)) {
        app = true;
      }
      
      const phone = (Math.min(screen.width,screen.height) < 760)? true:false;

//       alert("phone="+phone+" pad="+pad+"\nuag="+uag+" app="+app);
      
      if (phone && !app) {
          document.querySelector("meta[name=viewport]").setAttribute(
          'content', 
          'width=device-width, initial-scale=0.6, minimum-scale=0.6, maximum-scale=0.6, user-scalable=0');
      }

    </script>
<!-- end script1 -->
  </head>
  
  <body id="body" onunload="closeHelp()">
    <div id="container">
      <canvas id="bgc" height="640" width="590" class="canright" style="background-color:white">
        Ihr Browser kann diese Graphik nicht darstellen
      </canvas>
      <canvas id="sho" height="640" width="590" class="canright" style="background-color:transparent">
        Ihr Browser kann diese Graphik nicht darstellen
      </canvas>
      <canvas id="pdc" height="640" width="590" class="canright" style="background-color:transparent">
        Ihr Browser kann diese Graphik nicht darstellen
      </canvas>
      <canvas id="igc" height="640" width="590" class="canright" style="background-color:transparent">
        Ihr Browser kann diese Graphik nicht darstellen
      </canvas>
      <canvas id="can" height="640" width="590" class="canright" style="background-color:transparent">
        Ihr Browser kann diese Graphik nicht darstellen
      </canvas>
      <div id="buttonregion" class="butreg">
        <div id="butr1" class="butrow" display="inline-block">
          <input type="button" id="clear" class="but" value="ERASE ALL" style="visibility:hidden">
          <input type="button" id="undo" class="but" value="UNDO" style="visibility:hidden">
          <input type="button" id="smiles" class="but" value="get SMILES" style="visibility:hidden">
          <input type="button" id="sm2str" class="but" value="put SMILES" style="visibility:hidden">
          <input type="button" id="help" class="but" value="HELP" style="visibility:hidden">
          <img id="shift" src="shift.png" class="shift" width="35" height="35"/>
          <img id="alt" src="alt.png" class="alt" width="35" height="35"/>
        </div>
      </div>
      <div id="smilesbox">
        <span id="smhead">SMILES code:</span><br /><br />
        <textarea id='smitxa' cols='42' rows='2' readonly>smiles</textarea><br /><br />
        <button type='submit' id='smilesok'>Close</button>
      </div>
      <div id="xbox">
        <span id="xheader">ENTER ELEMENT SYMBOL:</span><br /><br />
        <input type='text' name='xtxt' id='xtxa' placeholder=''><br /><br />
        <button type='submit' id='xok'>OK</button>
      </div>
      <div id="abox">
        <span id="aheader">Annotate Reaction:</span><br /><br />
        above:<input type='text' name='atxt' id='atxa'><br /><br />
        below:<input type='text' name='btxt' id='btxa'><br /><br />
        <button type='submit' id='aok'>OK</button>
      </div>
      <div id="smixbox">
        <span id="smixheader">ENTER SMILES CODE</span><br /><br />
        <input type='text' name='smixtxt' id='smixtxa'><br /><br />
        <div class='smixbutrow'>
          <input type='button' id='smixcancel' class='smixbut' value='Cancel'>
          <input type='button' id='smixadd' class='smixbut' value='ADD'>
          <button type='submit' id='smixok' class='smixbut'>REPLACE</button>
        </div>
      </div>
    </div>
    
<!-- END MOSFECCS_SVG FRAME -->    
<!-- START INTERACTIVE -->
    <!-- script2 -->
    <script type="text/javascript">

//START CODE TO COMPILE
function Kf(da){var ua=0;return function(){return ua<da.length?{done:!1,value:da[ua++]}:{done:!0}}}function mg(da){var ua="undefined"!=typeof Symbol&&Symbol.iterator&&da[Symbol.iterator];return ua?ua.call(da):{next:Kf(da)}}function Uh(da){da=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,da];for(var ua=0;ua<da.length;++ua){var Ra=da[ua];if(Ra&&Ra.Math==Math)return Ra}return globalThis}
var Ej=Uh(this),Fj="function"==typeof Object.defineProperties?Object.defineProperty:function(da,ua,Ra){da!=Array.prototype&&da!=Object.prototype&&(da[ua]=Ra.value)};function Gj(da,ua){if(ua){var Ra=Ej;da=da.split(".");for(var $b=0;$b<da.length-1;$b++){var Ec=da[$b];Ec in Ra||(Ra[Ec]={});Ra=Ra[Ec]}da=da[da.length-1];$b=Ra[da];ua=ua($b);ua!=$b&&null!=ua&&Fj(Ra,da,{configurable:!0,writable:!0,value:ua})}}
Gj("Promise",function(da){function ua(pb){this.aa=0;this.Ba=void 0;this.A=[];var wc=this.ka();try{pb(wc.resolve,wc.reject)}catch(od){wc.reject(od)}}function Ra(){this.A=null}function $b(pb){return pb instanceof ua?pb:new ua(function(wc){wc(pb)})}if(da)return da;Ra.prototype.aa=function(pb){if(null==this.A){this.A=[];var wc=this;this.ka(function(){wc.Ba()})}this.A.push(pb)};var Ec=Ej.setTimeout;Ra.prototype.ka=function(pb){Ec(pb,0)};Ra.prototype.Ba=function(){for(;this.A&&this.A.length;){var pb=this.A;
this.A=[];for(var wc=0;wc<pb.length;++wc){var od=pb[wc];pb[wc]=null;try{od()}catch(xd){this.va(xd)}}}this.A=null};Ra.prototype.va=function(pb){this.ka(function(){throw pb;})};ua.prototype.ka=function(){function pb(xd){return function(Se){od||(od=!0,xd.call(wc,Se))}}var wc=this,od=!1;return{resolve:pb(this.nb),reject:pb(this.va)}};ua.prototype.nb=function(pb){if(pb===this)this.va(new TypeError("A Promise cannot resolve to itself"));else if(pb instanceof ua)this.ob(pb);else{a:switch(typeof pb){case "object":var wc=
null!=pb;break a;case "function":wc=!0;break a;default:wc=!1}wc?this.mb(pb):this.Na(pb)}};ua.prototype.mb=function(pb){var wc=void 0;try{wc=pb.then}catch(od){this.va(od);return}"function"==typeof wc?this.pb(wc,pb):this.Na(pb)};ua.prototype.va=function(pb){this.Oa(2,pb)};ua.prototype.Na=function(pb){this.Oa(1,pb)};ua.prototype.Oa=function(pb,wc){if(0!=this.aa)throw Error("Cannot settle("+pb+", "+wc+"): Promise already settled in state"+this.aa);this.aa=pb;this.Ba=wc;this.vb()};ua.prototype.vb=function(){if(null!=
this.A){for(var pb=0;pb<this.A.length;++pb)pd.aa(this.A[pb]);this.A=null}};var pd=new Ra;ua.prototype.ob=function(pb){var wc=this.ka();pb.Pa(wc.resolve,wc.reject)};ua.prototype.pb=function(pb,wc){var od=this.ka();try{pb.call(wc,od.resolve,od.reject)}catch(xd){od.reject(xd)}};ua.prototype.then=function(pb,wc){function od(qf,Xf){return"function"==typeof qf?function(xh){try{xd(qf(xh))}catch(yh){Se(yh)}}:Xf}var xd,Se,zh=new ua(function(qf,Xf){xd=qf;Se=Xf});this.Pa(od(pb,xd),od(wc,Se));return zh};ua.prototype.catch=
function(pb){return this.then(void 0,pb)};ua.prototype.Pa=function(pb,wc){function od(){switch(xd.aa){case 1:pb(xd.Ba);break;case 2:wc(xd.Ba);break;default:throw Error("Unexpected state: "+xd.aa);}}var xd=this;null==this.A?pd.aa(od):this.A.push(od)};ua.resolve=$b;ua.reject=function(pb){return new ua(function(wc,od){od(pb)})};ua.race=function(pb){return new ua(function(wc,od){for(var xd=mg(pb),Se=xd.next();!Se.done;Se=xd.next())$b(Se.value).Pa(wc,od)})};ua.all=function(pb){var wc=mg(pb),od=wc.next();
return od.done?$b([]):new ua(function(xd,Se){function zh(xh){return function(yh){qf[xh]=yh;Xf--;0==Xf&&xd(qf)}}var qf=[],Xf=0;do qf.push(void 0),Xf++,$b(od.value).Pa(zh(qf.length-1),Se),od=wc.next();while(!od.done)})};return ua});function Hj(){Hj=function(){};Ej.Symbol||(Ej.Symbol=Ij)}function Jj(da,ua){this.A=da;Fj(this,"description",{configurable:!0,writable:!0,value:ua})}Jj.prototype.toString=function(){return this.A};
var Ij=function(){function da(Ra){if(this instanceof da)throw new TypeError("Symbol is not a constructor");return new Jj("jscomp_symbol_"+(Ra||"")+"_"+ua++,Ra)}var ua=0;return da}();function Lk(){Hj();var da=Ej.Symbol.iterator;da||(da=Ej.Symbol.iterator=Ej.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[da]&&Fj(Array.prototype,da,{configurable:!0,writable:!0,value:function(){return Mk(Kf(this))}});Lk=function(){}}
function Mk(da){Lk();da={next:da};da[Ej.Symbol.iterator]=function(){return this};return da}function Nk(){this.va=!1;this.A=null;this.Oa=void 0;this.aa=1;this.Na=0;this.ka=null}function Ok(da){if(da.va)throw new TypeError("Generator is already running");da.va=!0}Nk.prototype.Ba=function(da){this.Oa=da};function Pk(da,ua){da.ka={qb:ua,rb:!0};da.aa=da.Na}Nk.prototype.return=function(da){this.ka={return:da};this.aa=this.Na};function am(da,ua){da.aa=2;return{value:ua}}
function bm(da){this.A=new Nk;this.aa=da}function cm(da,ua){Ok(da.A);var Ra=da.A.A;if(Ra)return dm(da,"return"in Ra?Ra["return"]:function($b){return{value:$b,done:!0}},ua,da.A.return);da.A.return(ua);return em(da)}function dm(da,ua,Ra,$b){try{var Ec=ua.call(da.A.A,Ra);if(!(Ec instanceof Object))throw new TypeError("Iterator result "+Ec+" is not an object");if(!Ec.done)return da.A.va=!1,Ec;var pd=Ec.value}catch(pb){return da.A.A=null,Pk(da.A,pb),em(da)}da.A.A=null;$b.call(da.A,pd);return em(da)}
function em(da){for(;da.A.aa;)try{var ua=da.aa(da.A);if(ua)return da.A.va=!1,{value:ua.value,done:!1}}catch(Ra){da.A.Oa=void 0,Pk(da.A,Ra)}da.A.va=!1;if(da.A.ka){ua=da.A.ka;da.A.ka=null;if(ua.rb)throw ua.qb;return{value:ua.return,done:!0}}return{value:void 0,done:!0}}
function fm(da){this.next=function(ua){Ok(da.A);da.A.A?ua=dm(da,da.A.A.next,ua,da.A.Ba):(da.A.Ba(ua),ua=em(da));return ua};this.throw=function(ua){Ok(da.A);da.A.A?ua=dm(da,da.A.A["throw"],ua,da.A.Ba):(Pk(da.A,ua),ua=em(da));return ua};this.return=function(ua){return cm(da,ua)};Lk();this[Symbol.iterator]=function(){return this}}
function gm(da){function ua($b){return da.next($b)}function Ra($b){return da.throw($b)}return new Promise(function($b,Ec){function pd(pb){pb.done?$b(pb.value):Promise.resolve(pb.value).then(ua,Ra).then(pd,Ec)}pd(da.next())})}Gj("globalThis",function(da){return da||Ej});Gj("Object.is",function(da){return da?da:function(ua,Ra){return ua===Ra?0!==ua||1/ua===1/Ra:ua!==ua&&Ra!==Ra}});
Gj("Array.prototype.includes",function(da){return da?da:function(ua,Ra){var $b=this;$b instanceof String&&($b=String($b));var Ec=$b.length;Ra=Ra||0;for(0>Ra&&(Ra=Math.max(Ra+Ec,0));Ra<Ec;Ra++){var pd=$b[Ra];if(pd===ua||Object.is(pd,ua))return!0}return!1}});
function hm(da,ua,Ra){if(null==da)throw new TypeError("The 'this' value for String.prototype."+Ra+" must not be null or undefined");if(ua instanceof RegExp)throw new TypeError("First argument to String.prototype."+Ra+" must not be a regular expression");return da+""}Gj("String.prototype.includes",function(da){return da?da:function(ua,Ra){return-1!==hm(this,ua,"includes").indexOf(ua,Ra||0)}});
Gj("Math.hypot",function(da){return da?da:function(ua){if(2>arguments.length)return arguments.length?Math.abs(arguments[0]):0;var Ra,$b,Ec;for(Ra=Ec=0;Ra<arguments.length;Ra++)Ec=Math.max(Ec,Math.abs(arguments[Ra]));if(1E100<Ec||1E-100>Ec){if(!Ec)return Ec;for(Ra=$b=0;Ra<arguments.length;Ra++){var pd=Number(arguments[Ra])/Ec;$b+=pd*pd}return Math.sqrt($b)*Ec}for(Ra=$b=0;Ra<arguments.length;Ra++)pd=Number(arguments[Ra]),$b+=pd*pd;return Math.sqrt($b)}});
Gj("Array.prototype.fill",function(da){return da?da:function(ua,Ra,$b){var Ec=this.length||0;0>Ra&&(Ra=Math.max(0,Ec+Ra));if(null==$b||$b>Ec)$b=Ec;$b=Number($b);0>$b&&($b=Math.max(0,Ec+$b));for(Ra=Number(Ra||0);Ra<$b;Ra++)this[Ra]=ua;return this}});Gj("Number.isFinite",function(da){return da?da:function(ua){return"number"!==typeof ua?!1:!isNaN(ua)&&Infinity!==ua&&-Infinity!==ua}});Gj("Number.isInteger",function(da){return da?da:function(ua){return Number.isFinite(ua)?ua===Math.floor(ua):!1}});
Gj("String.prototype.repeat",function(da){return da?da:function(ua){var Ra=hm(this,null,"repeat");if(0>ua||1342177279<ua)throw new RangeError("Invalid count value");ua|=0;for(var $b="";ua;)if(ua&1&&($b+=Ra),ua>>>=1)Ra+=Ra;return $b}});Gj("Math.sign",function(da){return da?da:function(ua){ua=Number(ua);return 0===ua||isNaN(ua)?ua:0<ua?1:-1}});
window.drawCanvas=function(da,ua,Ra,$b,Ec){function pd(){Wb.addEventListener("mousedown",Kj,!1);Wb.addEventListener("mousemove",Qk,!1);Wb.addEventListener("touchstart",Xf,!1);Wb.addEventListener("touchmove",xh,!0);Wb.addEventListener("touchend",Rk,!1);document.body.addEventListener("mouseup",Lj,!1);document.body.addEventListener("touchcancel",yh,!1);document.body.addEventListener("keydown",Se,!1);document.body.addEventListener("keypress",zh,!1);document.body.addEventListener("keyup",qf,!1);da||window.addEventListener("resize",
wc(xd,100),!1)}function pb(){Wb.removeEventListener("mousedown",Kj,!1);Wb.removeEventListener("mousemove",Qk,!1);Wb.removeEventListener("touchstart",Xf,!1);Wb.removeEventListener("touchmove",xh,!0);Wb.removeEventListener("touchend",Rk,!1);document.body.removeEventListener("mouseup",Lj,!1);document.body.removeEventListener("touchcancel",yh,!1);document.body.removeEventListener("keydown",Se,!1);document.body.removeEventListener("keypress",zh,!1);document.body.removeEventListener("keyup",qf,!1)}function wc(a,
b){b=b||100;var c;return function(e){c&&clearTimeout(c);c=setTimeout(a,b,e)}}function od(a){return new Promise(function(b){return setTimeout(b,a)})}function xd(){var a=new yd(0,0,0,0),b=screen.height;if(90===Math.abs(window.orientation))if(screen.width<screen.height){var c=screen.height;b=screen.width}else c=screen.width,b=screen.height;else c=screen.width;Mj=c/window.innerWidth;1<g.length&&(Yc(),a=Fd(g,0,"s"));he=ua?90===Math.abs(window.orientation)?Ra?.6:.71:1:da?.9>c/window.innerWidth?window.innerWidth/
c:1:1;da?ua?90===Math.abs(window.orientation)?(Ic.width=1.4*c,Ic.height=Ra?1.18*b:Math.min(1.4*b,window.innerHeight),Wb.width=Ic.width,Wb.height=Ic.height-rf.clientHeight-10,Te.width=Ic.width,Te.height=Wb.height,Ue.width=Ic.width,Ue.height=Wb.height,Ve.width=Ic.width,Ve.height=Ic.height,rf.style.marginTop="5px"):(Ic.width=1.6*c,Ic.height=1.2*b,Wb.width=Ic.width,Wb.height=Ic.height-rf.clientHeight-10,Te.width=Ic.width,Te.height=Wb.height,Ue.width=Ic.width,Ue.height=Wb.height,Ve.width=Ic.width,Ve.height=
Ic.height,rf.style.marginTop="10px"):(Ic.width=Math.max(window.innerWidth-10,Math.max(a.b+a.c+20,590)),Te.width=Ic.width,Ue.width=Ic.width,Wb.width=Ic.width,Ve.width=Ic.width,90===Math.abs(window.orientation)?(Ic.height=window.innerHeight,Wb.height=window.innerHeight-52):(Ic.height=window.innerHeight-20,Wb.height=window.innerHeight-80),Te.height=Wb.height,Ue.height=Wb.height,Ve.height=Ic.height):(Ic.width=Math.max(window.innerWidth-10,Math.max(a.b+a.c+20,590)),Wb.width=Ic.width,Te.width=Ic.width,
Ue.width=Ic.width,Ve.width=Ic.width,Ic.height=Math.max(window.innerHeight-10,Math.max(a.t+a.h+20,674)),Wb.height=Math.max(window.innerHeight-94-10,Math.max(a.t+a.h+20,596)),Te.height=Wb.height,Ue.height=Wb.height,Ve.height=Ic.height);Fc.b=10;Fc.t=42;Fc.c=34*he;Fc.h=503*he;hc.b=36*he+14;hc.t=38;hc.c=532*he;hc.h=36*he;kc.b=10;kc.t=Math.max(Wb.height-36*he-10,Fc.t+Fc.h+5);kc.c=Vh?272*he:5;kc.h=36*he;Zc.b=Vh?kc.b+kc.c+50:34*he+14;Zc.t=kc.t+4;Zc.c=50;Zc.h=kc.h-4;Lf.t=36;Lf.c=Wb.width-20;Lf.h=kc.t+kc.h+
5-36-2;za.b=34*he+14;za.t=Lf.t+36*he+12;za.c=Lf.c-Fc.c-4;za.h=Lf.h-72*he-16;ra.b=za.b+2*$a;ra.t=za.t+2*$a;ra.c=za.c-4*$a;ra.h=za.h-4*$a;Gd.x=Zc.b+Zc.c+30;Gd.y=Zc.t+Zc.h/2-4;ye.x=Zc.b+Zc.c+80;ye.y=Zc.t+Zc.h/2-4;Sk();rf.style.top=String(Wb.height+4)+"px";da?(90===Math.abs(window.orientation)&&(Yf.style.top="20px"),rf.style.width=String(Ic.width-10)+"px",rf.style.left="10px"):(rf.style.width=document.getElementById("svg")?"580px":"550px",rf.style.height="40px",rf.style.marginLeft=String(kc.b)+"px");
Ra&&ua&&(af=.6,im.style.transform="scale("+String(af)+","+String(af)+")");Nj()}function Se(a){a.shiftKey&&(0===zb?(zb=10,document.getElementById("shift").className="shift selected"):1===zb&&(zb=11,document.getElementById("shift").className="shift selected"));a.altKey&&(0===zb?(zb=1,document.getElementById("alt").className="alt selected"):10===zb&&(zb=11,document.getElementById("alt").className="alt selected"));if(a.which&&8===a.which&&!1===Wh)if(a.stopPropagation(),a.preventDefault(),ze||0<Vc.length){a=
Vc.slice(0);if(0<pa.length&&0<a.length)for(var b=0;b<a.length;b++){for(var c=0;c<pa.length;c++)if(pa[c].M.includes(a[b])||pa[c].L.includes(a[b]))Yg(c),c--;a.splice(b,1);b--}for(a=1;a<g.length;a++)g[a].v=0,Vc.includes(g[a].t)&&(g[a].v=1);Oj(1);Yc()}else Pj()}function zh(a){var b;a.charCode?b=a.charCode:b=a.keyCode;switch(b){case 113:td(0);qd(0);break;case 99:td(0);break;case 72:a=window.screenX;Ec=window.open("help/MOSFECCS_Help.html","Structural Formula Editor Help","dependent=yes,scrollbars=yes,resizable=yes");
Ec.resizeTo(900,900);Ec.moveTo(a-Ec.outerWidth-5,20);break;case 104:td(1);break;case 79:case 111:case 101:td(2);break;case 78:case 110:case 114:td(3);break;case 83:case 115:td(4);break;case 80:case 112:td(5);break;case 70:case 102:td(6);break;case 118:td(7);break;case 98:td(8);break;case 73:case 105:td(9);break;case 88:case 120:td(10);a.preventDefault();Qj("x");break;case 46:td(11);break;case 43:case 89:td(12);break;case 45:case 121:td(13);break;case 49:qd(0);break;case 50:qd(1);break;case 116:qd(2);
break;case 117:case 60:qd(3);break;case 100:case 62:qd(4);break;case 51:qd(5);break;case 52:qd(6);break;case 53:qd(7);break;case 54:qd(8);break;case 55:Xh("7");qd(10);break;case 56:Xh("8");qd(10);break;case 57:Xh("9");qd(10);break;case 97:qd(9);break;case 119:qd(11);break;case 109:qd(12);break;case 76:case 108:qd(13);break;case 103:if("visible"===Zf.style.visibility)return!1;Yc();a.preventDefault();Tk();break;case 107:Rj?(Uk(0),Rj=!1):(Uk(1),Rj=!0);break;case 69:Ga.clearRect(za.b+1,za.t+1,za.c-2,
za.h-2);Yc();Ui();break;case 74:if(Ah=Ah?!1:!0){if(a=Ga,$f(a),Md(),$f(xc),1!==M.length){if(2<=Ha.length)for(b=1;b<Ha.length;b++){var c=Ha[b].f;var e=Ha[b].g;var l=M[c].x;c=M[c].y;var f=M[e].x;e=M[e].y;var t=Ha[b].B;Zg(a,l,c,f,e,t,Ae,"black")}for(b=1;b<M.length;b++)c=a,e=b,f=String(M[e].U),c.save(),c.font=String(L)+"pt Arial, Helvetica, sans-serif",c.fillStyle="magenta",l=g[e].x-.5*c.measureText(f).width,e=g[e].y+L/2,c.clearRect(l,e-L,c.measureText(f).width,L),c.fillText(f,l,e),c.restore();$g=ah=Ge=
!1}}else vb(Ga,0,!0);break;case 48:sf=sf?!1:!0;!0===sf&&(Ah=!1);vb(Ga,0,!0);break;case 84:sf=sf?!1:!0;!0===sf&&(Ah=!1);if(sf){if(a=Ga,$f(a),Md(),$f(xc),1!==M.length){if(2<=Ha.length)for(b=1;b<Ha.length;b++)c=Ha[b].f,e=Ha[b].g,l=M[c].x,c=M[c].y,f=M[e].x,e=M[e].y,t=Ha[b].B,Zg(a,l,c,f,e,t,Ae,"black");for(b=1;b<M.length;b++)Vk(a,b,"black");if(0<Na.length)for(b=0;b<Na.length;b++)Wk(a,b,"red");if(0<pa.length)for(b=0;b<pa.length;b++)Xk(a,b,"black");$g=ah=Ge=!1}}else vb(Ga,0,!0);break;case 33:Nj();break;
case 77:for(a=1;a<=tf;a++)Be(a,String(a),"green",!0,"t")}}function qf(a){if(16===a.which||18===a.which||!0===da&&0<zb&&0===a.which)zb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt"}function Xf(a){a||(a=window.event);2===a.touches.length?Yh=!0:(a.preventDefault(),a.stopPropagation(),Nd=(a.targetTouches[0].pageX-Wb.offsetLeft)/af,Od=(a.targetTouches[0].pageY-Wb.offsetTop)/af,Jc(ra,Nd,Od)&&(bb=hb=0,a=Yd(g,Z,Nd,Od),0<a?(hb=a,bb=0,Fg(g[hb].x,g[hb].y),
uf=hb):0>a?(bb=-1*a,hb=0,Yk(bb),bh=bb):bb=hb=0),Kj())}function xh(a){a||(a=window.event);if(!0!==Yh||2!==a.touches.length)a.preventDefault(),Nd=(a.targetTouches[0].pageX-Wb.offsetLeft)/af,Od=(a.targetTouches[0].pageY-Wb.offsetTop)/af,Zk()}function yh(a){Nd=(a.changedTouches[0].pageX-Wb.offsetLeft)/af;Od=(a.changedTouches[0].pageY-Wb.offsetTop)/af;Yh=!1}function Rk(a){a||(a=window.event);0===a.touches.length&&Yh?Yh=!1:(Nd=(a.changedTouches[0].pageX-Wb.offsetLeft)/af,Od=(a.changedTouches[0].pageY-Wb.offsetTop)/
af,Lj())}function Kj(){Vi=!0;wb="";cc=Nd;dc=Od;if(Jc(ra,cc,dc)){yc=zc=0;Sj=cc;Tj=dc;bb=hb=0;var a=Yd(g,Z,cc,dc);0<a?(hb=a,bb=0):0>a?(bb=-1*a,hb=0):bb=hb=0}Zh=!1}function Qk(a){a||(a=window.event);Nd=(a.pageX-Wb.offsetLeft)/af;Od=(a.pageY-Wb.offsetTop)/af;Zk()}function Zk(){var a,b,c;var e=a=c=b=0;var l=-1,f=-1;var t=0;zc=Nd;zc>ra.b+ra.c&&(zc=ra.b+ra.c);zc<ra.b&&(zc=ra.b);yc=Od;yc>ra.t+ra.h&&(yc=ra.t+ra.h);yc<ra.t&&(yc=ra.t);if(Jc(za,Nd,Od)){"moveTree"!==wb&&"copyTree"!==wb&&"rotateTree"!==wb&&(e=
Yd(g,Z,Nd,Od),l=0<Na.length?$k(Nd,Od):-1,f=0<pa.length?al(Nd,Od):-1);0<e?(pe=e,Gg=0):0>e?(Gg=-1*e,pe=0):Gg=pe=0;-1<l?Hg=l:Hg=-1;-1<f?$h=f:$h=-1;Zh=Math.sqrt((zc-Sj)*(zc-Sj)+(yc-Tj)*(yc-Tj))>bl;if("moveAllMol"!==wb&&"moveTree"!==wb&&"copyTree"!==wb&&"rotateTree"!==wb&&!ze&&Zh)if(0<pe){if(0===uf){var r=g[pe].x;var w=g[pe].y;Fg(g[pe].x,g[pe].y);uf=pe}}else if(0<Gg&&Gg!==bb&&"provMeshDraw"!==wb&&"provChainDraw"!==wb&&"moveAtom"!==wb)0===bh&&(Yk(Gg),bh=Gg);else if(-1<Hg){if(0>ai){var A=Na[Hg].G,C=Na[Hg].K,
ya=Na[Hg].crv,Da=f=l=e=0;0>A?(e=(g[Z[-1*A].f].x+g[Z[-1*A].g].x)/2,l=(g[Z[-1*A].f].y+g[Z[-1*A].g].y)/2):0<A&&(e=g[A].x,l=g[A].y);0>C?(f=(g[Z[-1*C].f].x+g[Z[-1*C].g].x)/2,Da=(g[Z[-1*C].f].y+g[Z[-1*C].g].y)/2):0<C&&(f=g[C].x,Da=g[C].y);var ja=ld(e,l,f,Da);var Ua=Math.sqrt((f-e)*(f-e)+(Da-l)*(Da-l));C=.8*na/Ua;A=-1*ya*C*Ua*Math.sin(Math.PI*ja/180);ja=-1*ya*C*Ua*Math.cos(Math.PI*ja/180);ya=e+A;C=l+ja;A=f+A;ja=Da+ja;V.save();da&&(V.fillStyle="rgba(0,255,0,0.4)",V.beginPath(),V.arc((ya+A+e+f)/4+.25*(ya-
e),(C+ja+l+Da)/4+.25*(C-l),3*$a,0,2*Math.PI),V.fill());V.strokeStyle="green";V.bb=1.5;V.beginPath();V.arc((ya+A+e+f)/4+.25*(ya-e),(C+ja+l+Da)/4+.25*(C-l),4,0,2*Math.PI);V.stroke();V.restore();ai=Hg}}else if(-1<$h){if(0>Wi){e=$h;l=(pa[e].W.x+pa[e].V.x)/2;f=(pa[e].W.y+pa[e].V.y)/2;V.save();da&&(V.fillStyle="LightGray",V.beginPath(),V.arc(l,f,3*$a,0,2*Math.PI),V.fill());V.fillStyle="DarkGray";V.beginPath();V.arc(l,f,Xi,0,2*Math.PI);V.fill();V.restore();for(l=0;l<pa[e].M.length;l++)Be(pa[e].M[l],"reactant",
"blue",!0,"t");for(l=0;l<pa[e].L.length;l++)Be(pa[e].L[l],"product","green",!0,"t");Wi=$h}}else 0<uf&&(uf=0,Md()),0<bh&&(bh=0,Md()),-1<ai&&(ai=-1,Md()),-1<Wi&&(Wi=-1,Md());if(Vi){""===wb&&(e=Math.sqrt((zc-cc)*(zc-cc)+(yc-dc)*(yc-dc)),ng=e>.5*$a?!0:!1);if(ng&&""===wb&&0===hb&&0===bb&&1>=zb&&1<g.length&&Jc(ra,cc,dc)){if(1===Vc.length&&cc>H.b+H.c/2-Kc&&cc<H.b+H.c/2+Kc&&dc>H.t-2*Kc&&dc<H.t+2*Kc){wb="rotateTree";return}if(0===cl(cc,dc)&&0===zb)wb="spanSelRect",V.save(),V.clearRect(za.b,za.t,za.c,za.h),
V.strokeStyle="magenta",V.setLineDash([2,3]),V.strokeRect(cc,dc,zc-cc,yc-dc),V.restore();else if(0<cl(cc,dc)){ch(Vc,1);bf=Fd(g,1,"s");Md();V.save();V.strokeStyle="magenta";vb(V,1,!1);0===zb?Uj="MOVE":1===zb&&(Uj="COPY");for(e=0;e<Vc.length;e++)Be(Vc[e],Uj,"magenta",!0,"t");og=V.getImageData(bf.b-2,bf.t-L,bf.c+4,bf.h+L+2);V.strokeRect(bf.b,bf.t,bf.c,bf.h);V.restore();ie=bf.b-2;je=bf.t-L;0===zb?wb="moveSelMol":1===zb&&(wb="copySelMol")}}if(ng&&""===wb&&(0<hb||0<bb||ze&&1>=zb||1===g.length||!ze&&0<zb)){switch(!0){case 0===
zb&&ze&&cc>H.b&&cc<H.b+H.c&&dc>H.t&&dc<H.t+H.h:0<bb?t=Z[bb].f:0<hb&&(t=hb);if(0<bb||0<hb)Yi(t),H=Fd(g,1,"s");vb(V,1,!1);V.save();V.lineWidth=1;V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);og=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("MOVE",H.b,H.t-4);V.restore();ie=H.b;je=H.t;wb="moveTree";return;case 1===zb&&(0<hb||0<bb):case 1===zb&&ze&&Jc(H,cc,dc):0<bb?t=Z[bb].f:0<hb&&(t=hb);if(0<hb||0<bb)Yi(t),H=Fd(g,1,"s");vb(V,1,!1);V.save();V.lineWidth=1;
V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);og=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("COPY",H.b,H.t-4);V.restore();ie=H.b;je=H.t;wb="copyTree";break;case 10>zb&&0===bb&&vf&&(pg||wf):0<hb?(r=qe.indexOf(g[hb].o),0>r||0===g[hb].a.length?(wb="provBondDraw",bi=!0):(wb="",bi=!1)):(wb=1===g.length||1===zb%2?"provBondDraw":"",bi=!1);break;case 10>zb&&xf&&0===bb:wb="provChainDraw";0<hb?(r=qe.indexOf(g[hb].o),0>r||0===g[hb].a.length?(dh=g[hb].x,eh=g[hb].y,
ci=!0):(wb="",ci=!1)):(1===g.length||1===zb%2?(dh=cc,eh=dc):wb="",ci=!1);break;case 10>zb&&Mf&&0===bb:wb="provMeshDraw";0<hb?(r=qe.indexOf(g[hb].o),0>r||0===g[hb].a.length?(b=g[hb].x,c=g[hb].y,Ig=!0,Bh=-1):(wb="",Ig=!1)):1===g.length||1===zb%2?(b=cc,c=dc,Ig=!1,Bh=-1):wb="";break;case 0===zb&&cf&&0<bb:wb="provRingDraw";break;case 10===zb&&0<hb:wb="moveAtom";break;case 10===zb&&0<bb:ke=cc;le=dc;di=!0;bh=0;wb="moveBond";break;case 10===zb&&0===hb&&0===bb&&1<g.length:wb="moveAllMol";Yc();V.save();H=Fd(g,
0,"s");vb(V,1,!1);V.lineWidth=1;V.strokeStyle="magenta";V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);og=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";V.fillText("MOVE ALL",H.b,H.t-4);V.restore();ie=H.b;je=H.t;break;case 11===zb&&(0<hb||0<bb):0<bb?t=Z[bb].f:0<hb&&(t=hb);if(0<bb||0<hb)Yi(t),H=Fd(g,1,"s");vb(V,1,!1);V.save();V.lineWidth=1;V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);og=V.getImageData(H.b,H.t,H.c,H.h);V.font="8pt sans-serif";V.fillStyle="magenta";
V.fillText("MOVE",H.b,H.t-4);V.restore();ie=H.b;je=H.t;V.putImageData(og,ie+10,je+10);wb="moveTree";break;case (16===Xb||17===Xb)&&(0<hb||0<bb):wb="provArrowDraw";a=ld(cc,dc,zc,yc);ei=!1;0<hb?(r=g[hb].x,w=g[hb].y):0<bb&&(r=(g[Z[bb].f].x+g[Z[bb].g].x)/2,w=(g[Z[bb].f].y+g[Z[bb].g].y)/2);ke=r;le=w;break;default:Kb(),vb(Ga,0,!0)}""===wb&&Yc()}if(Zh&&""!==wb)switch(wb){case "provBondDraw":bi||1!==g.length&&1!==zb%2?(r=g[hb].x,w=g[hb].y):(r=cc,w=dc);Zi&&(dl(xc,ke,le,fi,gi,"erase"),Zi=!1);a=ld(r,w,zc,yc);
a=15*Math.floor(a/15);var ta=Math.cos(Math.PI*a/180)*na;a=-1*Math.sin(Math.PI*a/180)*na;Jc(ra,r+ta,w+a)&&(dl(xc,r,w,r+ta,w+a,"draw"),ke=r,le=w,fi=r+ta,gi=w+a,Zi=!0);break;case "provRingDraw":a=g[Z[bb].f].x;c=g[Z[bb].f].y;b=g[Z[bb].g].x;t=g[Z[bb].g].y;r=Nd-(a+b)/2;w=Od-(c+t)/2;w=Jg(b-a,t-c,r,w);4<Xb&&9>Xb||10===Xb?(10===Xb?ta=We:ta=Xb-2,Jd=yf(xc,ta,bb,"bond",w,"test"),!0===Jd&&(Ch?(Jd=yf(xc,ta,bb,"bond",w,"erase"),Ch=!1):(Jd=yf(xc,ta,bb,"bond",w,"draw"),Ch=!0))):9===Xb&&(Jd=yf(xc,6,bb,"bond",w,"test"),
!0===Jd&&(Ch?(Jd=yf(xc,6,bb,"bond",w,"erase"),Ch=!1):(Jd=yf(xc,6,bb,"bond",w,"draw"),Ch=!0)));Dh=w;break;case "moveAtom":0<hb&&($i&&(el(xc,hb,ke,le,"erase"),$i=!1),el(xc,hb,zc,yc,"draw"),ke=zc,le=yc,$i=!0);break;case "moveBond":0<bb&&(di&&(fl(xc,bb,ke-cc,le-dc,"erase"),di=!1),fl(xc,bb,zc-cc,yc-dc,"draw"),ke=zc,le=yc,di=!0);break;case "moveAllMol":ta=zc-cc;r=yc-dc;Jc(ra,ie+ta+H.c,je+r+H.h)&&Jc(ra,ie+ta,je+r)&&(Wb.style.cursor="move",V.save(),V.fillStyle="white",V.fillRect(za.b,za.t,za.c,za.h),V.restore(),
V.putImageData(og,ie+ta,je+r),V.font="8pt sans-serif",V.fillStyle="magenta",V.fillText("MOVE ALL",ie+ta,je+r-4),ke=ta,le=r);break;case "moveSelMol":case "copySelMol":ta=zc-cc;r=yc-dc;Jc(ra,ie+ta+bf.c,je+r+bf.h)&&Jc(ra,ie+ta,je+r)&&(Wb.style.cursor="move",V.save(),V.fillStyle="white",V.fillRect(za.b,za.t,za.c,za.h),V.putImageData(og,ie+ta,je+r),V.restore(),ke=ta,le=r);break;case "moveTree":case "copyTree":w=new yd(H.b+zc-cc,H.t-Kc-2+yc-dc,H.c,H.h+2*Kc+2);Vj(w,ra)?(ta=zc-cc,r=yc-dc):(ta=zc-cc,r=yc-
dc,w.b<ra.b&&(ta=ra.b+4-ie),w.t<ra.t+1&&(r=ra.t+Kc+4-je),w.b+w.c>ra.b+ra.c&&(ta=ra.b+ra.c-4-H.c-ie),w.t+w.h>ra.t+ra.h&&(r=ra.t+ra.h-H.h-4-je));Wb.style.cursor="move";V.save();V.fillStyle="white";V.fillRect(Lf.b,Lf.t,Lf.c,Lf.h);V.restore();V.putImageData(og,ie+ta,je+r);V.font="8pt sans-serif";V.fillStyle="magenta";"moveTree"===wb?V.fillText("MOVE",ie+ta,je+r-4):V.fillText("COPY",ie+ta,je+r-4);ke=ta;le=r;break;case "rotateTree":V.save();V.fillStyle="white";V.fillRect(za.b,za.t,za.c,za.h);V.restore();
Zd=H.b+H.c/2;Ce=H.t+H.h/2;ta=Math.round(180*Math.atan2(zc-Zd,Ce-yc)/Math.PI);V.save();V.translate(Zd,Ce);V.rotate(Math.PI*ta/180);V.translate(-Zd,-Ce);vb(V,1,!1);V.strokeStyle="magenta";V.fillStyle="magenta";V.beginPath();V.arc(Zd,Ce,4,0,2*Math.PI);V.stroke();V.beginPath();V.arc(Zd,Ce,2,0,2*Math.PI);V.fill();V.beginPath();V.strokeRect(Zd-H.c/2,Ce-H.h/2,H.c,H.h);V.lineWidth="1";V.fillStyle="magenta";V.beginPath();V.moveTo(H.b+H.c/2-Kc-4,H.t-Kc-2);V.lineTo(H.b+H.c/2-Kc+2,H.t-Kc+6);V.lineTo(H.b+H.c/
2-Kc+4,H.t-Kc-4);V.closePath();V.fill();V.beginPath();V.moveTo(H.b+H.c/2+Kc-4,H.t-Kc-4);V.lineTo(H.b+H.c/2+Kc-2,H.t-Kc+6);V.lineTo(H.b+H.c/2+Kc+4,H.t-Kc-2);V.closePath();V.fill();V.lineWidth="1";V.beginPath();V.arc(Zd,H.t-Kc,Kc,0,2*Math.PI);V.stroke();V.font="10pt sans-serif";V.fillStyle="magenta";V.fillText(String(ta)+"\u00b0",Zd+Kc+4,H.t-Kc);V.restore();break;case "spanSelRect":if(Jc(ra,zc,yc)){V.save();V.clearRect(ra.b,ra.t,ra.c,ra.h);if(0<Vc.length)for(e=0;e<Vc.length;e++)Be(Vc[e],"","magenta",
!1,"t");H.b=Math.min(cc,zc);H.t=Math.min(dc,yc);H.c=Math.abs(cc-zc);H.h=Math.abs(dc-yc);V.strokeStyle="magenta";V.setLineDash([2,3]);V.strokeRect(cc,dc,zc-cc,yc-dc);V.restore();zf&&(V.fillStyle="magenta","reactant"===ag?V.fillText("arrow start",H.b,H.t-8):"product"===ag&&V.fillText("arrow end",H.b,H.t-8))}else V.clearRect(za.b,za.t,za.c,za.h),wb="";break;case "provChainDraw":ta=Math.sqrt((zc-dh)*(zc-dh)+(yc-eh)*(yc-eh));ta=Math.floor(ta/gl);w=ld(dh,eh,zc,yc);r=15*Math.floor(w/15);w=7.5<w%15?1:-1;
(ta!=aj||bj!=r||cj!=w)&&1<=ta&&(dj&&(hl(xc,aj,dh,eh,bj,cj,!0,"erase"),dj=!1),hl(xc,ta,dh,eh,r,w,!0,"draw"),aj=ta,bj=r,cj=w,dj=!0);break;case "provMeshDraw":0===Aa.length&&(Aa.push(new $c(b,c)),$d=!1);1===Aa.length&&(a=ld(Aa[Aa.length-1].x,Aa[Aa.length-1].y,zc,yc),r=ha(30*Math.floor(a/30)),ta=na*Math.cos(Math.PI*r/180),a=-1*na*Math.sin(Math.PI*r/180),Gc=Aa[Aa.length-1].x+ta,Hc=Aa[Aa.length-1].y+a,Jc(ra,Gc,Hc)?(r!=Bh&&(!0===$d&&(Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,fh,gh,!0,"erase"),$d=!1),!1===
$d&&(Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),fh=Gc,gh=Hc,Bh=r,$d=!0)),ta=Math.sqrt((zc-cc)*(zc-cc)+(yc-dc)*(yc-dc)),ta>na-$a?(!0===$d&&(Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,fh,gh,!0,"erase"),$d=!1),ta=0<uf?pe:Yd(g,Z,Gc,Hc),r=il(Gc,Hc),0<=r&&Fg(Aa.x,Aa.y),0<ta?(hi=ta,Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):0<=r?(Kg=r,Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):Kg=-1,Aa.push(new $c(Gc,Hc)),Xe(xc,Aa[Aa.length-2].x,Aa[Aa.length-2].y,
Gc,Hc,!0,"draw"),ii=cc,ji=dc,Pd=Gc,Qd=Hc):(Gc=Aa[Aa.length-1].x,Hc=Aa[Aa.length-1].y)):(Gc=Aa[Aa.length-1].x,Hc=Aa[Aa.length-1].y));1<Aa.length&&(!1===Ig&&(Ga.font="12pt Calibri",Ga.fillStyle="white",Ga.fillText("C",Aa[0].x-6,Aa[0].y+6)),Pd=Aa[Aa.length-1].x,Qd=Aa[Aa.length-1].y,ii=Aa[Aa.length-2].x,ji=Aa[Aa.length-2].y,a=ld(zc,yc,Pd,Qd),r=ld(ii,ji,Pd,Qd),ta=ha(a-r),90>ta||270<ta?($d&&Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,fh,gh,!0,"erase"),Xe(xc,Aa[Aa.length-2].x,Aa[Aa.length-2].y,Aa[Aa.length-
1].x,Aa[Aa.length-1].y,!0,"erase"),Aa.pop()):(w=Jg(Pd-ii,Qd-ji,zc-Pd,yc-Qd),r=0<w?ha(r-60):ha(r+60),ta=na*Math.cos(Math.PI*r/180),a=-1*na*Math.sin(Math.PI*r/180),Gc=Pd+ta,Hc=Qd+a,Jc(ra,Gc,Hc)?(r!=Bh&&(!0===$d&&(Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,fh,gh,!0,"erase"),$d=!1),!1===$d&&(Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),fh=Gc,gh=Hc,Bh=r,$d=!0)),ta=Math.sqrt((zc-Pd)*(zc-Pd)+(yc-Qd)*(yc-Qd)),ta>na-$a?(!0===$d&&(Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,fh,gh,!0,"erase"),$d=
!1),ta=0<uf?pe:Yd(g,Z,Gc,Hc),r=il(Gc,Hc),0<=r&&Fg(Aa.x,Aa.y),0<ta?(hi=ta,Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):0<=r?(Kg=r,Xe(xc,Aa[Aa.length-1].x,Aa[Aa.length-1].y,Gc,Hc,!0,"prov"),$d=!0):Kg=-1,Aa.push(new $c(Gc,Hc)),Xe(xc,Pd,Qd,Gc,Hc,!0,"draw"),ii=Pd,ji=Qd,Pd=Gc,Qd=Hc):(Gc=Pd,Hc=Qd)):(Gc=Pd,Hc=Qd)));break;case "provArrowDraw":ej=a,0!==fi&&0!==gi&&(a=ld(fi,gi,zc,yc),-1<ej&&0===qg&&(r=Math.cos(Math.PI*a/180),w=-1*Math.sin(Math.PI*a/180),ta=Math.cos(Math.PI*ej/180),a=-1*
Math.sin(Math.PI*ej/180),qg=-1*Jg(ta,a,r,w))),ei&&(xc.clearRect(0,0,Ue.width,Ue.height),ei=!1),Jc(ra,zc,yc)&&(ta=xc,r=ke,w=le,a=zc,b=yc,e=qg,l=ld(r,w,a,b),c=ha(l-90*e),f=Math.sqrt((a-r)*(a-r)+(b-w)*(b-w)),t=-.5*e*f*Math.sin(Math.PI*l/180),f=-.5*e*f*Math.cos(Math.PI*l/180),e=r+t,l=w+f,t=a+t,f=b+f,ta.save(),ta.lineWidth=Ae,ta.strokeStyle="magenta",ta.fillStyle="magenta",ta.beginPath(),ta.moveTo(r,w),ta.bezierCurveTo(e,l,t,f,a,b),ta.stroke(),ta.beginPath(),ta.moveTo(a,b),ta.lineTo(a-8*Math.cos(Math.PI*
ha(c-30*qg)/180),b+8*Math.sin(Math.PI*ha(c-30*qg)/180)),16===Xb&&(ta.moveTo(a,b),ta.lineTo(a-8*Math.cos(Math.PI*ha(c+45*qg)/180),b+8*Math.sin(Math.PI*ha(c+45*qg)/180))),ta.stroke(),ta.restore(),fi=zc,gi=yc,Wj=qg,ei=!0)}}}else Kb()}function Lj(){function a(){ag="reactant";He=[];df=[];Vc=[];Yc();Md();Kb();wb=""}var b=0,c=0,e=0,l=0,f=0,t=-1;c=-1;e=0;e="";b=0;l=1;b=0;b=1;b=l=-1;var r=b=0;r=[];var w=[];r=[];r=b=0;b={};b=new yd(0,0,0,0);r=[];Vi=!1;Oc=Nd;Wc=Od;if(""===wb||Jc(ra,Oc,Wc))if(Jc(Lf,Oc,Wc))if(Ge=
!1,da&&(Jc(Fc,Oc,Wc)||Jc(hc,Oc,Wc)||Jc(kc,Oc,Wc)||Jc(Zc,Oc,Wc))?18>Math.sqrt((Oc-cc)*(Oc-cc)+(Wc-dc)*(Wc-dc))&&(Ge=!0):Math.sqrt((Oc-cc)*(Oc-cc)+(Wc-dc)*(Wc-dc))<jl&&(Ge=!0),Ge&&Jc(Zc,Oc,Wc))V.save(),V.fillStyle="LightGrey",V.fillRect(Zc.b+2,Zc.t+2,Zc.c-4,Zc.h-4),V.restore(),setTimeout(function(){Nj();zb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt"},100);else if(Ge&&Math.hypot(Oc-Gd.x,Wc-Gd.y)<Gd.r&&(V.save(),V.fillStyle="LightGray",V.beginPath(),
V.arc(Gd.x,Gd.y,Gd.r-2,0,2*Math.PI),V.fill(),V.restore(),setTimeout(function(){kl("in")},100)),Ge&&Math.hypot(Oc-ye.x,Wc-ye.y)<ye.r&&(V.save(),V.fillStyle="LightGray",V.beginPath(),V.arc(ye.x,ye.y,ye.r-2,0,2*Math.PI),V.fill(),V.restore(),setTimeout(function(){kl("out")},100)),Ge&&Wc>za.t+za.h&&Oc>kc.b+kc.c&&Oc<Zc.b)jm();else if(Ge&&Jc(Fc,Oc,Wc))b=Math.floor((Wc-Fc.t)/(Fc.h/14)),0>b&&(b=0),13<b&&(b=13),qd(b),(xf||Mf||Ie||cf)&&td(0),Yc(),Kb(),Md();else if(Vh&&Ge&&Jc(kc,Oc,Wc)&&(b=14+Math.floor((Oc-
kc.b)/(kc.c/8)),14>b&&(b=14),21<b&&(b=21),qd(b),td(0)),Ge&&Jc(hc,Oc,Wc))b=Math.floor((Oc-hc.b)/(hc.c/14)),0>b&&(b=0),13<b&&(b=13),td(b),10===b&&Qj("x"),Yc(),Kb(),Md();else{if(Jc(ra,Oc,Wc)){"moveTree"!==wb&&"copyTree"!==wb&&"rotateTree"!==wb&&(f=Yd(g,Z,Oc,Wc),t=$k(Oc,Wc),c=al(Oc,Wc));0<f?(mb=f,ae=0):0>f?(ae=-1*f,mb=0):ae=mb=0;hh=rg=-1;-1<t&&(rg=t);-1<c&&(hh=c);fj=gj=$g=ah=!1;if(Ge){0<mb&&!1===ng&&(ah=!0,l=qe.indexOf(g[mb].o));0<ae&&!1===ng&&($g=!0);-1<rg&&!1===ng&&(gj=!0);-1<hh&&!1===ng&&(fj=!0);if(ah){if(Ie){if(0<
pa.length&&(Eh(g,Z),rd.includes(mb)&&2<g[mb].a.length||!rd.includes(mb)&&1<g[mb].a.length))for(c=0;c<pa.length;c++)if(pa[c].M.includes(g[mb].t)||pa[c].L.includes(g[mb].t))Yg(c),c--;ki(g,Z,mb,!0);ed();Kb();vb(Ga,0,!0);return}if(sg){if(qe.includes(g[mb].o)){Kb();return}if(14===Xb){for(e=r=0;e<g[mb].a.length;e++){b=g[mb].a[e].t;if(4===b||5===b)b=1;r+=b}g[mb].H<5-r&&3>=g[mb].H&&(g[mb].H+=1)}else 15===Xb&&0<g[mb].H&&--g[mb].H;ed();Kb();vb(Ga,0,!0);return}if(cf){if(0<=l){Kb();vb(Ga,0,!0);return}if(4<Xb&&
9>Xb||10===Xb){if(10===Xb)if(0<We)b=We;else{Kb();return}else b=Xb-2;Jd=yf(xc,b,mb,"atom",1,"test");!0===Jd&&Fh(b,mb,1,"atom")}else 9===Xb&&(Jd=yf(xc,6,mb,"atom",1,"test"),!0===Jd&&Fh(-6,mb,1,"atom"));ed();Kb();vb(Ga,0,!0);return}if(pg&&(g[mb].o!==li[Je]||0<g[mb].N)){if(1===g[mb].j)for(c=0;c<g[mb].a.length;c++)0===g[mb].N?--g[g[mb].a[c].p].C:2===g[mb].N?--g[g[mb].a[c].p].D:3===g[mb].N&&--g[g[mb].a[c].p].F;g[mb].o=li[Je];g[mb].j=mi(li[Je]);g[mb].H=0;if(1===g[mb].j)for(c=0;c<g[mb].a.length;c++)g[g[mb].a[c].p].C+=
1,3<g[mb].a[c].t&&(b=Ia(Z,g[mb].a[c].p,mb),Z[b].f===mb&&ad(g,Z,b,1,!0));g[mb].N=0;ed();Kb();vb(Ga,0,!0);return}if(wf&&"X"!==be){Xj();return}if(ni&&!qe.includes(g[mb].o)){11===Je?g[mb].r=g[mb].r?!1:!0:12===Je?g[mb].s+=1:13===Je&&--g[mb].s;ed();Kb();vb(Ga,0,!0);return}vb(Ga,0,!0)}else if(gj){if(0===zb&&-1<rg&&Jc(ra,Nd,Od)&&Ie){hj(rg);ed();Kb();vb(Ga,0,!0);return}if(0===zb&&-1<rg&&Jc(ra,Nd,Od)){Na[rg].crv=0<Na[rg].crv?-1:1;ed();Kb();vb(Ga,0,!0);return}}else if(fj){if(0===zb&&-1<hh&&Jc(ra,Nd,Od)&&Ie){Yg(hh);
ed();Kb();vb(Ga,0,!0);return}0===zb&&-1<hh&&Jc(ra,Nd,Od)&&21===Xb&&km(hh)}else{if($g){if(10===zb&&0<ae&&Jc(ra,Nd,Od)){tg(g,Z,ae,1,!1);b=Fd(g,1,"s");Vj(b,ra)||tg(g,Z,ae,-1,!1);for(c=1;c<g.length;c++)1===g[c].v&&Nf(g,c);vb(Ga,0,!0);Yj();Yc();ed();Kb();da&&(Od=Nd=0)}else{if(vf)Xb+1!==Z[ae].B?ad(g,Z,ae,Xb+1,!0):(3===Xb||4===Xb)&&ad(g,Z,ae,-1,!0),ed();else if(Ie&&0<ae){if(0<pa.length&&(Eh(g,Z),!me(Z,Z[ae].f,Z[ae].g)))for(c=0;c<pa.length;c++)if(pa[c].M.includes(g[Z[ae].f].t)||pa[c].M.includes(g[Z[ae].g].t)||
pa[c].L.includes(g[Z[ae].f].t)||pa[c].L.includes(g[Z[ae].g].t))Yg(c),c--;ll(g,Z,ae);ed()}Kb();vb(Ga,0,!0)}return}if(ze&&1<g.length&&0===zb){Oc<H.b+H.c/2+20&&Oc>H.b+H.c/2-20&&Wc<H.t+H.h+30&&Wc>H.t+H.h&&ih(g,Z,"y",1);Oc<H.b+H.c+30&&Oc>H.b+H.c&&Wc<H.t+H.h/2+20&&Wc>H.t+H.h/2-20&&ih(g,Z,"x",1);ed();Kb();vb(Ga,0,!0);return}if(vf&&(pg||wf)&&(1===g.length||1===zb%2)){f=Oc;t=Wc;Jd=Jc(ra,f,t);!0===Jd&&(pg?e=li[Je]:e="C",l=ug(g,e,f,t,!1),0<l&&wf&&Xj());wf||(ed(),vb(Ga,0,!0));Kb();return}if(cf&&(1===g.length||
1===zb%2)){if(4<Xb&&9>Xb||10===Xb){if(10===Xb)if(0<We)b=We;else{Kb();return}else b=Xb-2;Jd=yf(xc,b,0,"freespace",1,"test");!0===Jd&&Fh(b,0,1,"atom")}else 9===Xb&&(Jd=yf(xc,6,0,"freespace",1,"test"),!0===Jd&&Fh(-6,0,1,"atom"));ed();Kb();vb(Ga,0,!0);return}Md()}Md();Yc()}if(ng){switch(wb){case "provBondDraw":bi||1!==g.length&&1!==zb%2?(b=hb,l=g[hb].x,c=g[hb].y):(b=ug(g,"C",cc,dc,!1),l=cc,c=dc);t=ld(l,c,Oc,Wc);t=15*Math.floor(t/15);f=Math.cos(Math.PI*t/180)*na;t=-1*Math.sin(Math.PI*t/180)*na;f=l+f;t=
c+t;if(Jc(ra,f,t)){if(vf&&(pg||wf)&&!xf){if(0===mb)pg?e=li[Je]:e="C",l=ug(g,e,f,t,!1),0<l&&(1!==g[l].j||1===g[hb].j||wf||(g[hb].C+=1),Ye(g,Z,b,l,Xb+1),wf&&Xj());else if(mb!=hb)if(e=oi(g,hb,mb),0<=e)l=mb,Of(g,Z,hb,mb,"+");else{if(3===Xb&&-1===g[mb].z||4===Xb&&1===g[mb].z){vb(Ga,0,!0);Kb();return}Ye(g,Z,hb,mb,Xb+1);l=mb;if(0<pa.length&&g[hb].t!==g[mb].t)for(c=0;c<pa.length;c++)if(pa[c].M.includes(g[hb].t)||pa[c].M.includes(g[mb].t)||pa[c].L.includes(g[hb].t)||pa[c].L.includes(g[mb].t))Yg(c),c--}else if(mb===
hb){vb(Ga,0,!0);Kb();return}vb(Ga,0,!0);wf||ed();Kb();return}}else{vb(Ga,0,!0);Kb();return}vb(Ga,0,!0);ed();Kb();break;case "provChainDraw":lm(aj,cc,dc,bj,cj);ci=!1;vb(Ga,0,!0);ed();Kb();wb="";break;case "provMeshDraw":mm(Aa.length);Ig=!1;Aa.length=0;vb(Ga,0,!0);ed();Kb();wb="";break;case "provRingDraw":if(4<Xb&&9>Xb||10===Xb){if(10===Xb)if(0<We)b=We;else{Kb();return}else b=Xb-2;Jd=yf(xc,b,bb,"bond",Dh,"test");!0===Jd&&Fh(b,bb,Dh,"bond")}else 9===Xb&&(Jd=yf(xc,6,bb,"bond",Dh,"test"),!0===Jd&&Fh(-6,
bb,Dh,"bond"));vb(Ga,0,!0);ed();Kb();wb="";break;case "moveAtom":if(0<pe&&pe!==hb){if(0!==g[hb].z&&0!==g[pe].z&&g[pe].z!==g[hb].z){vb(Ga,0,!0);Kb();return}pi(pe,hb)}else g[hb].x=zc,g[hb].y=yc;ed();vb(Ga,0,!0);Kb();wb="";break;case "moveBond":e=g[Z[bb].f].x+Oc-cc;b=g[Z[bb].f].y+Wc-dc;f=g[Z[bb].g].x+Oc-cc;t=g[Z[bb].g].y+Wc-dc;c=Yd(g,Z,e,b);l=Yd(g,Z,f,t);0<c&&c!==Z[bb].f&&0<l&&l!==Z[bb].g&&0<=oi(g,c,l)?nm(c,l,Z[bb].f,Z[bb].g):0<c&&c!==Z[bb].f?(g[Z[bb].g].x=f,g[Z[bb].g].y=t,pi(c,Z[bb].f)):0<l&&l!==Z[bb].g?
(g[Z[bb].f].x=e,g[Z[bb].f].y=b,pi(l,Z[bb].g)):(g[Z[bb].f].x=e,g[Z[bb].f].y=b,g[Z[bb].g].x=f,g[Z[bb].g].y=t);ed();vb(Ga,0,!0);Kb();wb="";break;case "moveAllMol":for(b=0;b<g.length;b++)g[b].x+=ke,g[b].y+=le;if(0<pa.length)for(b=0;b<pa.length;b++)pa[b].W.x+=ke,pa[b].W.y+=le,pa[b].V.x+=ke,pa[b].V.y+=le;vb(Ga,0,!0);ed();Kb();wb="";break;case "spanSelRect":f=new yd(Math.min(cc,Oc),Math.min(dc,Wc),Math.abs(Oc-cc),Math.abs(Wc-dc));e=!1;b=1;for(Lg=[];b<g.length;)Jc(f,g[b].x,g[b].y)&&(Lg.push(b),e=!0),b++;
if(0===Lg.length){Md();Kb();return}if(!zf){ml(Lg);if(1===Vc.length)om(Lg[0]),ze=!0;else if(1<Vc.length){Md();for(b=0;b<Vc.length;b++)Be(Vc[b],"","magenta",!1,"t");ze=!0}if(Ie&&(ze||0<Vc.length)){r=Vc.slice(0);if(0<pa.length&&0<r.length)for(b=0;b<r.length;b++){for(c=0;c<pa.length;c++)if(pa[c].M.includes(r[b])||pa[c].L.includes(r[b]))Yg(c),c--;r.splice(b,1);b--}for(b=1;b<g.length;b++)g[b].v=0,Vc.includes(g[b].t)&&(g[b].v=1);Oj(1);Yc()}break}if(zf&&e){if("reactant"===ag){for(b=0;b<g.length;b++)g[b].v=
0;Vc=[]}b=ml(Lg);if(0<b)if("reactant"===ag)V.clearRect(za.b,za.t,za.c,za.h),He=Vc.slice(0),ch(He,1),nl=Fd(g,1,"s"),V.clearRect(za.b,za.t,za.c,za.h),1===Xb-17?Be(1,"reactant(s)","blue",!0,"s"):Be(1,"arrow start","blue",!0,"s"),ag="product";else if("product"===ag)if(0<He.length&&Vc.length>He.length){df=Vc.slice(He.length);if(0===df.length){a();Kb();return}ch(df,2);ol=Fd(g,2,"s");V.clearRect(za.b,za.t,za.c,za.h);1===Xb-17?(Be(2,"reactant(s)","blue",!0,"s"),Be(2,"product(s)","green",!0,"s")):(Be(2,"arrow start",
"blue",!0,"s"),Be(2,"arrow end","green",!0,"s"));V.restore();ag="arrow"}else{a();Kb();return}else{a();Kb();return}else{a();Kb();return}if("arrow"===ag&&0<He.length&&0<df.length){V.clearRect(za.b,za.t,za.c,za.h);re=[];Zj(He,df,nl,ol);1===Xb-17?(Be(1,"reactant(s)","blue",!0,"s"),Be(2,"product(s)","green",!0,"s")):(Be(1,"arrow start","blue",!0,"s"),Be(2,"arrow end","green",!0,"s"));pa.push(new ij(He,df,Xb-17,"","",re[0],re[1],re[2],re[3]));for(b=1;b<g.length;b++)1===g[b].v&&g[b].za.push(pa.length-1),
2===g[b].v&&g[b].ya.push(pa.length-1),g[b].v=0;b=pa.length-1;b=0;ag="reactant";He=[];df=[];Vc=[];Yc();Md();ed();vb(Ga,0,!0)}}else if(zf){a();Kb();return}Ie&&e&&(Oj(1),Yc());if(!e){V.clearRect(za.b,za.t,za.c,za.h);a();Kb();return}wb="";break;case "moveTree":case "moveSelMol":Vc=[];for(b=1;b<g.length;b++)1===g[b].v&&(g[b].x+=ke,g[b].y+=le,Vc.includes(g[b].t)||Vc.push(g[b].t));if(0<pa.length){r=[];He=[];df=[];for(b=0;b<pa.length;b++)He=Gh(pa[b].M,Vc),df=Gh(pa[b].L,Vc),(0<He.length||0<df.length)&&r.push(b);
if(0<r.length)for(b=0;b<r.length;b++)pl(r[b])}V.clearRect(za.b,za.t,za.c,za.h);vb(Ga,0,!0);Yj();Yc();ed();He=[];df=[];Vc=[];Kb();wb="";break;case "copyTree":case "copySelMol":r=[];w=[];f=g.length;t=Z.length;for(b=0;b<f;b++)1===g[b].v&&(e=g.length,qi(g,g,b,e),g[e].za=[],g[e].ya=[],r.push(b),w.push(e),g[e].x=g[b].x+ke,g[e].y=g[b].y+le);for(b=0;b<f;b++)if(1===g[b].v){e=c=-1;for(l=0;l<g[b].a.length;l++)e=g[b].a[l].p,c=r.indexOf(e),e=r.indexOf(b),-1<c&&-1<e&&(c=w[c],g[w[e]].a[l].p=c);e=c=-1;for(l=0;l<
t;l++)if(Z[l].f===b){var A=Z.length;ri(Z,Z,l,A);e=r.indexOf(b);Z[A].f=w[e];c=r.indexOf(Z[l].g);-1<c&&-1<e&&(Z[A].g=w[c])}}V.clearRect(za.b,za.t,za.c,za.h);wb="";Kb();vb(Ga,0,!0);Yj();Yc();ed();break;case "rotateTree":e=ha(180*Math.atan2(Oc-Zd,Ce-Wc)/Math.PI);for(b=1;b<g.length;b++)1===g[b].v&&(t=ha(180*Math.atan2(g[b].x-Zd,Ce-g[b].y)/Math.PI),c=Math.sqrt((g[b].x-Zd)*(g[b].x-Zd)+(g[b].y-Ce)*(g[b].y-Ce)),f=c*Math.sin(Math.PI*ha(t+e)/180),t=-c*Math.cos(Math.PI*ha(t+e)/180),g[b].x=Zd+f,g[b].y=Ce+t);V.clearRect(za.b,
za.t,za.c,za.h);b=Fd(g,1,"s");Vj(b,ra)||Pj();for(c=1;c<g.length;c++)1===g[c].v&&Nf(g,c);vb(Ga,0,!0);ed();Kb();wb="";Yc();break;case "provArrowDraw":b=Yd(g,Z,Oc,Wc);r=Yd(g,Z,cc,dc);0!==r&&0!==b&&r!==b&&(0<r&&0<b&&(qe.includes(g[b].o)||qe.includes(g[r].o))||0>r&&(qe.includes(g[Z[Math.abs(r)].f].o)||qe.includes(g[Z[Math.abs(r)].g].o))||0>b&&(qe.includes(g[Z[Math.abs(b)].f].o)||qe.includes(g[Z[Math.abs(b)].g].o))?(Md(),Yc()):(b=new jj(r,b,"",0),b.ca=16===Xb?"f":"h",b.crv=Wj,Na.push(b),ed()));vb(Ga,0,
!0);Kb();wb="";break;default:Md(),Yc()}Kb()}}}else Kb();else vb(Ga,0,!0),Kb()}function Kb(){Wb.style.cursor="default";Mg("erase");Mg("mark");fj=gj=$g=ah=Ge=ei=Ig=$d=dj=Zi=di=$i=!1;Wj=qg=0;Vi=ng=Zh=!1;ai=-1;pe=bh=uf=0;Hg=-1;Gg=mb=bb=hb=0;rg=-1;Ce=Zd=le=ke=ae=0;Dh=1}function om(a){var b=document.getElementById("igc").getContext("2d");Yi(a);H=Fd(g,1,"s");Jc(za,H.b,H.t-Kc-2)&&Jc(za,H.b+H.c,H.t+H.h)?(vb(b,1,!1),b.bb=1,b.strokeRect(H.b,H.t,H.c,H.h),Zd=H.b+H.c/2,Ce=H.t+H.h/2,b.lineWidth=da?2:1,b.strokeStyle=
"magenta",b.fillStyle="magenta",b.font="10px Arial",b.save(),b.beginPath(),b.arc(Zd,Ce,4,0,2*Math.PI),b.stroke(),b.beginPath(),b.arc(Zd,Ce,2,0,2*Math.PI),b.fill(),b.beginPath(),b.moveTo(H.b+H.c/2-Kc-4,H.t-Kc-2),b.lineTo(H.b+H.c/2-Kc+2,H.t-Kc+6),b.lineTo(H.b+H.c/2-Kc+4,H.t-Kc-4),b.closePath(),b.fill(),b.beginPath(),b.moveTo(H.b+H.c/2+Kc-4,H.t-Kc-4),b.lineTo(H.b+H.c/2+Kc-2,H.t-Kc+6),b.lineTo(H.b+H.c/2+Kc+4,H.t-Kc-2),b.closePath(),b.fill(),b.beginPath(),b.arc(Zd,H.t-Kc,Kc,0,2*Math.PI),b.stroke(),b.beginPath(),
b.moveTo(H.b+H.c/2,H.t+H.h),b.lineTo(H.b+H.c/2,H.t+H.h+30),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c/2-20,H.t+H.h+15),b.bezierCurveTo(H.b+H.c/2-20,H.t+H.h+5,H.b+H.c/2+20,H.t+H.h+5,H.b+H.c/2+20,H.t+H.h+15),b.bezierCurveTo(H.b+H.c/2+20,H.t+H.h+25,H.b+H.c/2-20,H.t+H.h+25,H.b+H.c/2-20,H.t+H.h+15),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c/2+20,H.t+H.h+16),b.lineTo(H.b+H.c/2+16,H.t+H.h+24),b.lineTo(H.b+H.c/2+12,H.t+H.h+16),b.closePath(),b.fill(),b.beginPath(),b.strokeStyle="white",b.lineWidth="3",b.moveTo(H.b+
H.c/2,H.t+H.h+15),b.lineTo(H.b+H.c/2,H.t+H.h+22),b.stroke(),b.restore(),b.fillText("180\u00b0",H.b+H.c/2-10,H.t+H.h+38),b.beginPath(),b.moveTo(H.b+H.c,H.t+H.h/2),b.lineTo(H.b+H.c+30,H.t+H.h/2),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c+15,H.t+H.h/2-20),b.bezierCurveTo(H.b+H.c+5,H.t+H.h/2-20,H.b+H.c+5,H.t+H.h/2+20,H.b+H.c+15,H.t+H.h/2+20),b.bezierCurveTo(H.b+H.c+25,H.t+H.h/2+20,H.b+H.c+25,H.t+H.h/2-20,H.b+H.c+15,H.t+H.h/2-20),b.stroke(),b.beginPath(),b.moveTo(H.b+H.c+16,H.t+H.h/2+20),b.lineTo(H.b+H.c+
24,H.t+H.h/2+16),b.lineTo(H.b+H.c+16,H.t+H.h/2+12),b.closePath(),b.fill(),b.beginPath(),b.strokeStyle="white",b.lineWidth="3",b.moveTo(H.b+H.c+15,H.t+H.h/2),b.lineTo(H.b+H.c+22,H.t+H.h/2),b.stroke(),b.fillStyle="magenta",b.font="10px Arial",b.fillText("180\u00b0",H.b+H.c+32,H.t+H.h/2+3),b.restore(),ze=!0):b.clearRect(za.b,za.t,za.c,za.h)}function dl(a,b,c,e,l,f){"erase"===f?$f(a):(a.save(),a.strokeStyle="magenta",a.lineWidth=Ae,Jc(za,e,l)&&(a.beginPath(),a.moveTo(b,c),a.lineTo(e,l),a.stroke()),a.restore())}
function el(a,b,c,e,l){var f;if("erase"===l)$f(xc);else{var t=Ae;for(f=0;f<g[b].a.length;){var r=g[b].a[f].p;var w=g[b].a[f].t;l=g[r].x;r=g[r].y;Zg(a,l,r,c,e,w,t,"magenta");f++}}}function fl(a,b,c,e,l){var f;if("erase"===l)$f(a);else{var t=Ae;l=Z[b].f;var r=Z[b].g;Zg(a,g[l].x+c,g[l].y+e,g[r].x+c,g[r].y+e,Z[b].B,t,"magenta");b=Yd(g,Z,g[l].x+c,g[l].y+e);var w=Yd(g,Z,g[r].x+c,g[r].y+e);0<b&&b!==l&&b!==r&&0===w?(Fg(g[b].x,g[b].y),uf=b):0<w&&w!==r&&w!==l&&0===b?(Fg(g[w].x,g[w].y),uf=w):0<w&&0<b&&b!==l&&
w!==r?(Fg(g[w].x,g[w].y),Fg(g[b].x,g[b].y)):0===b&&0===w&&0<uf&&(uf=0,Md());for(f=0;f<g[l].a.length;){if(g[l].a[f].p!==r){var A=g[l].a[f].p;w=g[l].a[f].t;b=g[A].x;A=g[A].y;Zg(a,b,A,g[l].x+c,g[l].y+e,w,t,"magenta")}f++}for(f=0;f<g[r].a.length;)g[r].a[f].p!==l&&(A=g[r].a[f].p,w=g[r].a[f].t,b=g[A].x,A=g[A].y,Zg(a,b,A,g[r].x+c,g[r].y+e,w,t,"magenta")),f++}}function yf(a,b,c,e,l,f){var t=!1;var r=!0,w=[0,0,0,-.5*na,-.5*na,-.5*na,0,0,0,0,0,0,0],A=[0,0,0,-.28868*na,.5*na,-.80902*na,na,0,0,0,0,0,0];var C=
0<l?!0:!1;if("erase"===f){var ya=Ae+2;var Da="white"}else"draw"===f&&(ya=Ae,Da="magenta");if(!(1<g.length&&"atom"===e&&c!=mb)){0>b&&(Ng=t=!0,b=Math.abs(b));var ja=b;"bond"===e&&(ja=b-1);l=360/b;var Ua=(180-l)/2;var ta=Math.pow(-1,b)*Ua;6===b&&(ta=90);if("freespace"===e&&"test"===f){var xb=cc+w[b];var Ta=dc+A[b]}if("atom"===e){if(0<c&&2===g.length)xb=g[c].x,Ta=g[c].y;else if(0<c&&1===g[c].a.length){xb=g[c].x;Ta=g[c].y;t=g[c].a[0].p;var Ka=g[t].x;t=g[t].y;ta=ld(Ka,t,xb,Ta)}else if(0<c&&2===g[c].a.length&&
!1===t)xb=g[c].x,Ta=g[c].y,ta=Hh(g,c);else return;Ka=c}"bond"===e&&0<Z[c].B&&(e=Z[c].f,Ka=Z[c].g,xb=g[e].x,Ta=g[e].y,ta=Ya(g,e,Ka),Ua=180-360/b,C||(Ua*=-1,l*=-1));b=ha(ta-Ua);Pd=xb;Qd=Ta;"test"!==f&&(a.save(),a.lineWidth=ya,a.strokeStyle=Da,a.beginPath(),a.moveTo(Pd,Qd));for(ya=0;ya<ja-1;ya++){Da=na*Math.cos(Math.PI*b/180);c=-1*na*Math.sin(Math.PI*b/180);Gc=xb+Da;Hc=Ta+c;if("test"===f){if(r=Jc(ra,Gc,Hc),!1===r)return Ng=!1,r}else a.lineTo(Gc,Hc);b=ha(b+l);xb=Gc;Ta=Hc;Pd=Gc;Qd=Hc}"test"!==f&&(a.lineTo(g[Ka].x,
g[Ka].y),a.stroke(),a.restore());Ng=!1;return r}}function Xe(a,b,c,e,l,f,t){a.save();"draw"===t?(a.lineWidth=Ae,a.strokeStyle="black",a.fillStyle="black"):"erase"===t?(a.lineWidth=Ae+2,a.strokeStyle="white",a.fillStyle="white"):"prov"===t&&(a.lineWidth=Ae,a.strokeStyle="magenta",a.fillStyle="magenta");a.beginPath();a.moveTo(b,c);a.lineTo(e,l);a.stroke();if(f){f=Ig?String(Aa.length-1):String(Aa.length);var r=Aa.length-1;if(Aa.length>r&&0<r){var w=ld(Aa[r].x,Aa[r].y,Aa[r-1].x,Aa[r-1].y);e=ld(Aa[r].x,
Aa[r].y,e,l);e=ha(ak(w,e)+180)}else e=1===Aa.length&&0===r?270:-1;l=2===f.length?2*L:1.5*L;e=bk(l,e);a.font="12pt Calibri";"erase"===t?a.strokeText(f,ql,rl):"prov"===t&&(a.fillText(f,b+e.x-si*f.length/2,c+e.y+L/2),ql=b+e.x-si*f.length/2,rl=c+e.y+L/2)}a.restore()}function hl(a,b,c,e,l,f,t,r){var w;var A=1;var C=na*Math.cos(Math.PI*ha(l+A*f*30)/180);A=-na*Math.sin(Math.PI*ha(l+A*f*30)/180);a.save();"draw"===r?(a.lineWidth=Ae,a.strokeStyle="magenta",a.fillStyle="magenta"):"erase"===r&&(a.lineWidth=Ae+
2,a.strokeStyle="white",a.fillStyle="white");a.beginPath();a.moveTo(c,e);for(w=0;w<b;w++)a.lineTo(c,e),A=0===w%2?1:-1,C=na*Math.cos(Math.PI*ha(l+A*f*30)/180),A=-na*Math.sin(Math.PI*ha(l+A*f*30)/180),c+=C,e+=A;a.stroke();t&&(l=0>C?-8:4,0<hb?w=b-1:w=b,a.font="12pt Calibri","erase"===r&&a.strokeText(w,c-C+l,e-A),a.fillText(w,c-C+l,e-A));a.restore()}function Yi(a){var b;for(b=0;b<g.length;b++)g[b].v=0;lc=[];a=Ih(g,a);for(b=0;b<a;b++)g[lc[b]].v=1}function ml(a){var b;for(b=0;b<a.length;b++)Vc.includes(g[a[b]].t)||
Vc.push(g[a[b]].t);return Vc.length}function Be(a,b,c,e,l){V.save();H=Fd(g,a,l);V.strokeStyle=c;e&&V.setLineDash([2,3]);V.strokeRect(H.b,H.t,H.c,H.h);V.fillStyle=c;V.fillText(b,H.b,H.t-2);V.restore()}function sl(a,b,c,e,l,f){var t;for(t=1;t<a.length;t++){if(-1===b||a[t].v===b)a[t].x=c+(a[t].x-c)*l,a[t].y=e+(a[t].y-e)*l;f&&(a[t].v=0)}}function tl(a,b,c,e){var l;if(0===a.length)return-1;for(l=0;l<a.length;l++)a[l].W.x=b+(a[l].W.x-b)*e,a[l].W.y=c+(a[l].W.y-c)*e,a[l].V.x=b+(a[l].V.x-b)*e,a[l].V.y=c+(a[l].V.y-
c)*e}function ul(a,b,c,e){var l;if(0===a.length)return-1;for(l=0;l<a.length;l++)a[l].b=b+(a[l].b-b)*e,a[l].t=c+(a[l].t-c)*e,a[l].c=a[l].c*e,a[l].h=a[l].h*e}function Qj(a){var b="";pb();ti=a;"x"===a?b="Enter Element Symbol:":"n"===a&&(b="Number of Atoms in ring:");document.getElementById("xheader").innerHTML=b;Jh.style.visibility="visible";Jh.addEventListener("click",function(c){c.preventDefault()},!1);Jh.addEventListener("mouseup",function(c){c.preventDefault()},!1);Pf.focus();"x"===Pf.value&&(Pf.value=
"",Pf.blur());Pf.focus();pm.addEventListener("click",function(c){var e=Pf.value;c.preventDefault();"x"===ti?vl(e):"n"===ti&&Xh(e);Pf.value="";Pf.blur();pd();Jh.style.visibility="hidden"},!1);Jh.addEventListener("keypress",function(c){if(13===c.which){var e=Pf.value;c.preventDefault();"x"===ti?vl(e):"n"===ti&&Xh(e);Pf.value="";Pf.blur();pd();Jh.style.visibility="hidden"}},!1)}function km(a){pb();jh.style.visibility="visible";Kh.value=void 0===pa[a].na?"":pa[a].na;ui.value=void 0===pa[a].Aa?"":pa[a].Aa;
Kh.focus();jh.addEventListener("click",function(b){b.preventDefault()},!1);jh.addEventListener("mouseup",function(b){b.preventDefault()},!1);wl.addEventListener("click",function e(c){xl(a,Kh.value+"|"+ui.value);c.preventDefault();Kh.blur();ui.blur();wl.removeEventListener("click",e,!1);pd();jh.style.visibility="hidden";ed();Kb();vb(Ga,0,!0)},!1);jh.addEventListener("keypress",function l(e){13===e.which&&(xl(a,Kh.value+"|"+ui.value),e.preventDefault(),Kh.blur(),ui.blur(),jh.removeEventListener("keypress",
l,!1),pd(),jh.style.visibility="hidden",ed(),Kb(),vb(Ga,0,!0))},!1)}function xl(a,b){var c=b.split("|");b=c[0];c=c[1];pa[a].na=b?b.trim():"";pa[a].Aa=c?c.trim():""}function Tk(){function a(l){pb();ce.rows=String(Math.floor(l.length/ce.cols)+2);ce.value=l;Zf.style.visibility="visible";Wh=!0;Zf.addEventListener("click",function(f){f.preventDefault();ce.select();ce.selectionStart=0;ce.selectionEnd=ce.value.length},!1);Zf.addEventListener("mouseup",function(f){f.preventDefault()},!1);ce.addEventListener("onfocus",
function(f){f.preventDefault();ce.select();ce.selectionStart=0;ce.selectionEnd=ce.value.length},!1);ce.focus();ce.selectionStart=0;ce.selectionEnd=ce.value.length;qm.addEventListener("click",function(){pd();Zf.style.visibility="hidden";Wh=!1},!1);Zf.addEventListener("keypress",function(f){13===f.which&&(ce.selectionStart=0,ce.selectionEnd=0,ce.blur(),pd(),Zf.style.visibility="hidden",Wh=!1,td(0),qd(0))},!1)}var b=0,c=0,e=[];b=0;if(1<g.length)if(b=ck(),1===b&&0===Lc.length)a(Kd),sf=!1,vb(Ga,0,!0);
else if(1===b&&0<Lc.length){vb(Ga,0,!0);for(b=0;b<Lc.length;b++)vi(V,M,Lc[b]);alert("WARNING:\nThe drawing of one or more stereogenic centres\nis ambiguous or inconsistent!\n\nCorrect the stereo-drawing of the centers marked by red squares and try again.\n\nThe red squares disappear with the next drawing action");Lc=[]}else{if(-1===b)if(0<wi.length)for(c=0;c<wi.length;c++){e=[];for(b=0;b<cb[wi[c]].length;b++)e.push(M[cb[wi[c]][b]].Ca);rm(g,Z,e);b=ck();if(1===b&&0===Lc.length){a(Kd);sf=!1;vb(Ga,0,
!0);break}else if(1===b&&0<Lc.length){vb(Ga,0,!0);for(b=0;b<Lc.length;b++)vi(V,M,Lc[b]);alert("WARNING:\nThe drawing of one or more stereogenic centres\nis ambiguous or inconsistent!\n\nCorrect the stereo-drawing of the centers marked by red squares and try again.\n\nThe red squares disappear with the next drawing action");Lc=[];break}else alert("SMILES GENERATION FAILED because no ring closure over a single bond is possible in this structure!")}else alert("SMILES GENERATION FAILED because no ring closure over a single bond is possible in this structure!")}else alert("No atoms yet, empty SMILES code!")}
function sm(){pb();document.getElementById("smixheader").innerHTML="Enter SMILES Code";Yf.style.visibility="visible";Yf.addEventListener("click",function(a){a.preventDefault()},!1);Yf.addEventListener("mouseup",function(a){a.preventDefault()},!1);Af.focus();tm.addEventListener("click",function(a){var b=Af.value;""===b?a.preventDefault():(a.preventDefault(),bg=b,td(0),qd(0),be="X",kh(be),dk(bg.trim()));bg="";Af.value="";Af.blur();pd();Yf.style.visibility="hidden"},!1);um.addEventListener("click",function(a){a.preventDefault();
bg="";Af.value="";Af.blur();pd();Yf.style.visibility="hidden"},!1);vm.addEventListener("click",function(a){var b=Af.value;""===b?a.preventDefault():(a.preventDefault(),bg=b,Ui(),vb(Ga,0,!0),td(0),qd(0),be="X",kh(be),dk(bg.trim()));bg="";Af.value="";Af.blur();pd();Yf.style.visibility="hidden"},!1);Yf.addEventListener("keypress",function(a){if(13===a.which){var b=Af.value;""===b?a.preventDefault():(a.preventDefault(),bg=b,td(0),qd(0),be="X",kh(be),Ui(),dk(bg.trim()));bg="";Af.value="";Af.blur();pd();
Yf.style.visibility="hidden"}},!1)}function Xh(a){null!==a&&""!==a&&(9<parseInt(a,10)||3>parseInt(a,10)?(alert("Only rings from 3 to 9 atoms supported by ring tools\n\nFor larger rings use general chain tool."),We=0):(We=parseInt(a,10),qd(10)))}function vl(a){var b=0,c=!1;if(null!==a&&""!==a){var e=qe.indexOf(a);-1<e&&(be=a,c=!0);e=ek.indexOf(a);-1<e&&(be=a,c=!0);c||(e=a.match(/(\d{1,3})([A-Z]{1}[a-z]{0,1}:{0,1})/),null!==e&&(a=e[2],b=parseInt(e[1],10)),2<a.length&&(a=a.substr(0,2)),a=a.match(wm),
null!==a&&(c=!0,be=0<b?String(b)+a[0]:a[0]));c?kh(be):alert("Not a valid symbol!")}}function Xj(){var a,b=0,c=be;""===wb?2===g.length||1===zb%2?a=g.length-1:a=mb:"provBondDraw"===wb&&(a=g.length-1);var e=c.match(/(\d{1,3})([A-Z]{1}[a-z]{0,1}:{0,1})/);null!==e&&(c=e[2],b=parseInt(e[1],10));"D"===c&&(b=2,g[a].j=1,c=g[a].o="H");"T"===c&&(b=3,g[a].j=1,c=g[a].o="H");if(c!==g[a].o||2===b||3===b)if(!qe.includes(c)||1>=g[a].a.length)if(""===wb&&0<g[a].a.length&&(1===g[a].j&&0===g[a].N&&1!==g[g[a].a[0].p].j&&
0<g[g[a].a[0].p].C&&--g[g[a].a[0].p].C,1===g[a].j&&2===g[a].N&&1!==g[g[a].a[0].p].j&&0<g[g[a].a[0].p].D&&--g[g[a].a[0].p].D,1===g[a].j&&3===g[a].N&&1!==g[g[a].a[0].p].j&&0<g[g[a].a[0].p].F&&--g[g[a].a[0].p].F),g[a].o=c,g[a].j=mi(c),1===g[a].j)if(0===b)for(e=0;e<g[a].a.length;e++)g[g[a].a[e].p].C+=1;else if(2===b)for(e=0;e<g[a].a.length;e++)g[g[a].a[e].p].D+=1;else if(3===b)for(e=0;e<g[a].a.length;e++)g[g[a].a[e].p].F+=1;g[a].N=b;1===zb%2&&(zb--,document.getElementById("alt").className="alt");ed();
Kb();vb(Ga,0,!0)}function qd(a){Mg("erase");10===Xb&&10!==a&&(yl("n"),We=0);Xb=a;0<=a&&4>=a?(vf=!0,zf=sg=Ie=Mf=xf=cf=!1):5<=a&&10>=a?(vf=!1,cf=!0,zf=sg=Ie=Mf=xf=!1):11===a?(xf=cf=vf=!1,Mf=!0,zf=sg=Ie=!1):12===a?(cf=vf=!1,xf=!0,zf=sg=Ie=Mf=!1):13===a?(Mf=xf=cf=vf=!1,Ie=!0,zf=sg=!1):14<=a&&17>=a?(Ie=Mf=xf=cf=vf=!1,sg=!0,zf=!1):18<=a&&21>=a&&(sg=Ie=Mf=xf=cf=vf=!1,zf=!0);(cf||xf||Mf||Ie)&&0!==Je&&td(0);vf&&ni&&td(0);Mg("mark");10===a&&(0===We?Qj("n"):2<We&&10>We&&yl(String(We)))}function td(a){0!==a&&
(cf||Mf||xf||sg||zf)&&qd(0);10===Je&&10!==a&&"X"!==be&&kh("X");Je=a;0<=a&&10>a?(pg=!0,ni=wf=!1):10===a?(pg=!1,wf=!0,ni=!1):10<a&&(wf=pg=!1,ni=!0);Mg("erase");Mg("mark")}function cl(a,b){var c;if(0===Vc.length)return 0;for(c=1;c<=tf;c++)if(Jc(sd[c],a,b)&&Vc.includes(c))return c;return 0}function Vj(a,b){return a.t>b.t&&a.b>b.b&&a.b+a.c<b.b+b.c&&a.t+a.h<b.t+b.h}function Yj(){var a,b,c=[];for(a=1;a<g.length;a++)if(1===g[a].v)for(b=1;b<g.length;b++)if(b!==a){var e=Math.sqrt((g[b].x-g[a].x)*(g[b].x-g[a].x)+
(g[b].y-g[a].y)*(g[b].y-g[a].y));e<=$a&&c.push(a)}if(0<c.length)for(a=0;a<c.length;a++)vi(Ga,g,c[a])}function il(a,b){var c;for(c=0;c<Aa.length;c++){var e=Math.sqrt((a-Aa[c].x)*(a-Aa[c].x)+(b-Aa[c].y)*(b-Aa[c].y));if(e<=$a)return c}return-1}function $k(a,b){var c;for(c=0;c<Na.length;c++){if(0<Na[c].G){var e=g[Na[c].G].x;var l=g[Na[c].G].y}else 0>Na[c].G&&(l=-1*Na[c].G,e=(g[Z[l].f].x+g[Z[l].g].x)/2,l=(g[Z[l].f].y+g[Z[l].g].y)/2);if(0<Na[c].K){var f=g[Na[c].K].x;var t=g[Na[c].K].y}else 0>Na[c].K&&(t=
-1*Na[c].K,f=(g[Z[t].f].x+g[Z[t].g].x)/2,t=(g[Z[t].f].y+g[Z[t].g].y)/2);var r=ld(e,l,f,t);var w=Math.sqrt((f-e)*(f-e)+(t-l)*(t-l));var A=.8*na/w;var C=-1*Na[c].crv*A*w*Math.sin(Math.PI*r/180);w=-1*Na[c].crv*A*w*Math.cos(Math.PI*r/180);r=e+C;A=l+w;C=f+C;w=t+w;C=(r+C+e+f)/4+.25*(r-e);A=(A+w+l+t)/4+.25*(A-l);A=Math.sqrt((a-C)*(a-C)+(b-A)*(b-A));if(A<$a)return c}return-1}function al(a,b){var c;for(c=0;c<pa.length;c++){var e=(pa[c].W.x+pa[c].V.x)/2;var l=(pa[c].W.y+pa[c].V.y)/2;e=Math.sqrt((a-e)*(a-e)+
(b-l)*(b-l));if(e<$a)return c}return-1}function Mg(a){var b=document.getElementById("can").getContext("2d");b.save();if("erase"===a)b.strokeStyle="white",b.lineWidth=7,b.beginPath(),b.moveTo(hc.b,hc.t+hc.h+4),b.lineTo(hc.b+hc.c,hc.t+hc.h+4),b.stroke(),b.beginPath(),b.moveTo(Fc.b-4,Fc.t),b.lineTo(Fc.b-4,Fc.t+Fc.h),b.stroke(),b.beginPath(),b.moveTo(kc.b,kc.t+kc.h+4),b.lineTo(kc.b+kc.c,kc.t+kc.h+4),b.stroke();else if("mark"===a){var c=Je;var e=Xb;b.strokeStyle="red";b.lineWidth=5}b.beginPath();b.moveTo(hc.b+
hc.c/14*c,hc.t+hc.h+4);b.lineTo(hc.b+hc.c/14*(c+1),hc.t+hc.h+4);b.stroke();14<=e&&21>=e?(b.beginPath(),b.moveTo(kc.b+kc.c/8*(e-14),kc.t+kc.h+4),b.lineTo(kc.b+kc.c/8*(e-13),kc.t+kc.h+4)):(b.beginPath(),b.moveTo(Fc.b-5,Fc.t+e*Fc.h/14),b.lineTo(Fc.b-5,Fc.t+(e+1)*Fc.h/14-2));b.stroke();b.restore()}function Fg(a,b){V.save();da&&(V.fillStyle="rgba(255,0,0,0.1)",V.beginPath(),V.arc(a,b,3*fk,0,2*Math.PI),V.fill());V.lineWidth=da?2:1;V.strokeStyle="red";V.beginPath();V.arc(a,b,fk,0,2*Math.PI);V.stroke();V.restore()}
function Yk(a){var b=(g[Z[a].f].x+g[Z[a].g].x)/2;a=(g[Z[a].f].y+g[Z[a].g].y)/2;V.save();da&&(V.fillStyle="rgba(0,0,255,0.1)",V.beginPath(),V.arc(b,a,3*Xi,0,2*Math.PI),V.fill());V.lineWidth=da?2:1;V.strokeStyle="blue";V.beginPath();V.arc(b,a,Xi,0,2*Math.PI);V.stroke();V.restore()}function vi(a,b,c){var e=b[c].x;b=b[c].y;a.save();a.beginPath();a.lineWidth=2;a.strokeStyle="red";a.strokeRect(e-$a-2,b-$a-2,2*$a+4,2*$a+4);a.restore()}function jm(){var a=screen.height;if(90===Math.abs(window.orientation))if(screen.width<
screen.height){var b=screen.height;a=screen.width}else b=screen.width,a=screen.height;else b=screen.width;Mj=b/window.innerWidth;var c="\norientation="+String(window.orientation)+" phone="+ua;c+="\nvps="+String(Math.round(1E3*Mj)/1E3)+" iconscale="+String(Math.round(1E3*he)/1E3);c+="\ns.w="+String(b)+" s.h="+String(a);c+="\nw.iW="+String(window.innerWidth)+" w.iH="+String(window.innerHeight);c+="\nbgc.w="+String(Ic.width)+" bgc.h="+String(Ic.height);c+="\ncan.w="+String(Wb.width)+" can.h="+String(Wb.height);
c+="\ntrect%="+String(Math.round(100*(Fc.t+Fc.h)/Ic.height*10)/10)+"%";c+="\nbutreg.style.top="+String(rf.style.top);alert(c)}function yl(a){Ga.save();Ga.beginPath();Ga.arc(Fc.b+34*he/2,Fc.t+378*he,8,0*Math.PI,2*Math.PI);Ga.fillStyle="white";Ga.fill();Ga.font="10pt sans-serif";Ga.fillStyle="black";Ga.fillText(a,Fc.b+34*he/2-a.length/2*8,Fc.t+378*he+4);Ga.restore()}function kh(a){var b=hc.b+10*hc.c/14+4,c=hc.t+hc.h-6,e=0,l=0;var f=a.match(/(\d{1,3})([A-Z]{1}[a-z]{0,1}:{0,1})/);null!==f?(a=f[2],f=f[1]):
f="";Ga.save();Ga.fillStyle="white";Ga.fillRect(b,hc.t+3,hc.c/14-7,hc.h-6);Ga.fillStyle="X"===a?"black":"red";if(""!==f){Ga.font="9pt sans-serif";var t=Ga.measureText(f);e=2;l=.5*(hc.h-6);Ga.fillText(f,b+e,c-l);e+=t.width;l=(hc.h-6-19)/2}Ga.font="14pt sans-serif";""===f&&(e=(hc.c/14-7-Ga.measureText(a).width)/2,l=(hc.h-6-19)/2);if(2<f.length||3<f.length+a.length)e=hc.c/14-6-Ga.measureText(a).width,l=0;Ga.fillText(a,b+e,c-l);Ga.restore()}function Sk(){var a,b=[7,7,7,7,7,7,7,10,10,5,7,5,7,7],c=hc.b,
e=Fc.b+Fc.c+8;jd.save();jd.clearRect(0,0,Ve.width,Ve.height);jd.font="12pt Sans-Serif";jd.fillStyle="blue";for(a=0;a<gk.length;a++)jd.fillText(gk[a],c+38*a+18-b[a],hc.t+36+25);for(a=0;a<gk.length;a++)jd.fillText(xm[a],c+38*a+18-b[a],hc.t+36+42);for(a=0;a<hk.length;a++)jd.font="l"===hk[a]?"italic 14pt serif":"12pt Sans-Serif",jd.fillText(hk[a],e,Fc.t+4+36*a+20);jd.font="12pt Sans-Serif";jd.fillText("q",Fc.b-3+18,Fc.t-12);da?(jd.fillText("E",60,kc.t+60),jd.fillText("backsp",115,kc.t+60),jd.fillText("g",
220,kc.t+60),jd.fillText("H",400,kc.t+60),jd.fillText("!",Zc.b-10,Zc.t+20)):(jd.fillText("E",60,kc.t+110),jd.fillText("backsp",130,kc.t+110),jd.fillText("g",240,kc.t+110),jd.fillText("H",445,kc.t+110),jd.fillText("!",Zc.b+Zc.c/2,kc.t+53));jd.save();jd.strokeStyle="blue";jd.lineWidth=1;jd.beginPath();jd.moveTo(Fc.b+18+8,hc.t-12);jd.lineTo(hc.b,hc.t);jd.moveTo(Fc.b-3+22,hc.t-10);jd.lineTo(Fc.b-3+22,hc.t+4);jd.stroke();jd.restore()}function Uk(a){0===a?Ve.style.visibility="hidden":1===a&&(Ve.style.visibility=
"visible")}function vb(a,b,c){var e;$f(a);Md();$f(xc);if(1!==g.length){var l=1===b?"magenta":"black";if(2<=Z.length)for(e=1;e<Z.length;e++){var f=Z[e].f;var t=Z[e].g;if(1===b&&(1===g[f].v||1===g[t].v)||"moveAllMol"===wb||0===b){var r=g[f].x;f=g[f].y;var w=g[t].x;t=g[t].y;var A=Z[e].B;Zg(a,r,f,w,t,A,Ae,l)}}r=1===b?"magenta":"black";for(e=1;e<g.length;e++)(1===b&&1===g[e].v||"moveMol"===wb||0===b)&&Vk(a,e,r);if(0<Na.length&&c)for(e=0;e<Na.length;e++)Wk(a,e,"red");if(0<pa.length&&c)for(e=0;e<pa.length;e++)Xk(a,
e,"black");$g=ah=Ge=!1}}function Zg(a,b,c,e,l,f,t,r){var w=ld(b,c,e,l);var A=Math.PI/2+w/180*Math.PI;w=-1*xi*Math.sin(A);A=xi*Math.cos(A);0!==f&&(1===f&&(a.beginPath(),a.strokeStyle=r,a.lineWidth=t,a.moveTo(b,c),a.lineTo(e,l),a.stroke()),2===f&&(a.beginPath(),a.strokeStyle=r,a.lineWidth=t,a.moveTo(b+A,c+w),a.lineTo(e+A,l+w),a.stroke(),a.beginPath(),a.moveTo(b-A,c-w),a.lineTo(e-A,l-w),a.stroke()),3===f&&(a.strokeStyle=r,a.lineWidth=t,a.beginPath(),a.moveTo(b,c),a.lineTo(e,l),a.stroke(),a.beginPath(),
a.moveTo(b+2*A,c+2*w),a.lineTo(e+2*A,l+2*w),a.stroke(),a.beginPath(),a.moveTo(b-2*A,c-2*w),a.lineTo(e-2*A,l-2*w),a.stroke()),4===f&&(a.beginPath(),a.fillStyle=r,a.moveTo(b,c),a.lineTo(e-1.5*A,l-1.5*w),a.lineTo(e+1.5*A,l+1.5*w),a.lineTo(b,c),a.fill()),5===f&&(ik?(a.beginPath(),a.strokeStyle=r,a.moveTo(b-A,c-w),a.lineTo(b+A,c+w),a.lineTo(e,l),a.lineTo(b-A,c-w),a.bb=t,a.stroke()):(a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(e-2*A,l-2*w),a.lineTo(e+2*A,l+2*w),a.lineTo(b,c),a.clip(),a.beginPath(),a.strokeStyle=
r,a.setLineDash([2,3]),a.moveTo(b,c),a.lineWidth=zl,a.lineTo(e,l),a.stroke(),a.restore())))}function Vk(a,b,c){function e(Sb,Rb){var Mc,tb=.3*L,mc=String(g[Rb].H);Sb.save();Sb.fillStyle="blue";for(Mc=0;Mc<mc;Mc++){var Za=g[Rb].x+Ka[Mc]*Math.cos(Math.PI*ha(Ta[Mc])/180);var Lb=g[Rb].y-Ka[Mc]*Math.sin(Math.PI*ha(Ta[Mc])/180);var sc=Za+tb*Math.cos(Math.PI*ha(Ta[Mc]+90)/180);var zd=Lb-tb*Math.sin(Math.PI*ha(Ta[Mc]+90)/180);Za+=tb*Math.cos(Math.PI*ha(Ta[Mc]-90)/180);Lb-=tb*Math.sin(Math.PI*ha(Ta[Mc]-90)/
180);Sb.beginPath();Sb.arc(sc,zd,2,0,2*Math.PI);Sb.fill();Sb.beginPath();Sb.arc(Za,Lb,2,0,2*Math.PI);Sb.fill()}Sb.restore()}function l(Sb,Rb,Mc,tb){Sb.save();Sb.font=String(L+2)+"pt";Sb.strokeStyle="black";Sb.lineWidth=1;Sb.beginPath();Sb.arc(Rb,Mc,.6*Sb.measureText("+").width,0,2*Math.PI);Sb.moveTo(Rb-.6*Sb.measureText("+").width,Mc);Sb.lineTo(Rb+.6*Sb.measureText("+").width,Mc);"+"===tb&&(Sb.moveTo(Rb,Mc-.6*Sb.measureText("+").width),Sb.lineTo(Rb,Mc+.6*Sb.measureText("+").width));Sb.stroke();Sb.restore()}
var f=0,t="",r=-1,w=new $c(0,0),A=f=0,C=0,ya=0,Da="",ja="",Ua="",ta=w=0,xb=[];f=[];var Ta=[],Ka=[L,L,L,L],Pc=ya="";ja="";var ec=L,Ub=L;A=0;var Ad=!1;a.save();a.font=String(L)+"pt Arial, Helvetica, sans-serif";a.fillStyle=c;ja=jk(g,b);0<g[b].N&&(Ua=String(g[b].N));"H"===ja&&2===g[b].N&&(Ua="",ja="D");"H"===ja&&3===g[b].N&&(Ua="",ja="T");if(2>ja.length||Og.includes(ja)||ja.includes(":")||sf||qe.includes(ja))t="simple";else if(xb=ja.match(/([A-Za-z]{1,2})H(\d{0,2})/))t="right";else if(xb=ja.match(/H(\d{0,2})([A-Za-z]{0,2})/))t=
"left";ya=a.measureText(g[b].o.charAt(0)).width/2;Da=kk(g,b);""!==Da&&(f=Da.match(/(\d{1,2})/))&&(Pc=f[1]);ym(g,b,!0);"right"===t?r=Al(g,b,0):"left"===t&&(r=Al(g,b,180));Ad=!1;for(f=0;f<g[b].a.length;f++)if(A=Ya(g,b,g[b].a[f].p),"right"===t&&(30>A||330<A)||"left"===t&&150<A&&210>A)Ad=!0;"H"===g[b].o&&0===g[b].a.zb&&(C=60);if(g[b].r){if("simple"===t)switch(g[b].a.length){case 0:C=180;Ta=[ha(C+90),ha(C-90),ha(C+180),C];2===ja.length&&(Ka[2]+=.5*L);3<g[b].H&&(Ub+=L);break;case 1:C=qb[0];Ta=[ha(C+90),
ha(C-90),C,ha(C+180)];""===ja?Ub=.6*L:1===ja.length?(Ka=[1.1*L,1.1*L,1.1*L,1.1*L],3>g[b].H?Ub=.9*L:Ub=Ka[2]+.6*L):2===ja.length&&(Ka=[1.1*L,1.1*L,1.5*L,1.2*L],45>=C||315<=C?(Ka=[1.1*L,1.1*L,1.5*L,1.2*L],3>g[b].H?Ub=1.7*L:Ub=Ka[2]+.6*L):135<=C&&225>=C?(Ka=[1.1*L,1.1*L,1.2*L,1.2*L],Ub=3>g[b].H?.9*L:Ka[2]+.6*L):225<C&&315>C?(Ka=[1.5*L,L,1.1*L,1.2*L],Ub=3>g[b].H?1.2*L:Ka[2]+.6*L):45<C&&135>C?(Ka=[L,1.5*L,1.1*L,1.2*L],Ub=3>g[b].H?1.2*L:Ka[2]+.6*L):(Ub=1.6*L,Ka[2]=L));break;case 2:C=qb[0];0===g[b].H&&1===
Ke(g,Z,b)&&(C=ha(C+180));if(1===g[b].H)Ta=[ha(C+180)],Ka[0]=0===ja.length?.8*L:1.1*L;else if(1<g[b].H)if(Ta=[ha(C+135),ha(C-135),C],0===ja.length)Ka=[.8*L,.8*L,.8*L];else if(1===ja.length)Ka=[L,L,L];else if(2===ja.length)for(f=0;f<g[b].H;f++)if(30>Ta[f]||330<Ta[f])Ka[f]+=.7*L;else if(75>Ta[f]||285<Ta[f])Ka[f]+=.42*L;0===g[b].H?(Ub=L,1<=Ke(g,Z,b)?Ub=1.1*L:""===ja?Ub=.84*L:2===ja.length&&(60>C||300<C)&&(Ub+=.6*L)):2>=g[b].H?Ub=0<ja.length?(60>C||300<C)&&2===ja.length?1.6*L:1.1*L:.7*L:2<g[b].H&&(Ub=
Ka[2]+.5*L);break;default:C=qb[qb.length-2],Ub=L,Ta=[qb[qb.length-1],qb[qb.length-3]],Ka=[1.3*L,1.3*L],2===ja.length&&(Ub=60>C||300<C?1.5*L:L,Ka=[1.3*L,1.3*L]),""===ja&&(Ub=.8*L)}else if(0===g[b].a.length)Ta=[270,90,180,0],Ka=[1.2*L,1.2*L,1.2*L,a.measureText(ja).width],C=180,2<g[b].H&&(Ub=2*L);else if(1===g[b].a.length)C=qb[0],Ka=[1.2*L,1.2*L,1.2*L,1.2*L],Ub=1.1*L,45<C&&90>=C?(Ta=[180,90,270,0],C=90):90<C&&135>C?(Ta=[0,90,270,180],Ub=1.1*L,C=90):270<=C&&315>C?(Ta=[180,270,90,0],Ub=1.1*L,C=270):225<
C&&270>C?(Ta=[0,270,90,180],Ub=1.1*L,C=270):45>=C||315<=C?(Ta=[90,270,180,0],Ub=1.1*L,C=270):135<=C&&225>=C&&(Ta=[90,270,0,180],Ub=1.1*L,C=270),1<g[b].H&&(Ub+=.6*L);else if(2===g[b].a.length){C=qb[0];Ka[2]+=.6*L;Ta=45<C&&135>C?[C,"right"===t?ha(C+120):ha(C-120),"right"===t?ha(C-120):ha(C+120),ha(C-90)]:[C,"right"===t?ha(C-120):ha(C+120),"right"===t?ha(C+120):ha(C-120),ha(C-90)];if(45>C||315<C||135<C&&225>C)Ka[1]+=.6*L;C=Ta[1];2>g[b].H?Ub=1.3*L:(Ub=2*L,"right"===t&&0<C&&90>C&&(Ub=2*L,Ka[1]=Ub-.6*L));
2<g[b].H&&(Ka[2]=a.measureText(ja).width,"left"===t&&(Ta=[270,90,180,0]))}else Ka=[1.2*L,1.2*L,1.2*L],"simple"===t?(C=qb[qb.length-2],Ta=[qb[qb.length-1],qb[qb.length-2],qb[qb.length-3]]):r!==qb.length-1?(Ta=[qb[qb.length-1],qb[qb.length-2],qb[qb.length-3]],C=qb[qb.length-2]):(Ta=[qb[qb.length-2],qb[qb.length-3],qb[qb.length-1]],C=qb[qb.length-3]),Ub=1<g[b].H?Ka[1]+.6*L:1.3*L;w=bk(Ub,C);a.save();a.font=String(1.5*L)+"pt Arial, Helvetica, sans-serif";a.fillStyle="red";a.fillText("\u2022",g[b].x+w.x-
a.measureText("\u2022").width/2,g[b].y+w.y+.7*L);a.restore()}else if(0<g[b].H)switch(g[b].a.length){case 0:C=0;Ta=[ha(C+180),ha(C+90),ha(C-90),C];2===ja.length&&(Ka=[L,L,L,a.measureText(ja).width]);3<g[b].H&&(ec+=L);break;case 1:C=qb[0];if("simple"===t){if(Ta=2===g[b].a[0].t&&2>=g[b].H?[ha(C+60),ha(C-60),ha(C+180)]:3===g[b].a[0].t?[C,ha(C-90),ha(C-90)]:[ha(C+90),ha(C-90),C,ha(C+180)],Ka=[L,L,L,L],2===ja.length)for(f=0;f<g[b].H;f++)if(30>Ta[f]||330<Ta[f])Ka[f]+=.5*L;else if(75>Ta[f]||285<Ta[f])Ka[f]+=
.3*L}else 45>C||315<C?(Ta=[90,270,180,0],Ka=[L,1.2*L,L,1.2*L]):135<=C&&225>=C?(Ta=[270,90,0,180],Ka=[1.2*L,L,a.measureText(ja.charAt(0)).width]):45<=C&&90>=C?(Ta=[90,180,270,0],Ka=[a.measureText(ja.charAt(0)).width,L,1.2*L]):90<C&&135>C?(Ta=[90,0,270,180],Ka=[a.measureText(ja.charAt(0)).width,L,1.2*L]):270<=C&&315>=C?(Ta=[270,180,90,0],Ka=[1.2*L,L,1.3*L,1.2*L]):225<C&&270>C&&(Ta=[270,0,90,180],Ka=[1.2*L,L,1.3*L,1.2*L]);break;case 2:if("simple"===t)if(C=ha(qb[0]+180),1===g[b].H)Ta=[C],Ka[0]=2===ja.length?
45>C||315<C?1.3*L:.9*L:L;else{if(1<g[b].H&&(Ta=[ha(C+45),ha(C-45),ha(C+180)],2===ja.length))for(f=0;f<g[b].H;f++)(60>Ta[f]||300<Ta[f])&&2>f?Ka[f]+=.5*L:(80>Ta[f]||280<Ta[f])&&2===f&&(Ka[f]+=.25*L)}else if(C=qb[0],Ka[2]+=.6*L,Ta=45<C&&135>C?[C,"right"===t?ha(C+120):ha(C-120),"right"===t?ha(C-120):ha(C+120),ha(C-90)]:[C,"right"===t?ha(C-120):ha(C+120),"right"===t?ha(C+120):ha(C-120),ha(C-90)],45>C||315<C||135<C&&225>C)Ka[1]+=.6*L;break;default:if("simple"===t){if(Ta=[qb[qb.length-1],qb[qb.length-3],
qb[qb.length-2]],Ka=[1.2*L,1.2*L,1.2*L],2===ja.length)for(f=0;f<g[b].H;f++)(60>Ta[f]||300<Ta[f])&&2>f&&(Ka[f]+=.5*L)}else Ta=r!==qb.length-1?[qb[qb.length-1],qb[qb.length-2],qb[qb.length-3]]:[qb[qb.length-2],qb[qb.length-3],qb[qb.length-1]],Ka=[1.2*L,1.2*L,1.2*L]}"simple"===t&&""!==ja&&(f=g[b].x-ya,A=g[b].y+L/2,w=g[b].x-a.measureText(ja.charAt(0)).width/2,ta=A-1.2*L,ja.includes(":")?(xb=ja.match(/([CN]):(H)(\d{0,1})/))?(ja=xb[1]+xb[2]+xb[3],a.save(),a.font=String(L)+"pt Times New Roman serif bold",
a.fillStyle="DarkGreen",a.clearRect(f,A-L,a.measureText(ja).width+0,L+0),a.fillText(xb[1],f,A),a.restore(),f+=a.measureText(xb[1]).width,a.fillText(xb[2],f,A),""!==xb[3]&&(f+=a.measureText(xb[2]).width,A+=4,a.save(),a.font=String(L-2)+"pt Arial",a.fillText(xb[3],f,A),a.restore())):(xb=ja.match(/(\d{0,1}H)([CN]):/))?(ja=xb[2],a.clearRect(f,A-L,a.measureText(ja).width+0,L+0),a.save(),a.font=String(L)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.fillText(ja,f,A),a.restore(),ja=xb[1],f-=
a.measureText(xb[1]).width,a.clearRect(f,A-L,a.measureText(ja).width+0,L+0),a.fillText(ja,f,A)):(ja=ja.replace(":",""),a.save(),a.font=String(L)+"pt Times New Roman serif bold",a.fillStyle="DarkGreen",a.clearRect(f,A-L,a.measureText(ja).width+0,L+0),a.fillText(ja,f,A),a.restore()):(a.clearRect(f-1,A-L,a.measureText(ja).width+0+2,L+0+1),a.fillText(ja,f,A)),""!==Ua&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",w-=a.measureText(Ua).width-2,a.clearRect(w-1,ta-3*L/4,a.measureText(Ua).width+
2,3*L/4+1),a.fillText(Ua,w,ta),a.restore()));if(""!==Da&&("simple"===t||Ad)){switch(g[b].a.length){case 0:C=30;ec=1===ja.length?1.2*L:1.6*L;2<g[b].H&&(ec+=.6*L);g[b].r&&2<g[b].H&&(ec=Ka[2]+.8*L);break;case 1:C=qb[0];if(150<C&&200>C)C=ha(C-15);else if(340<C||20>C)C=ha(C+15);2>ja.length&&!Ad?(ec=1.3*L,""===ja&&(ec=.8*L),""!==Pc&&120<C&&240>C&&(ec=a.measureText(Da).width+.6*L),2<g[b].H&&(ec+=.8*L),0<g[b].H&&2===g[b].a[0].t&&(ec=Ka[0]+.6*L)):2===ja.length&&(45>C||315<C?ec=""!==Pc?1.2*L:1.8*L:135<C&&225>
C?ec=""!==Pc?1.2*L:1.4*L:135>=C&&45<=C?ec=""!==Pc?.8*L:1.2*L:225<=C&&315>=C&&(ec=L),""!==Pc&&(ec+=.4*L),2<g[b].H&&(ec+=1.2*L));g[b].r&&(ec=Ub+1.2*L);break;case 2:C=qb[0];g[b].r?0===g[b].H&&1===Ke(g,Z,b)?(C=ha(C+180),ec=1.4*L):ec=Ub+L:ec=1<ja.length&&(45>C||315<C)?1.8*L:""===ja?.8*L:1.4*L;2<g[b].H&&!g[b].r&&(ec=Ka[2]+.5*L);0===g[b].H&&180<Fa[1].$&&(C=ha(C+180));break;case 3:case 4:case 5:case 6:r===qb.length-2&&Ad?2>g[b].H?(C=qb[qb.length-3],ec=1.4*L):ec=Ka[1]+.6*L:(C=qb[qb.length-2],ec=1.4*L,2===
ja.length&&(60>C||300<C)&&(ec+=.2*L)),g[b].r&&(ec=Ub+L),""===ja&&(ec-=.2*L)}w=bk(ec,C);f=g[b].x+w.x;A=g[b].y+w.y;a.font=String(L+2)+"pt";0<Pc.length&&(f=g[b].x+w.x-.6*a.measureText("+").width,A=g[b].y+w.y+L/2,a.fillStyle="black",a.fillText(Pc,f,A),f+=a.measureText(Pc).width+L/2,A-=.6*a.measureText("+").width);l(a,f,A,0<g[b].s?"+":"\u2013")}if("right"===t||"left"===t)c="left"===t?-1*(a.measureText(ja).width-ya):-1*ya,(xb=ja.match(/([A-Za-z]{1,2})H(\d{1,2})/))?(ja=xb[1],ya=xb[2],f=g[b].x-a.measureText(ja.charAt(0)).width/
2,A=g[b].y+L/2,w=f,ta=A-1.2*L,a.clearRect(f,A-L,a.measureText(ja+"H").width,L),a.fillText(ja+"H",f,A),f+=a.measureText(ja+"H").width,A+=4,a.clearRect(f,A-L,a.measureText(ya).width,L),a.fillText(ya,f,A),f+=a.measureText(ya).width+2,A-=4,""==Da||Ad||(A-=.6*L,0<Pc.length&&(a.fillStyle="black",a.fillText(Pc,f,A),f+=a.measureText(Pc).width+.2*L),A-=.6*a.measureText("+").width,l(a,f+4,A,0<g[b].s?"+":"\u2013")),""!==Ua&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",w-=a.measureText(Ua).width,
a.clearRect(w-1,ta-3*L/4,a.measureText(Ua).width+2,3*L/4+1),a.fillText(Ua,w,ta),a.restore())):(xb=ja.match(/H(\d{1,2})([A-Za-z]{1,2})/))?(ja=xb[2],ya=xb[1],f=g[b].x+c,A=g[b].y+L/2,w=g[b].x-a.measureText("M").width/2,ta=A-L,a.clearRect(f,A-L,a.measureText("H").width,L),a.fillText("H",f,A),f+=a.measureText("H").width,A+=4,a.clearRect(f,A-L,a.measureText(ya).width,L),a.fillText(ya,f,A),f+=a.measureText(ya).width,A-=4,a.clearRect(f,A-L,a.measureText(ja).width,L),a.fillText(ja,f,A),f=g[b].x+c,""==Da||
Ad||(A-=.6*L,f-=a.measureText("+").width,A-=.6*a.measureText("+").width,l(a,f,A,0<g[b].s?"+":"\u2013"),0<Pc.length&&(a.fillStyle="black",A+=.6*a.measureText("+").width,f-=a.measureText(Pc).width+L/2,a.fillText(Pc,f,A))),""!==Ua&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",w-=a.measureText(Ua).width,a.clearRect(w,ta-3*L/4,a.measureText(Ua).width+0+2,3*L/4+1),a.fillText(Ua,w+1,ta),a.restore())):!ja.match(/^H/)||"H"===ja&&0===g[b].a.length?(f=g[b].x-a.measureText(ja.charAt(0)).width/
2,A=g[b].y+L/2,w=f-1,ta=A-L,a.clearRect(f,A-L,a.measureText(ja).width,L),a.fillStyle="black",a.fillText(ja,f,A),f+=a.measureText(ja).width+.5*L,""==Da||Ad||(3<g[b].H&&(f+=.8*L),A-=4,0<Pc.length&&(f-=.4*L,a.fillStyle="black",a.fillText(Pc,f,A),f+=a.measureText(Pc).width+L/2),A-=.6*a.measureText("+").width,l(a,f,A,0<g[b].s?"+":"\u2013")),""!==Ua&&(a.save(),a.font=String(3*L/4)+"pt Arial",a.fillStyle="red",w=w-1-a.measureText(Ua).width,a.clearRect(w-1,ta-3*L/4,a.measureText(Ua).width+0+2,3*L/4+1),a.fillText(Ua,
w,ta),a.restore())):(f=g[b].x-a.measureText(ja).width+a.measureText(ja.charAt(0)).width/2,A=g[b].y+L/2,w=g[b].x-a.measureText("M").width/2,ta=A-L,a.clearRect(f,A-L,a.measureText(ja).width,L),a.fillStyle="black",a.fillText(ja,f,A),""==Da||Ad||(A-=.6*L,f-=a.measureText("+").width,A-=.6*a.measureText("+").width,l(a,f,A,0<g[b].s?"+":"\u2013"),0<Pc.length&&(a.fillStyle="black",f-=a.measureText(Pc).width+L/2,A+=.6*a.measureText("+").width,a.fillText(Pc,f,A))),""!==Ua&&(a.save(),a.font=String(3*L/4)+"pt Arial",
a.fillStyle="red",w-=a.measureText(Ua).width,a.clearRect(w,ta-3*L/4,a.measureText(Ua).width+0+2,3*L/4+1),a.fillText(Ua,w+1,ta),a.restore()));a.restore();0<g[b].H&&e(a,b)}function Wk(a,b,c){var e=Na[b].G,l=Na[b].K,f=Na[b].ca;b=Na[b].crv;var t=0,r=0,w=0,A=0;0>e?(t=(g[Z[-1*e].f].x+g[Z[-1*e].g].x)/2,r=(g[Z[-1*e].f].y+g[Z[-1*e].g].y)/2):0<e&&(t=g[e].x,r=g[e].y);0>l?(w=(g[Z[-1*l].f].x+g[Z[-1*l].g].x)/2,A=(g[Z[-1*l].f].y+g[Z[-1*l].g].y)/2):0<l&&(w=g[l].x,A=g[l].y);var C=ld(t,r,w,A);e=ha(C-90*b);var ya=Math.sqrt((w-
t)*(w-t)+(A-r)*(A-r));var Da=.8*na/ya;l=-1*b*Da*ya*Math.sin(Math.PI*C/180);ya=-1*b*Da*ya*Math.cos(Math.PI*C/180);Da=t+l;C=r+ya;l=w+l;ya=A+ya;a.save();a.lineWidth=Ae;a.strokeStyle=c;a.fillStyle=c;a.beginPath();a.moveTo(t,r);a.bezierCurveTo(Da,C,l,ya,w,A);a.stroke();a.beginPath();a.moveTo(w,A);a.lineTo(w-8*Math.cos(Math.PI*ha(e-30*b)/180),A+8*Math.sin(Math.PI*ha(e-30*b)/180));"f"===f&&(a.moveTo(w,A),a.lineTo(w-8*Math.cos(Math.PI*ha(e+45*b)/180),A+8*Math.sin(Math.PI*ha(e+45*b)/180)));a.stroke();a.restore()}
function pl(a){new yd(0,0,0,0);new yd(0,0,0,0);Yc();ch(pa[a].M,10);var b=Fd(g,10,"s");ch(pa[a].L,20);var c=Fd(g,20,"s");re=[];Zj(pa[a].M,pa[a].L,b,c);pa[a].W.x=re[0];pa[a].W.y=re[1];pa[a].V.x=re[2];pa[a].V.y=re[3];re=[];Yc()}function Xk(a,b,c){var e=new $c(pa[b].W.x,pa[b].W.y),l=new $c(pa[b].V.x,pa[b].V.y),f=pa[b].ca;var t=new $c(0,0);var r=0;var w=ld(e.x,e.y,l.x,l.y);2===f&&(t.x=-1*$a*Math.cos(Math.PI*ha(w-90)/180),t.y=$a*Math.sin(Math.PI*ha(w-90)/180),e=yi(e,t),l=yi(l,t));a.save();a.strokeStyle=
c;a.fillStyle=c;a.lineWidth=2;a.beginPath();3===f&&(a.moveTo(e.x,e.y),a.lineTo(e.x+2*$a*Math.cos(Math.PI*ha(w+30)/180),e.y-2*$a*Math.sin(Math.PI*ha(w+30)/180)),a.moveTo(e.x,e.y),a.lineTo(e.x+2*$a*Math.cos(Math.PI*ha(w-30)/180),e.y-2*$a*Math.sin(Math.PI*ha(w-30)/180)));a.moveTo(e.x,e.y);a.lineTo(l.x,l.y);a.lineTo(l.x-2*$a*Math.cos(Math.PI*ha(w+30)/180),l.y+2*$a*Math.sin(Math.PI*ha(w+30)/180));a.moveTo(l.x,l.y);a.lineTo(l.x-2*$a*Math.cos(Math.PI*ha(w-30)/180),l.y+2*$a*Math.sin(Math.PI*ha(w-30)/180));
a.stroke();2===f&&(e=kj(e,t),l=kj(l,t),e=kj(e,t),l=kj(l,t),a.beginPath(),a.moveTo(l.x,l.y),a.lineTo(e.x,e.y),a.lineTo(e.x+2*$a*Math.cos(Math.PI*ha(w+30)/180),e.y-2*$a*Math.sin(Math.PI*ha(w+30)/180)),a.moveTo(e.x,e.y),a.lineTo(e.x+2*$a*Math.cos(Math.PI*ha(w-30)/180),e.y-2*$a*Math.sin(Math.PI*ha(w-30)/180)),a.stroke(),e=yi(e,t),l=yi(l,t));""!==pa[b].na&&3!==f&&(a.font=String(L)+"pt sans-serif",a.textBaseline="middle",t=1===f?2*$a:4*$a,r=a.measureText(pa[b].na).width,c=270<w||90>w?1:-1,t=Math.abs(r/
2*Math.sin(Math.PI*w/180))+t,a.fillText(pa[b].na,(e.x+l.x)/2-c*t*Math.sin(Math.PI*w/180)-r/2,(e.y+l.y)/2-c*t*Math.cos(Math.PI*w/180)));""!==pa[b].Aa&&3!==f&&(a.font=String(L)+"pt sans-serif",a.textBaseline="middle",t=1===f?2*$a:4*$a,f=a.measureText(pa[b].Aa).width,c=270<w||90>w?-1:1,t=Math.abs(f/2*Math.sin(Math.PI*w/180))+t,a.fillText(pa[b].Aa,(e.x+l.x)/2-c*t*Math.sin(Math.PI*w/180)-r/2,(e.y+l.y)/2-c*t*Math.cos(Math.PI*w/180)));a.restore()}function $f(a){a.clearRect(za.b+2,za.t+2,za.c-4,za.h-4)}function Md(){V.clearRect(0,
0,Te.width,Te.height)}function Nj(){lk.fillStyle="white";lk.clearRect(0,0,Ic.width,Ic.height);V.clearRect(0,0,Te.width,Te.height);xc.clearRect(0,0,Ue.width,Ue.height);Ga.clearRect(0,0,Wb.width,Wb.height);var a=document.getElementById("can").getContext("2d");a.save();a.font="12pt Sans-Serif";a.fillStyle="black";a.fillText("Structural Formula Editor  MOSFECCS",50,28);a.fillStyle="black";a.font="10pt Sans-Serif";a.fillText("v6_240305(240305.1)",za.b+za.c-a.measureText("v6_240305(240305.1)").width,28);
a.font="9pt Sans-Serif";a.fillText("\u00a9 B.Jaun ETHZ",za.b+za.c-90,za.t+za.h+15);a.restore();a.drawImage(mk,hc.b,hc.t,hc.c,hc.h);a.drawImage(nk,Fc.b,Fc.t,Fc.c,Fc.h);Vh&&a.drawImage(ok,kc.b,kc.t,kc.c,kc.h);kh(be);a.save();a.strokeStyle="black";a.lineWidth=1.5;a.strokeRect(Zc.b,Zc.t,Zc.c,Zc.h);a.font="10pt Sans-Serif";a.fillStyle="black";a.fillText("redraw",Zc.b+Zc.c/2-a.measureText("redraw").width/2,Zc.t+Zc.h/2+4);a.restore();a.save();a.strokeStyle="black";a.lineWidth=1.5;a.beginPath();a.arc(Gd.x,
Gd.y,Gd.r,0,2*Math.PI);a.stroke();a.font="14pt Sans-Serif";a.fillStyle="black";a.fillText("+",Zc.b+Zc.c+30-a.measureText("+").width/2,Zc.t+Zc.h/2);a.restore();a.save();a.strokeStyle="black";a.lineWidth=1.5;a.beginPath();a.arc(ye.x,ye.y,ye.r,0,2*Math.PI);a.stroke();a.font="14pt Sans-Serif";a.fillStyle="black";a.fillText("\u2013",ye.x-a.measureText("\u2013").width/2,ye.y+5);a.restore();a.save();a.font="10pt Sans-Serif";a.fillStyle="black";a.fillText("Bondlength",Gd.x-7,Gd.y+26);a.fillText(String(Math.round(na)),
(Gd.x+ye.x)/2-6,Gd.y+6);Mg("erase");Mg("mark");a.save();a.beginPath();a.strokeStyle="black";a.lineWidth=1;a.strokeRect(za.b,za.t,za.c,za.h);a.restore();Kb();1<g.length&&Bl();vb(Ga,0,!0);qd(0);td(0);be="X"}function ug(a,b,c,e,l){var f,t=0;for(f=1;f<a.length;f++)t=Yd(g,Z,c,e);if(0!==t)return-t;f=mi(b);l&&(b="("+b+")");l=a.length;a[l]=new kb(f,b,c,e,0,0,0);return a[l].Ca=l}function pi(a,b){var c;for(c=0;c<g[b].a.length;c++)Ye(g,Z,g[b].a[c].p,a,g[b].a[c].t);ki(g,Z,b,!0)}function ll(a,b,c){var e;for(e=
0;e<Na.length;e++)if(Na[e].G===-1*c||Na[e].K===-1*c)hj(e),e--;for(e=0;e<Na.length;e++)0>Na[e].G&&Math.floor(Math.abs(Na[e].G))>c&&(Na[e].G+=1),0>Na[e].K&&Math.floor(Math.abs(Na[e].K))>c&&(Na[e].K+=1);var l=b[c].f;var f=b[c].g;var t=-1;for(e=0;e<a[l].a.length;e++)a[l].a[e].p===f&&(t=e);0<=t&&a[l].a.splice(t,1);t=-1;for(e=0;e<a[f].a.length;e++)a[f].a[e].p===l&&(t=e);0<=t&&a[f].a.splice(t,1);b.splice(c,1)}function nm(a,b,c,e){var l=g[b].x;var f=g[b].y;b=g[e].x;var t=g[e].y;e=Ia(Z,c,e);ll(g,Z,e);pi(a,
c);a=Yd(g,Z,l,f);c=Yd(g,Z,b,t);pi(a,c)}function Fh(a,b,c,e){var l;var f=1;var t=!0;var r=[0,0,0,-.5*na,-.5*na,-.5*na,0,0,0,0,0,0,0],w=[0,0,0,-.28868*na,.5*na,-.80902*na,na,0,0,0,0,0,0];-6===a&&(Ng=!0);0<c?t=!0:0>c&&(t=!1);var A=0<a?a:-a;c=360/Math.abs(a);var C=(180-c)/2;var ya=Math.pow(-1,A)*C;6===A&&(ya=90);if("atom"===e){if(1===g.length||1===zb%2){var Da=Oc+r[A];var ja=Wc+w[A];var Ua=ug(g,"C",Da,ja,!1);0<Ua&&(b=Ua)}if(0<b&&0===g[b].a.length)Da=g[b].x,ja=g[b].y;else if(0<b&&1===g[b].a.length)Da=
g[b].x,ja=g[b].y,ya=Hh(g,b);else if(0<b&&2===g[b].a.length&&1===g[b].a[0].t&&1===g[b].a[1].t&&0<a)Da=g[b].x,ja=g[b].y,ya=Hh(g,b);else return;Ua=l=b}if("bond"===e){if(0===Z[b].B)return;A--;4!==Z[b].B&&5!==Z[b].B||ad(g,Z,b,1,!0);if(1===Z[b].B&&-6===a){Da=Z[b].f;ja=Z[b].g;for(Ua=f=0;Ua<g[Da].a.length;){if(2===g[Da].a[Ua].t){f+=1;break}Ua++}for(Ua=0;Ua<g[ja].a.length;){if(2===g[ja].a[Ua].t){f+=1;break}Ua++}0===f&&ad(g,Z,b,2,!0)}else if(2<Z[b].B){Ng=!1;return}l=Z[b].f;Ua=Z[b].g;Da=g[l].x;ja=g[l].y;f=1;
ya=Ya(g,l,Ua);C=180-360/Math.abs(a);t||(C*=-1,c*=-1)}b=ha(ya-C);e=l;for(t=0;t<A-1;t++)f=na*Math.cos(Math.PI*b/180),l=-1*na*Math.sin(Math.PI*b/180),Gc=Da+f,Hc=ja+l,Da=ug(g,"C",Gc,Hc,!1),0>Da&&(Da=Math.abs(Da)),f=-6===a?t%2+1:1,Ye(g,Z,e,Da,f),e=Da,b=ha(b+c),Da=Gc,ja=Hc;Ye(g,Z,e,Ua,-6===a&&1===f?2:1);Ng=!1}function lm(a,b,c,e,l){var f;var t=1;ha(e+t*l*30);ha(e+t*l*30);if(ci)var r=hb;else if(r=ug(g,"C",b,c,!1),0< !r)return;b=g[r].x;c=g[r].y;Pd=b;Qd=c;for(f=0;f<a-1;f++){t=0===f%2?1:-1;var w=na*Math.cos(Math.PI*
ha(e+t*l*30)/180);t=-na*Math.sin(Math.PI*ha(e+t*l*30)/180);b+=w;c+=t;t=ug(g,"C",b,c,!1);0>t&&(t=Math.abs(t));Ye(g,Z,r,t,1);r=t;Pd=b;Qd=c}}function mm(a){var b,c=-1;if(!1===Ig){var e=Aa[0].x;var l=Aa[0].y;var f=ug(g,"C",e,l,!1);0>f&&(f=Math.abs(f));0<=Kg&&0===Kg&&(c=f)}else f=hb;e=g[f].x;l=g[f].y;Pd=e;Qd=l;for(b=1;b<a;b++){e=Aa[b].x;l=Aa[b].y;var t=ug(g,"C",e,l,!1);0>t&&(t=Math.abs(t));0<=Kg&&b===Kg&&(c=t);Ye(g,Z,f,t,1);f=t;Pd=e;Qd=l}0<hi&&(t=hi,Ye(g,Z,f,t,1),hi=0);0<=c&&Ye(g,Z,f,c,1)}function Oj(a){var b,
c=0;for(b=1;b<g.length;)g[b].v===a&&(c=g[b].t,ki(g,Z,b,!0),b--),b++;for(b=1;b<g.length;)g[b].t>c&&--g[b].t,b++;if(0<pa.length)for(b=0;b<pa.length;b++)if(1===pa[b].M.length&&pa[b].M[0]===c||1===pa[b].L.length&&pa[b].L[0]===c)Yg(b),b--;else{pa[b].M.includes(c)&&pa[b].M.splice(pa[b].M.indexOf(c),1);pa[b].L.includes(c)&&pa[b].L.splice(pa[b].L.indexOf(c),1);for(a=0;a<pa[b].M.length;a++)pa[b].M[a]>c&&--pa[b].M[a];for(a=0;a<pa[b].L.length;a++)pa[b].L[a]>c&&--pa[b].L[a]}if(0<pa.length)for(b=0;b<pa.length;b++)pl(b);
Md();Yc();ed();Kb();vb(Ga,0,!0)}function Yg(a){var b,c;if(void 0!==pa[a]){for(b=1;b<g.length;b++)g[b].za.includes(a)&&g[b].za.splice(g[b].za.indexOf(a),1),g[b].ya.includes(a)&&g[b].ya.splice(g[b].ya.indexOf(a),1);for(b=1;b<g.length;b++){for(c=0;c<g[b].za.length;c++)g[b].za[c]>a&&--g[b].za[c];for(c=0;c<g[b].ya.length;c++)g[b].ya[c]>a&&--g[b].ya[c]}pa.splice(a,1)}}function Cl(a){na*=a;L=Math.floor(6+8/30*(na-15));si=5+(na-15)/5;$a=na/5;fk=da?ua?na/2:2*$a:$a+4;Kc=da?2*$a:$a+4;jl=na/10;bl=na/10;zi=na/
5;Xi=da?ua?na/3:2*zi:zi+2;gl=.86603*na;xi=Math.round(150*na/24)/100;zl=6*xi;Ae=30<na?2:1.5}function kl(a){var b=na,c=5*Math.floor(na/5);new yd(0,0,0,0);Md();if(!(2>g.length)){"in"===a?(b=c+5,50<b&&(b=50)):"out"===a&&(b=c-5,20>b&&(b=20));a=b/na;if(1<a){for(Bf=1;Bf<g.length;Bf++)g[Bf].v=9;b=Fd(g,9,"s");for(Bf=1;Bf<g.length;Bf++)g[Bf].v=0;if(a*b.c>za.c||a*b.h>za.h)return}Cl(a);Ga.save();Ga.fillStyle="white";Ga.fillRect(Gd.x+16,Gd.y-6,20,12);Ga.font="10pt Sans-Serif";Ga.fillStyle="black";Ga.fillText(String(Math.round(na)),
(Gd.x+ye.x)/2-6,Gd.y+6);Ga.restore();new yd(0,0,0,0);for(b=1;b<g.length;b++)g[b].v=9;b=Fd(g,9,"s");Ai(g,ra.b+ra.c/2-(b.b+b.c/2),ra.t+ra.h/2-(b.t+b.h/2),9);0<pa.length&&(Dl(pa,ra.b+ra.c/2-(b.b+b.c/2),ra.t+ra.h/2-(b.t+b.h/2)),El(ra.b+ra.c/2-(b.b+b.c/2),ra.t+ra.h/2-(b.t+b.h/2)));sl(g,9,ra.b+ra.c/2,ra.t+ra.h/2,a,!1);0<pa.length&&(tl(pa,ra.b+ra.c/2,ra.t+ra.h/2,a),ul(sb,ra.b+ra.c/2,ra.t+ra.h/2,a));Yc();vb(Ga,0,!0);$f(Ga);vb(Ga,0,!0)}}function ed(){tf=pk();qk();Fl()}function Fl(){var a,b=g,c=Z,e=Na,l=pa,
f=new Gl;var t=f.na;var r=f.Za;var w=f.Ya;var A=f.hb;t.length=1;r.length=1;w.length=0;A.length=0;for(a=1;a<b.length;a++)qi(b,t,a,a);for(a=1;a<c.length;a++)ri(c,r,a,a);for(a=0;a<e.length;a++)rk(e,w,a,a);for(a=0;a<l.length;a++)lj(l,A,a,a);f.aa=tf;f.A=Lh.length+1;f.Ja=Xb;f.Wa=Je;f.Xa=be;Lh.push(f)}function Hl(){new Gl;var a;if(!(2>Lh.length)){Lh.pop();var b=Lh[Lh.length-1];var c=b.na;var e=b.Za;var l=b.Ya;var f=b.hb;var t=g;var r=Z;var w=Na;var A=pa;t.length=1;r.length=1;w.length=0;A.length=0;for(a=
1;a<c.length;a++)qi(c,t,a,a);for(a=1;a<e.length;a++)ri(e,r,a,a);for(a=0;a<l.length;a++)rk(l,w,a,a);for(a=0;a<f.length;a++)lj(f,A,a,a);10===b.Ja?Xb=0:Xb=b.Ja;Je=b.Wa;be=b.Xa;kh(be)}}function Pj(){Hl();qd(Xb);td(Je);vb(Ga,0,!0)}function Gl(){this.na=[zm];this.Za=[Am];this.Ya=[];this.hb=[];this.Wa=this.Ja=this.aa=this.A=0;this.Xa="X"}function Ui(){g.length=1;M.length=1;cg.length=1;ef.length=1;Ac.length=0;Z.length=1;Ha.length=1;Bi.length=1;ff.length=1;ud.length=1;ud=[new sk(0,0)];Na=[];oc=[];pa=[];gf=
[];hf=[];Rc=[];ne=[];lh=[];tk=[];qb=[];Le=[];Pg={};dg=[];jf=[];Ze=[];sd=[];md=[];sb=[];df=[];eg=[];Bc={};He=[];rd=[];se=[];Hd=[];cb=[];Fa=[];Lg=[];Vc=[];nc=[];lc=[];Lc=[];Ci=tf=0;Ng=Ah=sf=ik=Mh=!1}function Yc(){var a;for(a=0;a<g.length;a++)g[a].v=0;Vc=[];Lg=[];ze=!1}function Il(){var a,b;for(a=0;a<g.length;a++)g[a].t=0;var c=1;for(b=0;0<c;){c=0;for(a=1;a<g.length;a++)if(0===g[a].t){c=a;break}if(0===c)break;lc=[];var e=Ih(g,c);for(a=0;a<e;a++)g[lc[a]].t=b;b++}return b-1}function ch(a,b){var c,e;if(0===
a.length)return-1;for(c=0;c<a.length;c++)for(e=1;e<g.length;e++)g[e].t===a[c]&&g[e].v!==b&&(g[e].v=b)}function Fd(a,b,c){var e,l=0,f=0,t=0,r=0,w=-1E4,A=-1E4,C=1E4,ya=1E4;if(0<b)for(e=1;e<g.length;e++){var Da="t"===c?g[e].t:g[e].v;Da===b&&(a[e].x>w&&(w=a[e].x,t=e),a[e].y>A&&(A=a[e].y),a[e].x<C&&(C=a[e].x,r=e),a[e].y<ya&&(ya=a[e].y))}else for(e=1;e<g.length;e++)a[e].x>w&&(w=a[e].x,t=e),a[e].y>A&&(A=a[e].y),a[e].x<C&&(C=a[e].x,r=e),a[e].y<ya&&(ya=a[e].y);0<r&&0<t&&(l=jk(a,r)+kk(a,r),f=jk(a,t)+kk(a,t));
a=si*l.length+8;return new yd(C-a,ya-3*L/2-4,w-C+a+(si*f.length+2)+4,A-ya+3*L/2+18)}function pk(){var a;sd=[new yd(0,0,0,0)];if(1!==g.length){var b=Il();for(a=1;a<=b;a++)sd.push(Fd(g,a,"t"));return b}}function qk(){var a;if(0===Rc.length)return-1;sb=[];for(a=0;a<Rc.length;a++)ch(Rc[a].ia,800),sb.push(Fd(g,800,"s")),Yc()}function mj(){var a;md=[];for(a=0;a<hf.length;a++)ch(hf[a],700),md.push(Fd(g,700,"s")),Yc()}function mi(a){var b;if(""===a||void 0===a)return-1;if("C:"===a)return 6;if("N:"===a)return 7;
for(b=0;b<Og.length;b++)if(Og[b]===a)return b+1;return null!==a.match(Bm)?0:-1}function Jc(a,b,c){return b>a.b&&b<a.b+a.c&&c>a.t&&c<a.t+a.h?!0:!1}function Yd(a,b,c,e){var l;for(l=1;l<a.length;l++){var f=Math.sqrt((c-a[l].x)*(c-a[l].x)+(e-a[l].y)*(e-a[l].y));if(f<=$a)return l}for(l=1;l<b.length;l++){var t=b[l].f;var r=b[l].g;f=(a[t].x+a[r].x)/2;t=(a[t].y+a[r].y)/2;f=Math.sqrt((c-f)*(c-f)+(e-t)*(e-t));if(f<=$a)return-l}return 0}function oi(a,b,c){var e;for(e=0;e<a[b].a.length;e++)if(a[b].a[e].p===c)return e;
return-1}function Jl(a){var b,c=0;for(b=0;b<g[a].a.length;b++){var e=g[a].a[b].t;if(4===e||5===e)e=1;c+=e}return c}function jk(a,b){var c;var e="";if(sf)return e=String(b);if(Ah)return e=String(a[b].U);if(!(c="C"!==a[b].o||a[b].a.length===a[b].C)){var l;for(l=c=0;c<a[b].a.length;)2===a[b].a[c].t&&l++,c++;c=2===l?!0:!1}if(c||"C"===a[b].o&&0<a[b].N)e=a[b].o;if("C"!==a[b].o&&"H"!==a[b].o&&0<Cf[a[b].j]||"C"===a[b].o&&a[b].a.length===a[b].C)c=uk(a,b,!1),0<c&&(a=Hh(a,b),90<a&&270>a?(1<c&&(e=String(c)+e),
e="H"+e):(e+="H",1<c&&(e+=String(c))));return e}function uk(a,b,c){var e=0,l;if("H"!==a[b].o&&0<Cf[a[b].j]){var f=Cf[a[b].j];ek.includes(a[b].o)&&(f-=2);c=c?a[b].C:0;for(l=0;l<a[b].a.length;l++){e=a[b].a[l].t;if(4===e||5===e)e=1;c+=e}e=f-c+a[b].s;if(Cm.includes(a[b].o)||"C"===a[b].o&&0<a[b].s)e=f-c-a[b].s;a[b].r&&e--}return Math.max(e,0)}function kk(a,b){var c="";1<Math.abs(a[b].s)&&(c+=String(Math.abs(a[b].s)));0<a[b].s?c+="+":0>a[b].s&&(c+="\u2013");return c}function Zj(a,b,c,e){a=new $c(0,0);var l=
new $c(0,0);var f=4*$a;var t=c.b+c.c/2,r=c.t+c.h/2,w=e.b+e.c/2,A=e.t+e.h/2,C=Math.sqrt((w-t)*(w-t)+(A-r)*(A-r)),ya=c.c/1.6,Da=c.h/1.6,ja=e.c/1.6,Ua=e.h/1.6,ta=c=0;e=ld(t,r,w,A);ya=ya*Da/Math.sqrt(ya*ya*Math.sin(Math.PI*e/180)*Math.sin(Math.PI*e/180)+Da*Da*Math.cos(Math.PI*e/180)*Math.cos(Math.PI*e/180));ja=ja*Ua/Math.sqrt(ja*ja*Math.sin(Math.PI*e/180)*Math.sin(Math.PI*e/180)+Ua*Ua*Math.cos(Math.PI*e/180)*Math.cos(Math.PI*e/180));if(C-ya-ja<f)for(0<C-ya-ja&&(c=1.05*Math.abs(f+ya+ja-C)*Math.cos(Math.PI*
e/180),ta=-1.05*Math.abs(f+ya+ja-C)*Math.sin(Math.PI*e/180)),f=0;f<b.length;f++)Nh(g,c,ta,b[f]);a.x=t+ya*Math.cos(Math.PI*e/180);a.y=r-ya*Math.sin(Math.PI*e/180);l.x=w-ja*Math.cos(Math.PI*e/180)+c;l.y=A+ja*Math.sin(Math.PI*e/180)+ta;Math.sqrt((l.x-t)*(l.x-t)+(l.y-r)*(l.y-r))<Math.sqrt((a.x-t)*(a.x-t)+(a.y-r)*(a.y-r))&&(b=a.x,a.x=l.x,l.x=b,b=a.y,a.y=l.y,l.y=b);re.push(a.x,a.y,l.x,l.y)}function Nh(a,b,c,e){var l;for(l=1;l<a.length;l++)a[l].t===e&&(a[l].x+=b,a[l].y+=c)}function Ye(a,b,c,e,l){var f;if(!(c>=
a.length||e>=a.length)&&c!==e){for(f=1;f<b.length;f++)if(b[f].f===c&&b[f].g===e||b[f].f===e&&b[f].g===c)return;var t=l;if(Ng){f=Jl(c);var r=Jl(e);if(4<f+l&&"C"===a[c].o||4<r+l&&"C"===a[e].o)t=1}4===t&&"H"===a[c].o?(l=c,c=e,e=l,t=5):5===t&&"H"===a[c].o&&(l=c,c=e,e=l,t=4);b[b.length]=new De(c,e,t);4===t&&(a[e].z=1);5===t&&(a[e].z=-1);a[c].a.push(new vk(e,t));a[e].a.push(new vk(c,t));a===g&&(Nf(a,c),Nf(a,e))}}function ki(a,b,c,e){function l(r,w){var A;for(A=0;A<r.length;A++)0>r[A].G&&Number.isInteger(r[A].G)&&
-1*r[A].G>w&&(r[A].G+=1),0>r[A].K&&Number.isInteger(r[A].K)&&-1*r[A].K>w&&(r[A].K+=1)}var f;var t=!1;if(2===a.length&&a===g)a.splice(1,1);else{if(e)for(f=0;f<Na.length;f++){t=!1;if(Na[f].G===c||Na[f].K===c)t=!0;0>Na[f].G&&Number.isInteger(Na[f].G)&&(b[-1*Na[f].G].f===c||b[-1*Na[f].G].g===c)&&(t=!0);0>Na[f].K&&Number.isInteger(Na[f].K)&&(b[-1*Na[f].K].f===c||b[-1*Na[f].K].g===c)&&(t=!0);t&&(hj(f),f--)}for(f=1;f<b.length;f++)if(b[f].f===c||b[f].g===c){if(e){for(t=0;t<Na.length;t++)Na[t].G!==-1*f&&Na[t].G!==
-1*f||hj(t);l(Na,f)}else b===ff&&0<oc.length&&l(oc,f);b.splice(f,1);f--}for(f=1;f<b.length;f++)b[f].f>c&&--b[f].f,b[f].g>c&&--b[f].g;for(f=1;f<a.length;f++)if(f!==c)for(t=0;t<a[f].a.length;t++)a[f].a[t].p===c&&(1===a[c].j&&a===g&&(0===a[c].N?--a[f].C:2===a[c].N?--a[f].D:3===a[c].N&&--a[f].F),a[f].a.splice(t,1));for(f=1;f<a.length;f++)for(t=0;t<a[f].a.length;t++)f!==c&&a[f].a[t].p>c&&--a[f].a[t].p;if(e)for(f=0;f<Na.length;f++)Na[f].G>c&&--Na[f].G,Na[f].K>c&&--Na[f].K;else if(b===ff&&0<oc.length)for(f=
0;f<oc.length;f++)oc[f].G>c&&--oc[f].G,oc[f].K>c&&--oc[f].K;a.splice(c,1);e&&vb(Ga,0,!0)}}function Of(a,b,c,e,l){var f=0;var t=oi(a,c,e);var r=oi(a,e,c);if(0<=t&&0<=r){var w=a[c].a[t].t;var A=a[e].a[r].t;if(w===A){switch(l){case "+":if(1===w||2===w)f=w+1;else if(4===w||5===w)f=2;break;case "-":if(2===w||3===w)f=w-1}if(0<f)for(a[c].a[t].t=f,a[e].a[r].t=f,a=1;a<b.length;a++)0!==b[a].B&&(b[a].f===c&&b[a].g===e||b[a].g===c&&b[a].f===e)&&(b[a].B=f)}}}function ad(a,b,c,e,l){var f,t;var r=b[c].f;var w=b[c].g;
var A=b[c].B;if((4===A||5===A)&&-1===e){if("H"!==a[w].o){for(l=t=f=0;l<a[r].a.length;){if(4===a[r].a[l].t||5===a[r].a[l].t){var C=Ia(b,r,a[r].a[l].p);b[C].g===r&&(f++,4===a[r].a[l].t?t++:5===a[r].a[l].t&&t--)}l++}if(!(0<f&&Math.abs(t)!==f||0<t&&5===A||0>t&&4===A)){for(l=t=f=0;l<a[w].a.length;){if(4===a[w].a[l].t||5===a[w].a[l].t)C=Ia(b,w,a[w].a[l].p),b[C].g===w&&(f++,4===a[w].a[l].t?t++:5===a[w].a[l].t&&t--);l++}2>f&&(4===A||5===A)&&(a[w].z=0);e=r;r=w;w=e;a[w].z=4===b[c].B?1:-1;b[c].f=r;b[c].g=w}}}else if(A!==
e){if(!0===l){for(l=t=f=0;l<a[w].a.length;){if(4===a[w].a[l].t||5===a[w].a[l].t)C=Ia(b,w,a[w].a[l].p),b[C].g===w&&(f++,4===a[w].a[l].t?t++:5===a[w].a[l].t&&t--);l++}if(Math.abs(t)!==f||1<f&&(4===A&&5===e||5===A&&4===e)||1<f&&(0<t&&5===e||0>t&&4===e))return}4===e&&(a[w].z=1);5===e&&(a[w].z=-1);1===e&&2>f&&(a[w].z=0);b[c].B=e;for(l=0;l<a[r].a.length;)a[r].a[l].p===w&&(a[r].a[l].t=e),l++;for(l=0;l<a[w].a.length;)a[w].a[l].p===r&&(a[w].a[l].t=e),l++}}function rm(a,b,c){var e=c.slice(0);e.push(c[0]);for(c=
0;c<e.length-1;c++)2===b[Ia(b,e[c],e[c+1])].B?Of(a,b,e[c],e[c+1],"-"):1===b[Ia(b,e[c],e[c+1])].B&&Of(a,b,e[c],e[c+1],"+")}function Dm(a,b,c,e,l,f,t){var r;var w=[];var A=[];var C=a.length;var ya=b.length;for(r=1;r<C;r++)if(-1===l||a[r].v===l){var Da=c.length;qi(a,c,r,Da);w.push(r);A.push(Da);c[Da].x=a[r].x+f;c[Da].y=a[r].y+t;-1<l&&(c[Da].t=l)}for(r=1;r<C;r++)if(-1===l||a[r].v===l){for(f=0;f<a[r].a.length;f++)t=a[r].a[f].p,Da=w.indexOf(t),t=w.indexOf(r),-1<Da&&-1<t&&(Da=A[Da],c[A[t]].a[f].p=Da);for(f=
1;f<ya;f++)if(b[f].f===r){var ja=e.length;ri(b,e,f,ja);t=w.indexOf(r);e[ja].f=A[t];Da=w.indexOf(b[f].g);-1<Da&&-1<t&&(e[ja].g=A[Da])}}}function hj(a){void 0!==Na[a]&&Na.splice(a,1)}function tg(a,b,c,e,l){var f=b[c].g,t=b[c].f;Eh(a,b);if(!me(b,b[c].f,b[c].g)&&2!==b[c].B&&3!==b[c].B){Oh(a,f,t);var r=lc.slice(0);var w=r.length;Oh(a,t,f);var A=lc.slice(0);f=A.length;f<w?(f=b[c].f,t=b[c].g,lc=A.slice(0)):(f=b[c].g,t=b[c].f,lc=r.slice(0));for(c=1;c<a.length;c++)a[c].v=0;for(c=1;c<lc.length;c++)a[lc[c]].v=
1;w=a[f].x;r=a[f].y;c=ha(e*Ya(a,f,t));nj(a,1,-1*w,-1*r,!1);Ph(a,1,a[f].x,a[f].y,e*c,!1);t=Ia(b,f,t);var C;for(A=1;A<a.length;A++)if(1===a[A].v&&(/x/.test("y")?a[A].x=-1*a[A].x:/y/.test("y")&&(a[A].y=-1*a[A].y),0!==a[A].z))for(C=0;C<a[A].a.length;C++)Ia(b,A,a[A].a[C].p)!==t&&(4===a[A].a[C].t?ad(a,b,Ia(b,A,a[A].a[C].p),5,!1):5===a[A].a[C].t&&ad(a,b,Ia(b,A,a[A].a[C].p),4,!1));Ph(a,1,a[f].x,a[f].y,-1*e*c,!1);nj(a,1,w,r,!1);for(a=1;a<g.length;a++)1===g[a].v&&Nf(g,a);l&&Yc()}}function Ai(a,b,c,e){var l;
for(l=1;l<a.length;l++)if(-1===e||a[l].v===e)a[l].x+=b,a[l].y+=c}function Dl(a,b,c){var e;for(e=0;e<a.length;e++)a[e].W.x+=b,a[e].W.y+=c,a[e].V.x+=b,a[e].V.y+=c}function El(a,b){if(0===sb.length)return-1;var c;for(c=0;c<sb.length;c++)sb[c].b+=a,sb[c].t+=b}function Bl(){var a;new yd(0,0,0,0);var b=na;for(a=1;a<g.length;a++)g[a].v=9;var c=Fd(g,9,"s");Ai(g,ra.b+ra.c/2-(c.b+c.c/2),ra.t+ra.h/2-(c.t+c.h/2),9);0<pa.length&&(Dl(pa,ra.b+ra.c/2-(c.b+c.c/2),ra.t+ra.h/2-(c.t+c.h/2)),El(ra.b+ra.c/2-(c.b+c.c/2),
ra.t+ra.h/2-(c.t+c.h/2)));a=c.c/ra.c;c=c.h/ra.h;if(1<a||1<c)a=1/(1.1*Math.max(a,c)),a=5*Math.floor(b*a/5),a/=b,sl(g,9,ra.b+ra.c/2,ra.t+ra.h/2,a,!1),Cl(a),L=Math.floor(6+8/30*(na-15)),Ga.save(),Ga.fillStyle="white",Ga.fillRect(Gd.x+16,Gd.y-6,20,12),Ga.font="10pt Sans-Serif",Ga.fillStyle="black",Ga.fillText(String(Math.round(na)),(Gd.x+ye.x)/2-6,Gd.y+6),Ga.restore(),0<pa.length&&(tl(pa,ra.b+ra.c/2,ra.t+ra.h/2,a),ul(sb,ra.b+ra.c/2,ra.t+ra.h/2,a));Yc()}function qi(a,b,c,e){new kb(0,"",0,0,0,0,0);var l=
new kb(0,"",0,0,0,0,0);c=a[c];l.v=c.v;l.Ca=c.Ca;l.j=c.j;l.o=c.o;l.N=c.N;l.x=c.x;l.y=c.y;l.s=c.s;l.C=c.C;l.Fa=c.Fa;l.Ga=c.Ga;l.ja=c.ja;l.D=c.D;l.wa=c.wa;l.xa=c.xa;l.ma=c.ma;l.F=c.F;l.Da=c.Da;l.ca=c.ca;l.tz=c.tz;l.z=c.z;l.r=c.r;l.U=c.U;l.X=c.X;l.I=c.I;l.H=c.H;l.t=c.t;l.za=c.za.slice(0);l.ya=c.ya.slice(0);for(a=0;a<c.a.length;a++)l.a.push(new vk(c.a[a].p,c.a[a].t));b[e]=l}function ri(a,b,c,e){new De(0,0,0);var l=new De(0,0,0);a=a[c];l.v=a.v;l.gb=a.gb;l.f=a.f;l.g=a.g;l.B=a.B;b[e]=l}function rk(a,b,c,
e){new jj(0,0,"",0);var l=new jj(0,0,"",0);a=a[c];l.G=a.G;l.K=a.K;l.ca=a.ca;l.crv=a.crv;b[e]=l}function lj(a,b,c,e){new ij([],[],0,"","",0,0,0,0);var l=new ij([],[],0,"","",0,0,0,0);a=a[c];l.M=a.M.slice(0);l.L=a.L.slice(0);l.ca=a.ca;l.na=a.na;l.Aa=a.Aa;l.W.x=a.W.x;l.W.y=a.W.y;l.V.x=a.V.x;l.V.y=a.V.y;b[e]=l}function wk(a,b,c,e){var l;b.length=1;for(l=e.length=1;l<a.length;l++)qi(a,b,l,l);for(l=1;l<c.length;l++)ri(c,e,l,l)}function Kl(a){var b,c,e,l=[];dg=[];eg=[];jf=[];for(b=1;b<a.length;b++)if("C"===
a[b].o||2===a[b].a.length){for(c=e=0;c<a[b].a.length;c++)2===a[b].a[c].t&&e++;2==e&&l.push(b)}for(b=0;b<l.length;b++)if(!dg.includes(l[b])){c=Ll(a,l[b]);if(1===a[c.u].a.length||1===a[c.l].a.length)if(1===a[c.u].a.length&&0===a[c.u].D&&0===a[c.u].F||1===a[c.l].a.length&&0===a[c.l].D&&0===a[c.l].F)continue;0===c.n%2?jf.push(c):eg.push(c)}}function Ll(a,b){var c,e=-1,l=-1,f=new oj(0,0,0,0);var t=[];var r=b;t.push(r);for(c=0;0>e&&20>=c;){var w=!1;for(b=0;b<a[r].a.length;b++)if(2===a[r].a[b].t&&!t.includes(a[r].a[b].p)){r=
a[r].a[b].p;t.push(r);w=!0;break}!1===w&&(e=r);c++}t=[];r=e;t.push(r);dg.push(r);for(c=0;0>l&&20>=c;){w=!1;for(b=0;b<a[r].a.length;b++)if(2===a[r].a[b].t&&!t.includes(a[r].a[b].p)){r=a[r].a[b].p;t.push(r);dg.push(r);w=!0;break}!1===w&&(l=r);c++}a=t.length;1!==a%2?f.s=0:(b=Math.floor(a/2),f.s=t[b]);f.u=e;f.l=l;f.n=a;return f}function xk(a,b,c,e){var l,f=new oj(0,0,0,0),t=0;var r=[];var w=[],A=0,C=0,ya=0,Da=0,ja=0,Ua=0,ta=0,xb=0,Ta=0,Ka=0,Pc=0,ec=0,Ub=0,Ad=0,Sb=0,Rb=0,Mc=0,tb=0,mc=0,Za=0,Lb=0,sc=0,
zd="";f.s=c.s;f.u=c.u;f.l=c.l;f.n=c.n;var Cc=a[f.u].x-a[f.s].x;var Yb=a[f.u].y-a[f.s].y;var bd=a[f.l].x-a[f.s].x;var pc=a[f.l].y-a[f.s].y;c=[];var oa=[];var te=[];var mh=[];var Vb=[];var Ld=[];for(l=0;l<a[f.u].a.length;l++){if(0!==a[f.u].z&&3<a[f.u].a[l].t){var Ee=Ia(b,f.u,a[f.u].a[l].p);b[Ee].g===f.u&&mh.push(a[f.u].a[l].p)}a[f.u].a[l].p===Ze[f.u]?2!==a[f.u].a[l].t&&(t=1,c.push(a[f.u].a[l].p)):2!==a[f.u].a[l].t&&c.push(a[f.u].a[l].p);2===a[f.u].a[l].t&&(Za=a[f.u].a[l].p);(Hd.includes(String(f.u)+
":"+String(a[f.u].a[l].p))||Hd.includes(String(a[f.u].a[l].p)+":"+String(f.u)))&&r.push(a[f.u].a[l].p)}for(l=0;l<a[f.l].a.length;l++)0!==a[a[f.l].a[l].p].z&&te.push(a[f.l].a[l].p),a[f.l].a[l].p===Ze[f.l]?2!==a[f.l].a[l].t&&(t=2,oa.push(a[f.l].a[l].p)):2!==a[f.l].a[l].t&&oa.push(a[f.l].a[l].p),2===a[f.l].a[l].t&&(mc=a[f.l].a[l].p),(Hd.includes(String(f.l)+":"+String(a[f.l].a[l].p))||Hd.includes(String(a[f.l].a[l].p)+":"+String(f.l)))&&w.push(a[f.l].a[l].p);2>c.length&&(1===a[f.u].F&&"gen"===e&&(Ub=
a[f.u].Da,Ad=a[f.u].ca,Sb=a[f.u].tz,c.unshift(-3)),1===a[f.u].D&&"gen"===e&&(ta=a[f.u].wa,xb=a[f.u].xa,Ta=a[f.u].ma,c.unshift(-2)),1===a[f.u].C&&(A=a[f.u].Fa,C=a[f.u].Ga,ya=a[f.u].ja,c.unshift(-1)),2>c.length&&(0<c[0]?(Lb=(a[Za].x+a[c[0]].x)/2,sc=(a[Za].y+a[c[0]].y)/2,ya=-1*a[c[0]].z):-2===c[0]?(Lb=(a[Za].x+ta)/2,sc=(a[Za].y+xb)/2,ya=-1*Ta):-3===c[0]&&(Lb=(a[Za].x+Ub)/2,sc=(a[Za].y+Ad)/2,ya=-1*Sb),b=a[f.u].x-Lb,Za=a[f.u].y-sc,l=Math.sqrt(b*b+Za*Za),A=a[f.u].x+na*b/l,C=a[f.u].y+na*Za/l,c.unshift(-1)));
2>oa.length&&(1===a[f.l].F&&(Rb=a[f.l].Da,Mc=a[f.l].ca,tb=a[f.l].tz,oa.unshift(-3)),1===a[f.l].D&&(Ka=a[f.l].wa,Pc=a[f.l].xa,ec=a[f.l].ma,oa.unshift(-2)),1===a[f.l].C&&(Da=a[f.l].Fa,ja=a[f.l].Ga,Ua=a[f.l].ja,oa.unshift(-1)),2>oa.length&&(0<oa[0]?(Lb=(a[mc].x+a[oa[0]].x)/2,sc=(a[mc].y+a[oa[0]].y)/2,Ua=-1*a[oa[0]].z):-2===oa[0]?(Lb=(a[mc].x+Ka)/2,sc=(a[mc].y+Pc)/2,Ua=-1*ec):-3===oa[0]&&(Lb=(a[mc].x+Rb)/2,sc=(a[mc].y+Mc)/2,Ua=-1*tb),b=a[f.l].x-Lb,Za=a[f.l].y-sc,l=Math.sqrt(b*b+Za*Za),Da=a[f.l].x+na*
b/l,ja=a[f.l].y+na*Za/l,oa.unshift(-1)));1<oa.length&&w.includes(oa[1])&&oa.reverse();Ac=[];Ac[0]=new kb(a[f.s].j,a[f.s].o,a[f.s].x,a[f.s].y,0,0,0);Vb.push(f.s);if(0===t)c.includes(-1)&&(Ac.push(new kb(1,"H",A-Cc,C-Yb,0,0,ya)),Vb.push(-1),Ld.push(Ac.length-1)),c.includes(-2)&&(Ac.push(new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta)),Vb.push(-2),Ld.push(Ac.length-1)),c.includes(-3)&&(Ac.push(new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb)),Vb.push(-3),Ld.push(Ac.length-1)),oa.includes(-1)&&(Ac.push(new kb(1,"H",Da-bd,ja-pc,0,0,
Ua)),Vb.push(-1)),oa.includes(-2)&&(Ac.push(new kb(1,"H",Ka-bd,Pc-pc,0,0,ec)),Vb.push(-2)),oa.includes(-3)&&(Ac.push(new kb(1,"H",Rb-bd,Mc-Yb,0,0,tb)),Vb.push(-3));else if(1===t)if(c[0]===Ze[f.u]?(Ac[1]=new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Cc,a[c[0]].y-Yb,0,0,a[c[0]].z),Vb.push(c[0]),Ld.push(1),-1!==c[1]?(Ac[2]=new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Cc,a[c[1]].y-Yb,0,0,a[c[1]].z),Vb.push(c[1])):(Ac[2]=new kb(1,"H",A-Cc,C-Yb,0,0,ya),Vb.push(-1))):(Ac[1]=new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Cc,a[c[1]].y-
Yb,0,0,a[c[1]].z),Vb.push(c[1]),Ld.push(1),-1!==c[0]?(Ac[2]=-2===c[0]?new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta):-3===c[0]?new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb):new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Cc,a[c[0]].y-Yb,0,0,a[c[0]].z),Vb.push(c[0])):(Ac[2]=new kb(1,"H",A-Cc,C-Yb,0,0,ya),Vb.push(-1))),Ld.push(2),-1===oa[0])Ac[3]=new kb(1,"H",Da-bd,ja-pc,0,0,Ua),Vb.push(-1),Ac[4]=-2===oa[1]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[1]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-bd,a[oa[1]].y-
pc,0,0,a[oa[1]].z),Vb.push(oa[1]);else if("parse"===e?(t=Math.min(oa[0],oa[1]),A=Math.max(oa[0],oa[1])):(t=nc.indexOf(oa[0]),A=nc.indexOf(oa[1])),t<A||w.includes(oa[0])||t===A)Ac[3]=-2===oa[0]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[0]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-bd,a[oa[0]].y-pc,0,0,a[oa[0]].z),Vb.push(oa[0]),Ac[4]=-2===oa[1]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[1]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-bd,a[oa[1]].y-
pc,0,0,a[oa[1]].z),Vb.push(oa[1]);else{if(t>A||w.includes(oa[1]))Ac[3]=-2===oa[1]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[1]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-bd,a[oa[1]].y-pc,0,0,a[oa[1]].z),Vb.push(oa[1]),Ac[4]=-2===oa[0]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[0]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-bd,a[oa[0]].y-pc,0,0,a[oa[0]].z),Vb.push(oa[0])}else if(2===t)if(oa[0]===Ze[f.l]?(Ac[1]=new kb(a[oa[0]].j,a[oa[0]].o,a[oa[0]].x-
bd,a[oa[0]].y-pc,0,0,a[oa[0]].z),Vb.push(oa[0]),-1!==oa[1]?(Ac[2]=-2===oa[1]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[1]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-bd,a[oa[1]].y-pc,0,0,a[oa[1]].z),Vb.push(oa[1])):(Ac[2]=new kb(1,"H",Da,ja,0,0,Ua),Vb.push(-1))):(Ac[1]=new kb(a[oa[1]].j,a[oa[1]].o,a[oa[1]].x-bd,a[oa[1]].y-pc,0,0,a[oa[1]].z),Vb.push(oa[1]),-1!==oa[0]?(Ac[2]=-2===oa[0]?new kb(1,"H",Ka-bd,Pc-pc,0,0,ec):-3===oa[0]?new kb(1,"H",Rb-bd,Mc-pc,0,0,tb):new kb(a[oa[0]].j,
a[oa[0]].o,a[oa[0]].x-bd,a[oa[0]].y-pc,0,0,a[oa[0]].z),Vb.push(oa[0])):(Ac[2]=new kb(1,"H",Da-bd,ja-pc,0,0,Ua),Vb.push(-1))),-1===c[0])Ac[3]=new kb(1,"H",A-Cc,C-Yb,0,0,ya),Vb.push(-1),Ld.push(3),Ac[4]=-2===c[1]?new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta):-3===c[1]?new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb):new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Cc,a[c[1]].y-Yb,0,0,a[c[1]].z),Vb.push(c[1]),Ld.push(4);else if("parse"===e?(t=Math.min(c[0],c[1]),A=Math.max(c[0],c[1])):(t=nc.indexOf(c[0]),A=nc.indexOf(c[1])),t<A||r.includes(c[0])||
t===A)Ac[3]=-2===c[0]?new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta):-3===c[0]?new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb):new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Cc,a[c[0]].y-Yb,0,0,a[c[0]].z),Vb.push(c[0]),Ld.push(3),Ac[4]=-2===c[1]?new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta):-3===c[1]?new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb):new kb(a[c[1]].j,a[c[1]].o,a[c[1]].x-Cc,a[c[1]].y-Yb,0,0,a[c[1]].z),Vb.push(c[1]),Ld.push(4);else if(t>A||r.includes(c[1]))Ac[3]=-2===c[1]?new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta):-3===c[1]?new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb):new kb(a[c[1]].j,
a[c[1]].o,a[c[1]].x-Cc,a[c[1]].y-Yb,0,0,a[c[1]].z),Vb.push(c[1]),Ld.push(3),Ac[4]=-2===c[0]?new kb(1,"H",ta-Cc,xb-Yb,0,0,Ta):-3===c[0]?new kb(1,"H",Ub-Cc,Ad-Yb,0,0,Sb):new kb(a[c[0]].j,a[c[0]].o,a[c[0]].x-Cc,a[c[0]].y-Yb,0,0,a[c[0]].z),Vb.push(c[0]),Ld.push(4);if("gen"===e){for(l=1;l<Vb.length;l++)te.includes(Vb[l])&&(Ac[l].z=0);for(l=1;l<Vb.length;l++)mh.includes(Vb[l])&&(Ac[l].z=-1*a[f.u].z);if(Ac[Ld[0]].z===Ac[Ld[1]].z){Lc.push(Vb[0]);return}}r=Ml(Ac,Z,[0,1,2,3,4],[0,0,0,0,0],[0,0,0,0,0],4110,
e);r=Nl(r);if(0<r)Pg[String(f.s)]="@",zd=a[f.s].I="@";else if(0>r)Pg[String(f.s)]="@@",zd=a[f.s].I="@@";else if(0===r)return"";if("parse"===e)return zd}function pj(a,b,c,e,l,f){var t,r=[],w=[],A=[],C="";var ya=[];var Da=[];var ja=0;Ol(a,b,c,f);if("gen"===f){var Ua=l.indexOf(c);var ta=-1;for(t=0;t<a[c].a.length;t++){var xb=l.indexOf(a[c].a[t].p);0<=xb&&xb<Ua&&xb>ta&&(ta=xb)}0<=ta&&(ja=l[ta]);t=yk(a,c);Em.includes(e)&&ya.push(0);a[c].C+a[c].D+a[c].F<t&&ya.push(0);0<t&&0!==ja&&1===a[c].C&&ya.push(-1);
if(void 0!==Bc[String(c)])for(e=0;e<Hd.length;e++)ta=Hd[e].split(":"),xb=ta[0],ta=ta[1],xb=parseInt(xb,10),ta=parseInt(ta,10),xb===c&&ta!==ja?ya.push(ta):ta===c&&xb!==ja&&ya.push(xb);0<t&&(1===a[c].D&&ya.push(-2),1===a[c].F&&ya.push(-3));for(e=0;e<a[c].a.length;e++)a[c].a[e].p!==ja&&(ya.includes(a[c].a[e].p)||Da.push(a[c].a[e].p));Da=Fm(Da,c,l);for(e=0;e<Da.length;e++)ya.push(Da[e]);0===Ua&&0===ya[0]&&ya.shift();r.push(c,ja,ya[0],ya[1],ya[2])}else"parse"===f&&(r=l.slice(0),ya=r.slice(2));w.push(0);
for(e=1;e<r.length;e++)0<r[e]?(ja=Ia(b,c,r[e]),3<b[ja].B&&b[ja].g===c?w.push(1):w.push(0)):w.push(0);A.push(0);for(e=1;e<r.length;e++){Da=Ia(b,r[e],r[0]);Ua=!1;if(0<r[e])for(l=0;l<a[r[e]].a.length;l++)ja=Ia(b,r[e],a[r[e]].a[l].p),3<b[ja].B&&b[ja].g===r[e]&&b[ja].f!==r[0]&&(Ua=!0),!0===Ua&&3<b[Da].B&&b[Da].g===r[e]&&(Ua=!1);!0===Ua?A.push(1):A.push(0)}l=Ol(a,b,c,f);a=Ml(a,b,r,w,A,l,f);if(null===a)return console.log("get_scSense_one: getTet returned null for sc="+c+"\ntetat:"+r+" centroWE:"+w+" endoWE="+
A+" stereocode1="+l+" mode="+f),Lc.push(c),"";if(3===ya.length){ya=w=0;for(f=1;5>f;f++)0<a[f].z?ya++:0>a[f].z&&w++;C=a=Gm(a,r,4E3+100*ya+10*w);r=new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);f=Qf(C[0],C[1]);ya=Qf(C[0],C[2]);w=Qf(C[0],C[3]);A=Qf(C[0],C[4]);C=qj(f);a=qj(ya);b=qj(w);l=qj(A);f=rj(f,na/C);ya=rj(ya,na/a);w=rj(w,na/b);A=rj(A,na/l);C=[];C.push(r);C.push(f);C.push(ya);C.push(w);C.push(A);w=a=C;r=sj(w,1,2,3,4,0);f=sj(w,2,3,4,1,0);ya=sj(w,3,4,1,2,0);w=sj(w,4,1,2,3,0);
!1===(r&&f&&ya&&w)?(Lc.push(c),r=0):(r=Nl(a),null===r&&(Lc.push(c),r=0));C=0<r?"@":0>r?"@@":""}return C}function Ol(a,b,c,e){var l=0,f=0;var t=a[c].a.length;"parse"===e||1!==a[c].C&&1!==a[c].D&&1!==a[c].F||(0<a[c].ja&&l++,0<a[c].ma&&l++,0<a[c].tz&&l++,0>a[c].ja&&f++,0>a[c].ma&&f++,0>a[c].tz&&f++,t+=a[c].C+a[c].D+a[c].F);for(e=0;e<a[c].a.length;e++){var r=Ia(b,c,a[c].a[e].p);4===a[c].a[e].t&&(b[r].f===c?l++:b[r].g===c&&f++);5===a[c].a[e].t&&(b[r].f===c?f++:b[r].g===c&&l++)}return 1E3*t+100*l+10*f}
function Ih(a,b){var c=[],e,l,f;lc=[];c.push(b);for(l=0;0<c.length;){b=c.pop();(f=lc.includes(b))||lc.push(b);for(e=0;e<a[b].a.length;e++)(f=lc.includes(a[b].a[e].p))||c.push(a[b].a[e].p);l++;if(200<l)break}return lc.length}function Oh(a,b,c){var e=[],l="";lc=[];var f=b;0<c&&(lc.push(c),lc.push(b),l+=String(a[c].U)+"-",l+=String(a[b].U));e.push(f);for(c=0;0<e.length;){f=e.pop();var t=lc.includes(f);t||(lc.push(f),0<c&&(l+="-"),l+=String(a[f].U));for(b=0;b<a[f].a.length;b++)(t=lc.includes(a[f].a[b].p))||
e.push(a[f].a[b].p);c++;if(200<c)break}return l}function Fm(a,b,c){b=[];var e={},l=-1;b=a.slice(0);for(a=0;a<b.length;a++)l=c.indexOf(b[a]),0<=l&&(e[String(b[a])]=l);b.sort(function(f,t){return e[String(f)]-e[String(t)]});return b}function yk(a,b){var c,e=0,l,f=!1;var t=Cf[a[b].j];for(l=c=0;l<a[b].a.length;l++){var r=a[b].a[l].t;if(4===r||5===r)r=1;c+=r}c<=t&&(f=!0);0!==a[b].s&&(f=!1);"S"!==a[b].o||4!==c&&6!==c||(f=!1);"P"===a[b].o&&5===c&&(f=!1);"C"===a[b].o?e=t-c-Math.abs(a[b].s):nh.includes(a[b].o)&&
f?e=t-c+a[b].s:0<a[b].C?e=a[b].C:e=0;return e}function Di(a,b){var c;for(c=0;c<a[b].a.length;c++)if(3===a[b].a[c].t)return a[b].a[c].p;return 0}function Ke(a,b,c){var e=0;if(0<a[c].a.length)for(b=0;b<a[c].a.length;b++)2===a[c].a[b].t&&e++;return e}function Me(a){var b;for(b=0;b<jf.length;b++){if(a===jf[b].u)return jf[b].l;if(a===jf[b].l)return jf[b].u}return-1}function Ia(a,b,c){var e;for(e=1;e<a.length;e++)if(a[e].f===b&&a[e].g===c||a[e].f===c&&a[e].g===b)return e;return-1}function Eh(a,b){var c;
se=[];rd=[];for(c=1;c<b.length;c++){var e=b[c].f;wk(a,cg,b,Bi);var l=Ih(cg,e);var f=c,t;var r=Bi[f].f;var w=Bi[f].g;var A=-1;for(t=0;t<cg[r].a.length;t++)cg[r].a[t].p===w&&(A=t);0<=A&&cg[r].a.splice(A,1);A=-1;for(t=0;t<cg[w].a.length;t++)cg[w].a[t].p===r&&(A=t);0<=A&&cg[w].a.splice(A,1);Bi.splice(f,1);l===Ih(cg,e)&&(se.push(c),(l=rd.includes(b[c].f))||rd.push(b[c].f),(l=rd.includes(b[c].g))||rd.push(b[c].g))}}function me(a,b,c){var e,l=!1;for(e=0;e<se.length;e++){var f=se[e];if(a[f].f===b&&a[f].g===
c||a[f].f===c&&a[f].g===b)l=!0}return l}function Pl(a){var b,c=0,e=0,l=0,f=0;for(b=0;b<a.length;b++)"("===a.charAt(b)&&c++,")"===a.charAt(b)&&e++,"["===a.charAt(b)&&l++,"]"===a.charAt(b)&&f++;return c!==e?1:l!==f?-1:0}function vg(a,b){return a.length!==b.length?!1:a.join()===b.join()?!0:!1}function tj(a,b){b=b.slice(0);return vg(a.slice(0).sort(function(c,e){return c-e}),b.sort(function(c,e){return c-e}))?!0:!1}function fg(a){var b,c;for(b=0;b<a.length;++b)for(c=b+1;c<a.length;++c)a[b]===a[c]&&a.splice(c--,
1);return a}function zk(a,b){var c=a.join();for(a=0;a<b.length;a++){var e=b[a].join();if(c===e)return!0}return!1}function Ei(a,b){var c=[];a=a.concat(b);b=a.length;for(var e={};b--;){var l=a[b];e[l]||(c.unshift(l),e[l]=!0)}return c}function Gh(a,b){var c=[],e;for(e=0;e<b.length;e++)a.includes(b[e])&&c.push(b[e]);return c}function ha(a){a%=360;0>a&&(a+=360);return a%360}function ld(a,b,c,e){a=Math.atan2(e-b,c-a);0>a&&(a+=2*Math.PI);return ha(360-180*a/Math.PI)}function Ya(a,b,c){return ld(a[b].x,a[b].y,
a[c].x,a[c].y)}function oh(a,b,c,e,l,f){c-=a;e-=b;a=l-a;b=f-b;b=(c*a+e*b)/(Math.sqrt(c*c+e*e)*Math.sqrt(a*a+b*b));1<b&&(b=1);-1>b&&(b=-1);return 180*Math.acos(b)/Math.PI}function Hm(a,b,c,e){var l=Math.sqrt((a[b[e].f].x-a[c].x)*(a[b[e].f].x-a[c].x)+(a[b[e].f].y-a[c].y)*(a[b[e].f].y-a[c].y));a=Fi(a,b[e].f,b[e].g,c);return l*Math.sin(Math.PI*a/180)}function Gi(a,b){return ha(ha(b)-ha(a))}function Ne(a,b,c){var e=0,l=[],f=[],t=0,r=0,w=0;Fa=[];for(e=0;e<a[b].a.length;e++)0!==a[a[b].a[e].p].x&&0!==a[a[b].a[e].p].y&&
(l.push(Ya(a,b,a[b].a[e].p)),f.push(a[b].a[e].p));l.sort(function(A,C){return A-C});f.sort(function(A,C){return Ya(a,b,A)-Ya(a,b,C)});if(0<f.length){for(e=0;e<f.length-1;e++)w=Gi(l[e],l[e+1]),t=f[e],r=f[e+1],Fa.push(new Ql(t,r,w));w=Gi(l[f.length-1],l[0]);t=f[f.length-1];r=f[0];Fa.push(new Ql(t,r,w));c&&Fa.sort(function(A,C){return A.$-C.$})}}function ym(a,b,c){Fa=[];qb=[];Ne(a,b,c);if(0!==Fa.length)for(a=0;a<Fa.length;a++){c=ha(Ya(g,b,Fa[a].ba)+Fa[a].$/2);if(180<Math.floor(Fa[a].$)||0===Math.floor(Fa[a].$))c=
ha(180+c);qb.push(c)}}function Al(a,b,c){var e;if(0!==Fa.length){if(1===Fa.length)return 0;for(e=0;e<Fa.length;e++){var l=Ya(a,b,Fa[e].ba);var f=Ya(a,b,Fa[e].fa);if(f<l||0===l&&f>l){if(c>l&&360>=c||c<f&&0<=c)return e}else if(c>l&&c<f)return e}}return-1}function ak(a,b){return ha(a+Gi(a,b)/2)}function Rf(a,b,c,e,l){var f=new $c(0,0),t=new $c(0,0);new $c(0,0);f.x=a[c].x-a[b].x;f.y=a[c].y-a[b].y;var r=Math.sqrt(f.x*f.x+f.y*f.y);f.x/=r;f.y/=r;t.x=a[e].x-a[b].x;t.y=a[e].y-a[b].y;r=Math.sqrt(t.x*t.x+t.y*
t.y);t.x/=r;t.y/=r;e=yi(f,t);r=Math.sqrt(e.x*e.x+e.y*e.y);return 0===r?ha(Ya(a,b,c)+(!1===l?90:-90)):!1===l?ld(0,0,e.x,e.y):ld(e.x,e.y,0,0)}function Fi(a,b,c,e){return oh(a[b].x,a[b].y,a[c].x,a[c].y,a[e].x,a[e].y)}function Nf(a,b){var c=a[b].a.slice(0);c.sort(function(e,l){return Ya(a,b,e.p)-Ya(a,b,l.p)});a[b].a=c.slice(0)}function Hh(a,b){var c,e=-1,l=0,f=[];if(0===a[b].a.length)return 0;if(0<a[b].a.length){for(c=0;c<a[b].a.length;){f.push(Ya(a,b,a[b].a[c].p));if(1===a[b].a.length)return ha(180+
f[f.length-1]);if(0<c){var t=Gi(f[c-1],f[c]);var r=ak(f[c-1],f[c]);t>e&&(e=t,l=r)}c++}1<a[b].a.length&&(t=Gi(f[f.length-1],f[0]),r=ak(f[f.length-1],f[0]),t>e&&(l=r))}return l}function bk(a,b){b=Math.PI*b/180;return{x:a*Math.cos(b),y:-1*a*Math.sin(b)}}function Im(a,b,c,e,l){var f,t=new Rd(0,0,0),r=[];r=0;var w=-1,A=0,C=f=0;w=0;var ya=r=-1;w=-1;A=0;C=[];A=[];var Da=C=0,ja=0,Ua=0;f=0;f=1;var ta=!1;0!==e[0].z&&(ta=!0);for(f=1;f<e.length;f++)0!==c[f]&&(Ua=Math.sqrt((e[f].x-e[0].x)*(e[f].x-e[0].x)+(e[f].y-
e[0].y)*(e[f].y-e[0].y)+(e[f].z-e[0].z)*(e[f].z-e[0].z)),C+=(e[f].x-e[0].x)*na/Ua,Da+=(e[f].y-e[0].y)*na/Ua,ja+=(e[f].z-e[0].z)*na/Ua);f=Math.sqrt(C*C+Da*Da+ja*ja);0<f?(f=na/f,t.x=e[0].x-C*f,t.y=e[0].y-Da*f,t.z=e[0].z-ja*f):ta=!0;switch(l){case 3100:case 3010:w=-1;C=[];for(f=1;5>f;f++)0!==c[f]&&(r=Ia(b,c[0],c[f]),0===e[f].z||0!==e[f].z&&0<r&&4!==b[r].B&&5!==b[r].B?C.push(f):A.push(f));1===A.length?w=A[0]:ta=!0;ta||(r=[],A=ha(oh(e[0].x,e[0].y,e[C[0]].x,e[C[0]].y,e[C[1]].x,e[C[1]].y)),f=ha(oh(e[0].x,
e[0].y,e[w].x,e[w].y,e[C[0]].x,e[C[0]].y)),C=ha(oh(e[0].x,e[0].y,e[w].x,e[w].y,e[C[1]].x,e[C[1]].y)),r.push(A,f,C),r.sort(function(xb,Ta){return xb-Ta}),180>=r[0]+r[1]?t.z=0:(t.x=e[w].x,t.y=e[w].y,t.z=-1*e[w].z));break;case 3110:for(f=1;5>f;f++)0!==c[f]&&0===e[f].z?w=f:0!==c[f]&&0!==e[f].z&&(0<e[f].z?r=f:0>e[f].z&&(ya=f));if(-1<r&&-1<ya&&-1<w)if(A=ha(oh(e[0].x,e[0].y,e[r].x,e[r].y,e[ya].x,e[ya].y)),f=ha(oh(e[0].x,e[0].y,e[w].x,e[w].y,e[r].x,e[r].y)),C=ha(oh(e[0].x,e[0].y,e[w].x,e[w].y,e[ya].x,e[ya].y)),
w=Math.min(f,C),180<=A+w||A>f&&A>C)if(Eh(a,b),rd.includes(c[0])){w=0;for(f=1;f<c.length;f++)0===c[f]||rd.includes(c[f])||f!==r&&f!==ya||(w=f);0!==w&&(t.z=-1*e[w].z,A=ha(ld(e[0].x,e[0].y,e[w].x,e[w].y)+30),t.x=e[0].x+na*Math.cos(Math.PI*A/180),t.y=e[0].y-na*Math.sin(Math.PI*A/180))}else ta=!0;else t.z=0;break;case 3200:case 3020:case 3300:case 3030:case 3210:case 3120:t.z=0}return!1===ta?t:null}function yi(a,b){var c=new $c(0,0);c.x=b.x+a.x;c.y=b.y+a.y;return c}function kj(a,b){var c=new $c(0,0);c.x=
a.x-b.x;c.y=a.y-b.y;return c}function uj(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function Qf(a,b){var c=new Rd(0,0,0);c.x=b.x-a.x;c.y=b.y-a.y;c.z=b.z-a.z;return c}function qj(a){return Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)}function rj(a,b){var c=new Rd(0,0,0);c.x=a.x*b;c.y=a.y*b;c.z=a.z*b;return c}function wg(a,b,c,e){var l=M[b].x;var f=M[b].y;var t=M[c].x;var r=M[c].y;var w=M[a].x;var A=M[a].y;a=(t-l)*(A-f)-(w-l)*(r-f);a/=Math.abs(a);l=M[c].x;f=M[c].y;t=M[b].x;r=M[b].y;w=M[e].x;A=M[e].y;b=(t-l)*(A-f)-
(w-l)*(r-f);b/=Math.abs(b);return a*b}function Hi(a,b,c,e,l,f,t,r){a=(l-c)*(b-e)-(a-c)*(f-e);a/=Math.abs(a);c=(c-l)*(r-f)-(t-l)*(e-f);c/=Math.abs(c);return a*c}function Jg(a,b,c,e){a=a*e-c*b;return 0===Math.abs(a)?0:a/Math.abs(a)}function Ml(a,b,c,e,l,f){new Rd(0,0,0);var t=[],r,w=!1;for(r=0;r<c.length;r++){if(0>c[r]){var A=a;var C=c[0],ya=Math.abs(c[r]),Da=new Rd(0,0,0);1===ya?(Da.x=A[C].Fa,Da.y=A[C].Ga,Da.z=.5*na*A[C].ja):2===ya?(Da.x=A[C].wa,Da.y=A[C].xa,Da.z=.5*na*A[C].ma):3===ya&&(Da.x=A[C].Da,
Da.y=A[C].ca,Da.z=.5*na*A[C].tz);A=Da}else 0<c[r]?(A=a,C=c[r],ya=new Rd(0,0,0),ya.x=A[C].x,ya.y=A[C].y,ya.z=.5*na*A[C].z,A=ya):A={x:0,y:0,z:0};t.push(A)}for(r=1;r<c.length;r++)1===e[r]&&(t[r].z=-1*t[0].z,t[0].z=0);for(r=1;r<c.length;r++)1===l[r]&&(t[r].z=0);for(r=1;r<c.length;r++)0===c[r]&&(A=Im(a,b,c,t,f),null!==A?(t[r].x=A.x,t[r].y=A.y,t[r].z=A.z):w=!0);for(r=0;r<t.length;r++)0<t[r].z&&(t[r].z=.5*na),0>t[r].z&&(t[r].z=-.5*na);return w?null:t}function Gm(a,b,c){var e=b=0,l=0,f=0;f=0;var t=[],r=[1,
2,3,4];switch(c){case 4100:case 4010:for(b=1;5>b;b++)0!==a[b].z&&(e=a[b].z,l=b);t.push(0);for(b=1;5>b;b++)f=ld(a[0].x,a[0].y,a[b].x,a[b].y),t.push(f);f=t[l];for(b=1;5>b;b++)t[b]=ha(t[b]-f);r.sort(function(w,A){return t[w]-t[A]});for(b=1;5>b;b++)b!==l&&b!==r[2]&&(a[b].z=-1*e);a[r[2]].z=e;break;case 4200:for(b=1;5>b;b++)0===a[b].z&&(a[b].z=-.5*na);break;case 4020:for(b=1;5>b;b++)0===a[b].z&&(a[b].z=.5*na);break;case 4300:case 4030:for(b=1;5>b;b++)0===a[b].z?l=b:e=a[b].z;for(b=1;5>b;b++)b===l&&(a[b].x=
a[0].x,a[b].y=a[0].y,a[b].z=0<e?-.5*na:.5*na);break;case 4310:for(b=1;5>b;b++)0>a[b].z&&(a[b].x=a[0].x,a[b].y=a[0].y);break;case 4130:for(b=1;5>b;b++)0<a[b].z&&(a[b].x=a[0].x,a[b].y=a[0].y)}return a}function Ak(a,b){return a.x*b.x+a.y*b.y+a.z*b.z}function Rl(a,b){var c=new Rd(0,0,0);c.x=a.y*b.z-a.z*b.y;c.y=a.z*b.x-a.x*b.z;c.z=a.x*b.y-a.y*b.x;return c}function sj(a,b,c,e,l,f){new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);c=Qf(a[b],a[c]);e=Qf(a[b],a[e]);l=Qf(a[b],a[l]);a=Qf(a[b],
a[f]);f=Rl(c,e);b=Ak(f,l);a=Ak(f,a);f=b/Math.abs(b)===a/Math.abs(a);return 0==b||0==a?!1:f?!0:!1}function Nl(a){new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);new Rd(0,0,0);var b=Qf(a[1],a[2]);var c=Qf(a[1],a[3]);a=Qf(a[1],a[4]);c=Rl(c,a);b=Ak(b,c);return 0==b?null:b/Math.abs(b)}function Ph(a,b,c,e,l,f){var t,r=[];for(t=1;t<a.length;t++)if(a[t].v===b){r.push(t);var w=ha(180*Math.atan2(a[t].x-c,e-a[t].y)/Math.PI);var A=Math.sqrt((a[t].x-c)*(a[t].x-c)+(a[t].y-e)*(a[t].y-e));var C=A*Math.sin(Math.PI*ha(w+
l)/180);w=-A*Math.cos(Math.PI*ha(w+l)/180);a[t].x=c+C;a[t].y=e+w;f&&(a[t].v=0)}}function ih(a,b,c,e){var l;new yd(0,0,0,0);var f=0,t=0;if(!1!==ze){var r=Fd(a,e,"s");"y"===c?(f=-1*(r.b+r.c/2),t=0):"x"===c&&(t=-1*(r.t+r.h/2),f=0);Ai(a,f,t,e);for(r=1;r<a.length;r++)if(-1===e||a[r].v===e)if("y"===c?a[r].x*=-1:"x"===c&&(a[r].y*=-1),0!==a[r].z)for(l=0;l<a[r].a.length;l++)4===a[r].a[l].t?ad(g,Z,Ia(b,r,a[r].a[l].p),5,!1):5===a[r].a[l].t&&ad(g,Z,Ia(b,r,a[r].a[l].p),4,!1);Ai(a,-1*f,-1*t,e);for(l=1;l<a.length;l++)-1!==
e&&a[l].v!==e||Nf(a,l);for(r=0;r<Na.length;r++)if(0<Na[r].G){if(g[Na[r].G].v===e||-1===e)Na[r].crv=0<Na[r].crv?-1:1}else if(g[Z[-1*Na[r].G].f].v===e||-1===e)Na[r].crv=0<Na[r].crv?-1:1;Yc()}}function nj(a,b,c,e,l){var f;for(f=1;f<a.length;f++)if(a[f].v===b||0===b)a[f].x+=c,a[f].y+=e,l&&(a[f].v=0)}function Qh(a,b){a=String(a);if(a.length>=b)return a;for(;a.length<b;)a="0"+a;return a}function Jm(a,b){if(a.length>=b)return a;for(;a.length<b;)a="0"+a;return a}function $c(a,b){this.x=a;this.y=b}function Rd(a,
b,c){this.x=a;this.y=b;this.z=c}function Ql(a,b,c){this.ba=a;this.fa=b;this.$=c}function yd(a,b,c,e){this.b=a;this.t=b;this.c=c;this.h=e}function sk(a,b){this.r=a;this.ab=b;this.ka=0;this.cb=[];this.pa=[];this.A=[];this.aa=[]}function oj(a,b,c,e){this.s=a;this.u=b;this.l=c;this.n=e}function vk(a,b){this.p=a;this.t=b}function kb(a,b,c,e,l,f,t){this.Ca=this.v=0;this.j=a;this.o=b;this.N=0;this.x=c;this.y=e;this.s=l;this.z=t;this.r=!1;this.U=0;this.C=f;this.tz=this.ca=this.Da=this.F=this.ma=this.xa=this.wa=
this.D=this.ja=this.Ga=this.Fa=0;this.I="";this.X=!1;this.t=this.H=0;this.a=[];this.za=[];this.ya=[]}function De(a,b,c){this.gb=this.v=0;this.f=a;this.g=b;this.B=c}function jj(a,b,c,e){this.G=a;this.K=b;this.ca=c;this.crv=e}function ij(a,b,c,e,l,f,t,r,w){this.M=a.slice(0);this.L=b.slice(0);this.ca=c;this.na=e;this.Aa=l;this.W=new $c(f,t);this.V=new $c(r,w)}function ck(){function a(m){var u;wk(ef,M,ff,Ha);for(u=1;u<M.length;)M[u].v!==m&&(ki(M,Ha,u,!1),u--),u++}function b(m){var u,q,x,G=!1;for(u=1;u<
m.length;u++){var K=qe.indexOf(m[u].o);if(0<=K)var B="1010600"+String(Math.min(K+10,99))+"00000";else{B=String(m[u].a.length);for(q=x=K=0;q<m[u].a.length;q++){var N=m[u].a[q].t;if(4===N||5===N)N=1;K+=N}B+=Qh(K,2);B+=Qh(m[u].j,2);B=0===m[u].s?B+"0":0<m[u].s?B+"1":B+"2";B+=String(Math.abs(m[u].s));q=Cf[m[u].j];K<=q&&(G=!0);0!==m[u].s&&(G=!1);m[u].r&&(G=!1);"S"!==m[u].o||4!==K&&6!==K||(G=!1);"P"===m[u].o&&5===K&&(G=!1);"C:"===m[u].o&&(q=2);"N:"===m[u].o&&(q=1);nh.includes(m[u].o)&&G?"C"===m[u].o?x=q-
K-Math.abs(m[u].s):x=q-K+m[u].s:nh.includes(m[u].o)&&!G?("C"===m[u].o?x=q-K-Math.abs(m[u].s):x=q-K+m[u].s,m[u].r&&x--):nh.includes(m[u].o)||0===q?x=0:(x=q-K+m[u].s,m[u].r&&x--);B+="0"+String(Math.max(Math.min(x,4),0));B+=Qh(m[u].N,3);B+=Qh(m[u].F,1)+Qh(m[u].D,1)}m[u].U=parseInt(B,10)}}function c(m,u,q){for(u=1;u<m.length;u++)m[u].U*=2;m[q].U--;e(m)}function e(m){var u,q=[],x=0,G={};q[0]=0;for(u=1;u<m.length;u++)q[u]=m[u].U;q.sort(function(K,B){return K-B});G={};x=0;for(u=1;u<q.length;u++)q[u]>q[u-
1]&&(x++,G[String(q[u])]=x);for(u=1;u<m.length;u++)m[u].U=G[String(m[u].U)];return x}function l(m){var u=0,q;for(q=e(m);q!==u;){u=q;var x,G=m,K=[];for(x=1;x<G.length;x++){var B=1;for(q=0;q<G[x].a.length;q++){var N=G[x].a[q].p;N=Sl[G[N].U];B*=N}K[x]=B}for(x=0;x<G.length;x++)G[x].U=parseInt(String(G[x].U)+Qh(K[x],12),10);q=e(m)}}function f(m){var u,q,x;for(u=1;u<m.length;u++){var G=x="";for(q=0;q<m[u].a.length;q++){var K=String(m[m[u].a[q].p].U);x=""===G?x+("["+String(m[u].a[q].p)):K===G?x+(","+String(m[u].a[q].p)):
x+("];["+String(m[u].a[q].p));G=K}x+="]";ph[u]=x}}function t(m){var u,q,x=!1,G=1,K="";var B=ph[m].split(";");for(u=0;u<B.length;u++){var N=1;var fa=B[u].replace("[","");fa=fa.replace("]","");fa=fa.split(",");if(q=1<fa.length){a:{q=m;var Y=parseInt(fa[0],10),ia=parseInt(fa[1],10);if(2==fa.length){var ba=Vb(q);var Oa=Vb(Y);var nb=Vb(ia);if(ba===Oa&&ba===nb&&-1<ba&&(Y=Ia(Ha,q,Y),q=Ia(Ha,q,ia),-1<Y&&-1<q&&(2===Ha[Y].B&&1===Ha[q].B||1===Ha[Y].B&&2===Ha[q].B))){q=!0;break a}}q=!1}q=!q}if(q){x=!0;K+=B[u];
for(q=1;q<=fa.length;q++)N*=q;G*=N}}x?(Zb.push(Number(m)),gg[m]=K):gg[m]="";return G}function r(){function m(ba){var Oa,nb=[];if(0===ba.length)return[[]];for(Oa=0;Oa<ba.length;Oa++){var Pa=ba.slice(0);var wa=Pa.splice(Oa,1);var fc=m(Pa);for(Pa=0;Pa<fc.length;Pa++){var eb=wa.concat(fc[Pa]);nb.push(eb)}}return nb}function u(ba,Oa){var nb,Pa,wa=[];for(nb=0;nb<ba.length;nb++)for(Pa=0;Pa<Oa.length;Pa++){var fc=ba[nb];var eb=Oa[Pa];fc=fc+","+eb;wa.push(fc)}return wa}var q,x=[],G=[[]],K="";var B=[];var N=
"";var fa=[],Y=[],ia=[];for(q=0;q<Zb.length;q++){fa=[];N=gg[Zb[q]];N=N.replace("][",";");N=N.replace("[","");N=N.replace("]","");x=N.split(";");Y=[];for(N=0;N<x.length;N++){G=[[]];ia=[];B=x[N].split(",");fa.push(B.length);G=m(B);for(B=0;B<G.length;B++)K=G[B].join(),ia.push(K);0<Y.length?Y=u(Y,ia):Y=ia}xg[q]=Y.slice(0);Ii[q]=Y.length}}function w(m){var u,q,x,G=m,K=Ii.slice(0);for(u=0;u<m;u++)Mb[u]=[];for(x=0;x<Zb.length;x++)for(G/=K[x],u=q=0;u<m;u++)Mb[u].push(q),0===(u+1)%G&&(q++,q===K[x]&&(q=0))}
function A(m,u){var q=[],x=[],G=[];var K="";K=[];x=Zb.indexOf(m);var B=M[m].a.slice(0);for(K=0;K<M[m].a.length;K++)q[K]=M[m].a[K].p;K=xg[x].slice();K=K[u];x=K.split(",");for(K=0;K<x.length;K++)x[K]=Number(x[K]);for(K=u=0;K<q.length;K++)x.includes(q[K])?(G[K]=x[u],u++):G[K]=q[K];B.sort(function(N,fa){return G.indexOf(N.p)-G.indexOf(fa.p)});M[m].a=B.slice(0)}function C(m,u){var q;Ab=[];for(q=0;q<u.length;q++)if(!(2!==u[q].B||dg.includes(u[q].f)&&dg.includes(u[q].g))){if(1<m[u[q].f].a.length&&1<m[u[q].g].a.length){if(11>
m[u[q].f].j&&1<Ke(m,u,u[q].f)||11>m[u[q].g].j&&1<Ke(m,u,u[q].g))continue;if(11>m[u[q].f].j&&3<m[u[q].f].a.length||11>m[u[q].g].j&&3<m[u[q].g].a.length)continue;if(2===m[u[q].f].a.length&&3===m[u[q].f].a[0].t||2===m[u[q].g].a.length&&3===m[u[q].g].a[0].t||2===m[u[q].f].a.length&&3===m[u[q].f].a[1].t||2===m[u[q].g].a.length&&3===m[u[q].g].a[1].t)continue;if(!dg.includes(u[q].f)&&!dg.includes(u[q].g))if(!me(u,u[q].f,u[q].g))Ab.push(q);else if(!m[u[q].f].X&&!m[u[q].g].X){var x=Vb(u[q].f);var G=Vb(u[q].g);
x===G&&0<=x&&x<yg&&8<=cb[x].length&&Ab.push(q)}}(1<m[u[q].g].a.length&&(1===m[u[q].f].D||1===m[u[q].f].F)||1<m[u[q].f].a.length&&(1===m[u[q].g].D||1===m[u[q].g].F)||!(1!==m[u[q].f].D&&1!==m[u[q].f].F||1!==m[u[q].g].D&&1!==m[u[q].g].F))&&Ab.push(q)}}function ya(m,u){var q;for(q=0;q<Ab.length;q++){var x=u[Ab[q]].f;var G=u[Ab[q]].g;var K;var B=m;var N,fa=0,Y=0,ia=0,ba=0;var Oa=Vb(x);var nb=Vb(G);if(-1<Oa&&-1===nb){for(K=N=0;K<B[x].a.length;K++)2!==B[x].a[K].t&&Vb(B[x].a[K].p)===Oa&&(0===N?fa=B[x].a[K].p:
1===N&&(Y=B[x].a[K].p),N++);if(2===N){for(K=N=0;K<B[G].a.length;K++)2!==B[G].a[K].t&&(0===N?ia=B[G].a[K].p:1===N&&(ba=B[G].a[K].p),N++);B=wg(fa,x,G,ia);Xc[String(x)+"-"+String(G)]={w:x,t:G,O:fa,P:Y,S:ia,R:ba,T:B,Ra:[Oa]};ue[Oa].includes(String(x)+"-"+String(G))||ue[Oa].push(String(x)+"-"+String(G))}}else if(-1===Oa&&-1<nb){for(K=N=0;K<B[G].a.length;K++)2!==B[G].a[K].t&&Vb(B[G].a[K].p)===nb&&(0===N?fa=B[G].a[K].p:1===N&&(Y=B[G].a[K].p),N++);if(2===N){for(K=N=0;K<B[x].a.length;K++)2!==B[x].a[K].t&&
(0===N?ia=B[x].a[K].p:1===N&&(ba=B[x].a[K].p),N++);B=wg(fa,G,x,ia);Xc[String(G)+"-"+String(x)]={w:G,t:x,O:fa,P:Y,S:ia,R:ba,T:B,Ra:[nb]};ue[nb].includes(String(G)+"-"+String(x))||ue[nb].push(String(G)+"-"+String(x))}}else if(-1<Oa&&-1<nb&&Oa!==nb){for(K=N=0;K<B[x].a.length;K++)2!==B[x].a[K].t&&Vb(B[x].a[K].p)===Oa&&(0===N?fa=B[x].a[K].p:1===N&&(Y=B[x].a[K].p),N++);if(2===N){for(K=N=0;K<B[G].a.length;K++)2!==B[G].a[K].t&&Vb(B[G].a[K].p)===nb&&(0===N?ia=B[G].a[K].p:1===N&&(ba=B[G].a[K].p),N++);2===N&&
(B=wg(fa,G,x,ia),Xc[String(x)+"-"+String(G)]={w:x,t:G,O:fa,P:Y,S:ia,R:ba,T:B,Ra:[Oa,nb]},ue[nb].includes(String(x)+"-"+String(G))||ue[nb].push(String(x)+"-"+String(G)),ue[Oa].includes(String(x)+"-"+String(G))||ue[Oa].push(String(x)+"-"+String(G)))}}}for(q=0;q<Ab.length;q++)if(x=u[Ab[q]].f,G=u[Ab[q]].g,""===m[x].I||""===m[G].I)void 0!==E[String(x)+"-"+String(G)]&&delete E[String(x)+"-"+String(G)],void 0!==E[String(G)+"-"+String(x)]&&delete E[String(G)+"-"+String(x)],Da(m,u,x,G);Rb();if(0<W.length)for(q=
0;q<W.length;q++){x=!0;B=W[q][W[q].length-1];B=B.split("-");G=parseInt(B[1],10);ud=[];if(3===m[G].a.length){Oa=[];for(B=0;B<m[G].a.length;B++)2!==m[G].a[B].t&&Oa.push(m[G].a[B].p);Sb(m,Oa[0],G);Sb(m,Oa[1],G);B=Mc(m,u,0,1,!1);0===B&&(x=!1)}else 1===m[G].a.length&&(x=!1);B=W[q][0];B=B.split("-");G=parseInt(B[1],10);ud=[];if(3===m[G].a.length){Oa=[];for(B=0;B<m[G].a.length;B++)2!==m[G].a[B].t&&Oa.push(m[G].a[B].p);Sb(m,Oa[0],G);Sb(m,Oa[1],G);B=Mc(m,u,0,1,!1);0===B&&(x=!1)}else 1===m[G].a.length&&(x=
!1);if(x)for(B=0;B<W[q].length;B++)x=m,G=W[q][B],void 0===E[G]&&void 0!==Xc[G]&&(E[G]={w:Xc[G].w,t:Xc[G].t,O:Xc[G].O,P:Xc[G].P,S:Xc[G].S,R:Xc[G].R,T:Xc[G].T},Oa=String(E[G].t)+"-"+String(E[G].w),x[E[G].w].I=1===E[G].T?"t":"c",x[E[G].t].I=1===E[G].T?"t":"c",void 0===E[Oa]&&(E[Oa]={w:Xc[G].t,t:Xc[G].w,O:Xc[G].S,P:Xc[G].R,S:Xc[G].O,R:Xc[G].P,T:Xc[G].T}))}}function Da(m,u,q,x){var G,K=[],B=[],N=0,fa=0,Y=0,ia=0,ba=0;for(G=0;G<m[q].a.length;G++)2!==m[q].a[G].t&&K.push(m[q].a[G].p);1===K.length?(N=K[0],
fa=0):2===K.length&&(ud=[],Sb(m,K[0],q),Sb(m,K[1],q),G=Mc(m,u,0,1,!0),0===G?fa=N=0:(1===G&&(N=K[0],fa=K[1]),-1===G&&(N=K[1],fa=K[0])));for(G=0;G<m[x].a.length;G++)2!==m[x].a[G].t&&B.push(m[x].a[G].p);1===B.length?(Y=B[0],ia=0):2===B.length&&(ud=[],Sb(m,B[0],x),Sb(m,B[1],x),G=Mc(m,u,0,1,!0),0===G?ia=Y=0:(1===G&&(Y=B[0],ia=B[1]),-1===G&&(Y=B[1],ia=B[0])));if(0!==N&&0!==Y){ba=wg(N,q,x,Y);if(0===ba||ba!=ba)Ya(m,N,q)===Ya(m,q,x)&&Lc.push(q),Ya(m,Y,x)===Ya(m,x,q)&&Lc.push(x),ba=0;2!==K.length||wg(N,q,x,
Y)!==wg(fa,q,x,Y)&&Ya(m,fa,q)!==Ya(m,q,x)||Lc.push(q);2!==B.length||wg(Y,x,q,N)!==wg(ia,x,q,N)&&Ya(m,ia,x)!==Ya(m,x,q)||Lc.push(x)}else 0===K.length&&0<Y&&(1===m[q].D||1===m[q].F)?1===m[q].D?ba=Hi(m[q].wa,m[q].xa,m[q].x,m[q].y,m[x].x,m[x].y,m[Y].x,m[Y].y):1===m[q].F&&(ba=Hi(m[q].Da,m[q].ca,m[q].x,m[q].y,m[x].x,m[x].y,m[Y].x,m[Y].y)):0===B.length&&0<N&&(1===m[x].D||1===m[x].F)?1===m[x].D?ba=Hi(m[N].x,m[N].y,m[q].x,m[q].y,m[x].x,m[x].y,m[x].wa,m[x].xa):1===m[x].F&&(ba=Hi(m[N].x,m[N].y,m[q].x,m[q].y,
m[x].x,m[x].y,m[x].Da,m[x].ca)):0!==K.length||0!==B.length||1!==m[q].D&&1!==m[q].F||1!==m[x].D&&1!==m[x].F?ba=0:ba=Hi(m[q].wa,m[q].xa,m[q].x,m[q].y,m[x].x,m[x].y,m[x].wa,m[x].xa);1===ba?(void 0===E[String(q)+"-"+String(x)]&&void 0===E[String(x)+"-"+String(q)]&&(E[String(q)+"-"+String(x)]={w:q,t:x,O:N,P:fa,S:Y,R:ia,T:ba},E[String(x)+"-"+String(q)]={w:x,t:q,O:Y,P:ia,S:N,R:fa,T:ba}),m[q].I="t",m[x].I="t"):-1!==ba||me(u,q,x)||(void 0===E[String(q)+"-"+String(x)]&&void 0===E[String(x)+"-"+String(q)]&&
(E[String(q)+"-"+String(x)]={w:q,t:x,O:N,P:fa,S:Y,R:ia,T:ba},E[String(x)+"-"+String(q)]={w:x,t:q,O:Y,P:ia,S:N,R:fa,T:ba}),m[q].I="c",m[x].I="c")}function ja(m,u,q){for(var x in Xc)if(Xc.hasOwnProperty(x))switch(q){case "f":if(Xc[x].w===u)return x;case "t":if(Xc[x].t===u)return x;case "fl1":if(Xc[x].O===u)return x;case "fl2":if(Xc[x].P===u)return x;case "tl1":if(Xc[x].S===u)return x;case "tl2":if(Xc[x].R===u)return x;case "rx":if(Xc[x].Ra===u)return x}return""}function Ua(m,u){var q;for(q=0;q<jf.length;q++){var x=
jf[q].u;var G=jf[q].l;""!==m[x].I&&""!==m[G].I&&m[x].I===m[G].I||Da(m,u,x,G)}}function ta(m,u){var q,x,G=0,K=0,B,N;for(x=0;x<eg.length;x++){var fa={s:0,u:0,l:0,n:0};fa.s=eg[x].s;fa.u=eg[x].u;fa.l=eg[x].l;fa.n=eg[x].n;if(""===m[fa.s].I){var Y=N=B=!1;for(q=0;q<m[fa.u].a.length;q++)4===m[fa.u].a[q].t&&(N=!0),5===m[fa.u].a[q].t&&(Y=!0);if(0<m[fa.u].C&&0<m[fa.u].ja||0<m[fa.u].D&&0<m[fa.u].ma||0<m[fa.u].F&&0<m[fa.u].tz)N=!0;if(0<m[fa.u].C&&0>m[fa.u].ja||0<m[fa.u].D&&0>m[fa.u].ma||0<m[fa.u].F&&0>m[fa.u].tz)Y=
!0;if(Y||N)B=!0,K=fa.u,G=fa.l;Y=N=!1;for(q=0;q<m[fa.l].a.length;q++)4===m[fa.l].a[q].t&&(N=!0),5===m[fa.l].a[q].t&&(Y=!0);if(0<m[fa.l].C&&0<m[fa.l].ja||0<m[fa.l].D&&0<m[fa.l].ma||0<m[fa.l].F&&0<m[fa.l].tz)N=!0;if(0<m[fa.l].C&&0>m[fa.l].ja||0<m[fa.l].D&&0>m[fa.l].ma||0<m[fa.l].F&&0>m[fa.l].tz)Y=!0;(Y||N)&&!1===B?(B=!0,K=fa.l,G=fa.u):(Y||N)&&!0===B&&(B=!1,Lc.push(fa.s));if(B){fa.u=K;fa.l=G;Y=m;var ia=u,ba=0,Oa=0;B=fa.u;q=fa.l;ud=[];for(N=0;N<Y[B].a.length;N++)4!==Y[B].a[N].t&&5!==Y[B].a[N].t||Sb(Y,
Y[B].a[N].p,B);if(2===ud.length)ba=Mc(Y,ia,0,1,!0);else if(0===ud.length){if(1===Y[B].D||1===Y[B].F)ba=1}else ba=1;ud=[];for(N=0;N<Y[q].a.length;N++)1===Y[q].a[N].t&&Sb(Y,Y[q].a[N].p,q);2===ud.length?Oa=Mc(Y,ia,0,1,!0):Oa=0===ud.length?1===Y[q].D||1===Y[B].F?1:0:1;(q=0!==ba&&0!==Oa?!0:!1)&&Nc.push(fa)}}}}function xb(m,u,q){var x;for(x=0;x<Nc.length;x++)xk(m,u,Nc[x],q)}function Ta(m,u,q){var x,G,K;"reset"===q&&(ac=[],Df=[]);for(x=1;x<m.length;x++)if("add"!==q||""===m[x].I){var B=Ka(m,u,x);if(G=""!==
B?!0:!1){a:{var N,fa=m,Y=u;var ia=x;ud=[];for(K=0;K<fa[ia].a.length;K++)Sb(fa,fa[ia].a[K].p,ia);for(K=0;K<ud.length-1;K++)for(N=K+1;N<ud.length;N++)if(ia=Mc(fa,Y,K,N,!0),0===ia){K=!1;break a}K=!0}!1===K&&(G=!1);G&&!ac.includes(x)&&(ac.push(x),Ef[String(x)]="",Df.push(B))}}}function Ka(m,u,q){var x,G="",K=!1;for(x=0;x<m[q].a.length;x++)if(4===m[q].a[x].t||5===m[q].a[x].t)K=!0;1===m[q].C&&0!==m[q].ja&&(K=!0);1===m[q].D&&0!==m[q].ma&&(K=!0);1===m[q].F&&0!==m[q].tz&&(K=!0);if(K){x=yk(m,q);G=m[q].o+":"+
String(m[q].a.length)+":"+String(x)+":"+String(m[q].s);if("N:3:0:0"===G){var B=[];for(x=0;x<m[q].a.length;x++)me(u,q,m[q].a[x].p)&&B.push(m[q].a[x].p);2===B.length&&me(u,B[0],B[1])&&(G="N:3:0:az")}Km.includes(G)||(K=!1);if(1<yk(m,q)-(m[q].C+m[q].D+m[q].F)+m[q].C||1<m[q].D||1<m[q].F)K=!1;else if(2>=m[q].a.length)if(("P:2:1:0"===G&&2<=m[q].a.length||"As:2:1:0"===G&&2<=m[q].a.length)&&0<m[q].C)K=!0;else if("C:2:2:0"===G){if(1===m[q].C&&1===m[q].D||1===m[q].C&&1===m[q].F||1===m[q].D&&1===m[q].F||0===
m[q].C&&1===m[q].D||0===m[q].C&&1===m[q].F)K=!0}else"C:1:3:0"===G?1===m[q].C&&1===m[q].D&&1===m[q].F&&(K=!0):K=!1}return K?G:""}function Pc(m,u){var q;for(q=0;q<ac.length;q++){var x=pj(m,u,ac[q],Df[q],nc,"gen");m[ac[q]].I=x;Ef[String(ac[q])]=x}}function ec(m){var u,q=0;for(u=1;u<m.length;u++)""!==m[u].I&&q++;return q}function Ub(m,u,q){u=[];var x;rb=[];nc=[];Kd="";u.push(q);for(x=0;0<u.length&&rb.length<m.length-1;){var G=u.pop();var K=rb.includes(G);if(!K){rb.push(G);var B="";0<Ba[Ze[G]]&&(B+="(",
--Ba[Ze[G]]);B=G===q?B+String(G):B+("\u00b7"+String(G));nc.push(G);Kd+=B;1===m[G].a.length-Ib[G]&&rb.length<m.length-1&&G!==q&&(Kd+=")");for(B=0;B<m[G].a.length;B++)(K=rb.includes(m[G].a[B].p))||u.push(m[G].a[B].p)}x++;if(200<x)break}}function Ad(m,u,q){var x=[],G,K,B=[];Hd=[];Ze=[];Ba=[];Ib=[];Ba[0]=0;Ib[0]=0;for(G=1;G<m.length;G++)Ba[G]=G===q&&1<m[G].a.length?Math.max(m[G].a.length-1,0):Math.max(m[G].a.length-2,0),Ib[G]=0;x.push(q);for(K=0;0<x.length&&B.length<m.length-1;){q=x.pop();var N=B.includes(q);
if(!N){Ze[q]=0;if(0<B.length)for(G=B.length-1;0<=G;G--)if(0<=oi(M,B[G],q)){Ze[q]=B[G];break}B.push(q);for(G=0;G<m[q].a.length;G++)if(N=B.includes(m[q].a[G].p)){if(m[q].a[G].p!==Ze[q]&&me(u,m[q].a[G].p,q)){N=String(m[q].a[G].p)+":"+String(q);var fa;a:{for(fa=0;fa<Hd.length;fa++)if(Hd[fa]===N){fa=!0;break a}fa=!1}fa||(Hd.push(N),Ib[q]+=1,Ib[m[q].a[G].p]+=1,Ba[m[q].a[G].p]=Math.max(Ba[m[q].a[G].p]-1,0),Ba[q]=Math.max(Ba[q]-1,0))}}else x.push(m[q].a[G].p)}K++;if(200<K)break}}function Sb(m,u,q){var x=
[],G=[],K=[],B={},N=[],fa=[],Y=new sk(0,0),ia;x.push(u);G.push(u);K.push(q);var ba=B[String(u)]=0;N.push(m[u].I);for(""!==m[u].I&&ba++;0<x.length;){var Oa=x.shift();for(ia=0;ia<m[Oa].a.length;ia++){var nb=m[Oa].a[ia].p;G.includes(nb)||nb===q||(G.push(nb),N.push(m[nb].I),""!==m[nb].I&&ba++,K.push(Oa),B[String(nb)]=B[String(Oa)]+1,x.push(nb))}}for(ia=0;ia<G.length;ia++)fa[ia]=B[String(G[ia])];Y.r=u;Y.ab=q;Y.ka=ba;Y.cb=G.slice(0);Y.pa=fa.slice(0);Y.A=K.slice(0);Y.aa=N.slice(0);ud.push(Y)}function Rb(){var m=
0,u=m=0;u="";var q=-1,x=0,G=0,K=[],B=[],N=[],fa=[];if(0!==kf.length){W=[];for(m=0;m<kf.length;m++)fa[m]=kf[m].split(",");K=kf.join().split(",");K=K.filter(function(Y,ia,ba){return ia===ba.indexOf(Y)});for(m=0;m<K.length;m++)for(B.push([]),u=0;u<fa.length;u++)fa[u][0]!==K[m]&&fa[u][1]!==K[m]||B[B.length-1].push(u);G=x=m=0;u=fa[x][G];q=K.indexOf(u);W.push([]);for(N=[];""!==u&&20>m;){N.includes(u)||(W[W.length-1].push(u),N.push(u));if(N.length>=K.length)break;1===B[q].length?0!==G||N.includes(fa[x][1])?
1!==G||N.includes(fa[x][0])?(G=0,x++,W.push([])):G=0:G=1:2===B[q].length&&(B[q][0]===x?(x=B[q][1],fa[x][0]===u?G=1:fa[x][1]===u&&(G=0)):B[q][1]===x&&(x=B[q][0],fa[x][0]===u?G=1:fa[x][1]===u&&(G=0)));if(N.length>=K.length)break;u="";if(void 0===fa[x][G]||N.includes(fa[x][G]))break;else u=fa[x][G],q=K.indexOf(u);m++}0===W[W.length-1].length&&W.splice(-1,1)}}function Mc(m,u,q,x,G){function K(ia,ba,Oa,nb){var Pa=1;for(ba=0;ud[Oa].pa[ba]<nb;)ba++;for(;ud[Oa].pa[ba]===nb;)Pa*=Sl[ia[ud[Oa].cb[ba]].U],ba++;
return Pa}var B=0;var N=ud[q].pa[ud[q].pa.length-1];var fa=ud[x].pa[ud[x].pa.length-1];for(B=0;B<=Math.min(N,fa);){var Y=K(m,u,q,B)-K(m,u,x,B);if(0!==Y){if(0<Y)return 1;if(0>Y)return-1}else{if(B===N&&B===fa&&0===Y)return B=tb(m,u,ud[q].r,ud[x].r,ud[q].ab,G),0!==B?1:0;B++;if(B>N)return-1;if(B>fa)return 1}}}function tb(m,u,q,x,G,K){function B(sa,Va,lb,Bb){var Cb=[],tc=[],Jb=[],Nb=[];var jc=Va.slice(0);var Sd=jc.indexOf(lb);var fd=jc.indexOf(Bb);for(Va=0;Va<sa[lb].a.length;Va++)2!==sa[lb].a[Va].t&&(Cb.push(sa[lb].a[Va].p),
Jb.push(jc.indexOf(sa[lb].a[Va].p)));if(2===Cb.length)Cb=Math.abs(Sd-Jb[0])<Math.abs(Sd-Jb[1])?Cb[0]:Cb[1];else if(1===Cb.length)Cb=Cb[0];else return"";for(Va=0;Va<sa[Bb].a.length;Va++)2!==sa[Bb].a[Va].t&&(tc.push(sa[Bb].a[Va].p),Nb.push(jc.indexOf(sa[Bb].a[Va].p)));if(2===tc.length)tc=Math.abs(fd-Nb[0])<Math.abs(fd-Nb[1])?tc[0]:tc[1];else if(1===tc.length)tc=tc[0];else return"";if(-1===wg(Cb,lb,Bb,tc))return sa[lb].I="c",sa[Bb].I="c";sa[lb].I="t";return sa[Bb].I="t"}var N=[],fa=[],Y=0,ia=0,ba="",
Oa="";Y=ia=Y=ia="";var nb=!1,Pa=!1,wa=!1,fc=!0,eb=!1;ia=Y="";N=0;Oh(m,q,G);N=lc.slice(0);Oh(m,x,G);fa=lc.slice(0);if(N.length===fa.length){for(q=1;q<N.length;q++)K&&N[q]===fa[q]?!1===eb&&(eb=!0,Y=ja(m,G,"f"),ia=ja(m,N[q],"f"),""===Y||""===ia||kf.includes(Y+","+ia)||kf.includes(ia+","+Y)||kf.push(Y+","+ia)):eb=!1,Y=mc(N[q]),ia=mc(fa[q]),0<Y&&0<ia?(ba=m[N[q]].I,Oa=m[fa[q]].I,"c"===ba&&"c"===Oa||"t"===ba&&"t"===Oa||("c"===ba&&"t"===Oa||"t"===ba&&"c"===Oa?fc=!1:(ba=B(m,N,N[q],Y),Oa=B(m,fa,fa[q],ia),ba!==
Oa&&(fc=!1)))):(ia=Ka(m,u,N[q]),Y=Ka(m,u,fa[q]),ia===Y&&""!==ia&&(ia=pj(m,u,N[q],ia,N,"gen"),Y=pj(m,u,fa[q],Y,fa,"gen"),""!==ia&&""!==Y&&(ia===Y?!1===nb&&!1===Pa?nb=!0:!0===Pa&&(wa=!0,Pa=nb=!1):!1===nb&&!1===Pa?Pa=!0:!0===nb&&(wa=!0,Pa=nb=!1))));N=nb&&fc||fc&&!nb&&!Pa&&!wa?0:-1}else N=-1;return N}function mc(m){var u;if(0===m)return-1;for(u=0;u<Ab.length;u++){if(Ha[Ab[u]].f===m&&("c"===M[m].I||"t"===M[m].I))return Ha[Ab[u]].g;if(Ha[Ab[u]].g===m&&("c"===M[m].I||"t"===M[m].I))return Ha[Ab[u]].f}return-1}
function Za(m){function u(ob,Wa){var Qc,F,Td=0;if(3===ob[Wa].a.length)for(Qc=Td=0;Qc<ob[Wa].a.length;Qc++)if(2===ob[Wa].a[Qc].t)Td++;else if(1===ob[Wa].a[Qc].t)for(F=0;F<ob[ob[Wa].a[Qc].p].a.length;F++)2===ob[ob[Wa].a[Qc].p].a[F].t&&Td++;return 3===Td?!0:!1}function q(ob,Wa){var Qc,F,Td;for(Qc=Td=0;Qc<ob[Wa].a.length;Qc++)if(1===ob[Wa].a[Qc].t)for(F=0;F<ob[ob[Wa].a[Qc].p].a.length;F++)2===ob[ob[Wa].a[Qc].p].a[F].t&&Td++;return 2<=Td?!0:!1}function x(ob,Wa){var Qc,F,Td="",lf="";var ve=!1;var Dc=Cf[ob[Wa].j];
for(F=Qc=0;F<ob[Wa].a.length;F++){var de=ob[Wa].a[F].t;if(4===de||5===de)de=1;Qc+=de}Qc<=Dc&&0<Dc&&(ve=!0);0!==ob[Wa].s&&(ve=!1);ob[Wa].r&&(ve=!1);0<ob[Wa].N&&(lf=String(ob[Wa].N),ve=!1);0<Nc.length&&void 0!==Pg[String(Wa)]?(de=Pg[String(Wa)],ve=!1):de="";0<ac.length&&ac.includes(Wa)&&(void 0!==Ef[String(Wa)]?(de=Ef[String(Wa)],""!==de&&(ve=!1)):de="");"S"!==ob[Wa].o||4!==Qc&&6!==Qc||(ve=!1);"P"===ob[Wa].o&&5===Qc&&(ve=!1);"C:"===ob[Wa].o&&(Dc=2);"N:"===ob[Wa].o&&(Dc=1);F=uk(ob,Wa,!0)+ob[Wa].C-ob[Wa].D-
ob[Wa].F;F+Qc+ob[Wa].D+ob[Wa].F!==Dc&&(ve=!1);Dc=ob[Wa].X&&Lm.includes(ob[Wa].o)?ob[Wa].o.toLowerCase():ek.includes(ob[Wa].o)?ob[Wa].o.slice(0,1):ob[Wa].o;ve&&nh.includes(ob[Wa].o)?ob=Dc:(ve=0>=F?"":1===F?"H":"H"+String(F),0===ob[Wa].s?Td="":0<ob[Wa].s?(Td="+"+String(ob[Wa].s),1===ob[Wa].s&&(Td="+")):0>ob[Wa].s&&(Td=String(ob[Wa].s),-1===ob[Wa].s&&(Td="-")),ob="["+lf+Dc+de+ve+Td+"]");return ob}function G(ob,Wa){var Qc="";0<ob[Wa].D&&0===ob[Wa].F&&(Qc=2>ob[Wa].a.length?0!==nc.indexOf(Wa)?"([2H])".repeat(ob[Wa].D-
1)+"[2H]":"([2H])".repeat(ob[Wa].D):"([2H])".repeat(ob[Wa].D));1<=ob[Wa].F&&(Qc=2>ob[Wa].a.length?0!==nc.indexOf(Wa)?"([2H])".repeat(ob[Wa].D)+"([3H])".repeat(ob[Wa].F-1)+"[3H]":"([2H])".repeat(ob[Wa].D)+"([3H])".repeat(ob[Wa].F):"([2H])".repeat(ob[Wa].D)+"([3H])".repeat(ob[Wa].F));return Qc}var K=0,B=0,N=/\u00b7(\d+)/,fa=[],Y="",ia="",ba="",Oa="",nb=ba="",Pa="",wa=0;K=-1;var fc="",eb="",sa=ia=0,Va="",lb=1,Bb=0,Cb=0,tc=0,Jb=0,Nb=0,jc=0,Sd=0,fd=0;B=0;fd=[];var bc=0,Ud="",Ob={};jc=0;var Sf=bc="";Y=
[];ia=Y=Kd;for(Vd in Ob)Ob.hasOwnProperty(Vd)&&delete Ob[Vd];if(2===nc.length&&1===m[nc[0]].j&&1===m[nc[1]].j&&(0<m[nc[0]].N||0<m[nc[1]].N)){ia=m[nc[0]].N+m[nc[1]].N;switch(ia){case 2:eb="[H][2H]";break;case 3:eb="[H][3H]";break;case 4:eb="[2H][2H]";break;case 5:eb="[2H][3H]";break;case 6:eb="[3H][3H]"}return eb}var Vd=Y.match(/^(\d+)/);if(null!==Vd){ba=String(Vd[0]);Y=Y.slice(Vd.index+ba.length);sa=parseInt(Vd[1],10);fc="";void 0!==Bc[String(sa)]&&(fc=Bc[String(sa)]);if(0<m[sa].D||0<m[sa].F)eb=G(m,
sa);nb=x(m,sa);Pa="";K=mc(sa);-1===K&&(K=Me(sa));void 0!==E[String(sa)+"-"+String(K)]&&(Va=String(sa)+"-"+String(K),B=fd=0,Bb=E[Va].t,Cb=E[Va].O,tc=E[Va].P,Jb=E[Va].S,Nb=E[Va].R,Ud=String(-1!==mc(Cb)||-1!==Me(Cb)?1:0),Ud+=String(-1!==mc(tc)||-1!==Me(tc)?1:0),Ud+=String(-1!==mc(Jb)||-1!==Me(Jb)?1:0),Ud+=String(-1!==mc(Nb)||-1!==Me(Nb)?1:0),void 0!==E[Va]&&0===Cb&&0===tc&&(lb=E[String(sa)+"-"+String(K)].T,1===m[sa].D&&0===m[sa].F||0===m[sa].D&&1===m[sa].F||1===m[sa].D&&1===m[sa].F))&&(Pa="",1===lb?
bc="/":-1===lb&&(bc="\\"),eb=eb.replace(/\(\[/,"("+bc+"["),Ob[String(K)]=-1===lb?"\\"===bc?"\\":"/":"\\"===bc?"/":"\\");ia=nb+fc+Pa+eb+ia.slice(ba.length);fa.push(sa)}for(;0!==Y.length&&null!==Vd;)if(eb="",Vd=ia.match(N),null!==Vd){ba=String(Vd[0]);Y=ia.slice(Vd.index+ba.length);sa=parseInt(Vd[1],10);Oa=ia.slice(0,Vd.index);ba=ia.slice(Vd.index+ba.length);if(0<m[sa].D||0<m[sa].F)eb=G(m,sa);for(K=0;K<m[sa].a.length;K++)if(m[sa].a[K].p===Ze[sa]||fa.includes(m[sa].a[K].p)){m[sa].X&&m[m[sa].a[K].p].X?
wa=0:wa=m[sa].a[K].t;switch(wa){case 0:case 1:case 4:case 5:fc="";break;case 2:fc="=";break;case 3:fc="#"}if(0<fc.length)break}nb=x(m,sa);Pa="";K=mc(sa);-1===K&&(K=Me(sa));if(-1!==K&&""!==m[sa].I&&""!==m[K].I)if(fa.includes(K)){void 0!==E[Va]&&0===Jb&&0===Nb&&(/\\\u00b7/.test(ia)||/\/\u00b7/.test(ia)||(eb=Ob[sa]+eb),eb=eb.replace(/\(\[/,"("+Ob[sa]+"["),eb=eb.replace(/\\\(/,"("),eb=eb.replace(/\/\(/,"("));if(void 0!==Bc[String(sa)])for(K=0;K<nc.length;K++)nc[K]!==sa&&void 0!==Bc[String(nc[K])]&&Bc[String(nc[K])]===
Bc[String(sa)]&&(Jb!==nc[K]||0!==Nb&&"1"!==Ud.charAt(2)?Nb===nc[K]&&(1===lb?Sf="\\"===bc?"/":"\\":Sf=bc,void 0!==Ob[String(Jb)]&&""!==Ob[String(Jb)]&&"0"===Ud.charAt(2)&&(Ob[String(Jb)]="")):(1===lb?Sf=bc:Sf="\\"===bc?"/":"\\",void 0!==Ob[String(Nb)]&&""!==Ob[String(Nb)]&&"0"===Ud.charAt(3)&&(Ob[String(Nb)]="")));fc+=nb;fc+=Sf;Sf=""}else{if(void 0!==E[String(sa)+"-"+String(K)]){Va=String(sa)+"-"+String(K);Ud="";B=fd=0;Bb=E[Va].t;Cb=E[Va].O;tc=E[Va].P;fa.includes(Cb)&&fa.includes(tc)&&(jc=fa.indexOf(Cb),
Sd=fa.indexOf(tc),Cb=fa[Math.max(jc,Sd)],tc=fa[Math.min(jc,Sd)]);Ud+=String(-1!==mc(Cb)||-1!==Me(Cb)?1:0);Ud+=String(-1!==mc(tc)||-1!==Me(tc)?1:0);Jb=E[Va].S;Nb=E[Va].R;0!==Jb&&0!==Nb&&(jc=nc.indexOf(Jb),Sd=nc.indexOf(Nb),void 0!==Bc[String(Jb)]&&void 0!==Bc[String(Bb)]&&Bc[String(Jb)]===Bc[String(Bb)]&&(fd=Jb),void 0!==Bc[String(Jb)]&&void 0!==Bc[String(Bb)]&&Bc[String(Jb)]===Bc[String(Bb)]&&(B=Nb),0===fd&&0===B?(Jb=nc[Math.min(jc,Sd)],Nb=nc[Math.max(jc,Sd)]):0!==B&&0===fd&&(Nb=Jb,Jb=B));Ud+=String(-1!==
mc(Jb)||-1!==Me(Jb)?1:0);Ud+=String(-1!==mc(Nb)||-1!==Me(Nb)?1:0);lb=E[Va].T;Cb!==E[Va].O&&(lb*=-1);Jb!==E[Va].S&&(lb*=-1);switch(Ud){case "0000":case "0001":case "0010":case "0011":if(!m[Cb].X&&u(m,Cb)){fd=[];for(B=jc=0;B<m[Cb].a.length;B++)1===m[Cb].a[B].t?fd.push(m[Cb].a[B].p):2===m[Cb].a[B].t&&(jc=m[Cb].a[B].p);2===fd.length&&fa.includes(jc)&&fa.includes(Cb)?(nc.indexOf(fd[0])>nc.indexOf(fd[1])&&(bc=fd[0],fd[0]=fd[1],fd[1]=bc),bc=Pa=sa===fd[0]?"\\":sa===fd[1]&&void 0!==Ob[String(fd[0])]?"\\"===
Ob[fd[0]]?"/":"\\":"\\",Ob[String(sa)]=Pa):(bc=Pa="\\",Ob[String(sa)]=Pa)}else if(q(m,Cb)){fd=[];for(B=jc=0;B<m[Cb].a.length;B++)1!==m[Cb].a[B].t||"c"!==m[m[Cb].a[B].p].I&&"t"!==m[m[Cb].a[B].p].I||nc.indexOf(Cb)<nc.indexOf(m[Cb].a[B].p)&&fd.push(m[Cb].a[B].p);1<fd.length&&fa.includes(Cb)?(fd.sort(function(ob,Wa){return nc.indexOf(ob)-nc.indexOf(Wa)}),sa===fd[0]?(bc=Pa="\\",Ob[String(sa)]=Pa):0<fd.indexOf(sa)&&void 0!==Ob[String(fd[0])]&&(bc=Pa="\\"===Ob[fd[0]]?"/":"\\",Ob[String(sa)]=Pa)):(bc=Pa=
"\\",Ob[String(sa)]=Pa)}else bc=Pa="\\",Ob[String(sa)]=Pa;break;case "0100":void 0!==Bc[String(tc)]&&fa.includes(tc)&&(bc=Pa="\\",Ob[String(sa)]=Pa);break;case "1000":case "1001":case "1101":case "1010":case "1011":case "1100":case "1111":if(void 0!==Ob[String(sa)])bc=Pa=Ob[String(sa)];else if(u(m,Cb))for(B=0;B<m[Cb].a.length;B++)1===m[Cb].a[B].t&&void 0!==Ob[String(m[Cb].a[B].p)]?(bc=Pa="\\"===Ob[String(m[Cb].a[B].p)]?"/":"\\",Ob[String(sa)]=Pa):1===m[Cb].a[B].t&&(bc=Pa="\\",Ob[String(sa)]=Pa);else bc=
Pa="\\",Ob[String(sa)]=Pa}switch(Ud){case "0100":case "0101":case "1101":case "0111":case "1111":case "1100":Ob[String(tc)]="\\";if("0100"===Ud||"0101"===Ud||"0111"===Ud)bc="\\";break;case "0110":nc.indexOf(tc)<nc.indexOf(Jb)?(bc=Ob[String(tc)]="\\",Ob[String(Jb)]=1===lb?Ob[String(tc)]:"\\"===Ob[String(tc)]?"/":"\\"):(bc=Ob[String(Jb)]="\\",Ob[String(tc)]=1===lb?Ob[String(Jb)]:"\\"===Ob[String(Jb)]?"/":"\\")}switch(Ud){case "0000":case "1000":case "1100":if(void 0===Bc[String(Jb)]||Bc[String(Jb)]!==
Bc[String(Bb)])Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\";break;case "0011":case "0010":case "1111":Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\";break;case "1011":case "1010":Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\";break;case "0100":case "0111":Ob[String(Jb)]=1===lb?bc:"\\"===bc?"/":"\\"}switch(Ud){case "0000":case "1000":case "1100":void 0!==Bc[String(Jb)]&&Bc[String(Jb)]===Bc[String(Bb)]&&(Ob[String(Nb)]=-1===lb?bc:"\\"===bc?"/":"\\");break;case "0001":case "1001":case "1011":case "1101":Ob[String(Nb)]=
-1===lb?bc:"\\"===bc?"/":"\\";break;case "0011":case "0111":case "1111":Ob[String(Nb)]="\\"===Ob[String(Jb)]?"/":"\\";break;case "0101":Ob[String(Nb)]=-1===lb?bc:"\\"===bc?"/":"\\"}}0===Jb&&0===Nb&&(/\\\u00b7/.test(ia)&&(bc="\\"),/\/\u00b7/.test(ia)&&(bc="/"),Ob[String(K)]=1===lb?"\\"===bc?"\\":"/":"\\"===bc?"/":"\\");fc=/\\\u00b7/.test(ia)||/\/\u00b7/.test(ia)?fc+nb:fc+(Pa+nb)}else void 0!==Ob[String(sa)]&&""!==Ob[String(sa)]?Pa=Ob[String(sa)]:Pa="",fc+=Pa+nb;void 0!==Bc[String(sa)]&&(fc+=Bc[String(sa)]);
ia=Oa+fc+eb+ba;fa.push(sa)}Y=ia.match(/\((\[\dH\])\)$/);null!==Y&&(ia=ia.substring(0,ia.length-6)+Y[1]);return ia}function Lb(m,u,q){var x=m=0,G=0,K="\u00bf";if(0<oc.length)oc.sort(function(B,N){return Math.abs(B.G)-Math.abs(N.G)});else return"";for(m=0;m<oc.length;m++)G=x=0,0>oc[m].G?Number.isInteger(oc[m].G)?(x=q.indexOf(String(u[-1*oc[m].G].f))+1,G=q.indexOf(String(u[-1*oc[m].G].g))+1,K+=String(x)+"-"+String(G)+":"):(x=-1*(q.indexOf(String(Math.floor(-1*oc[m].G)))+1)-.5,K+=String(x)+":"):0<oc[m].G&&
Number.isInteger(oc[m].G)&&(x=q.indexOf(String(oc[m].G))+1,K+=String(x)+":"),0>oc[m].K&&Number.isInteger(oc[m].K)?(x=q.indexOf(String(u[-1*oc[m].K].f))+1,G=q.indexOf(String(u[-1*oc[m].K].g))+1,K+=String(x)+"-"+String(G)+":"):0<oc[m].K&&(x=Number.isInteger(oc[m].K)?q.indexOf(String(oc[m].K))+1:q.indexOf(String(Math.floor(oc[m].K)))+1.5,K+=String(x)+":"),K+=oc[m].ca+":",K+=0<oc[m].crv?"l":"r",m<oc.length-1&&(K+=";");return K+"\u00bf"}function sc(m){var u=0,q="\u00a7";if(0<m.length){for(u=0;u<m.length;u++)m[u].M.sort(function(x,
G){return x-G}),m[u].L.sort(function(x,G){return x-G});m.sort(function(x,G){x=x.M.join()+x.L.join();G=G.M.join()+G.L.join();return x>G?1:G>x?-1:0})}else return"";for(u=0;u<m.length;u++)q+=m[u].M.join()+":"+m[u].L.join()+":"+String(m[u].ca)+":"+m[u].na+":"+m[u].Aa,u<m.length-1&&(q+=";");return q+"\u00a7"}function zd(){var m,u="",q="";q=u=0;q=[];var x=[],G="";if(0!==Hd.length){x=[];for(m=0;m<Hd.length;m++)q=Hd[m].split(":"),u=q[0],q=q[1],u=rb.indexOf(parseInt(u,10)),q=rb.indexOf(parseInt(q,10)),x[Hd[m]]=
Math.min(u,q);Hd.sort(function(K,B){return x[K]-x[B]});Bc={};for(m=0;m<Hd.length;m++)q=Hd[m].split(":"),u=q[0],q=q[1],G=9<m+1?"%":"",Bc[u]=void 0!==Bc[u]?Bc[u]+(G+String(m+1)):G+String(m+1),Bc[q]=void 0!==Bc[q]?Bc[q]+(G+String(m+1)):G+String(m+1)}}function Cc(m,u,q){var x=m[q].a.slice(0);x.sort(function(G,K){var B=G.t;var N=K.t;if(4===B||5===B)B=1;if(4===N||5===N)N=1;return m[q].X?m[K.p].U-m[G.p].U:me(u,q,G.p)&&me(u,q,K.p)&&B!==N?B-N:me(u,q,G.p)&&2===B&&!me(u,q,K.p)&&2===N?1:!me(u,q,G.p)&&2===B&&
me(u,q,K.p)&&2===N?-1:me(u,q,G.p)&&1<B||me(u,q,K.p)&&1<N?B-N:m[K.p].U===m[G.p].U?(aa.push({m:q,xb:G.p,yb:K.p}),0):m[K.p].U-m[G.p].U});m[q].a=x.slice(0)}function Yb(m){var u;var q=2;for(u=1;u<m.length;u++)q+=m[u].a.length-2;return q/2}function bd(m,u){var q;if(3>u.length)return!1;var x=u.slice(0);x.push(u[0]);for(u=0;u<x.length-1;u++){var G=!1;for(q=0;q<m[x[u]].a.length;q++)m[x[u]].a[q].p===x[u+1]&&(G=!0);if(!1===G)return!1}return!0}function pc(m,u){var q=m.slice(0).sort(function(K,B){return K-B}),
x=u.slice(0).sort(function(K,B){return K-B}),G=0;if(m.length!==u.length)return!1;for(G=0;G<q.length;G++)if(q[G]!==x[G])return!1;return!0}function oa(m,u){function q(sa,Va,lb,Bb,Cb,tc){sa=-1;var Jb=[];var Nb=[];Nb.push(Bb);Nb.push(Cb);var jc=Pb.splice(lb,1);Jb.push(jc);lb=0;for(Cb=Bb=!1;!Bb&&!Cb&&0<Pb.length;){if(0===tc)for(jc=0,sa=-1;jc<Pb.length;){if(Va[Pb[jc]].f===Nb[Nb.length-1]||Va[Pb[jc]].g===Nb[Nb.length-1]){sa=jc;break}jc++}else if(1===tc)for(jc=Pb.length-1,sa=-1;0<=jc;){if(Va[Pb[jc]].f===
Nb[Nb.length-1]||Va[Pb[jc]].g===Nb[Nb.length-1]){sa=jc;break}jc--}0>sa?Cb=!0:Va[Pb[sa]].f===Nb[Nb.length-1]?Nb.includes(Va[Pb[sa]].g)?Va[Pb[sa]].g===Nb[0]&&2<Nb.length&&(Bb=!0,cb.push(Nb),jc=Pb.splice(sa,1),Jb.push(jc),fa.push(Jb)):(Nb.push(Va[Pb[sa]].g),jc=Pb.splice(sa,1),Jb.push(jc)):Nb.includes(Va[Pb[sa]].f)?Va[Pb[sa]].f===Nb[0]&&2<Nb.length&&(Bb=!0,cb.push(Nb),jc=Pb.splice(sa,1),Jb.push(jc),fa.push(Jb)):(Nb.push(Va[Pb[sa]].f),jc=Pb.splice(sa,1),Jb.push(jc));lb++;if(20<lb)return}if(Bb)return!0;
if(Cb)return!1}function x(sa,Va,lb){var Bb;for(Bb=0;Bb<sa.length;Bb++)if(Z[sa[Bb]].f===Va&&Z[sa[Bb]].g===lb||Z[sa[Bb]].f===lb&&Z[sa[Bb]].g===Va)return Bb;return-1}function G(sa,Va){var lb;for(lb=0;lb<Le.length;lb++)if(sa[se[Va]].f===Le[lb]||sa[se[Va]].g===Le[lb])return!0;return!1}function K(sa){var Va,lb;for(lb=0;lb<Le.length;lb++){var Bb=[];for(Va=0;Va<se.length;Va++)sa[se[Va]].f===Le[lb]?Bb.push(sa[se[Va]].g):sa[se[Va]].g===Le[lb]&&Bb.push(sa[se[Va]].f);Y[lb]=Bb.slice(0)}}var B,N,fa=[],Y=[],ia=
[];var ba=[];ia=0;var Oa=[],nb=[];ba=[];var Pa=[],wa=[];ia=ba=0;var fc=[],eb=[];Ci=Yb(m);Eh(m,u);(function(sa,Va){var lb,Bb;Le=[];for(lb=0;lb<rd.length;lb++){var Cb=0;if(2<sa[rd[lb]].a.length){for(Bb=0;Bb<sa[rd[lb]].a.length;Bb++)me(Va,rd[lb],sa[rd[lb]].a[Bb].p)&&Cb++;3<=Cb&&Le.push(rd[lb])}}})(m,u);Pb=[];for(B=0;B<se.length;B++)G(u,B)||Pb.push(se[B]);cb=[];for(fa=[];0<Pb.length;)q(m,u,0,u[Pb[0]].f,u[Pb[0]].g,0);yg=cb.length;Ca=cb.slice(0);if(0<Le.length){ia=[];for(B=0;B<se.length;B++)ia.push(se[B]);
for(B=0;B<cb.length;B++){for(N=0;N<cb[B].length-1;N++)ba=x(ia,cb[B][N],cb[B][N+1]),ia.splice(ba,1);ba=x(ia,cb[B][0],cb[B][cb[B].length-1]);ia.splice(ba,1)}Y=[];K(u);for(ba=0;ba<Le.length;ba++)for(N=0;N<Y[ba].length;N++){Pb=[];for(B=0;B<ia.length;B++)Pb[B]=ia[B];B=x(Pb,Le[ba],Y[ba][N]);q(m,u,B,Le[ba],Y[ba][N],0);q(m,u,B,Le[ba],Y[ba][N],1)}for(B=yg;B<cb.length-1;){for(N=B+1;N<cb.length;)N>B&&pc(cb[B],cb[N])&&(cb.splice(N,1),fa.splice(N,1),N--),N++;B++}for(B=yg;B<cb.length-1;){for(N=B+1;N<cb.length;){if(!pc(cb[B],
cb[N])&&(cb[B].length>cb[N].length?(Oa=cb[B].slice(0),nb=cb[N].slice(0)):cb[N].length>cb[B].length&&(Oa=cb[N].slice(0),nb=cb[B].slice(0)),ba=[],ba=Gh(Oa,nb),pc(ba,nb))){Pa=[];for(ba=0;ba<Oa.length-1;ba++)Pa.push(Ia(u,Oa[ba],Oa[ba+1]));Pa.push(Ia(u,Oa[Oa.length-1],Oa[0]));wa=[];for(ba=0;ba<nb.length-1;ba++)wa.push(Ia(u,nb[ba],nb[ba+1]));wa.push(Ia(u,nb[nb.length-1],nb[0]));for(ba=ia=0;ba<wa.length;ba++)Pa.includes(wa[ba])||(ia=wa[ba]);ba=Math.min(Oa.indexOf(u[ia].f),Oa.indexOf(u[ia].g));ia=Math.max(Oa.indexOf(u[ia].f),
Oa.indexOf(u[ia].g));ba=nb.includes(Oa[ba+1])?Oa.slice(ia).concat(Oa.slice(0,ba+1)):Oa.slice(ba,ia-ba+1);fc.push(ba);eb.push(Oa)}N++}B++}for(B=0;B<fc.length-1;){for(N=B+1;N<fc.length;)N>B&&pc(fc[B],fc[N])&&(fc.splice(N,1),N--),N++;B++}for(B=0;B<eb.length-1;){for(N=B+1;N<eb.length;)N>B&&pc(eb[B],eb[N])&&(eb.splice(N,1),N--),N++;B++}for(B=0;B<eb.length;B++)for(N=0;N<cb.length;N++)pc(eb[B],cb[N])&&(cb.splice(N,1),N--);for(ba=0;ba<fc.length;ba++)cb.push(fc[ba]);for(B=0;B<cb.length;B++)!1===bd(m,cb[B])&&
(cb.splice(B,1),fa.splice(B,1),B--);for(B=0;B<cb.length-1;){for(N=B+1;N<cb.length;)N>B&&pc(cb[B],cb[N])&&(cb.splice(N,1),fa.splice(N,1),N--),N++;B++}cb.sort(function(sa,Va){return sa.length-Va.length})}}function te(m,u){var q,x="";if(0!==u.length%2)return!1;var G=u.slice(0);G.push(u[0]);for(u=0;u<G.length-1;u++)for(q=0;q<m[G[u]].a.length;q++)m[G[u]].a[q].p===G[u+1]&&(x+=2===m[G[u]].a[q].t?"1":"0");return/00/.test(x)||/11/.test(x)?!1:!0}function mh(m,u){function q(sa,Va){var lb;for(lb=0;lb<Va.length;lb++)if(pc(Va[lb],
sa))return!0}function x(sa,Va,lb){var Bb,Cb=sa,tc=[];var Jb=[];Jb.push(Va);tc.push(sa);for(Va=0;0<Jb.length;){sa=Jb.pop();var Nb=tc.includes(sa);if(!Nb){if(0<tc.length)for(Bb=tc.length-1;0<=Bb;Bb--)if(N[String(sa)].includes(tc[Bb])){Cb=tc[Bb];break}tc.push(sa);var jc=[];for(Bb=0;Bb<N[String(sa)].length;Bb++)N[String(sa)][Bb]!==Cb&&((Nb=tc.includes(N[String(sa)][Bb]))||jc.push(N[String(sa)][Bb]));if(2===jc.length)Bb=parseInt(fc[lb].charAt(nb.indexOf(sa)),10),void 0===fa[String(Cb)+"-"+String(sa)]||
0!==Bb&&1!==Bb||Jb.push(fa[String(Cb)+"-"+String(sa)][Bb][0]);else if(1===jc.length)Jb.push(jc[0]);else return tc.slice(0)}Va++;if(200<Va)break}}function G(sa){var Va;for(Va=0;Va<sa.length;Va++)if(!K.includes(sa[Va]))return!1;return!0}var K=[],B=[],N={},fa={},Y=0,ia;var ba=ia=0;ba=[];var Oa=ia=0;ba=[];Oa=0;var nb=[];var Pa=[];var wa=1;var fc=[];Pa=!1;var eb=0;eb=0;for(Y=1;Y<m.length;Y++)m[Y].X=!1;mf=[];for(fb in N)N.hasOwnProperty(fb)&&delete N[fb];for(fb in fa)fa.hasOwnProperty(fb)&&delete fa[fb];
for(wa=0;wa<rd.length;wa++){for(Y=ba=ia=Pa=0;Y<m[rd[wa]].a.length;Y++)2===m[rd[wa]].a[Y].t&&Pa++,2===m[rd[wa]].a[Y].t&&me(u,rd[wa],m[rd[wa]].a[Y].p)&&ia++,2!==m[rd[wa]].a[Y].t&&1===Ke(m,u,m[rd[wa]].a[Y].p)&&ba++;1===ia&&3>=m[rd[wa]].a.length&&1===Pa&&K.push(rd[wa])}if(!(4>K.length)){for(wa=0;wa<Ca.length;wa++)if(te(m,Ca[wa])&&G(Ca[wa]))for(mf.push(cb.indexOf(Ca[wa])),Y=0;Y<Ca[wa].length;Y++)m[Ca[wa][Y]].X=!0,K.splice(K.indexOf(Ca[wa][Y]),1);else for(Y=0;Y<Ca[wa].length;Y++)K.includes(Ca[wa][Y])&&
K.splice(K.indexOf(Ca[wa][Y]),1);Pa=[];for(wa=0;wa<K.length;wa++)3===m[K[wa]].a.length&&K.includes(m[K[wa]].a[0].p)&&K.includes(m[K[wa]].a[1].p)&&K.includes(m[K[wa]].a[2].p)&&Pa.push(K[wa]);for(wa=0;wa<K.length;wa++)for(Y=0;Y<m[K[wa]].a.length;Y++)K.includes(m[K[wa]].a[Y].p)&&(void 0===N[String(K[wa])]?N[String(K[wa])]=[m[K[wa]].a[Y].p]:N[String(K[wa])].push(m[K[wa]].a[Y].p));if(0<Pa.length){for(wa=0;wa<Pa.length;wa++)for(ia=0;3>ia;ia++){Y=N[String(Pa[wa])][ia];fb=String(Y)+"-"+String(Pa[wa]);fa[fb]=
[];ba=[];for(Y=0;Y<N[String(Pa[wa])].length;Y++)Y!==ia&&ba.push(N[String(Pa[wa])][Y]);fa[fb].push(ba.slice(0));fa[fb].push(ba.reverse().slice(0))}fc=[];wa=Math.pow(2,Pa.length-1)-1;Y=wa.toString(2).length;for(wa=0;wa<Y;wa++);for(wa=0;wa<Math.pow(2,Pa.length-1);wa++)fc[wa]=Jm(wa.toString(2),Y);for(Y=0;Y<Pa.length;Y++)for(eb=Pa[Y],nb=Pa.slice(0),nb.splice(nb.indexOf(eb),1),wa=Oa=0;wa<N[String(eb)].length;wa++)for(ia=0;ia<fc.length;ia++)ba=x(eb,N[String(eb)][wa],ia),Oa++,bd(m,ba)&&!q(ba,B)&&B.push(ba)}else{for(wa=
eb=0;wa<K.length;wa++)if(!m[K[wa]].X&&void 0!==N[String(K[wa])]&&1<N[String(K[wa])].length){eb=K[wa];break}if(0!==eb)for(Y=0;Y<N[String(eb)].length;Y++)if(void 0!==N[String(N[String(eb)][Y])]&&1<N[String(N[String(eb)][Y])].length&&(ba=x(eb,N[String(eb)][Y],-1),bd(m,ba)&&!q(ba,B))){B.push(ba);break}}for(wa=0;wa<B.length;wa++)if(te(m,B[wa]))for(ia=0;ia<B[wa].length;ia++)m[B[wa][ia]].X=!0;for(wa=0;wa<cb.length;wa++)if(8>=cb[wa].length&&0===cb[wa].length%2){Pa=!1;for(Y=ia=0;Y<cb[wa].length-1;Y++)2===
u[Ia(u,cb[wa][Y],cb[wa][Y+1])].B&&ia++;2===u[Ia(u,cb[wa][cb[wa].length-1],cb[wa][0])].B&&ia++;ia===cb[wa].length/2&&(Pa=!0);for(Y=0;Y<cb[wa].length;Y++){for(ba=Oa=eb=0;ba<m[cb[wa][Y]].a.length;ba++){ia=m[cb[wa][Y]].a[ba].t;if(4===ia||5===ia)ia=1;1<ia&&Oa++;eb+=ia}if(4<eb||1<Oa){Pa=!1;break}}for(ba=0;ba<cb[wa].length;ba++)1<Ke(M,Ha,rd[ba])&&(Pa=!1);if(Pa)for(Y=0;Y<cb[wa].length;Y++)m[cb[wa][Y]].X=!0}}}function Vb(m){var u;for(u=0;u<cb.length;u++)if(cb[u].includes(m))return u;return-1}function Ld(m,
u){var q,x,G=[];for(q=0;q<cb.length;q++){var K=cb[q].slice(0);K.push(cb[q][0]);for(x=0;x<K.length-1;x++){var B=Ia(m,K[x],K[x+1]);0<B&&B===u&&G.push(q)}}return G}function Ee(m,u){var q=[];for(m=0;m<cb.length;m++)cb[m].includes(u)&&q.push(m);return q}var S,qc,Qb,we="",ic=-1,fb,Ji="",ee=0,Qg=1,yg=0,Sc="",uc=0,Ff=0,fe=0,Db=-1,Fe="",gb=[],Bd=0,Cd=1,Dd=0,cd=0,zg="",R=0,hg=[],gc=[],Rg=[],ph=[],mf=[],ue=[],Xc={},kf=[],W=[],E={},aa=[],Ca=[],Qa=[],yb=[],ab=[],Gb=[],Ib=[],Ba=[],Ab=[],Mb=[],Pb=[],Eb=[],ac=[],
Nc=[],Ef={},Df=[],Zb=[],gg=[],xg=[],Ii=[],rb=[],Oe=[],Ag=0,Tf=0;Lc=[];Kd="";oc=[];for(S=0;S<Na.length;S++)rk(Na,oc,S,S);wk(g,ef,Z,ff);(function(m,u){var q,x;for(q=1;q<m.length;){if(1===m[q].j&&0<m[q].a.length&&1!==m[m[q].a[0].p].j){if(0<oc.length)for(x=0;x<oc.length;x++)0>oc[x].G&&Number.isInteger(oc[x].G)&&(u[-1*oc[x].G].f===q||u[-1*oc[x].G].g===q)&&(oc[x].G=-1*m[q].a[0].p-.5),0<oc[x].K&&Number.isInteger(oc[x].K)&&oc[x].K===q&&(oc[x].K=m[q].a[0].p+.5);0===m[q].N?(m[m[q].a[0].p].Fa=m[q].x,m[m[q].a[0].p].Ga=
m[q].y,m[m[q].a[0].p].ja=m[q].z):2===m[q].N?(m[m[q].a[0].p].wa=m[q].x,m[m[q].a[0].p].xa=m[q].y,m[m[q].a[0].p].ma=m[q].z):3===m[q].N&&(m[m[q].a[0].p].Da=m[q].x,m[m[q].a[0].p].ca=m[q].y,m[m[q].a[0].p].tz=m[q].z);ki(m,u,q,!1);q--}q++}})(ef,ff);for(S=1;S<ef.length;S++)ef[S].Ca=S;for(S=1;S<ff.length;S++)ff[S].Ca=S;var Gf=1;for(R=0;R<ef.length-1;){lc=[];ee=0;for(S=1;S<ef.length;S++)if(0===ef[S].v){ee=S;break}if(0===ee)break;Dd=Ih(ef,ee);R+=Dd;for(S=0;S<lc.length;S++)for(ef[lc[S]].v=Gf,qc=0;qc<ff.length;qc++)if(lc.includes(ff[qc].f)||
lc.includes(ff[qc].g))ff[qc].v=Gf;Gf++}Gf--;Qg=Gf;Qa=[];Ff=0;for(Gf=1;Gf<=Qg;Gf++){a(Gf);for(S=1;S<M.length;S++)M[S].I="",void 0!==Pg[String(S)]&&(Pg[String(S)]=""),void 0!==Ef[String(S)]&&(Ef[String(S)]="");yg=Ci=0;Kd="";Ki=qh=1;hg=[];gc=[];ph=[];Le=[];Pg=[];dg=[];mf=[];kf=[];W=[];jf=[];aa=[];Ze=[];Ib=[];Ba=[];Ff=0;Ab=[];eg=[];Bc=[];Mb=[];rd=[];se=[];Pb=[];Hd=[];cb=[];ac=[];Nc=[];Ef={};Df=[];nc=[];Zb=[];gg=[];Ii=[];xg=[];rb=[];lc=[];for(fb in E)E.hasOwnProperty(fb)&&delete E[fb];for(fb in Xc)Xc.hasOwnProperty(fb)&&
delete Xc[fb];Ff=M[1].t;Ki=qh=1;Ci=Yb(M);0<Ci&&(oa(M,Ha),mh(M,Ha));for(S=0;S<cb.length;S++)ue[S]=[];b(M);l(M);for(S=1;S<M.length;S++)Cc(M,Ha,S);Kl(M);ta(M,Ha);Ua(M,Ha);C(M,Ha);ya(M,Ha);l(M);Mh=!1;for(S=1;S<M.length;S++)Cc(M,Ha,S),""!=M[S].I&&(Mh=!0);Ta(M,Ha,"reset");0<ac.length&&(Mh=!0);gb=[];for(S=1;S<M.length;S++)1===M[S].U&&gb.push(S);if(gb.length===M.length-1||!1===Mh)for(gb.length=1,c(M,Ha,gb[0]),l(M),S=1;S<M.length;S++)Cc(M,Ha,S);f(M);qh=1;Zb=[];for(S=1;S<M.length;S++)qh*=t(S);if(0<Zb.length&&
!1===Mh)for(Ad(M,Ha,gb[0]),Ub(M,Ha,gb[0]),S=0;S<rb.length;S++)if(-1<(ic=Zb.indexOf(rb[S]))){Db=Zb[ic];Zb.splice(ic,1);qh/=t(Db);break}r();w(qh);for(qc=0;qc<gb.length;qc++)for(Cd=gb[qc],Ki=qh,fe=0;0<Ki;){for(S=0;S<Zb.length;S++)A(Zb[S],Mb[fe][S]);Ad(M,Ha,Cd);Ub(M,Ha,Cd);zd();for(S=Tf=0;S<Hd.length;S++)Oe=Hd[S].split(":"),Ag=Ia(Ha,parseInt(Oe[0],10),parseInt(Oe[1],10)),M[Ha[Ag].f].X||M[Ha[Ag].g].X||!(0<Ag)||2!==Ha[Ag].B&&3!==Ha[Ag].B||(Tf=Ag);if(0<Tf)for(Eb=Ld(Ha,Tf),Eb=Eb.concat(Ee(M,Ha[Tf].f)),Eb=
Eb.concat(Ee(M,Ha[Tf].g)),fg(Eb),S=0;S<cb.length;S++)Eb.includes(S)&&te(M,cb[S])&&wi.push(S);else{0<ac.length&&Pc(M,Ha);0<Nc.length&&xb(M,Ha,"gen");uc=0;for(Bd=ec(M);uc!==Bd;)uc=Bd,ya(M,Ha),Ua(M,Ha),Ta(M,Ha,"add"),0<ac.length&&Pc(M,Ha),ta(M,Ha),0<Nc.length&&xb(M,Ha,"gen"),Bd=ec(M);for(fb in E)E.hasOwnProperty(fb)&&(0!==E[fb].P&&void 0!==Bc[String(E[fb].w)]?void 0!==Bc[String(E[fb].w)]&&Bc[String(E[fb].O)]===Bc[String(E[fb].w)]&&(cd=E[fb].O,E[fb].O=E[fb].P,E[fb].P=cd,E[fb].T*=-1):0!==E[fb].P&&nc.indexOf(E[fb].O)>
nc.indexOf(E[fb].P)&&(cd=E[fb].O,E[fb].O=E[fb].P,E[fb].P=cd,E[fb].T*=-1),0!==E[fb].R&&void 0!==Bc[String(E[fb].t)]?void 0!==Bc[String(E[fb].t)]&&Bc[String(E[fb].R)]===Bc[String(E[fb].t)]&&(cd=E[fb].S,E[fb].S=E[fb].R,E[fb].R=cd,E[fb].T*=-1):0!==E[fb].R&&nc.indexOf(E[fb].S)>nc.indexOf(E[fb].R)&&(cd=E[fb].S,E[fb].S=E[fb].R,E[fb].R=cd,E[fb].T*=-1));Sc="";for(S=0;S<nc.length;S++)0<S&&(Sc+=","),Sc+=String(M[nc[S]].Ca);Kd=Za(M);gc.includes(Kd)||(gc.push(Kd),hg.push(Sc))}fe++;Ki--}if(0===gc.length)return-1;
1<gc.length&&(Rg=gc.slice(0),gc.sort(function(m,u){return m.length===u.length?m>u?-1:m<u?1:0:m.length-u.length}));for(S=0;S<Rg.length;S++)if(gc[0]===Rg[S]){Sc=hg[S];break}Kd=gc[0];Qa.push(Kd);yb.push(Sc);ab.push(Ff)}Gb=[];for(S=0;S<Qa.length;S++)Gb.push(Qa[S]+"!"+yb[S]+"!"+String(ab[S]));Gb.sort(function(m,u){m=m.split("!");u=u.split("!");return m[0]===u[0]?0:m[0].length===u[0].length?m[0]>u[0]?-1:m[0]<u[0]?1:0:u[0].length-m[0].length});zg=Sc=Kd="";for(S=0;S<Gb.length;S++){var Id=Gb[S].split("!");
0<S&&(Kd+=".",Sc+=".",zg+=".");Kd+=Id[0];Sc+=Id[1];zg+=Id[2]}nc=Sc.split(/[,.]/);0<Na.length&&(we=Lb(ef,ff,nc));Ji=function(m,u){var q,x="";for(q=0;q<u.length;q++)0<m[u[q]].H&&(x+=String(q+1)+":"+String(m[u[q]].H)+";");return""!==x?x="!"+x.slice(0,-1)+"!":""}(ef,nc);if(0<pa.length){gf=[];for(S=0;S<pa.length;S++)lj(pa,gf,S,S);ab=[];ab=zg.split(".");for(qc=0;qc<gf.length;qc++){for(Qb=0;Qb<gf[qc].M.length;Qb++)ab.includes(String(gf[qc].M[Qb]))&&(gf[qc].M[Qb]=ab.indexOf(String(gf[qc].M[Qb]))+1);for(Qb=
0;Qb<gf[qc].L.length;Qb++)ab.includes(String(gf[qc].L[Qb]))&&(gf[qc].L[Qb]=ab.indexOf(String(gf[qc].L[Qb]))+1)}Fe=sc(gf)}Kd=Kd+we+Ji+Fe;return 1}function dk(a){function b(){var W,E;var aa=ra.b+10;var Ca=ra.t+10;var Qa=[];var yb=[];for(E=W=0;E<md.length;E++){aa>ra.b+ra.c-10-md[E].c&&(aa=ra.b+10,Ca+=10+W,W=0);W=Math.max(W,md[E].h);var ab=aa+md[E].c+20;Qa.push(aa-md[E].b+20);yb.push(Ca-md[E].t+10);aa=ab+10}for(E=0;E<md.length;E++)Ta(E,Qa[E],yb[E]),md[E].b+=Qa[E],md[E].t+=yb[E]}function c(W){var E,aa;
var Ca=ra.b;W+=10;for(aa=E=0;aa<hf.length;aa++)if(tk.includes(aa)){Ca>ra.b+ra.c-10-md[aa].c&&(Ca=ra.b,W+=10+E,E=0);E=Math.max(E,md[aa].h);var Qa=Ca+md[aa].c+20;Ca-=md[aa].b;var yb=W-md[aa].t;Ta(aa,Ca,yb);md[aa].b+=Ca;md[aa].t+=yb;Ca=Qa+10}}function e(W){var E,aa,Ca,Qa=[],yb=[];for(E=0;E<W.length;E++)for(aa=0;aa<W.length;aa++)if(E!==aa&&!tj(W[E].M,W[aa].L)){var ab=!1;for(Ca=0;Ca<W[aa].L.length;Ca++)W[E].M.includes(W[aa].L[Ca])&&(ab=!0);ab&&(Ca=Ei(W[aa].L,W[E].M),W[aa].L=Ca.slice(0),W[E].M=Ca.slice(0))}for(E=
0;E<W.length;)zk(W[E].M,Qa)||Qa.push(W[E].M),zk(W[E].L,yb)||yb.push(W[E].L),E++;for(E=0;E<Qa.length;)Rc.push(new Ad(Qa[E])),E++;for(E=0;E<yb.length;)zk(yb[E],Qa)||Rc.push(new Ad(yb[E])),E++;for(E=0;E<W.length;)aa=Pc(W[E].L,Rc),Qa=Pc(W[E].M,Rc),-1<aa&&-1<Qa&&(Rc[aa].eb.push(new Sb(Qa,E+ue)),Rc[Qa].Qa.push(new Sb(aa,E+ue))),E++;for(E=0;E<Rc.length;)0!==Rc[E].eb.length||Ld.includes(E)||Ld.push(E),0!==Rc[E].Qa.length||Vb.includes(E)||Vb.push(E),E++}function l(W){var E,aa,Ca=ra.b+ra.c/2;for(E=0;E<Rc.length;E++){var Qa=
r(E);var yb=ra.b;lh=lh.concat(Qa);for(aa=0;aa<Qa.length;aa++){var ab=yb+md[Qa[aa]].c/2;Ta(Qa[aa],ab-Ca,0);yb+=md[Qa[aa]].c+W}}mj();qk()}function f(){var W;lh=[];for(W=0;W<Rc.length;W++){var E=r(W);lh=lh.concat(E)}}function t(){var W,E=[];for(W=0;W<hf.length;W++)lh.includes(W)||E.push(W);return E}function r(W){var E,aa=Rc[W].ia.slice(0),Ca=[];for(W=0;W<aa.length;W++)for(E=0;E<hf.length;E++)hf[E].includes(aa[W])&&!Ca.includes(E)&&Ca.push(E);return Ca}function w(W){var E;for(E=0;E<Ld.length;E++)fb.push({G:Ld[E],
path:A(W,Ld[E],E)})}function A(W,E,aa){var Ca=[],Qa={},yb=0,ab=[];Ca.push(E);ab.push(E);for(Qa[String(E)]=0;0<Ca.length;){var Gb=Ca.shift();for(E=0;E<W[Gb].Qa.length;E++){var Ib=W[Gb].Qa[E].tb;ab.includes(Ib)||(ab.push(Ib),Qa[String(Ib)]=Qa[String(Gb)]+1,Ca.push(Ib))}}for(E=0;E<ab.length;E++)W[ab[E]].path=aa,W[ab[E]].pa=Qa[String(ab[E])],0<E&&W[ab[E]].pa===W[ab[E-1]].pa?yb++:yb=1,W[ab[E]].Va=yb;return ab.slice(0)}function C(W){var E,aa=fb[W].path,Ca=[];for(W=1;W<aa.length;W++)for(E=0;E<pa.length;E++)if(vg(pa[E].M,
Rc[aa[W-1]].ia)&&vg(pa[E].L,Rc[aa[W]].ia)||vg(pa[E].L,Rc[aa[W-1]].ia)&&vg(pa[E].M,Rc[aa[W]].ia)){Ca.push(E);break}return Ca}function ya(){var W=!1,E=1,aa,Ca=0,Qa,yb=ra.t,ab=0,Gb,Ib=0,Ba=[],Ab=18*$a;for(Qa=0;Qa<fb.length;Qa++){var Mb=0;for(W=!1;Mb<fb[Qa].path.length;)Ca=fb[Qa].path[Mb],1<Rc[Ca].Va&&(W=!0),Mb++}for(Qa=0;Qa<fb.length;Qa++){for(Mb=0;Mb<fb[Qa].path.length;)Ca=fb[Qa].path[Mb],ab=Math.max(ab,sb[Ca].h),Mb++;var Pb=ra.b;var Eb=yb+3*$a+ab/2;Mb=aa=0;var ac=-1;for(Gb=0;Mb<fb[Qa].path.length;){var Nc=
fb[Qa].path[Mb];Ib=Math.max(Ib,Nc);var Ef=sb[Nc].b+sb[Nc].c/2;var Df=sb[Nc].t+sb[Nc].h/2;var Zb=Eb-sb[Nc].h/2;if(Rc[Nc].pa!==aa){aa++;1===E?Gb=1.125*sb[ac].c+Ab+.125*sb[Nc].c:-1===E&&(Gb=-1*(1.125*sb[Nc].c+Ab+.125*sb[ac].c));var gg=1.125*sb[ac].c+Ab+1.125*sb[Nc].c;var xg=.125*sb[ac].c+Ab+1.125*sb[Nc].c;if(!1===W&&1===E&&sb[ac].b+gg>ra.b+ra.c){for(Eb=0;Eb<Ba.length;Eb++)sb[Ba[Eb]].t+sb[Ba[Eb]].h>yb&&(yb=sb[Ba[Eb]].t+sb[Ba[Eb]].h);Gb=(sb[ac].c-sb[Nc].c)/2;Eb=yb+Ab+3*$a;Zb=Eb-sb[Nc].h/2;E=0}else if(!1===
W&&0===E)E=Math.abs(ra.b+ra.c-Pb)<Math.abs(ra.b-Pb)?-1:1,-1===E?Gb=-1*(.125*sb[ac].c+Ab+1.125*sb[Nc].c):1===E&&(Gb=.125*sb[ac].c+Ab+1.125*sb[Nc].c);else if(!1===W&&-1===E&&sb[ac].b-xg<za.b){for(Eb=0;Eb<Ba.length;Eb++)sb[Ba[Eb]].t+sb[Ba[Eb]].h>yb&&(yb=sb[Ba[Eb]].t+sb[Ba[Eb]].h);Gb=(sb[ac].c-sb[Nc].c)/2;Eb=yb+Ab+3*$a;Zb=Eb-sb[Ca].h/2;E=0}}else 1<Rc[Nc].Va&&(Zb+=sb[ac].h+3*$a,Eb+=sb[ac].h+3*$a,Gb=0);Pb+=Gb;gg=Pb+sb[Nc].c/2;xg=Zb+sb[Nc].h/2;for(ac=0;ac<Rc[Nc].ia.length;ac++)Nh(g,gg-Ef,xg-Df,Rc[Nc].ia[ac]);
sb[Nc].b=Pb;sb[Nc].t=Zb;Ba.push(Nc);ac=Nc;Mb++}for(Eb=0;Eb<Ba.length;Eb++)sb[Ba[Eb]].t+sb[Ba[Eb]].h>yb&&(yb=sb[Ba[Eb]].t+sb[Ba[Eb]].h)}if(Rc.length>Ib)for(Pb=ra.b,Zb=yb+3*$a,Eb=Ib+1;Eb<Rc.length;Eb++)for(E=Rc[Eb].ia.slice(0),ac=0;ac<Rc[Eb].ia.length;ac++)W=E[ac],-1<xb(W)?Nh(g,ne[xb(W)].kb,ne[xb(W)].lb,W):Nh(g,Pb-sb[Eb].b,Zb-sb[Eb].t,Rc[Eb].ia[ac]),sb[Eb].b=Pb,sb[Eb].t=Zb,Pb+=sb[Eb].c+3*$a,Pb>ra.b+ra.c&&(Pb=ra.b,Zb+=yb+3*$a)}function Da(W){var E,aa=[],Ca=new $c(0,0),Qa=new $c(0,0),yb=new $c(0,0),ab=
new $c(0,0);pk();for(E=1;E<g.length;E++)g[E].t===W&&aa.push(E);var Gb=[];for(E=0;E<aa.length;E++)Gb.push(g[aa[E]].j);var Ib=ld(g[aa[0]].x,g[aa[0]].y,g[aa[aa.length-1]].x,g[aa[aa.length-1]].y);ab.x=0;for(E=ab.y=0;E<aa.length;E++)ab.x+=g[aa[E]].x,ab.y+=g[aa[E]].y;ab.x=ab.x/aa.length;ab.y=ab.y/aa.length;for(E=0;E<aa.length;E++)Ca.y+=g[aa[E]].j*Math.pow(g[aa[E]].x-ab.x,2),Ca.x+=g[aa[E]].j*Math.pow(g[aa[E]].y-ab.y,2),0<g[aa[E]].x-ab.x?Qa.y+=g[aa[E]].j*Math.pow(g[aa[E]].x-ab.x,2):0>g[aa[E]].x-ab.x&&(yb.y+=
g[aa[E]].j*Math.pow(g[aa[E]].x-ab.x,2)),0<g[aa[E]].y-ab.y?Qa.x+=g[aa[E]].j*Math.pow(g[aa[E]].y-ab.y,2):0>g[aa[E]].y-ab.y&&(yb.x+=g[aa[E]].j*Math.pow(g[aa[E]].y-ab.y,2));void 0===Db[String(W)]?Db[String(W)]={ub:W,Ea:ab,sb:Ca,da:Qa,ha:yb,Ka:Ib,La:Gb}:(Db[String(W)].ub=W,Db[String(W)].Ea=ab,Db[String(W)].sb=Ca,Db[String(W)].da=Qa,Db[String(W)].ha=yb,Db[String(W)].Ka=Ib,Db[String(W)].La=Gb)}function ja(W,E){var aa=W.split(";");for(W=0;W<aa.length;W++){var Ca=aa[W].split(":");g[te[parseInt(Ca[0],10)]+
E].H=parseInt(Ca[1],10)}}function Ua(W,E){var aa,Ca=0,Qa=0,yb=1;var ab=W.split(";");for(W=0;W<ab.length;W++){var Gb=ab[W].split(":");if(4===Gb.length){if(/\d-\d/.test(Gb[0])){var Ib=Gb[0].split("-");var Ba=te[parseInt(Ib[0],10)]+E;Ib=te[parseInt(Ib[1],10)]+E;Ba=Ia(Z,Ba,Ib);0<Ba&&(Ca=-1*Ba)}else if(Number(Gb[0]))if(Number.isInteger(Number(Gb[0])))Ca=te[parseInt(Gb[0],10)]+E;else if(Ca=Number(Gb[0]),0>Ca){Ba=te[Math.floor(-1*Ca)]+E;for(Ib=aa=0;Ib<g[Ba].a.length;Ib++)if(1===g[Ba].a[Ib].t&&1===g[g[Ba].a[Ib].p].j){aa=
g[Ba].a[Ib].p;break}0===aa?(Nf(g,Ba),Ib=1===g[Ba].a.length?ha(Ya(g,g[Ba].a[0].p,Ba)+60):Hh(g,Ba),ec(g,Z,Ba,Ib,1),Ba=Ia(Z,Ba,g.length-1)):Ba=Ia(Z,Ba,aa);Ca=-1*Ba}if(/\d-\d/.test(Gb[1]))Ib=Gb[1].split("-"),Ba=te[parseInt(Ib[0],10)]+E,Ib=te[parseInt(Ib[1],10)]+E,Ba=Ia(Z,Ba,Ib),0<Ba&&(Qa=-1*Ba);else if(Number(Gb[1]))if(Number.isInteger(Number(Gb[1])))Qa=te[parseInt(Gb[1],10)]+E;else if(Qa=Number(Gb[1]),0<Qa){Ba=te[Math.floor(Qa)]+E;for(Ib=aa=0;Ib<g[Ba].a.length;Ib++)if(1===g[Ba].a[Ib].t&&1===g[g[Ba].a[Ib].p].j){aa=
g[Ba].a[Ib].p;break}0===aa?(Nf(g,Ba),Ib=1===g[Ba].a.length?ha(Ya(g,g[Ba].a[0].p,Ba)+60):Hh(g,Ba),ec(g,Z,Ba,Ib,1),Qa=g.length-1):Qa=aa}Ba=Gb[2];"l"===Gb[3]?yb=1:"r"===Gb[3]&&(yb=-1);Gb=new jj(Ca,Qa,Ba,yb);Na.push(Gb)}}}function ta(){var W,E,aa=0,Ca=0,Qa=0,yb=0,ab,Gb="";pk();for(W=0;W<Na.length;W++){var Ib=ab=0;var Ba=Na[W].G;var Ab=Na[W].K;0>Ba&&(Ba=Z[-1*Ba].f);0>Ab&&(Ab=Z[-1*Ab].f);if(g[Ba].t!==g[Ab].t){var Mb=g[Ba].t;Ba=g[Ab].t;var Pb=E=0;for(Ab=1;Ab<g.length;Ab++)g[Ab].t===Mb&&E++,g[Ab].t===Ba&&
Pb++;Ab=E>Pb?Ba:Mb;Ba=E>Pb?Mb:Ba;E=Ba===Mb?Na[W].G:Na[W].K;Mb=Ab===Mb?Na[W].G:Na[W].K;0<E?(aa=g[E].x,Ca=g[E].y):0>E&&(aa=(g[Z[Math.abs(E)].f].x+g[Z[Math.abs(E)].g].x)/2,Ca=(g[Z[Math.abs(E)].f].y+g[Z[Math.abs(E)].g].y)/2);E=Math.abs(aa-sd[Ba].b);Pb=Math.abs(Ca-sd[Ba].t);var Eb=Math.abs(sd[Ba].b+sd[Ba].c-aa);var ac=Math.abs(sd[Ba].t+sd[Ba].h-Ca);var Nc=Math.min(E,Pb,Eb,ac);E=[E,Pb,Eb,ac].indexOf(Nc);0<Mb?(Qa=g[Mb].x,yb=g[Mb].y):0>Mb&&(Qa=(g[Z[Math.abs(Mb)].f].x+g[Z[Math.abs(Mb)].g].x)/2,yb=(g[Z[Math.abs(Mb)].f].y+
g[Z[Math.abs(Mb)].g].y)/2);Mb=Math.abs(Qa-sd[Ab].b);Pb=Math.abs(yb-sd[Ab].t);Eb=Math.abs(sd[Ab].b+sd[Ab].c-aa);ac=Math.abs(sd[Ab].t+sd[Ab].h-Ca);Nc=Math.min(Mb,Pb,Eb,ac);Mb=[Mb,Pb,Eb,ac].indexOf(Nc);switch(E){case 0:ab=sd[Ba].b-(sd[Ab].b+sd[Ab].c);Ib=Ca-yb;0===Mb&&(Gb="y");break;case 1:ab=aa-Qa;Ib=sd[Ba].t-(sd[Ab].t+sd[Ab].h);1===Mb&&(Gb="x");break;case 2:ab=sd[Ba].b+sd[Ba].c-sd[Ab].b;Ib=Ca-yb;2===Mb&&(Gb="y");break;case 3:ab=aa-Qa,Ib=sd[Ba].t+sd[Ba].h-sd[Ab].t,3===Mb&&(Gb="x")}ne.push({wb:W,jb:Ba,
Ma:Ab,kb:ab,lb:Ib,fb:Gb})}}}function xb(W){var E;for(E=0;E<ne.length;E++)if(ne[E].Ma===W)return E;return-1}function Ta(W,E,aa){var Ca=hf[W].slice(0);for(W=0;W<Ca.length;W++)Nh(g,E,aa,Ca[W]);Yc()}function Ka(W,E){var aa;hg=[];var Ca=W.split(";");for(W=0;W<Ca.length;){var Qa=[];var yb=[];var ab=Ca[W].split(":");var Gb=ab[0].split(",");for(aa=0;aa<Gb.length;)Qa.push(parseInt(Gb[aa],10)+E),aa++;Gb=ab[1].split(",");for(aa=0;aa<Gb.length;)yb.push(parseInt(Gb[aa],10)+E),aa++;aa=parseInt(ab[2],10);Gb=void 0!==
ab[3]?ab[3]:"";ab=void 0!==ab[4]?ab[4]:"";hg.push(new ij(Qa,yb,aa,Gb,ab,0,0,0,0));W++}}function Pc(W,E){for(var aa=0;aa<E.length;){if(tj(W,E[aa].ia))return aa;aa++}return-1}function ec(W,E,aa,Ca,Qa){var yb=W[aa].x+na*Math.cos(Math.PI*Ca/180);Ca=W[aa].y+-1*na*Math.sin(Math.PI*Ca/180);W[W.length]=new kb(1,"H",yb,Ca,0,0,0);W[W.length-1].t=W[aa].t;W[aa].C+=1;W[aa].Fa=yb;W[aa].Ga=Ca;W[aa].ja=0;3<Qa&&(W[aa].ja=4===Qa?1:-1);Ye(W,E,aa,W.length-1,Qa)}function Ub(W){function E(d,k,n,p){var h=0,U=0,z="",y=0,
O=!1;n=0;var D,I="",Q=0;if(D=p.match(Mm))""!==D[1]&&(z=D[1],h=0);else if(D=p.match(Tl)){""!==D[1]&&(Q=parseInt(D[1],10));if(""!==D[2]){z=D[2];Bg.includes(z)&&(O=!0,z=z[0].toUpperCase()+z.substring(1));if(!Og.includes(z))return Cd="invalidElement",-1;h=mi(z)}""!==D[6]&&(U="+"===D[6]?1:"-"===D[6]?-1:parseInt(D[6],10));""!==D[3]&&("@"===D[3]?I="@":"@@"===D[3]&&(I="@@"));"H"===D[4]&&(y=""!==D[5]?parseInt(D[5],10):1)}else{z=p;Bg.includes(p)&&(O=!0,z=z[0].toUpperCase()+z.substring(1));if(!Og.includes(z))return Cd=
"invalidElement",-1;h=mi(z)}p=d.length;d[p]=new kb(h,z,0,0,U,y,0);d[p].Ca=p;!0===O&&(d[p].X=!0);""!==I&&(d[p].I=I,gc.push(p));0<Q&&(d[p].N=Q);for(h=0;h<Ee[p].length;h++){for(U=1;U<cd.length;U++)if(cd[U].f===p&&cd[U].g===Ee[p][h]||cd[U].g===p&&cd[U].f===Ee[p][h]){n=cd[U].B;break}void 0!==d[Ee[p][h]]&&(2===d[p].N?d[Ee[p][h]].D++:3===d[p].N&&d[Ee[p][h]].F++);Ye(d,k,p,Ee[p][h],n)}return p}function aa(d,k){var n;for(n=0;n<d.length;n++)if(d[n].i.includes(k))return n;return-1}function Ca(d,k,n,p){var h,
U={},z=[],y=[];Hb=[];y.push(n);for(z.push(n);0<z.length;){var O=z.shift();if(O===p)break;for(h=0;h<d[O].a.length;h++)n=d[O].a[h].p,y.includes(n)||(y.push(n),U[String(n)]=O,z.push(n))}h=p;Hb=[];for(Hb.push(p);void 0!==U[String(h)];)U.hasOwnProperty(String(h))&&(Hb.push(U[String(h)]),h=U[String(h)]);Hb.reverse();Ed=[];for(Fb=1;Fb<Hb.length-2;Fb++)0<wa(Hb[Fb],Hb[Fb+1])||1!==k[Ia(k,Hb[Fb],Hb[Fb+1])].B||Ed.push(Ia(k,Hb[Fb],Hb[Fb+1]))}function Qa(d,k,n){var p=0;if(ge.includes(n)){for(k=0;k<d[n].a.length;k++)M[n].X&&
2===M[n].a[k].t&&p++;return p}return-1}function yb(d,k,n,p){k=[];var h=[];lf=[];k.push(n);var U=1;for(n=0;0<k.length;){var z=k.pop();var y=h.includes(z);if(!y){h.push(z);lf.push(z);if(z===p)return 1;for(y=0;y<d[z].a.length;y++)h.includes(d[z].a[y].p)||d[z].a[y].t===U&&d[d[z].a[y].p].X&&k.push(d[z].a[y].p)}U=1===U?2:1;n++;if(200<n)break}}function ab(d,k,n,p){var h;k={};var U=[],z=[];lf=[];z.push(n);for(U.push(n);0<U.length;){var y=U.shift();if(y===p)break;for(h=0;h<d[y].a.length;h++)d[d[y].a[h].p].X&&
(n=d[y].a[h].p,z.includes(n)||(z.push(n),k[String(n)]=y,U.push(n)))}h=p;lf=[];for(lf.push(p);void 0!==k[String(h)];)k.hasOwnProperty(String(h))&&(lf.push(k[String(h)]),h=k[String(h)]);lf.reverse();return lf.slice(-1)[0]===p?1:-1}function Gb(d,k,n,p){var h,U=[];for(h=0;h<d[k].a.length;h++)!n.includes(d[k].a[h].p)||0!==p&&d[k].a[h].t!==p||U.push(d[k].a[h].p);return U.slice(0)}function Ib(d,k,n){var p,h="+";if(1===n.length%2)return-1;for(p=0;p<n.length-1;p++)Of(d,k,n[p],n[p+1],h),h="+"===h?"-":"+";return 0}
function Ba(d,k,n,p){var h=[],U,z=0,y=Math.floor(ra.c/(.866*na))-3;new $c(0,0);var O="",D=0,I=0,Q=1,xa=0,ea=[210,330,150,30,90,270];var T=F[n].i.slice(0);0<p?z=p:n!==fe&&(z=F[n].m);for(U=0;U<T.length;U++){p=T[U];void 0!==S[String(z)+"-"+String(p)]&&(O=String(z)+"-"+String(p));Me(p)&&""===O&&void 0!==S[String(p)+"-"+String(Me(p))]&&(O=String(p)+"-"+String(Me(p)));var v=d;var qa=k,Sa=n,ma=U,la=qc[p],P=z,X,ca=0,ka=0,va,Ea=new $c(0,0);for(X=va=0;X<v[la].a.length;X++)void 0!==oa[String(v[la].a[X].p)]&&
va++;if(0===ma)if(Sa===fe||0===Tb)Ea.x=za.b+20,Ea.y=za.t+za.h/2;else if(0===vc.length&&ee.includes(Sa))Ea.x=za.b+za.c/2-(F[Sa].i.length-1)*na*.866/2,Ea.y=za.t+za.h/2;else if(6===v[P].a.length){for(X=la=0;X<v[P].a.length;X++)rb(v,v[P].a[X].p)&&la++;qa=ea[la];Ea.x=v[P].x+na*Math.cos(Math.PI*qa/180);Ea.y=v[P].y-na*Math.sin(Math.PI*qa/180)}else qa=Ef(v,qa,P),Ea.x=v[P].x+na*Math.cos(Math.PI*qa/180),Ea.y=v[P].y-na*Math.sin(Math.PI*qa/180),""!==Eb(P)&&(O=Eb(P),S[O].t!==T[ma]&&(O=""));else{if(1===ma){if(Sa===
fe||0===vc.length&&(mf.includes(Sa)||ee.includes(Sa))){if(!(ca=3===v.length)){ka=v;Sa=T;X=!0;for(ca=1;ca<Sa.length-1;ca++)Di(ka,Sa[ca])||Pb(ka,Sa[ca])||(X=!1);ca=X}ca=ca||2<T.length&&0<Di(v,T[ma])&&Di(v,T[ma])!==T[0]?300:330}else rb(v,P)&&rb(v,la)?ca=Ya(v,P,la):ca=270;X=Ia(qa,P,la);Sa=Ia(qa,la,T[ma]);0<X&&2===qa[X].B?void 0!==S[String(P)+"-"+String(la)]?(O=String(P)+"-"+String(la),ka=Df(v,O,T[ma])):2===qa[Sa].B&&2===v[la].a.length?(h[0]=P,h.push(la),h.push(T[ma]),ka=0):ka=60:3===qa[Sa].B?ka=3===v.length?
60:0:(void 0!==S[String(T[ma-1])+"-"+String(T[ma])]&&(O=String(T[ma-1])+"-"+String(T[ma])),ka=4===v[la].a.length&&(!gc.includes(la)||1<va)?0:2===qa[Ia(qa,la,T[ma])].B&&6===v[la].j&&2===v[la].a.length&&1===v[la].s&&6<v[T[ma]].j?0:1===ma%2?60:-60,xa++)}else if(1<ma)switch(ca=Ya(v,T[ma-2],la),Sa=Ia(qa,la,T[ma]),X=Ia(qa,T[ma-2],la),qa=String(qa[Sa].B)+"."+String(qa[X].B),qa){case "1.1":if(2<ma)if(ca=Ya(v,T[ma-3],T[ma-2]),xa>=y){ca=Ya(v,T[ma-2],T[ma-1]);if(180<ca&&0===I)I=1,D++,Q=270<ca?-1:1;else if(0===
I){ca=Ya(v,T[ma-3],T[ma-2]);ka=0;xa++;break}0<I&&4>I?(ka=60*Q,xa++,I++):4===I&&(ca=Ya(v,T[ma-3],T[ma-2]),I=ka=0,y+=1===D%2?-1:1,xa=3)}else 4===v[la].a.length&&(!gc.includes(la)||1<va)?(ca=Ya(v,T[ma-2],T[ma-1]),ka=0):(qa=Ya(v,T[ma-2],T[ma-1]),P=Ya(v,T[ma-3],T[ma-2]),2<Math.abs(qa-P)?(Ya(v,T[ma-3],T[ma-2]),ka=0):3<ma?(qa=Ya(v,T[ma-4],T[ma-3]),2<Math.abs(P-qa)?(ca=Ya(v,T[ma-4],T[ma-3]),ka=0):(ca=Ya(v,T[ma-2],T[ma-1]),ka=1===ma%2?60:-60)):(ca=Ya(v,T[ma-2],T[ma-1]),ka=1===ma%2?60:-60),xa++);else ka=1===
ma%2?60:-60,xa++;break;case "1.2":""!==O?(ca=Ya(v,T[ma-2],T[ma-1]),ka=Df(v,O,T[ma]),O=""):(ca=Ya(v,T[ma-2],T[ma-1]),ka=90<ca&&270>ca?60:-60,h=[]);break;case "1.3":ka=0;break;case "2.1":void 0!==S[String(la)+"-"+String(T[ma])]&&(O=String(la)+"-"+String(T[ma]));if(16===v[la].j&&4===v[la].a.length){ca=Ya(v,T[ma-2],T[ma-1]);ka=0;break}if(6===v[la].j&&2===v[la].a.length&&1===v[la].s&&6<v[T[ma]].j){ca=Ya(v,T[ma-2],T[ma-1]);ka=0;break}2<ma?(ca=Ya(v,T[ma-3],T[ma-2]),ka=2<Math.abs(Ya(v,T[ma-3],T[ma-2])-Ya(v,
T[ma-2],T[ma-1]))?0:1===ma%2?60:-60):2===ma&&0<P&&rb(v,P)?(ca=Ya(v,P,T[0]),ka=0):ka=1===ma%2?60:-60;break;case "2.2":2===v[la].a.length?(0===h.length&&(h.push(T[ma-2]),h.push(T[ma-1])),h.push(T[ma]),ka=0):ka=1===ma%2?60:-60;break;case "3.1":case "2.3":case "3.2":ka=2===v[la].a.length?0:1===ma%2?60:-60;break;default:ka=1===ma%2?60:-60}qa=ha(ca+ka);ma=na*Math.cos(Math.PI*qa/180);P=-1*na*Math.sin(Math.PI*qa/180);Ea.x=v[la].x+ma;Ea.y=v[la].y+P}v=Ea;if(""!==O&&"="!==Qb[p]&&0!==S[O].R&&S[O].R===p||""!==
O&&"="!==Qb[p]&&0===S[O].R&&S[O].S===p)""!==Eb(p)?O=Eb(p):O="";d[p].x=v.x;d[p].y=v.y}vc.push(n)}function Ab(d,k,n,p,h,U){var z=0;z=[];var y=na,O=0,D="",I=0,Q=0,xa=0;I=0;Q=-1;var ea=0,T=0,v=0,qa=1;qa=0;qa=1;var Sa=0,ma=[],la=0;ea=[];var P=[];qa=0;Q=[];la=0;xa=-1;if(!Ul.includes(n)){if(0<U&&La[n].includes(U)){for(;0<La[n].indexOf(U);)La[n]=La[n].splice(1,La[n].length).concat(La[n][0]);0<h&&(I=La[n][0],Q=R[U].indexOf(h),Mb(d,k,La[n][0],h,p,"chend","",1,Q,0,0,"",na),ma.push(La[n][0]))}else{if(3<=La[n].length&&
!La[n].includes(Rh)){for(ea=0;ea<La[n].length;ea++)Q=Q.concat(R[La[n][ea]].slice(0));fg(Q);Bb(k);Eh(d,k);for(ea=0;ea<Q.length;ea++){for(T=la=0;T<d[Q[ea]].a.length;T++)me(k,Q[ea],d[Q[ea]].a[T].p)&&la++;void 0!==oa[String(Q[ea])]&&2<oa[String(Q[ea])].length&&(Cb(Q[ea])||z.push(Q[ea]))}La[n].sort(function(X,ca){return lb(X)>lb(ca)?-1:lb(ca)>lb(X)?1:0});I=La[n][0]}else for(La[n].sort(function(X,ca){return R[ca].length-R[X].length}),I=La[n][0],ea=0;ea<La[n].length;ea++)if(d[R[La[n][ea]][0]].X){-1===Rh&&
(I=La[n][ea]);break}Mb(d,k,I,0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);ma.push(I)}ea=La[n].slice(0);ea.splice(ea.indexOf(I),1);ea.sort(function(X,ca){return m(d,X)!==m(d,ca)?m(d,X)?-1:1:R[ca].length-R[X].length});ea.unshift(I);La[n]=ea.slice(0);0<Cg&&(rc.push(Cg),ma.push(Cg));for(la=0;20>la&&ma.length<La[n].length;){for(ea=0;ea<ma.length;ea++)if(ma[ea]!==Cg)for(T=0;T<La[n].length;T++)if(!ma.includes(La[n][T])&&La[n][T]!==Cg&&(Q=-1,P=[],!ma.includes(La[n][T])&&(Q=Tf(ma[ea],La[n][T]),-1<Q&&
(Sa=ma[ea],qa=La[n][T],D=String(Math.min(Sa,qa))+"-"+String(Math.max(Sa,qa)),void 0===ib[D])))){q([gb[Q].ta,gb[Q].ua],R[qa])?(I=gb[Q].ta,xa=gb[Q].ua):(I=gb[Q].ua,xa=gb[Q].ta);Q=0;P=R[qa].slice(0);P.push(R[qa][0]);for(v=0;v<P.length-1;v++)if(P[v]===I){Q=v;break}for(v=0;v<d[xa].a.length;v++)d[xa].a[v].p!==I&&R[Sa].includes(d[xa].a[v].p)&&!R[qa].includes(d[xa].a[v].p)&&(O=d[xa].a[v].p);qa=B(d,I,xa,O);qa=-1*qa;Mb(d,k,La[n][T],I,xa,"bond","",qa,Q,0,0,"",na);ma.push(La[n][T])}for(ea=0;ea<ma.length;ea++)for(T=
0;T<La[n].length;T++)if(Q=-1,P=[],!ma.includes(La[n][T])&&(Q=Tf(ma[ea],La[n][T]),-1<Q&&(Sa=ma[ea],qa=La[n][T],D=String(Math.min(Sa,qa))+"-"+String(Math.max(Sa,qa)),void 0!==ib[D]))){q(ib[D],R[qa])?(I=ib[D][0],xa=ib[D][ib[D].length-1],z=ib[D][ib[D].length-2]):(I=ib[D][ib[D].length-1],xa=ib[D][0],z=ib[D][1]);Q=0;P=R[qa].slice(0);P.push(R[qa][0]);for(v=0;v<P.length-1;v++)if(P[v]===I){Q=v;break}for(v=0;v<d[xa].a.length;v++)d[xa].a[v].p!==I&&R[Sa].includes(d[xa].a[v].p)&&!R[qa].includes(d[xa].a[v].p)&&
(O=d[xa].a[v].p);qa=B(d,O,xa,z);3<ib[D].length&&(R[La[n][T]].length-ib[D].length<ib[D].length?y=.8*na:R[La[n][T]].length-ib[D].length>=ib[D].length&&(y=1.25*na));Mb(d,k,La[n][T],I,xa,"bridge","",qa,Q,0,0,D,y);ma.push(La[n][T])}for(ea=0;ea<ma.length;ea++)for(T=0;T<La[n].length;T++)if(xa=-1,P=[],!(ma.includes(La[n][T])||(xa=Ag(ma[ea],La[n][T]),-1===xa||-1<Va(Bd[xa].Ja)))){Q=0;Sa=ma[ea];qa=La[n][T];I=Bd[xa].Ja;P=R[qa].slice(0);for(v=0;v<P.length;v++)if(P[v]===I){Q=v;break}Mb(d,k,La[n][T],I,0,"atom",
"",1,Q,0,0,"",na);ma.push(La[n][T])}la++}if("m2porphin"===ig&&La[n].includes(Cg))for(jb in Pe){Pe.hasOwnProperty(jb)&&(d[Pe[jb].Ua].x=(d[Pe[jb].Sa].x+d[Pe[jb].Ta].x)/2,d[Pe[jb].Ua].y=(d[Pe[jb].Sa].y+d[Pe[jb].Ta].y)/2);break}Ul.push(n)}}function Mb(d,k,n,p,h,U,z,y,O,D,I,Q,xa){var ea=0,T=0;ea=0;var v="",qa=0,Sa=v=0,ma=qa=0,la=qa=0;ma=0;var P=1;qa=0;qa=[];la="";var X=0,ca=!1,ka=0,va=0,Ea=0;T=0;var Ja=!1,Ma=[],Tc=[];Tc=[];var gd=[];var Xa=[];var vd=[],Qe=[];vd="";var Re="normal";Ea="";var Li=[],Mi=[];
Qe=Xa=0;vd=1;var Ni=0,Bk=!0,vj=!1,nf=0,Hf=0;T=0;var Oi=[];Qe=[0,0,0,-.5*xa,-.5*xa,-.5*xa,0,0,0,0,0,0,0,0,0,0,0];Ni=[0,0,0,-.28868*xa,.5*xa,-.80902*xa,xa,0,0,0,0,0,0,0,0,0];var Nm=[0,0,0,300,270,252,270,231.43,225,220,270,270,270,270,270,338.5,0,330,330,330,332];Ja=[[[45,45,45,45,45,45,45,45],[45,45,45,45,90,-45,90,45],[72,72,72,-36,72,72,72,-36]],[[60,60,60,-48,72,72,72,-48,60],[60,40,40,40,40,40,40,60,-60]],[[60,60,60,-60,60,60,60,60,-60,60],[60,60,60,-36,72,72,-36,72,72,-36],[36,36,36,36,36,36,
36,36,36,36],[45,60,60,60,-90,60,60,60,45,0]],[[60,60,60,-60,60,60,60,-38.53,68.53,68.53,-38.53],[45,45,45,-63,72,72,72,-63,45,45,45],[72,-63,45,45,45,45,45,45,-63,72,72],[51.43,51.43,51.43,51.43,51.43,-68.57,60,60,60,60,-68.57],[60,60,60,-30,-18,72,72,72,-18,-30,60],[32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73,32.73]],[[60,60,60,-60,60,60,60,-60,60,60,60,-60],[72,72,-54,72,72,-54,72,72,-54,72,72,-54],[60,60,60,-48,-36,72,72,72,-36,72,-48,60]],[[60,60,60,-60,60,-48,72,72,72,-48,60,
-60,60],[68.53,68.53,-47.06,68.53,68.53,-68.53,60,60,60,-68.53,68.53,68.53,-47.06]],[[60,60,60,-60,60,-60,60,60,60,60,-60,60,-60,60],[60,60,60,-60,60,-60,60,60,60,60,-60,60,-60,60]],[[68.53,68.53,-68.53,60,60,60,-90,60,60,60,-90,60,60,60,-68.53],[72,72,-72,72,72,-72,72,72,-72,72,72,-72,72,72,-72]],[[60,60,-90,60,60,60,-90,60,60,60,-90,60,60,60,-90,60],[60,60,60,-60,60,-60,60,60,60,-60,60,60,-60,60,60,-60],[45,45,-45,45,45,45,45,-45,45,45,-45,45,45,45,45,-45]],[[-60,60,-60,60,60,60,-60,60,-45,75,75,
-45,60,-60,60,60,60]],[[-60,60,60,-60,60,60,-60,60,60,-60,60,60,-60,60,60,-60,60,60]],[[-60,60,60,-60,60,60,-60,60,-45,75,75,-45,60,-60,60,60,-60,60,60]],[[-63,72,72,-63,72,-63,72,72,-63,72,-63,72,72,-63,72,-63,72,72,-63,72]]];Ea=[];Ma=[0,0,0,1,2,2,2,3,0,0,0,0,0,0,3,1,2];va=[[75,69.735,70.53],[75,30,75,75]];var Om=[[.89658,.89658,.89658],[.89658,.89658,1,.89658]],Pm=[[30,131.93,36.136],[30,120,30,30]],Qm=[[.75,1.2091,1.2091],[.75,.75,1,.75]],Rm=[[140],[120,60],[75,90.964,33.148],[75,69.896,35.104,
75],[75,38,42.2,41,58.5],[65,55.2,27.3,32.5,65,55.2]],Sm=[[1.3054],[.6666,1],[.59771,1.1902,.88169],[.58232,.97813,1,.58232],[.6666,.75,.75,1,.75],[.58333,.86667,.975,1,.88333,.86667]];if(!rc.includes(n))if("m2porphin"===ig&&n===Cg)rc.push(Cg);else{z=R[n].length;for(Xa=0;Xa<R[n].length;Xa++)6!==d[R[n][Xa]].j&&(qa.push(Xa),la+=d[R[n][Xa]].o);if(0<qa.length&&0===O&&"first"===U){if(15===R[n].length&&"NNNN"===la)for(Xa=1;Xa<qa.length;Xa++){if(3===qa[Xa]-qa[Xa-1]){X=qa[Xa]-1-z;break}}else"m2porphin"===
ig||"porphin"===ig?X=qa[0]:X=qa[0]-Ma[z];O=X}Ma=R[n].slice(O,R[n].length).concat(R[n].slice(0,O));Qg[n]&&(ca=!0);if(7<z&&21>z&&""===ig){for(Xa=1;Xa<Ma.length;Xa++)if(Ea=Ia(k,Ma[Xa],Ma[Xa-1]),2===k[Ea].B)Tc[Xa-1]=1,void 0!==S[String(Ma[Xa-1])+"-"+String(Ma[Xa])]?(Ea=String(Ma[Xa-1])+"-"+String(Ma[Xa]),Ma.includes(S[Ea].O)&&Ma.includes(S[Ea].S)||!Ma.includes(S[Ea].O)&&!Ma.includes(S[Ea].S)?Tc[Xa-1]="t"===S[Ea].T?-1:1:Tc[Xa-1]="t"===S[Ea].T?1:-1):Gf(k,Ea,3)?Tc[Xa-1]=-1:Tc[Xa-1]=1;else if(Gf(k,Ea,3))Tc[Xa-
1]=-1;else if(-1<Va(Ma[Xa-1])&&Va(Ma[Xa])===Va(Ma[Xa-1]))Tc[Xa-1]=1;else if(2<d[Ma[Xa]].a.length)for(O=0;O<d[Ma[Xa]].a.length;O++)R[n].includes(d[Ma[Xa]].a[O].p)||(10<R[n].length&&(2!==d[Ma[Xa]].a[O].t||1!==d[d[Ma[Xa]].a[O].p].a.length)?0<ba(d[Ma[Xa]].a[O].p)&&ba(d[Ma[Xa]].a[O].p)!==n?Tc[Xa-1]=0:Tc[Xa-1]=1:Tc[Xa-1]=0);Tc[Ma.length-1]=0;vj=!1;Hf=0;Ea=Ja[z-8][Hf].slice(0);if(7<z&&21>z)for(;!vj&&Hf<Ja[z-8].length;){gd=[];for(O=0;O<Ja[z-8][Hf].length-1;O++)gd.push(Math.sign(Ja[z-8][Hf][O])*Math.sign(Ja[z-
8][Hf][O+1]));gd.push(Math.sign(Ja[z-8][Hf][Ja[z-8][Hf].length-1])*Math.sign(Ja[z-8][Hf][0]));Oi=gd.slice(0);for(nf=0;nf<Oi.length;){Bk=!0;for(Xa=0;Xa<Tc.length;Xa++)if(0!==Tc[Xa]&&-1===Math.sign(Tc[Xa]*Oi[Xa])){Bk=!1;break}if(!0===Bk){vj=!0;break}else nf++,Oi=gd.slice(nf,gd.length).concat(gd.slice(0,nf))}if(vj){T=Hf;Ea=Ja[z-8][T].slice(nf,Oi.length).concat(Ja[z-8][T].slice(0,nf));break}Hf++;Hf>=Ja[z-8].length&&(T=0)}}else if(16===z&&"m2porphin"===ig)T=0,nf=2,Ea=Ja[z-8][T].slice(nf,z).concat(Ja[z-
8][T].slice(0,nf));else if(16===z&&"porphin"===ig)T=0,nf=2,Ea=Ja[z-8][T].slice(nf,z).concat(Ja[z-8][T].slice(0,nf));else if(20<z)for(Ea=[],Xa=0;Xa<z;Xa++)0===Xa%2?Ea.push(60):Ea.push(-1*(60-720/z));if("first"===U){ma=0;v=360/Math.abs(z);ea=(180-v)/2*Math.pow(-1,z);6===z&&(ea=90);8===z&&(ea=90);var Uf=D;var Vf=I;9>z?(Uf+=Qe[z],Vf+=Ni[z]):20<z&&(Vf=Uf=400);d[Ma[0]].x=Uf;d[Ma[0]].y=Vf;21>z?""===ig&&16===z&&(la="NNNN")?Sa=30:Sa=Nm[z]:Sa=0;ma++}if("chend"===U){ma=0;Pb(d,h)&&Pb(d,p)?ea=Ya(d,qc[h],h):""!==
Eb(h)&&""!==ac(p)&&Eb(h)===ac(p)?(v=Eb(h),rb(d,S[v].w)&&rb(d,S[v].O)&&rb(d,S[v].P)&&!rb(d,S[v].t)?ea=Rf(d,S[v].w,S[v].O,S[v].P,!0):rb(d,S[v].w)&&rb(d,S[v].O)&&!rb(d,S[v].t)?ea=ha(Ya(d,S[v].O,S[v].w)+60):rb(d,S[v].w)&&rb(d,S[v].P)&&!rb(d,S[v].t)?ea=ha(Ya(d,S[v].P,S[v].w)-60):ea=30):""!==ac(h)?(v=ac(h),ea=rb(d,S[v].w)&&rb(d,S[v].t)&&(rb(d,S[v].O)||rb(d,S[v].P))?ha(Ya(d,S[v].w,S[v].t)+Df(d,v,p)):rb(d,S[v].w)&&rb(d,S[v].t)?ha(Ya(d,S[v].w,S[v].t)+60):ea+Df(d,v,p)):ea=0<Di(d,h)?Ya(d,Di(d,h),h):Ef(d,k,h);
Uf=d[h].x+xa*Math.cos(Math.PI*ea/180);Vf=d[h].y+-1*xa*Math.sin(Math.PI*ea/180);d[Ma[0]].x=Uf;d[Ma[0]].y=Vf;if(""!==ac(p))v=ac(p),qa=Math.sign(Df(d,v,Ma[1])),Sa=ea+qa*(180-360/Math.abs(z))/2,v=-360*qa/Math.abs(z),y=-1*qa;else if(3<d[p].a.length&1===x(d,p)){for(D=qa=0;D<d[p].a.length;D++)qa+=d[p].a[D].t;v=0<Cf[d[p].j]&&qa>Cf[d[p].j]&&2<eb(d,p)?-360/Math.abs(z):360/Math.abs(z);Sa=ha(ha(ea+30)-(180-v/2))}else 7<z?(v=360/Math.abs(z),Sa=ha(ea-(180-Ea[ma])/2)):(v=360/Math.abs(z),Sa=ha(ea-(180-v)/2));ma++}if("atom"===
U){Tc=Ma.slice(1,Ma.length);Tc.reverse();Ma=Ma.slice(0,1);Ma=Ma.concat(Tc);Uf=d[p].x;Vf=d[p].y;for(D=la=qa=ma=0;D<d[p].a.length;D++)0!==d[d[p].a[D].p].x&&0!==d[d[p].a[D].p].y&&(ma+=d[d[p].a[D].p].x,qa+=d[d[p].a[D].p].y,la++);0<la&&(ma/=la,qa/=la);ea=ld(ma,qa,d[p].x,d[p].y);v=360/z;Sa=ha(ea-(180-v)/2);ma=1}if("bond"===U){qa=Ia(k,p,h);if(3<eb(d,p)&&3<eb(d,h)&&(Xa=oa[String(p)].slice(0),vd=oa[String(h)].slice(0),Xa.sort(function(Ck,Dk){return Ck-Dk}),vd.sort(function(Ck,Dk){return Ck-Dk}),vg(Xa,vd))){Ni=
0;Qe=[];vd="";for(D=0;D<Xa.length;D++)rc.includes(Xa[D])&&(Ni++,Qe.push(Xa[D]),vd+=String(R[Xa[D]].length));if(2===Ni){vd+=String(z);Xa=R[Qe[0]].length>=R[Qe[1]].length?Qe[0]:Qe[1];Qe=R[Qe[0]].length<=R[Qe[1]].length?Qe[0]:Qe[1];Re="normal";switch(!0){case "333"===vd||"444"===vd||"777"===vd||"888"===vd:Re="squew";break;case "3"===vd.charAt(2):Re="normal";break;case "4"===vd.charAt(2):Re="normal";break;case "5"===vd.charAt(2):Re=700>parseInt(vd,10)?"wide":"normal";break;case "6"===vd.charAt(2):Re=
770>parseInt(vd,10)?"wide":"shrunk";break;case 6<parseInt(vd.charAt(2),10):Re="squew";break;default:Re="normal"}"squew"===Re?(Li=Rm[z-3].slice(0),Mi=Sm[z-3].slice(0)):"wide"===Re?(Li=Pm[z-5].slice(0),Mi=Qm[z-5].slice(0)):"shrunk"===Re&&(Li=va[z-5].slice(0),Mi=Om[z-5].slice(0));for(D=0;D<d[h].a.length;D++)R[Xa].includes(d[h].a[D].p)&&d[h].a[D].p!==p&&"wide"!==Re?y=B(d,p,h,d[h].a[D].p):R[Qe].includes(d[h].a[D].p)&&d[h].a[D].p!==p&&"wide"===Re&&(y=B(d,p,h,d[h].a[D].p))}}if(1===k[qa].B&&ca){for(D=va=
0;D<d[p].a.length;){if(2===d[p].a[D].t){va+=1;break}D++}for(D=0;D<d[h].a.length;){if(2===d[h].a[D].t){va+=1;break}D++}ka=0<va?1:0}else 2===k[qa].B&&ca&&(ka=1);Uf=d[h].x;Vf=d[h].y;ea=Ya(d,p,h);"normal"===Re?(v=9>z?360/z:Ja[z-8][T][1],vd=1):(v=Li[0],vd=Mi[0]);0>y&&(v=-1*v);Sa=ha(ea+v);ma=2}"bridge"===U&&(Uf=d[h].x,Vf=d[h].y,P=1,ea=Ya(d,p,h),v=y*u(d,k,z,Q,xa,P),Sa=ha(ea+v),ma=ib[Q].length);for(;ma<Ma.length;){ea=vd*xa*Math.cos(Math.PI*Sa/180);T=vd*xa*-1*Math.sin(Math.PI*Sa/180);Gc=Uf+ea;Hc=Vf+T;if(0===
d[Ma[ma]].x&&0===d[Ma[ma]].y){if(0<Yd(M,Ha,Gc,Hc)&&(T=Yd(M,Ha,Gc,Hc),void 0!==oa[String(T)])){Ja=!1;for(O=0;O<oa[String(T)].length;O++)if(-1<Tf(n,oa[String(T)][O])){Ja=!0;break}Ja&&(ea=xa*Math.cos(Math.PI*ha(30+Sa)/180),T=-1*xa*Math.sin(Math.PI*ha(30+Sa)/180),Gc=Uf+ea,Hc=Vf+T)}d[Ma[ma]].x=Gc;d[Ma[ma]].y=Hc}7<z&&(v=Ea[ma]);""!==Q&&(P++,v=y*u(d,k,z,Q,xa,P));"normal"!==Re&&(v=y*Li[ma-1],vd=Mi[ma-1]);Sa=ha(Sa+v);Uf=Gc;Vf=Hc;ca&&0===Ke(d,k,Ma[ma])&&0===Ke(d,k,Ma[ma-1])&&ma%2===ka&&Of(d,k,Ma[ma],Ma[ma-
1],"+");ma++}if(ca)for(0===Ke(d,k,Ma[ma-1])&&0===Ke(d,k,Ma[0])&&(ma-1)%2===ka&&Of(d,k,Ma[0],Ma[ma-1],"+"),Ma.push(Ma[0]),Xa=1;Xa<Ma.length;Xa++)0===Ke(d,k,Ma[Xa])&&0===Ke(d,k,Ma[Xa-1])&&Of(d,k,Ma[Xa],Ma[Xa-1],"+");rc.push(n)}}function Pb(d,k){var n,p=0;for(n=0;n<d[k].a.length;n++)2===d[k].a[n].t&&p++;return 2===p?!0:!1}function Eb(d){var k="",n;for(n in S)if(S.hasOwnProperty(n)&&S[n].w===d){k=n;break}return k}function ac(d){var k="",n;for(n in S)if(S.hasOwnProperty(n)&&S[n].t===d){k=n;break}return k}
function Nc(d){var k="";"0"!==d.charAt(0)&&"0"!==d.charAt(2)?k=d.charAt(0)===d.charAt(2)?"t":"c":"0"!==d.charAt(0)&&"0"!==d.charAt(3)?k=d.charAt(0)===d.charAt(3)?"c":"t":"0"!==d.charAt(1)&&"0"!==d.charAt(2)?k=d.charAt(1)===d.charAt(2)?"t":"c":"0"!==d.charAt(1)&&"0"!==d.charAt(3)&&(k=d.charAt(1)===d.charAt(3)?"t":"c");return k}function Ef(d,k,n){var p=0,h=0;h=d[n].a.length;var U=p=0,z=[],y=[];y=-1;var O=0;O="";var D=0,I=0;O=I=0;var Q=-1;p=0;D=1;var xa=[];Q=[];for(p=0;p<h;p++)0!==d[d[n].a[p].p].x&&
0!==d[d[n].a[p].p].y&&z.push(d[n].a[p].p);if(void 0===oa[String(n)])for(p=0;p<h;p++)void 0!==oa[String(d[n].a[p].p)]&&U++;p=z.length;z.sort(function(ea,T){return aa(F,ea)-aa(F,T)});switch(h){case 0:y=270;break;case 1:0===p?y=30:1===p&&(h=Ya(d,z[0],n),y=ha(h+60));break;case 2:0===p?y=30:1===p?(Q=aa(F,n),h=Ya(d,z[0],n),2<F[Q].i.length?F[Q].i[0]===n?(p=Ia(k,F[Q].i[0],F[Q].i[1]),2===k[p].B?D=G(d,k,p):O=B(d,F[Q].i[2],F[Q].i[1],F[Q].i[0])):F[Q].i.slice(-1)===n&&(y=F[Q].i.slice(-3),p=Ia(k,y[1],y[2]),2===
k[p].B?D=G(d,k,p):O=B(d,y[0],y[1],y[2])):2===F[Q].i.length&&(F[Q].i[1]===n?0<F[Q].m&&rb(d,F[Q].m)&&(p=Ia(k,F[Q].i[0],n),2===k[p].B?D=G(d,k,p):O=B(d,F[Q].m,F[Q].i[0],n)):0<F[Q].J&&rb(d,F[Q].J)&&(p=Ia(k,F[Q].i[1],n),2===k[p].B?D=G(d,k,p):O=B(d,F[Q].J,F[Q].i[1],n))),0!==O||Pb(d,n)||(O=0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?1:-1),y=ha(h-D*O*60)):2===p&&2===z.length&&(h=Ya(d,z[0],n),y=ha(h-60));break;case 3:0===p?y=30:1===p?(h=Ya(d,z[0],n),0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?y=
h-60:y=h+60):2===p&&(y=Rf(d,n,z[0],z[1],!0));break;case 4:if(0===p)y=30;else if(1===p)h=Ya(d,z[0],n),gc.includes(n)&&2>U?0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?y=h-60:y=h+60:16===d[n].j?y=h:0<Math.cos(Math.PI*h/180)*Math.sin(Math.PI*h/180)?y=h-90:y=h+90;else if(2===p)void 0!==oa[String(n)]||140>Fi(d,n,z[0],z[1])?(y=Rf(d,n,z[0],z[1],!0),y=ha(y+30)):(h=Ya(d,z[0],n),y=ha(h-90));else if(3===p)if(3===eb(d,n))if(""!==Id(d,n))for(O=Id(d,n),p=0;p<z.length;p++)Id(d,z[p])===O&&(y=ib[String(O)][0]===
n?Ya(d,ib[String(O)][ib[O].length-1],n):Ya(d,ib[String(O)][0],n));else for(p=0;p<z.length;p++){if(void 0!==oa[String(z[p])]&&1<oa[String(z[p])].length){y=Ya(d,z[p],n);break}}else{xa=[];Q=[];for(p=0;p<z.length;p++)aa(F,z[p])===aa(F,n)?xa.push(z[p]):Q.push(z[p]);if(2===xa.length)175<Fi(d,n,xa[0],xa[1])&&185>Fi(d,n,xa[0],xa[1])?y=Ya(d,Q[0],n):(O=Rf(d,n,xa[0],xa[1],!0),D=Ya(d,n,Q[0]),I=Math.abs(D-O),y=O+I,2>Math.abs(y-D)&&(y=O-I));else if(Ne(d,n,!0),175<Fa[Fa.length-1].$){for(p=0;p<z.length;p++)if(z[p]!==
Fa[Fa.length-1].ba&&z[p]!==Fa[Fa.length-1].fa){I=z[p];break}y=Ya(d,I,n)}else y=Rf(d,n,Fa[Fa.length-1].ba,Fa[Fa.length-1].fa,!1)}}return y}function Df(d,k,n){var p=0,h=0,U=!1,z=1;"0"!==S[k].ea.charAt(0)?rb(d,S[k].O)?(p=S[k].O,h=S[k].ea.charAt(0),U=!1):rb(d,S[k].P)&&(p=S[k].P,h=S[k].ea.charAt(0),U=!0):"0"!==S[k].ea.charAt(1)&&(rb(d,S[k].P)?(p=S[k].P,h=S[k].ea.charAt(1),U=!0):rb(d,S[k].O)&&(p=S[k].O,h=S[k].ea.charAt(1),U=!1));n===S[k].S?z="0"!==S[k].ea.charAt(2)?U?S[k].ea.charAt(2)===h?-1:1:S[k].ea.charAt(2)===
h?1:-1:U?S[k].ea.charAt(3)===h?1:-1:S[k].ea.charAt(3)===h?-1:1:n===S[k].R&&(z="0"!==S[k].ea.charAt(3)?U?S[k].ea.charAt(3)===h?-1:1:S[k].ea.charAt(3)===h?1:-1:U?S[k].ea.charAt(2)===h?1:-1:S[k].ea.charAt(2)===h?-1:1);rb(d,p)&&rb(d,S[k].w)&&rb(d,S[k].t)?(n=d[p].x-d[S[k].w].x,p=d[p].y-d[S[k].w].y,h=d[S[k].t].x-d[S[k].w].x,d=d[S[k].t].y-d[S[k].w].y,d=Jg(n,p,h,d)):rb(d,S[k].S)&&rb(d,S[k].w)&&rb(d,S[k].t)?(n=d[S[k].S].x-d[S[k].w].x,p=d[S[k].S].y-d[S[k].w].y,h=d[S[k].t].x-d[S[k].w].x,d=d[S[k].t].y-d[S[k].w].y,
d=Jg(n,p,h,d)):rb(d,S[k].R)&&rb(d,S[k].w)&&rb(d,S[k].t)?(n=d[S[k].R].x-d[S[k].w].x,p=d[S[k].R].y-d[S[k].w].y,h=d[S[k].t].x-d[S[k].w].x,d=d[S[k].t].y-d[S[k].w].y,d=Jg(n,p,h,d)):d=1;return-1*z*d*60}function Zb(d,k,n,p){function h(la,P,X,ca){la=P[X].f;var ka=P[ca].f;X=P[X].g;P=P[ca].g;return la===ka||X===P||la===P||ka==X?!0:!1}function U(la,P,X,ca){var ka=!1;var va=la[P[X].f].x;var Ea=la[P[X].f].y;var Ja=la[P[X].g].x;var Ma=la[P[X].g].y;var Tc=la[P[ca].f].x;X=la[P[ca].f].y;var gd=la[P[ca].g].x;la=la[P[ca].g].y;
Ja-=va;Ma-=Ea;gd-=Tc;P=la-X;la=Ja*P-gd*Ma;if(1E-8>Math.abs(la))return 0;0<la&&(ka=!0);va-=Tc;Ea-=X;X=Ja*Ea-Ma*va;if(0>X===ka)return 0;Ea=gd*Ea-P*va;return 0>Ea===ka||X>la===ka||Ea>la===ka?0:1}var z=1E3,y=0,O=0,D=0,I=0,Q=0,xa=0,ea=0;ea=xa=ea=0;ea=[];I=[];I=[];var T=[],v=[],qa=[],Sa=[];D=[];z=[];var ma=[];O=[];Q=n/2;xa=n;O=n/2;z=new yd(0,0,0,0);for(y=1;y<d.length-1;y++)for(D=y+1;D<d.length;D++)if(0!==d[y].x||0!==d[y].y||0!==d[D].x||0!==d[D].y)ea=Math.sqrt((d[y].x-d[D].x)*(d[y].x-d[D].x)+(d[y].y-d[D].y)*
(d[y].y-d[D].y)),void 0!==oa[String(y)]&&void 0!==oa[String(D)]?xa=Q:xa=n,ea<xa&&(ea=[y,D],T.push(ea));if(0<T.length){if(1<Fe.length){for(y=0;y<Fe.length;y++){for(D=ea=xa=0;D<R[Fe[y]].length;D++)xa+=d[R[Fe[y]][D]].x,ea+=d[R[Fe[y]][D]].y;xa/=R[Fe[y]].length;ea=xa/R[Fe[y]].length;I.push({r:Fe[y],x:xa,y:ea})}for(y=0;y<I.length-1;y++)for(D=y+1;D<I.length;D++)ea=Math.sqrt(Math.pow(I[y].x-I[D].x,2)+Math.pow(I[y].y-I[D].y,2)),ea<Q&&ma.push([I[y].r,I[D].r])}for(y=0;y<T.length-1;y++)for(D=y+1;D<T.length;D++)I=
Ia(k,T[y][0],T[D][0]),Q=Ia(k,T[y][1],T[D][1]),xa=Ia(k,T[y][1],T[D][0]),ea=Ia(k,T[y][0],T[D][1]),0<I&&0<Q?v.push([I,Q]):0<xa&&0<ea&&v.push([xa,ea])}for(D=1;D<k.length;D++)for(z.b=Math.min(d[k[D].f].x,d[k[D].g].x),z.t=Math.min(d[k[D].f].y,d[k[D].g].y),z.c=Math.abs(d[k[D].f].x-d[k[D].g].x),z.h=Math.abs(d[k[D].f].y-d[k[D].g].y),y=1;y<d.length;y++)y!==k[D].f&&y!==k[D].g&&Jc(z,d[y].x,d[y].y)&&Hm(d,k,y,D)<O&&qa.push([y,D]);for(y=1;y<d.length;y++)if(!(2>d[y].a.length))for(O=0;O<d[y].a.length-1;O++)for(D=
O+1;D<d[y].a.length;D++)z=ha(Ya(d,y,d[y].a[D].p)-Ya(d,y,d[y].a[O].p)),10>z&&Sa.push([y,d[y].a[O].p,d[y].a[D].p]);D=[];for(y=1;y<k.length-1;y++)for(O=y+1;O<k.length;O++)h(d,k,y,O)||(0<ia(d,k,y)||0<ia(d,k,O))&&-1<Oe(ia(d,k,y))&&-1<Oe(ia(d,k,O))||1===U(d,k,y,O)&&D.push([y,O]);z=[];for(y=1;y<R.length;y++)if(!(7<R[y].length||!0===Pa(y)))for(I=R[y].slice(0),I.push(R[y][0]),I.unshift(R[y][R[y].length-1]),O=1;O<I.length-1;O++)2<eb(d,I[O])||165<Fi(d,I[O],I[O-1],I[O+1])&&z.push([y,I[O]]);O=[];for(y=1;y<d.length;y++)4===
d[y].a.length&&(Ne(d,y,!0),180<Fa[Fa.length-1].$&&O.push(y));if(0===p){kd=[];for(y=0;y<T.length;y++)kd.push(T[y]);rh=[];for(y=0;y<v.length;y++)rh.push(v[y]);Wd=[];for(y=0;y<qa.length;y++)Wd.push(qa[y]);Sg=[];for(y=0;y<Sa.length;y++)Sg.push(Sa[y]);$e=[];for(y=0;y<D.length;y++)$e.push(D[y]);jg=[];for(y=0;y<z.length;y++)jg.push(z[y]);Sh=[];for(y=0;y<ma.length;y++)Sh.push(ma[y]);Th=[];for(y=0;y<O.length;y++)Th.push(O[y])}return 1===p?T.length+v.length+qa.length+Sa.length+D.length+z.length+O.length:kd.length+
rh.length+Wd.length+Sg.length+$e.length+jg.length+Th.length}function gg(d,k,n){var p=new oj(0,0,0,0),h;if(d===M)for(h=1;h<d.length;h++)Nf(M,h);Lc=[];var U=[];var z=[];h=[];p.s=0;p.u=0;p.l=0;p.n=0;Fa=[];var y="@"===d[n].I?1:-1;p=Ll(d,n);if(p.u>p.l){var O=p.u;p.u=p.l;p.l=O}for(O=0;O<d[p.u].a.length;O++)1===d[p.u].a[O].t&&(z.push(d[p.u].a[O].p),U.push(d[p.u].a[O].p));for(O=0;O<d[p.l].a.length;O++)1===d[p.l].a[O].t&&(h.push(d[p.l].a[O].p),U.push(d[p.l].a[O].p));for(O=0;O<U.length;O++);ad(d,k,Ia(k,p.l,
h[0]),4,!0);k[Ia(k,p.l,h[0])].g===p.l&&ad(d,k,Ia(k,p.l,h[0]),-1,!0);1<h.length&&(ad(d,k,Ia(k,p.l,h[1]),5,!0),k[Ia(k,p.l,h[1])].g===p.l&&ad(d,k,Ia(k,p.l,h[1]),-1,!0));z=xk(d,k,p,"parse");d[p.s].I="";if(""!==z&&z!==(1===y?"@":"@@")){if(d[p.s].I="",ad(d,k,Ia(k,p.l,h[0]),5,!0),k[Ia(k,p.l,h[0])].g===p.l&&ad(d,k,Ia(k,p.l,h[0]),-1,!0),1<h.length&&(ad(d,k,Ia(k,p.l,h[1]),4,!0),k[Ia(k,p.l,h[1])].g===p.l&&ad(d,k,Ia(k,p.l,h[1]),-1,!0)),z=xk(d,k,p,"parse"),""===z||z!==(1===y?"@":"@@"))ad(d,k,Ia(k,p.l,h[0]),1,
!0),1<h.length&&ad(d,k,Ia(k,p.l,h[1]),1,!0),Lc.push(n)}else if(""===z||void 0===z)ad(d,k,Ia(k,p.l,h[0]),1,!0),1<h.length&&ad(d,k,Ia(k,p.l,h[1]),1,!0),Lc.push(n)}function xg(d,k){var n=[];n=[];var p=new oj(0,0,0,0),h=0,U=0,z=0,y=n=0,O=0,D=h=h=0,I=0,Q=[];I=D=O=h=0;U="";var xa=[],ea=0;ea=ea=0;ea=[];var T=0,v=0,qa={};n=0;var Sa="";U=!0;var ma=T=0;n=0;h=[];var la="",P=0,X=0,ca=0;if(d===M)for(y=1;y<d.length;y++)Nf(M,y);Lc=[];for(y=0;y<gc.length;y++){v=gc[y];O=d[v].a.length;for(h=I=D=0;h<O;h++)0<ia(d,k,
Ia(k,v,d[v].a[h].p))&&D++,gc.includes(d[v].a[h].p)&&I++;qa[String(v)]=100*O+10*I+D}gc.sort(function(ka,va){return qa[String(va)]-qa[String(ka)]});for(y=0;y<gc.length;y++)v=gc[y];for(y=0;y<gc.length;y++){v=gc[y];Q=[];xa=[];ea=[];T=0;n=[];U="";h=n=O=I=D=0;U=!0;Sa="";h=[];p.s=0;p.u=0;p.l=0;z=U=h=p.n=0;Fa=[];ma="@"===d[v].I?1:-1;if(2!==Ke(d,k,gc[y])){for(h=0;h<d[v].a.length;h++)U=N(v,d[v].a[h].p),""!==U?xa.push([d[v].a[h].p,parseInt(U,10)]):Q.push(d[v].a[h].p);Q.sort(function(ka,va){return ka-va});if(0<
xa.length)for(xa.sort(function(ka,va){return parseInt(ka[1],10)-parseInt(va[1],10)}),h=xa.length-1;0<=h;h--)Q.unshift(xa[h][0]);for(h=0;h<Q.length;h++)Q[h]<v&&(O=Q[h])}for(h=U=xa=0;h<Q.length;h++)xa+=d[Q[h]].N,1===d[Q[h]].j&&U++;if(4===Q.length&&5===xa&&3===U){for(h=xa=h=U=xa=h=T=ea=n=Sa=0;4>h;h++)if(2===d[Q[h]].N&&1===d[Q[h]].j){Sa=Q[h];break}for(h=0;4>h;h++)if(3===d[Q[h]].N&&1===d[Q[h]].j){n=Q[h];break}for(h=0;4>h;h++)if(0===d[Q[h]].N&&1===d[Q[h]].j){ea=Q[h];break}0!==O?T=Ya(d,O,v):T=210;h=ha(T+
60);xa=ha(T-75);U=ha(T-45);d[ea].x=d[v].x+na*Math.cos(Math.PI*h/180);d[ea].y=d[v].y-na*Math.sin(Math.PI*h/180);d[ea].z=0;d[Sa].x=d[v].x+na*Math.cos(Math.PI*xa/180);d[Sa].y=d[v].y-na*Math.sin(Math.PI*xa/180);d[n].x=d[v].x+na*Math.cos(Math.PI*U/180);d[n].y=d[v].y-na*Math.sin(Math.PI*U/180);if(-1===ma&&0!==O||1===ma&&0===O)D=Sa,I=n;else if(1===ma&&0!==O||-1===ma&&0===O)D=n,I=Sa;h=Ia(k,v,D);xa=Ia(k,v,I);k[h].g===v&&(k[h].f=v,k[h].g=D);k[xa].g===v&&(k[xa].f=v,k[xa].g=I);ad(d,k,Ia(k,v,D),4,!1);ad(d,k,Ia(k,
v,I),5,!1)}else{Ne(d,v,!0);if(4===Q.length){if(0===p.s){if(0===D&&0<eb(d,v)){for(h=ea=0;h<Q.length;h++)ia(d,k,Ia(k,v,Q[h]))?ea++:(D=Q[h],I=0);if(4===ea)if(Fa=[],Ne(d,v,!0),4===Fa.length&&180<=Fa[3].$)for(h=Fa[3].ba,gc.includes(Fa[3].ba)&&(h=Fa[3].fa),gc.includes(Fa[3].fa)&&(h=Fa[0].ba),ea=ha(180+ld(d[v].x,d[v].y,(d[Fa[3].ba].x+d[Fa[3].fa].x)/2,(d[Fa[3].ba].y+d[Fa[3].fa].y)/2)),ea=-1*Jg(d[h].x-d[v].x,d[h].y-d[v].y,Math.cos(Math.PI*ea/180),-1*Math.sin(Math.PI*ea/180)),T=0;170<Fa[Fa.length-1].$&&6>T;)Ii(d,
v,h,15*ea),Fa=[],Ne(d,v,!0),T++;else if(4===Fa.length)for(h=0;h<Q.length;h++)0<eb(d,Q[h])||0!==X||(D=Q[h],X=wa(v,D),ca=D);if(0!==D){for(h=0;h<Q.length;h++)-1<eb(d,Q[h])&&(n=Q[h]);0===n&&(D=0)}if(0===D){for(h=0;h<d[v].a.length;h++)if(""!==la&&Id(d,d[v].a[h].p)===la&&Id(d,v)===la){D=d[v].a[h].p;la="";P=0;break}for(h=0;h<d[v].a.length;h++)if(0===D&&0<X&&R[X].includes(v)&&-1===eb(d,d[v].a[h].p)&&R[X].includes(d[v].a[h].p)){D=d[v].a[h].p;ca=X=0;break}}if(0===D){for(h=0;h<d[v].a.length;h++)if(""===la&&
""!==Id(d,d[v].a[h].p)&&Id(d,v)===Id(d,d[v].a[h].p)){la=Id(d,d[v].a[h].p);P=d[v].a[h].p;break}for(h=0;h<d[v].a.length;h++)if(0===X&&-1===eb(d,d[v].a[h].p)&&wa(v,d[v].a[h].p)&&""===Id(d,d[v].a[h].p)){X=wa(v,d[v].a[h].p);ca=d[v].a[h].p;break}if(0!==X&&""!==la){if(ib[la][0]===P&&ib[la][ib[la].length-1].includes(gc)||ib[la][ib[la].length-1]===P&&ib[la][0].includes(gc))gc.includes(P)?D=0:D=P;if(0!==D||gc.includes(Fa[0].ba))if(gc.includes(Fa[0].fa)){for(h=0;h<Q.length;h++)if(R[X].includes(Q[h])&&!gc.includes(Q[h])){D=
Q[h];break}la=""}else D=Fa[0].fa,ca=X=0,la="",P=0;else D=Fa[0].ba,ca=X=0,la="",P=0}else if(0!==X&&wa(v,ca))for(h=0;h<Q.length;h++){if(R[X].includes(Q[h])){D=Q[h];break}}else""!==la&&Id(d,v)===la&&(D=P);0===D&&(la="",ca=X=P=0)}if(0===D)for(h=0;h<Q.length;h++)0<eb(d,Q[h])||(D=Q[h],I=0)}if(0===D&&void 0!==oa[String(v)]){n=[];for(h=0;h<Q.length;h++)ia(d,k,Ia(k,v,Q[h]))||n.push(Q[h]);0<n.length&&(D=n[0],1<n.length?I=n[1]:I=0)}if(0===D){U=!0;Ne(d,v,!0);for(h=0;h<Fa.length;h++)if(88>Fa[h].$||92<Fa[h].$){U=
!1;break}if(!0===U)for(h=0;h<Q.length;h++)if(!gc.includes(Q[h])&&void 0===oa[String(Q[h])]){D=Q[h];break}}if(0===D)for(Ne(d,v,!0),n=0;4>n;){D=Fa[n].ba;I=Fa[n].fa;if(gc.includes(D)||gc.includes(I)||void 0!==oa[String(D)]||void 0!==oa[String(I)])I=D=0;else break;n++}0===D&&(gc.includes(Q[0])||gc.includes(Q[2])?gc.includes(Q[1])||gc.includes(Q[3])||(D=Q[1],I=Q[3]):(D=Q[0],I=Q[2]));if(0!==D)h=Ia(k,v,D),1===k[h].B&&(k[h].f===v?ad(d,k,h,4,!0):(n=k[h].f,k[h].f=k[h].g,k[h].g=n,0<=d[D].z?ad(d,k,h,4,!0):ad(d,
k,h,5,!0))),0!==I&&1===k[Ia(k,v,I)].B&&(ad(d,k,Ia(k,v,I),5,!0),k[Ia(k,v,I)].g===v&&ad(d,k,Ia(k,v,I),-1,!0));else{Lc.push(v);continue}}}else if(4>Q.length&&0===p.s){0===D&&2===Q.length&&(h=Rf(d,v,Q[0],Q[1],!1),U=d[v].x+na*Math.cos(Math.PI*h/180),z=d[v].y+-1*na*Math.sin(Math.PI*h/180),d[d.length]=new kb(1,"H",U,z,0,0,1),d[v].C+=1,Ye(d,k,v,d.length-1,4),D=d.length-1,I=0,Q.unshift(d.length-1));if(0===D){if(void 0!==oa[String(v)]){for(h=0;h<d[v].a.length;h++)sa(d,v,d[v].a[h].p)&&ea.push(d[v].a[h].p);0<
ea.length&&(T=ea[0])}if(0<eb(d,v)||0<ea.length)if(Ne(d,v,!0),175>ha(Fa[0].$+Fa[1].$)&&0===nb(v)){for(h=0;h<d[v].a.length;h++)if(""!==la&&Id(d,d[v].a[h].p)===la){D=d[v].a[h].p;la="";break}if(0===D)for(h=0;h<d[v].a.length;h++)if(0===D&&0<X&&""===Id(d,d[v].a[h].p)&&-1===eb(d,d[v].a[h].p)&&R[X].includes(d[v].a[h].p)){D=d[v].a[h].p;X=0;break}if(0===D){for(h=0;h<d[v].a.length;h++)if(""===la&&""!==Id(d,d[v].a[h].p)&&Id(d,v)===Id(d,d[v].a[h].p)){la=Id(d,d[v].a[h].p);P=d[v].a[h].p;break}for(h=0;h<d[v].a.length;h++)if(0===
X&&-1===eb(d,d[v].a[h].p)&&wa(v,d[v].a[h].p)&&""===Id(d,d[v].a[h].p)){X=wa(v,d[v].a[h].p);ca=d[v].a[h].p;break}0!==X&&""!==la?gc.includes(P)?gc.includes(ca)?D=0:(D=ca,la=""):(D=P,X=0):0!==X?D=ca:""!==la&&(D=P);0===D&&(la="",X=0)}}else{n=[];for(h=0;h<Q.length;h++)(0<eb(d,Q[h])||Ek.includes(Q[h]))&&n.push(Q[h]);if(0<T)for(h=0;h<Q.length;h++)if(Q[h]!==T){I=Q[h];break}1!==n.length||0!==I||180<=Fa[Fa.length-1].$?0===I&&(I=-1):I=n[0];0!==I&&(h=0<I?ha(180+Ya(d,v,I)):K(d,v),I=0,U=d[v].x+na*Math.cos(Math.PI*
h/180),z=d[v].y+-1*na*Math.sin(Math.PI*h/180),0<Yd(M,Ha,U,z)&&(h=ha(h+120),U=d[v].x+na*Math.cos(Math.PI*h/180),z=d[v].y+-1*na*Math.sin(Math.PI*h/180)),0<Yd(M,Ha,U,z)&&(h=ha(h-240),U=d[v].x+na*Math.cos(Math.PI*h/180),z=d[v].y+-1*na*Math.sin(Math.PI*h/180)),d[d.length]=new kb(1,"H",U,z,0,0,1),d[v].C+=1,Ye(d,k,v,d.length-1,4),D=d.length-1,I=0,Q.unshift(d.length-1))}}if(0===D)for(h=0;h<Q.length;h++)if(1===d[Q[h]].a.length&&Q[h]!==O){D=Q[h];break}if(0===D)for(h=0;h<Q.length;h++)if(1===d[Q[h]].a.length){D=
Q[h];break}if(0===D)for(h=0;h<Q.length;h++)if(0< !ba(Q[h])&&1===k[Ia(k,v,Q[h])].B&&Q[h]!==O){D=Q[h];break}if(0===D)for(h=0;h<Q.length;h++)if(0< !ba(Q[h])&&1===k[Ia(k,v,Q[h])].B){D=Q[h];break}if(0===D)for(h=0;h<Q.length;h++)if(1===k[Ia(k,v,Q[h])].B&&Q[h]!==O){D=Q[h];break}if(0===D)for(h=0;h<Q.length;h++)if(1===k[Ia(k,v,Q[h])].B){D=Q[h];break}0===D&&(D=Q[1]);gc.includes(D)&&(Ne(d,v,!0),h=180<Fa[Fa.length-1].$?Rf(d,v,Fa[Fa.length-1].fa,Fa[Fa.length-1].ba,!0):ha(30+Ya(d,v,D)),ec(d,k,v,h,4),D=M.length-
1,Q.push(D));if(0!==D&&0<Ia(k,v,D))h=Ia(k,v,D),1===k[h].B&&(k[h].f===v?ad(d,k,h,4,!0):(n=k[h].f,k[h].f=k[h].g,k[h].g=n,0<=d[D].z?ad(d,k,h,4,!0):ad(d,k,h,5,!0)));else{Lc.push(v);continue}}""===la&&(P=0);0===X&&(ca=0);0===p.s&&(Q.splice(Q.indexOf(O),1),3>Q.length&&Q.unshift(0),h=[v,O,Q[0],Q[1],Q[2]],Sa=pj(d,k,v,"",h,"parse"));""!==Sa&&Sa!==(1===ma?"@":"@@")?0===p.s&&(ad(d,k,Ia(k,v,D),5,!1),4===d[v].a.length&&0!==I&&ad(d,k,Ia(k,v,I),4,!1)):""===Sa&&0===p.s&&(ad(d,k,Ia(k,v,D),1,!0),4===d[v].a.length&&
0!==I&&ad(d,k,Ia(k,v,I),1,!0),Lc.push(v))}}fg(Lc)}function Ii(d,k,n,p){var h=Math.sqrt((d[n].x-d[k].x)*(d[n].x-d[k].x)+(d[n].y-d[k].y)*(d[n].y-d[k].y));d[n].x=d[k].x+h*Math.cos(Math.PI*p/180);d[n].y=d[k].y-h*Math.sin(Math.PI*p/180)}function rb(d,k){return 0!==d[k].x&&d[k].x==d[k].x&&0!==d[k].y&&d[k].y==d[k].y?!0:!1}function Oe(d){var k;if(0===La.length)return-1;for(k=0;k<La.length;k++)if(La[k].includes(d))return k;return-1}function Ag(d,k){var n;for(n=0;n<Bd.length;n++)if(Bd[n].Y===d&&Bd[n].Z===k||
Bd[n].Z===d&&Bd[n].Y===k)return n;return-1}function Tf(d,k){var n;for(n=0;n<gb.length;n++)if(gb[n].Y===d&&gb[n].Z===k||gb[n].Z===d&&gb[n].Y===k)return n;return-1}function Gf(d,k,n){var p="";for(p in ib)if(ib.hasOwnProperty(p)&&ib[p].length===n&&ib[p].includes(d[k].g)&&ib[p].includes(d[k].f))return p}function Id(d,k){d="";for(d in ib)if(ib.hasOwnProperty(d)&&ib[d].includes(k))return d;return""}function m(d,k){for(J=0;J<R[k].length;J++)if(""!==Id(d,R[k][J]))return!0;return!1}function u(d,k,n,p,h,U){k=
0;var z=ib[p].length,y=n-z;var O=ib[p][0];p=ib[p][z-1];d=Math.sqrt((d[p].x-d[O].x)*(d[p].x-d[O].x)+(d[p].y-d[O].y)*(d[p].y-d[O].y));switch(!0){case 1===U:switch(y){case 1:k=180-180*Math.acos(Math.min(d/(2*h),1))/Math.PI;break;case 2:k=180-180*Math.acos(Math.min(Math.abs((d-h)/(2*h)),1))/Math.PI;break;case 3:U=2*h*Math.cos(Math.PI/6);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;break;case 4:U=h*(2*Math.cos(2*Math.PI/7)+1);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;
break;case 5:U=2*h*(Math.cos(Math.PI/8)+Math.cos(3*Math.PI/8));k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;break;default:k=0}break;case 2===U:switch(y){case 2:k=180*Math.acos(Math.min(Math.abs((d-h)/(2*h)),1))/Math.PI;break;case 3:U=2*h*Math.cos(Math.PI/6);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;k=k-90+360/n;break;case 4:U=h*(2*Math.cos(2*Math.PI/7)+1);k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;k=180-k-360/n;break;case 5:U=2*h*(Math.cos(Math.PI/
8)+Math.cos(3*Math.PI/8));k=180-180*Math.acos(Math.min(Math.abs(d-U)/(2*h),1))/Math.PI;k=90-k+1080/(2*n);break;default:k=0}break;case 2<U:k=360/n}return k}function q(d,k){var n=k.slice(0);n.push(k[0]);for(k=0;k<n.length-1&&d[0]!==n[k];k++);return d[1]===n[k+1]?!0:!1}function x(d,k){var n,p=0;for(n=0;n<d[k].a.length;n++)0!==d[d[k].a[n].p].x&&0!==d[d[k].a[n].p].y&&p++;return p}function G(d,k,n){var p,h="",U="",z=1;if(2!==k[n].B)return 1;if(null!==Qb[k[n].g].match(/[\\|/]/))for(h=Qb[k[n].g].match(/[\\|/]/)[0],
p=0;p<d[k[n].f].a.length;p++){var y=d[k[n].f].a[p].p;if(y!==k[n].g&&/[\\|/]/.test(Qb[y])){U=Qb[y].match(/[\\|/]/)[0];break}}else if(null!==Qb[k[n].f].match(/[\\|/]/))for(h=Qb[k[n].f].match(/[\\|/]/)[0],p=0;p<d[k[n].g].a.length;p++)if(y=d[k[n].g].a[p].p,y!==k[n].f&&/[\\|/]/.test(Qb[y])){U=Qb[y].match(/[\\|/]/)[0];break}""!==h&&""!==U&&(z=h===U?1:-1);return z}function K(d,k){var n,p=new $c(0,0);if(void 0!==oa[String(k)]&&0<oa[String(k)].length){for(n=0;n<oa[String(k)].length;n++)p.x+=Fk[oa[String(k)][n]].x-
d[k].x,p.y+=Fk[oa[String(k)][n]].y-d[k].y;return ld(p.x,p.y,0,0)}return-1}function B(d,k,n,p){return-1*Jg(d[n].x-d[k].x,d[n].y-d[k].y,d[p].x-d[n].x,d[p].y-d[n].y)}function N(d,k){for(var n in ic)if(ic.hasOwnProperty(n)&&(ic[n].ra===d&&ic[n].oa===k||ic[n].ra===k&&ic[n].oa===d))return n;return""}function fa(d,k,n){var p=-1,h=k[k.length-1],U=-1;var z=db[k[0]].i.indexOf(ic[d].ra);var y=db[n[0]].i.indexOf(ic[d].oa),O=[],D=[],I=[];k=k[0];if(k===h)U=db[h].i.indexOf(ic[d].ra);else for(;-1<z&&k!==h;)if(D.push(db[k].i[z]),
z--,0>z){var Q=db[k].m;k=db[k].qa;z=db[k].i.indexOf(Q);if(k===h){U=z;break}z=db[k].i.indexOf(Q)}k=n[0];if(k===h)p=db[h].i.indexOf(ic[d].oa);else for(z=y;-1<z&&k!==h;)if(I.unshift(db[k].i[z]),z--,0>z&&(Q=db[k].m,k=db[k].qa,z=db[k].i.indexOf(Q),k===h)){p=z;break}for(z=p;z>=U;z--)O.unshift(db[h].i[z]);R.push(O.concat(I,D))}function Y(d){var k,n=Dd.length,p=Dd.length,h=[];for(k=0;k<R[d].length;k++)R[d][k]<n&&(n=R[d][k]);for(k=0;k<R[d].length;k++)R[d][k]<p&&R[d][k]!==n&&(p=R[d][k]);if(R[d].indexOf(n)>
R[d].indexOf(p)){for(k=R[d].length-1;0<=k;k--)h.push(R[d][k]);R[d]=h.slice(0)}for(k=0;0<R[d].indexOf(n)&&!(p=R[d].shift(),R[d].push(p),k++,20<k););}function ia(d,k,n){for(d=1;d<R.length;d++)if(R[d].includes(k[n].f)&&R[d].includes(k[n].g))return d;return 0}function ba(d){var k;for(k=1;k<R.length;k++)if(R[k].includes(d))return k;return 0}function Oa(d){for(J=1;J<R.length;J++)R[J].includes(d)&&(void 0===oa[String(d)]&&(oa[String(d)]=[]),oa[String(d)].push(J))}function nb(d){for(J=1;J<R.length;J++)if(3===
R[J].length&&R[J].includes(d))return J;return 0}function Pa(d){var k,n=!0;for(k=0;k<R[d].length;k++){var p=Dd[R[d][k]].match(/^\[([a-z]{0,2})(H{0,1})([0-9]{0,2})([-|+]{0,1}\d{0,2})\]$/);null!==p?""!==p[1]&&(Bg.includes(p[1])?ge.includes(R[d][k])||ge.push(R[d][k]):n=!1):Bg.includes(Dd[R[d][k]])?ge.includes(R[d][k])||ge.push(R[d][k]):n=!1}return n}function wa(d,k){var n,p=0;for(n=1;n<R.length;n++)if(R[n].includes(d)&&R[n].includes(k)){p=n;break}return p}function fc(d,k){var n,p=new $c(0,0),h=0,U=0;
for(n=0;n<R[k].length;n++)h+=d[R[k][n]].x,U+=d[R[k][n]].y;p.x=h/R[k].length;p.y=U/R[k].length;return p}function eb(d,k){var n=0,p;for(p=0;p<d[k].a.length;p++)0<ba(d[k].a[p].p)&&!sa(d,k,d[k].a[p].p)&&n++;return 2<n?n:-1}function sa(d,k,n){for(d=0;d<xe.length;d++)if(xe[d].Ha===k&&xe[d].Ia===n||xe[d].Ha===n&&xe[d].Ia===k)return!0;return!1}function Va(d){var k;for(k=0;k<gb.length;k++)if(d===gb[k].ta||d===gb[k].ua)return k;return-1}function lb(d){var k,n=0;for(k=0;k<gb.length;k++)gb[k].Y!==d&&gb[k].Z!==
d||n++;return n}function Bb(){var d,k;for(d=0;d<gb.length-1;d++)for(k=d+1;k<gb.length;k++)if(gb[d].ta===gb[k].ta&&gb[d].ua===gb[k].ua){var n=String(gb[d].ta)+"-"+String(gb[d].ua);void 0===If[n]?If[n]=[gb[d].Y,gb[d].Z,gb[k].Y,gb[k].Z]:If.hasOwnProperty(n)&&If[n].push(gb[d].Y,gb[d].Z,gb[k].Y,gb[k].Z)}for(jb in If)If.hasOwnProperty(jb)&&fg(If[jb])}function Cb(d){for(jb in If)if(If.hasOwnProperty(jb)){var k=jb.split("-");if(k[0]===String(d)||k[1]===String(d))return!0}return!1}function tc(){function d(ea,
T){var v,qa;for(v=0;v<U[ea].length;v++){var Sa=!1;for(qa=0;qa<U[T].length;qa++)if(U[ea][v].w===U[T][qa].w&&U[ea][v].t===U[T][qa].t||U[ea][v].w===U[T][qa].t&&U[ea][v].t===U[T][qa].w)y.push(new Wa(U[ea][v].w,U[ea][v].t)),Sa=!0;Sa||h.push(new Wa(U[ea][v].w,U[ea][v].t))}}function k(ea,T){ea=ea.slice(0);var v=[],qa=new Wa(ea[T].w,ea[T].t);v.push(new Wa(qa.w,qa.t));xa.push(qa.w);for(ea.splice(T,1);0<ea.length;){var Sa=!1;for(T=0;T<ea.length;T++)if(qa.t===ea[T].w){qa.w=ea[T].w;qa.t=ea[T].t;v.push(new Wa(qa.w,
qa.t));xa.push(qa.w);Sa=!0;ea.splice(T,1);break}else if(qa.t===ea[T].t){qa.t=ea[T].w;qa.w=ea[T].t;v.push(new Wa(qa.w,qa.t));xa.push(qa.w);Sa=!0;ea.splice(T,1);break}if(!Sa)return!1}for(Q=0;Q<v.length;Q++);return!0}var n=!1,p=[],h=[];n=[];var U=[[]],z=0,y=[];p=[];var O=[!1],D=[!1],I=0,Q=0,xa=[];z=[];I=[];z=R.slice(1,R.length);z.sort(function(ea,T){return ea.length-T.length});R=[[0]];R=R.concat(z);for(z=1;z<R.length;z++){U[z]=[];for(I=0;I<R[z].length-1;I++)U[z].push(new Wa(R[z][I],R[z][I+1]));U[z].push(new Wa(R[z][R[z].length-
1],R[z][0]))}for(z=1;z<R.length-1;z++)for(I=z+1;I<R.length;I++)p=Gh(R[z],R[I]),p.length===R[z].length&&p.length===R[I].length?(R.splice(I,1),I--):(y=[],h=[],n=[],d(z,I),n=h.slice(0),y=[],h=[],d(I,z),p=[],p=n.concat(h),0<p.length&&(xa=[],n=!1,n=k(p,0),!0===n&&xa.length<R[I].length&&(R[I]=xa)));for(z=1;z<R.length;z++)Y(z);R.sort(function(ea,T){return ea[0]-T[0]});for(z=1;z<R.length;z++){U[z]=[];for(I=0;I<R[z].length-1;I++)U[z].push(new Wa(R[z][I],R[z][I+1]));U[z].push(new Wa(R[z][R[z].length-1],R[z][0]));
for(I=0;I<U[z].length;I++);}for(Q=1;Q<R.length;Q++)for(I=[],z=0;z<R[Q].length;z++)I.push(Dd[R[Q][z]]);Fe=[];Bd=[];gb=[];for(z=1;z<R.length-1;z++)for(I=z+1;I<R.length;I++)if(p=[],p=Gh(R[z],R[I]),y=[],d(I,z),1===p.length)Bd.push({Y:z,Z:I,Ja:p[0]}),D[z]=!0,D[I]=!0;else if(0<y.length)for(Q=0;Q<y.length;Q++)gb.push({Y:z,Z:I,ta:Math.min(y[Q].w,y[Q].t),ua:Math.max(y[Q].w,y[Q].t)}),O[z]=!0,O[I]=!0;for(z=1;z<R.length;z++)void 0!==O[z]&&!1!==O[z]||void 0!==D[z]&&!1!==D[z]||Fe.push(z);for(z=1;z<Dd.length;z++)oa[String(z)]=
void 0,Oa(z)}function Jb(d,k,n){var p=0,h=0;h=-1;h="";var U=-1;p=R[d].slice(0);h=R[k].slice(0);var z=n[0],y=n[n.length-1],O=p.indexOf(z),D=h.indexOf(z),I=[];n=[];n=[];var Q=[];p=p.slice(O,p.length).concat(p.slice(0,O));h=h.slice(D,h.length).concat(h.slice(0,D));if(p[0]!==h[0]||p[1]!==h[1])h.reverse(),D=h.indexOf(z),h=h.slice(D,h.length).concat(h.slice(0,D));I.push(y);I=I.concat(p.slice(p.indexOf(y)+1));I.push(z);n=h.slice(h.indexOf(y)+1);n.reverse();I=I.concat(n);R[d]=[];R[d]=I.slice(0);for(p=0;p<
Tg.length;p++){h=-1;h=Tf(k,Tg[p]);-1<h&&(gb[h].Y=d);n=Gh(R[d],R[Tg[p]]);if(3===n.length&&7!==M[n[1]].j){for(h=0;h<n.length;h++)if(7===M[n[h]].j){U=h;break}Q=[];0===R[d].indexOf(n[U])?(Q.push(R[d][R[d].length-1]),Q.push(n[U]),Q.push(R[d][1])):(Q.push(R[d][R[d].indexOf(n[U])-1]),Q.push(n[U]),Q.push(R[d][R[d].indexOf(n[U])+1]));n=Q.splice(0)}else n.sort(function(xa,ea){return R[d].indexOf(ea)-R[d].indexOf(xa)}),n.reverse();h=String(Math.min(k,Tg[p]))+"-"+String(Math.max(k,Tg[p]));void 0!==ib[h]&&delete ib[h];
h=String(Math.min(d,Tg[p]))+"-"+String(Math.max(d,Tg[p]));void 0===ib[h]&&(ib[h]=n)}}function Nb(d,k,n){var p,h;for(p=0;p<F[n].i.length;p++){var U=F[n].i[p];for(h=0;h<d[U].a.length;h++)if(!F[n].i.includes(d[U].a[h].p)){var z=Ia(k,U,d[U].a[h].p);if(0<z)return z}}return-1}function jc(d){var k;fe=-1;ee=[];mf=[];Xc=[];Pi=-1;for(k=0;k<d.length;k++)if(0===d[k].m&&0===d[k].J)fe=k;else if(0<d[k].m&&0<d[k].J&&void 0!==oa[String(d[k].m)]&&void 0!==oa[String(d[k].J)])ee.push(k);else if(0<d[k].J&&void 0!==oa[String(d[k].J)])mf.push(k);
else if(0<d[k].m&&0===d[k].J&&(Xc.push(k),0===d[k].ga))for(Fb=1;Fb<R.length;Fb++)R[Fb].includes(d[k].m)&&(Pi=Fb)}function Sd(d,k){d[k].i.reverse();d[k].sa.reverse();var n=d[k].J;d[k].J=d[k].m;d[k].m=n;for(n=d[k].i.length-1;0<n;n--)Qb[d[k].i[n]]=Qb[d[k].i[n-1]],qc[d[k].i[n]]=d[k].i[n-1];qc[d[k].i[0]]=0;Qb[d[k].i[0]]="";Qb[d[k].i[0]]=Qb[d[k].m];qc[d[k].i[0]]=d[k].m;qc[d[k].m+1]===d[k].m&&(Qb[d[k].m]=Qb[d[k].m+1],qc[d[k].m]=d[k].m+1)}function fd(d,k){F[d].i=F[d].i.concat(F[k].i);F[d].J=F[k].J}function bc(d,
k,n){var p=new Qc(d[k].ga,d[k].i[n-1],k,d[k].J);1>n||2>d[k].i.length||(p.i=d[k].i.slice(n),p.sa=d[k].sa.slice(n),d[k].i=d[k].i.slice(0,n),d[k].sa=d[k].sa.slice(0,n),d[k].J=p.i[0],Sd(d,k),d.push(p))}function Ud(d,k){var n=[],p,h;var U=new Qc(0,0,-1,0);if(0!==F.length){for(h=0;h<F.length;h++)h===fe&&(n.push(F[h].i[0]),n.push(F[h].i[F[h].i.length-1])),0<Xc.length&&Xc.includes(h)&&!ba(0<F[h].m)&&n.push(F[h].i[F[h].i.length-1]),0<mf.length&&mf.includes(h)&&n.push(F[h].i[F[h].i.length-1]),0<ee.length&&
ee.includes(h)&&(n.push(F[h].i[0]),n.push(F[h].i[F[h].i.length-1]));fg(n);hd=[];if(1<n.length){for(h=0;h<n.length-1;h++)for(p=h+1;p<n.length;p++){var z=!1;Ca(d,k,n[h],n[p]);for(Uc=0;Uc<Hb.length;Uc++)if(0<ba(Hb[Uc])){z=!0;break}if(z)break;if(Hb.length>hd.length)hd=Hb.slice(0);else if(Hb.length===hd.length)if(0<Vd(d,Hb[0])&&0<Vd(d,Hb[Hb.length-1])&&(0===Vd(d,hd[0])||0===Vd(d,hd[hd.length-1])))hd=Hb.slice(0);else if(Ob(d,Hb)>Ob(d,hd))hd=Hb.slice(0);else if(8===d[Hb[0]].j&&8===d[Hb[Hb.length-1]].j&&
8===d[hd[0]].j&&8===d[hd[hd.length-1]].j){z=Sf(d,Hb[0])+Sf(d,Hb[Hb.length-1]);var y=Sf(d,hd[0])+Sf(d,hd[hd.length-1]);2<y&&2===z&&(hd=Hb.slice(0))}}if(3<hd.length){d=[];n=aa(F,hd[0]);k=F[n].i.indexOf(hd[0]);for(h=1;h<hd.length;h++)aa(F,hd[h])!==n&&(p=F[aa(F,hd[h-1])].i.indexOf(hd[h-1]),d.push({s:n,v:k,e:p}),n=aa(F,hd[h]),k=F[n].i.indexOf(hd[h]));d.push({s:n,v:k,e:F[aa(F,hd[hd.length-1])].i.indexOf(hd[hd.length-1])});for(h=0;h<d.length;h++){if(d[h].v>d[h].e)for(p=d[h].v,d[h].v=d[h].e,d[h].e=p,k=F[d[h].s].i.slice(d[h].v,
d[h].e+1),k.reverse(),p=k.length-1;0<p;p--)Qb[k[p]]=Qb[k[p-1]],qc[k[p]]=k[p-1];else k=F[d[h].s].i.slice(d[h].v,d[h].e+1);U.i=U.i.concat(k)}ub=[];ub[ub.length]=new Qc(U.ga,U.m,U.qa,U.J);ub[ub.length-1].i=U.i.slice(0);for(h=0;h<F.length;h++){U=-1;for(p=0;p<d.length;p++)if(d[p].s===h){U=p;break}-1<U?(0<d[U].v&&(ub[ub.length]=new Qc(F[h].ga+1,F[h].m,0,F[h].i[d[U].v]),ub[ub.length-1].i=F[h].i.slice(0,d[U].v),Sd(ub,ub.length-1)),d[U].e<F[h].i.length-1&&(ub[ub.length]=new Qc(F[h].ga+1,F[h].i[d[U].e],0,F[h].J),
ub[ub.length-1].i=F[h].i.slice(d[U].e+1))):-1<aa(F,F[h].m)?(ub[ub.length]=new Qc(F[aa(F,F[h].m)].ga,F[h].m,aa(F,F[h].m),F[h].J),ub[ub.length-1].i=F[h].i.slice(0),ub[0].i.includes(ub[ub.length-1].m)&&(ub[ub.length-1].qa=0,ub[ub.length-1].ga=1)):(ub[ub.length]=new Qc(F[h].ga,F[h].m,F[h].qa,F[h].J),ub[ub.length-1].i=F[h].i.slice(0))}ub[0].i[0]>ub[0].i[ub[0].i.length-1]&&Sd(ub,0);for(p=0;p<ub[0].i.length;p++)ub[0].sa.push(Dd[ub[0].i[p]]);qc[ub[0].i[0]]=0<ub[0].m?ub[0].m:0;for(p=1;p<ub[0].i.length;p++)qc[ub[0].i[p]]=
ub[0].i[p-1];for(h=1;h<ub.length;h++){0<ub[h].m&&0===ba(ub[h].m)?(ub[h].qa=aa(ub,ub[h].m),ub[h].ga=ub[ub[h].qa].ga+1):(ub[h].qa=-2,ub[h].ga=-1);for(p=0;p<ub[h].i.length;p++)ub[h].sa.push(Dd[ub[h].i[p]]);qc[ub[h].i[0]]=0<ub[h].m?ub[h].m:0;for(p=1;p<ub[h].i.length;p++)qc[ub[h].i[p]]=ub[h].i[p-1]}F=[];F=ub;for(h=1;h<F.length;h++)aa(F,F[h].m)}else hd=[]}else hd=[]}}function Ob(d,k){var n=0,p;for(p=0;p<k.length;p++)6===d[k[p]].j&&n++;return n}function Sf(d,k){return 1===d[k].a.length&&1===d[k].a[0].t?
1:1===d[k].a.length&&2===d[k].a[0].t?2:0}function Vd(d,k){var n,p;for(n=0;n<d[k].a.length;n++)for(p=1;p<R.length;p++)if(R[p].includes(d[k].a[n].p))return p;return 0}function ob(d,k,n,p){this.ib=d;this.ra=k;this.$a=n;this.oa=p}function Wa(d,k){this.w=d;this.t=k}function Qc(d,k,n,p){this.ga=d;this.m=k;this.qa=n;this.J=p;this.i=[];this.la="";this.sa=[]}var F=[],Td="",lf=[],ve=-1,Dc=[],de=[],Wd=[],Sg=[],Qi=0,rh=[],Gk=[],$e=[],jg=[],Sh=[],Wf=0,db=[],Ug=[],Vg=[],Wg=0,of=-1,oe={},If={},J=0,kg=0,wj=0,Fb=
0,Uc=0,jb,Rh=0,xj=0,Ri=-1,hd=[],Pi=0,Jf="",ub=[],Hk=0,Si=0,Vl="",Dg=0,Th=[],Ek=[],Xg=[],Wl=[],ge=[],Ti=[],yj="",zj=[[]],sh=[],th=[],vc=[],rc=[],Ul=[],Tb=0,Pe={},xe=[],Ik=[],ib={},Xl=new $c(0,0),Fk=[{x:0,y:0}],La=[],Cg=0,Tg=[],lg=1,Jk=0,Hb=[],Ed=[],ig="",uh=[],Aj=0,vh=-1,kd=[],id=0,nd=0,Bj=!1,Cj=!1,dd=[],wd=[],pf=0,Eg=0,Xd="",Yl="",wh="",Tl=/^\[(\d{0,3})([A-Z]{0,1}[a-z]{0,2})(@{0,2})(H{0,1})([0-9]{0,2})([-|+]{0,1}\d{0,2})\]$/,Mm=/^\[(R{1,1}\d{0,1})\]$/;if(0!==W.length){M.length=1;Ha.length=1;F=[];
ee=[];Qg=[];Pi=0;fe=-1;Dd=[];cd=[new De(0,0,0)];Fe=[];vc=[];rc=[];ib={};gb=[];R=[[0]];gc=[];Bd=[];mf=[];Xc=[];for(jb in ic)ic.hasOwnProperty(jb)&&delete ic[jb];for(jb in oa)oa.hasOwnProperty(jb)&&delete oa[jb];for(jb in S)S.hasOwnProperty(jb)&&delete S[jb];for(jb in ib)ib.hasOwnProperty(jb)&&delete ib[jb];for(jb in Pe)Pe.hasOwnProperty(jb)&&delete Pe[jb];for(jb in If)If.hasOwnProperty(jb)&&delete If[jb];(function(d){var k,n=0,p=0,h=0,U=!1,z=!1,y=0,O="",D=1,I,Q=!1,xa="";db[p]=new Qc(0,0,-1,0);var ea=
I="";/^\[\d{0,1}H[+-]{0,1}\]/.test(d)&&(z=!0);for(k=0;k<d.length;k++){var T=d.charAt(k);k<d.length-1&&(O=T+d.charAt(k+1));if((U||!nh.includes(O.charAt(0))||!Bg.includes(O.charAt(1)))&&k<d.length-1&&(Og.includes(O)||Bg.includes(O)||qe.includes(O)))n++,db[p].i.push(n),I+=O,U||(db[p].sa[n]=I,Dd[n]=I,Qb[n]=ea,we[n]="",db[p].la+=O,ea=I=""),1<n?(1<db[p].i.length?(qc[n]=db[p].i[db[p].i.length-2],cd.push(new De(db[p].i[db[p].i.length-2],db[p].i[db[p].i.length-1],D))):(qc[n]=db[p].m,cd.push(new De(db[p].m,
db[p].i[db[p].i.length-1],D))),D=1):qc[n]=0,k++,O="";else if("H"===T&&U&&!z&&"[2"!==I&&"[3"!==I||!Og.includes(T)&&!Bg.includes(T)&&"R"!==T)if(U||null===T.match(/%{1}/))if(U||null===T.match(/[0-9]{1}/))if("("===T)y++,h++,db[h]=new Qc(y,db[p].i[db[p].i.length-1],p,0),p=h;else if(")"===T)y--,p=db[p].qa;else if("["===T)U=!0,I="[";else if("]"===T)I+="]",/^\[H[+-]{0,1}\]/.test(I)&&!1===z&&n++,db[p].sa[n]=I,Dd[n]=I,"[H][H]"===d&&2===n&&(qc[n]=1,db[p].i.push(2),cd.push(new De(1,2,1))),Qb[n]=ea,we[n]="",db[p].la+=
I,ea=I="",z=U=!1;else if("="===T)db[p].la+=T,ea+=T,D=2;else if("#"===T)db[p].la+=T,ea+=T,D=3;else if("\\"===T||"/"===T)db[p].la+=T,ea+=T;else{if(!U||"H"!==T)if(!U||Og.includes(T)||Bg.includes(T))return Cd='invalidSymbol in SMILES:"'+T+'"',-1;I+=T}else xa=Q?xa+T:T,Q&&2!==xa.length||(void 0!==ic[String(xa)]?(ic[String(xa)].$a=p,ic[String(xa)].oa=n):(ic[String(xa)]=new ob(p,n,0,0),ic[String(xa)].ib=p,ic[String(xa)].ra=n),db[p].la+=xa,""!==ea&&(we[n]=ea,ea=""),xa="",Q=!1);else!1===U&&(Q=!0,xa="");else n++,
db[p].i.push(n),I+=T,U||(db[p].sa[n]=I,Dd[n]=I,Qb[n]=ea,we[n]="",db[p].la+=T,ea=I=""),1<n?(1<db[p].i.length?(qc[n]=db[p].i[db[p].i.length-2],cd.push(new De(db[p].i[db[p].i.length-2],db[p].i[db[p].i.length-1],D))):(qc[n]=db[p].m,cd.push(new De(db[p].m,db[p].i[db[p].i.length-1],D))),D=1):qc[n]=0}Hd=[];for(var v in ic)ic.hasOwnProperty(v)&&Hd.push(String(ic[v].ra)+":"+String(ic[v].oa))})(W);for(jb in ic)if(ic.hasOwnProperty(jb)){cd.push(new De(ic[jb].ra,ic[jb].oa,1));Ug=[];Vg=[];for(kg=ic[jb].ib;0<=
kg;)Ug.push(kg),kg=db[kg].qa;for(kg=ic[jb].$a;0<=kg;)Vg.push(kg),kg=db[kg].qa;for(;0<Ug.length&&0<Vg.length;)if(Ug[Ug.length-1]===Vg[Vg.length-1])Ri=Ug.pop(),Ri=Vg.pop();else break;-1<Ri&&(Ug.push(Ri),Vg.push(Ri));fa(jb,Ug,Vg)}for(Fb=1;Fb<Dd.length;Fb++)Ee[Fb]=[];for(J=1;J<cd.length;J++)Ee[cd[J].f].push(cd[J].g),Ee[cd[J].g].push(cd[J].f);for(J=1;J<Dd.length;J++)if(xj=E(M,Ha,qc[J],Dd[J]),0>xj)return;jf=[];eg=[];Kl(M);for(J=1;J<M.length;J++)if("="===Qb[J]){Cj=Bj=!1;dd=[];wd=[];Xd="";Eg=pf=0;id=qc[J];
nd=0<Me(id)?Me(id):J;for(jb in ic)ic.hasOwnProperty(jb)&&(ic[jb].ra===id?pf=ic[jb].oa:ic[jb].oa===id&&(pf=ic[jb].ra),ic[jb].ra===nd?Eg=ic[jb].oa:ic[jb].oa===nd&&(Eg=ic[jb].ra));/[\\|/]/.test(Qb[id])&&(Bj=!0);for(Fb=0;Fb<M[id].a.length;Fb++)2!==M[id].a[Fb].t&&(dd.push(M[id].a[Fb].p),/[\\|/]/.test(Qb[M[id].a[Fb].p])||/[\\|/]/.test(we[M[id].a[Fb].p]))&&(Bj=!0);0===pf&&2===dd.length?dd.sort(function(d,k){return d-k}):0<pf&&2===dd.length&&(/[\\|/]/.test(Qb[id])?pf===dd[0]&&(dd[0]=id[1],dd[1]=pf):/[\\|/]/.test(we[pf])&&
pf!==dd[0]?(dd[1]=dd[0],dd[0]=pf):/[\\|/]/.test(Qb[pf])&&pf!==dd[1]&&(dd[0]=dd[1],dd[1]=pf));/[\\|/]/.test(we[nd])&&(Cj=!0);for(Fb=0;Fb<M[nd].a.length;Fb++)2!==M[nd].a[Fb].t&&(wd.push(M[nd].a[Fb].p),/[\\|/]/.test(Qb[M[nd].a[Fb].p])&&(Cj=!0));0===Eg&&2===wd.length?wd.sort(function(d,k){return d-k}):0<Eg&&2===wd.length&&(/[\\|/]/.test(we[nd])?wd[0]===Eg&&(wd[0]=wd[1],wd[1]=Eg):Eg!==wd[0]&&(wd[1]=wd[0],wd[0]=Eg));!1!==Bj&&!1!==Cj&&(Xd=/[\\|/]/.test(Qb[id])?Xd+("\\"===Qb[id]?"1":"2"):2===dd.length&&/[\\|/]/.test(we[dd[0]])?
Xd+("\\"===we[dd[0]]?"1":"2"):"0",Xd=2===dd.length&&/[\\|/]/.test(Qb[dd[1]])?Xd+("\\"===Qb[dd[1]]?"1":"2"):2===dd.length&&/[\\|/]/.test(Qb[dd[0]])?Xd+("\\"===Qb[dd[0]]?"2":"1"):1===dd.length&&/[\\|/]/.test(Qb[dd[0]])?Xd+("\\"===Qb[dd[0]]?"2":"1"):Xd+"0",Xd=/[\\|/]/.test(we[nd])?2===wd.length?Xd+("\\"===we[nd]?"2":"1"):Xd+("\\"===we[nd]?"1":"2"):/[\\|/]/.test(Qb[wd[0]])?Xd+("\\"===Qb[wd[0]]?"1":"2"):Xd+"0",Xd=/[\\|/]/.test(we[nd])?Xd+"0":2===wd.length&&/[\\|/]/.test(Qb[wd[1]])?Xd+("\\"===Qb[wd[1]]?
"1":"2"):Xd+"0",Yl=Nc(Xd),void 0===S[String(id)+"-"+String(nd)]&&(S[String(id)+"-"+String(nd)]={w:id,t:nd,O:dd[0],P:0,S:wd[0],R:0,ea:Xd,T:Yl},2===dd.length&&(S[String(id)+"-"+String(nd)].P=dd[1]),2===wd.length&&(S[String(id)+"-"+String(nd)].R=wd[1])),void 0===S[String(nd)+"-"+String(id)]&&(wh=S[String(id)+"-"+String(nd)].T,S[String(nd)+"-"+String(id)]={w:nd,t:id,O:0,P:0,S:0,R:0,ea:"",T:""},2===wd.length?(S[String(nd)+"-"+String(id)].O=wd[1],S[String(nd)+"-"+String(id)].P=wd[0],wh="t"===wh?"c":"t"):
S[String(nd)+"-"+String(id)].O=wd[0],2===dd.length?(S[String(nd)+"-"+String(id)].S=dd[1],S[String(nd)+"-"+String(id)].R=dd[0],wh="t"===wh?"c":"t"):S[String(nd)+"-"+String(id)].S=dd[0],S[String(nd)+"-"+String(id)].T=wh,S[String(nd)+"-"+String(id)].ea="t"===wh?"1010":"1020"))}Jf="";for(J=1;J<R.length;J++)Jf=Jf+"-"+R[J].length;Jf=Jf.slice(1);for(Uc=0;Jf!==Vl&&20>Uc;){Vl=Jf;tc();Jf="";for(J=1;J<R.length;J++)Jf=Jf+"-"+R[J].length;Jf=Jf.slice(1);Uc++}Ik[0]=0;for(J=1;J<cd.length;J++)Ik.push(wa(cd[J].f,cd[J].g));
Qg=[];for(J=1;J<R.length;J++)if(!0===Pa(J))for(Qg[J]=!0,Uc=0;Uc<R[J].length;Uc++)1===Uc%2&&(Qb[R[J][Uc]]="=");else Qg[J]=!1;if(0<gb.length)for(J=0;J<gb.length;J++)void 0===oe[String(gb[J].Y)]&&(oe[String(gb[J].Y)]=[]),oe[String(gb[J].Y)].push(gb[J].Z),void 0===oe[String(gb[J].Z)]&&(oe[String(gb[J].Z)]=[]),oe[String(gb[J].Z)].push(gb[J].Y);if(0<Bd.length)for(J=0;J<Bd.length;J++)void 0===oe[String(Bd[J].Y)]&&(oe[String(Bd[J].Y)]=[]),oe[String(Bd[J].Y)].push(Bd[J].Z),void 0===oe[String(Bd[J].Z)]&&(oe[String(Bd[J].Z)]=
[]),oe[String(Bd[J].Z)].push(Bd[J].Y);lg=0;for(jb in oe)if(oe.hasOwnProperty(jb)){La[lg]=[];La[lg]=Ei(La[lg],oe[jb]);for(J=0;J<oe[jb].length;J++)La[lg]=Ei(La[lg],oe[String(oe[jb][J])]);La[lg]=fg(La[lg]);La[lg].sort(function(d,k){return parseInt(d,10)-parseInt(k,10)});lg++}if(1<La.length){for(J=0;J<La.length-1;J++)for(Fb=J+1;Fb<La.length;Fb++)!0===vg(La[J],La[Fb])&&La.splice(Fb--,1);for(J=0;J<La.length-1;J++)for(Fb=J+1;Fb<La.length;Fb++)for(Uc=0;Uc<La[J].length;Uc++)if(La[Fb].includes(La[J][Uc])){La[J]=
Ei(La[J],La[Fb]);La.splice(Fb--,1);break}}La.sort(function(d,k){var n,p=0,h=0;if(k.length===d.length){for(n=0;n<d.length;n++)p+=R[d[n]].length,h+=R[k[n]].length;return h-p}return k.length-d.length});for(J=0;J<La.length;J++)La[J].sort(function(d,k){return R[k].length-R[d].length});(function(d,k){var n=0,p=0,h=0,U=0,z=p=n=U=h=0;z=[];var y=!1;for(h=0;h<db.length;h++)for(n=p=U=0;U<db[h].i.length;)0<ba(db[h].i[U])?(0<U&&0<n&&(F[F.length-1].J=db[h].i[U],n=0),p=db[h].i[U]):(0===U?F[F.length]=new Qc(db[h].ga,
db[h].m,db[h].qa,0):0<p&&(F[F.length]=new Qc(0,p,-2,0),p=0),F[F.length-1].i.push(db[h].i[U]),F[F.length-1].sa.push(Dd[db[h].i[U]]),n=db[h].i[U]),U++;La.sort(function(O,D){return D.length-O.length});F.sort(function(O,D){return O.ga-D.ga});for(h=0;h<F.length;h++)0===F[h].m&&0<F[h].J&&(Sd(F,h),z.push(h));if(0<F.length){for(h=0;h<F.length;h++){if(0===F[h].ga&&0===F[h].J&&0!==F[h].m)for(U=0;U<F.length;U++)if(h!==U&&0<F[U].m&&0<F[U].J&&void 0!==oa[String(F[U].J)]&&(n=F[h].i[F[h].i.length-1],p=F[U].i[0],
Ee[n].includes(p))){fd(h,U);F.splice(U,1);y=!0;break}if(!0===y)break}jc(F);Ud(d,k);for(h=0;h<F.length;h++)0===F[h].m&&0<F[h].J&&(Sd(F,h),z.push(h));if(1<d[F[0].i[0]].a.length)for(h=0;h<d[F[0].i[0]].a.length;h++)if(ba(d[F[0].i[0]].a[h].p)){F[0].m=d[F[0].i[0]].a[h].p;break}for(h=0;h<F.length;h++)if(z=F[h].i[F[h].i.length-1],1<d[z].a.length)for(U=0;U<d[z].a.length;U++)if(0===F[h].J&&ba(d[z].a[U].p)){F[h].J=d[z].a[U].p;break}-1===fe&&3<F[0].i.length&&0<F[0].m&&0===F[0].J&&void 0!==oa[String(F[0].m)]&&
1===oa[String(F[0].m)].length&&Sd(F,0);jc(F)}})(M,Ha);xe=[];for(J=1;J<cd.length;J++)void 0!==oa[String(cd[J].f)]&&void 0!==oa[String(cd[J].g)]&&0===Ik[J]&&xe.push({Ab:J,Ha:cd[J].f,Ia:cd[J].g});for(jb in ic)ic.hasOwnProperty(jb)&&Ye(M,Ha,ic[jb].ra,ic[jb].oa,1);(function(d){var k,n,p=0;Ek=[];for(n=0;n<gb.length-1;n++){var h=gb[n].Y;var U=gb[n].Z;for(k=n+1;k<gb.length;k++)if(h===gb[k].Y&&U===gb[k].Z||h===gb[k].Z&&U===gb[k].Y){var z=String(Math.min(h,U))+"-"+String(Math.max(h,U));void 0!==ib[z]?ib[z]=
Ei(ib[z],[gb[k].ta,gb[k].ua,gb[n].ta,gb[n].ua]):(ib[z]=[gb[k].ta,gb[k].ua,gb[n].ta,gb[n].ua],ib[z]=fg(ib[z]))}}for(var y in ib)if(ib.hasOwnProperty(y)){k=[];for(n=0;n<ib[y].length;n++)if(2<eb(d,ib[y][n])){p=ib[y][n];k.push(p);break}for(z=0;k.length<ib[y].length;){for(n=0;n<d[p].a.length;n++)ib[y].includes(d[p].a[n].p)&&!k.includes(d[p].a[n].p)&&(p=d[p].a[n].p,k.push(p));z++;if(20<z)break}ib[y]=k.slice(0);n=y.split("-");h=R[parseInt(n[0],10)].length>=R[parseInt(n[1],10)].length?parseInt(n[0],10):parseInt(n[1],
10);q(ib[y],R[h])||ib[y].reverse()}fg(Ek)})(M);var Zl=0;for(jb in ib)ib.hasOwnProperty(jb)&&3===ib[jb].length&&7===M[ib[jb][0]].j&&7===M[ib[jb][2]].j&&!nh.includes(M[ib[jb][1]].o)&&(yj=jb,Pe[jb]={Y:jb.split("-")[0],Z:jb.split("-")[1],Ua:ib[jb][1],Sa:ib[jb][0],Ta:ib[jb][2]},Zl++);var Dj=0,Kk=0;for(J=1;J<R.length;J++)if(5===R[J].length){for(Fb=Kk=0;Fb<R[J].length;Fb++)7===M[R[J][Fb]].j&&Kk++;1===Kk&&(Dj++,Tg.push(J))}if(0<La.length&&10<=R[La[0][0]].length&&4<=Dj&&0<F.length&&0===F[0].m&&0===F[0].J&&
(Dg=Nb(M,Ha,0),0<Dg))if(F[0].i.includes(Ha[Dg].f)){var Tm=Ha[Dg].g;bc(F,0,Math.min(F[0].i.indexOf(Ha[Dg].f)+1,F[0].i.length-1));F[0].m=Tm;fe=-1}else if(F[0].i.includes(Ha[Dg].g)){var Um=Ha[Dg].f;bc(F,0,Math.min(F[0].i.indexOf(Ha[Dg].g)+1,F[0].i.length-1));F[0].m=Um;fe=-1}1===Zl&&4<=Dj?(ig="m2porphin",fe=-1,0<F.length&&0===F[0].m&&0===F[0].J&&(Dg=Nb(M,Ha,0)),0<La.length&&10===R[La[0][0]].length&&10===R[La[0][1]].length&&(Jb(La[0][0],La[0][1],[Pe[yj].Sa,Pe[yj].Ua,Pe[yj].Ta]),Cg=La[0][1])):4<=Dj&&5<=
La[0].length&&16===R[La[0][0]].length&&(ig="porphin");Ze=qc.slice(0);(function(d,k){var n;var p=-1;var h="",U=0;var z=F.length+R.length-1;if(1<R.length){var y=1;for(n=2;n<R.length;n++)R[n].length>R[y].length&&(y=n);Rh=8<R[y].length?y:-1}0<La.length&&(p=0);switch(!0){case -1<fe||mf.includes(0):Ba(d,k,0,0);h=0===fe?"mchain":"achain";Tb=rc.length+vc.length;break;case 0<F.length&&0<ee.length:Ba(d,k,ee[0],0);th.push(ee[0]);p=ba(F[ee[0]].m);ba(F[ee[0]].J);var O=F[ee[0]].m;var D=F[ee[0]].i[0];y=Oe(p);-1!==
y?Ab(d,k,y,D,O,p):Mb(d,k,p,O,D,"chend","",1,R[p].indexOf(O),0,0,"",na);h="cchain";Tb=rc.length+vc.length;break;case 0<La.length:Ab(d,k,p,0,0,0);h="ringSys";Tb=rc.length+vc.length;break;case 1<R.length&&0<Rh&&8<R[Rh].length:Mb(d,k,Rh,0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);h="ring";Tb=rc.length+vc.length;break;case 0<F.length&&0>fe&&0===F[0].ga:Ba(d,k,0,0);h="achain";Tb=rc.length+vc.length;break;case 0<F.length&&0>fe&&0<mf.length:Ba(d,k,mf[0],0);h="achain";Tb=rc.length+vc.length;break;case 0<
F.length&&0===F[0].ga&&0<Pi:Mb(d,k,Pi,0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);h="ring";Tb=rc.length+vc.length;break;case 0<Fe.length:Mb(d,k,Fe[0],0,0,"first","",1,0,za.b+za.c/2,za.t+za.h/2,"",na);h="ring";Tb=rc.length+vc.length;break;case 0<F.length:Ba(d,k,0,0),h="achain",Tb=rc.length+vc.length}for(;Tb<z&&20>U;)if(U++,p=!1,"cchain"===h){if(O=F[th[th.length-1]].J,D=F[th[th.length-1]].i.slice(-1)[0],p=ba(F[th[th.length-1]].J),y=Oe(p),-1!==y?(Ab(d,k,y,D,O,p),h="ringSys"):(y=R[p].indexOf(O),
Mb(d,k,p,O,D,"chend","",1,y,0,0,"",na),h="ring"),Tb=rc.length+vc.length,Tb===z)return}else{if("achain"===h){var I=vc[vc.length-1];O=F[I].J;D=F[I].i.slice(-1)[0];switch(!0){case 0<O&&void 0!==D&&0<ba(O)&&!rc.includes(ba(O)):n=ba(O);y=Oe(n);0<=y?(Ab(d,k,y,D,O,n),Tb=rc.length+vc.length,h="ringSys"):(y=R[n].indexOf(O),Mb(d,k,n,O,D,"chend","",1,y,0,0,"",na),Tb=rc.length+vc.length,h="ring");if(Tb===z)return;break;case 0<O&&!rb(d,O):y=aa(F,O);if(-1<y&&(O===F[y].i[0]?Ba(d,k,y,D):O===F[y].i.slice(-1)[0]?(Sd(F,
y),Ba(d,k,y,F[y].m)):(bc(F,y,F[y].i.indexOf(O)),rb(d,F[F.length-1].m)||(F[F.length-1].m=F[I].i.slice(-1)[0]),z++,Ba(d,k,F.length-1,F[F.length-1].m)),Tb=rc.length+vc.length,h="achain",Tb===z))return;break;case 0<F[I].m&&!rb(d,F[I].m):y=aa(F,F[I].m);if(-1<y){if(F[I].m===F[y].i[0]?Ba(d,k,y,F[I].i[0]):F[I].m===F[y].i.slice(-1)[0]?(Sd(F,y),Ba(d,k,y,F[I].i[0])):(bc(F,y,F[y].i.indexOf(F[I].m)),rb(d,F[F.length-1].m)||(F[F.length-1].m=F[I].i[0]),z++,Ba(d,k,F.length-1,F[F.length-1].m)),Tb=rc.length+vc.length,
h="achain",Tb===z)return}else if(n=ba(F[I].m),0<n&&(y=Oe(n),0<=y?(Ab(d,k,y,F[I].i[0],F[I].m,n),Tb=rc.length+vc.length,h="ringSys"):(y=R[n].indexOf(F[I].m),Mb(d,k,n,F[I].m,F[I].i[0],"chend","",1,y,0,0,"",na),Tb=rc.length+vc.length,h="ring"),Tb===z))return;break;case (0===F[I].J||rb(d,F[I].J))&&(0===F[I].m||rb(d,F[I].m)):n=!1;if(0<vc.length)for(I=0;I<F.length;I++)if(!vc.includes(I)){if(0<F[I].m&&rb(d,F[I].m)&&(Ba(d,k,I,F[I].m),Tb=rc.length+vc.length,h="achain",n=!0,Tb===z)||!n&&0<F[I].J&&rb(d,F[I].J)&&
(Sd(F,I),Ba(d,k,I,F[I].m),Tb=rc.length+vc.length,h="achain",n=!0,Tb===z))return;if(!n)for(D=F[I].i[0],O=0;O<d[D].a.length;O++)if(rb(d,d[D].a[O].p)&&(Ba(d,k,I,d[D].a[O].p),Tb=rc.length+vc.length,h="achain",n=!0,Tb===z))return;if(!n)for(D=F[I].i.slice(-1)[0],O=0;O<d[D].a.length;O++)if(rb(d,d[D].a[O].p)&&(Ba(d,k,I,d[D].a[O].p),Tb=rc.length+vc.length,h="achain",n=!0,Tb===z))return;if(!n)for(y=1;y<F[I].i.length-1&&!n;){D=F[I].i[y];for(O=0;O<d[D].a.length;O++)if(rb(d,d[D].a[O].p)&&(Ba(d,k,I,d[D].a[O].p),
Tb=rc.length+vc.length,h="achain",n=!0,Tb===z))return;y++}}if(!n&&0<rc.length)for(I=1;I<R.length;I++)if(!rc.includes(I))for(y=0;y<R[I].length;y++)for(D=R[I][y],O=0;O<d[D].a.length;O++)if(rb(d,d[D].a[O].p)&&(-1<Oe(I)?(Ab(d,k,Oe(I),d[D].a[O].p,D,I),h="ringSys"):(Mb(d,k,I,D,d[D].a[O].p,"chend","",1,y,0,0,"",na),h="ring"),Tb=rc.length+vc.length,Tb===z))return;break;default:for(O=F[vc.slice(-1)[0]].i.slice(-1)[0],y=0;y<d[O].a.length;y++)if(!1===rb(d,d[O].a[y].p))if(D=aa(F,d[O].a[y].p),-1<D&&F[D].i[0]===
d[O].a[y].p){Ba(d,k,D,O);Tb=rc.length+vc.length;h="achain";if(Tb===z)return;p=!0;break}else if(-1<D&&F[D].i.slice(-1)[0]===d[O].a[y].p){Sd(F,D);Ba(d,k,D,O);Tb=rc.length+vc.length;h="achain";if(Tb===z)return;p=!0;break}}}else if("ring"===h||"ringSys"===h){if(0<xe.length){for(I=D=n=O=0;I<xe.length;I++)if(rb(d,xe[I].Ha)&&!rb(d,xe[I].Ia)?(O=xe[I].Ia,n=ba(O),D=xe[I].Ha):rb(d,xe[I].Ia)&&!rb(d,xe[I].Ha)&&(O=xe[I].Ha,n=ba(O),D=D=xe[I].Ia),0<O){y=Oe(n);0<=y?(Ab(d,k,y,D,O,n),Tb=rc.length+vc.length,h="ringSys"):
(y=R[n].indexOf(O),Mb(d,k,n,O,D,"chend","",1,y,0,0,"",na),Tb=rc.length+vc.length,h="ring");if(Tb===z)return;p=!0;break}if(p)continue}n=!1;for(I=0;I<F.length;I++)if(!vc.includes(I)&&("ring"===h||"ringSys"===h)){0<ba(F[I].m)&&rc.includes(ba(F[I].m))?(Ba(d,k,I,F[I].m),h="achain",Tb=rc.length+vc.length,n=!0):0<ba(F[I].J)&&rc.includes(ba(F[I].J))&&(Sd(F,I),Ba(d,k,I,F[I].m),h="achain",Tb=rc.length+vc.length,n=!0);if(Tb===z)return;if(n)break}if(p)continue}for(n=0;n<F.length;n++)if(!vc.includes(n)&&0<F[n].m&&
rb(d,F[n].m)){Ba(d,k,n,0);h="achain";Tb=rc.length+vc.length;if(Tb===z)return;break}for(n=1;n<R.length;n++)if(!rc.includes(n)){for(I=0;I<R[n].length;I++){for(y=0;y<d[R[n][I]].a.length;y++)if(0===ba(d[R[n][I]].a[y].p)&&!0===rb(d,d[R[n][I]].a[y].p)){O=R[n][I];D=d[R[n][I]].a[y].p;-1<Oe(n)?(Ab(d,k,Oe(n),D,O,n),h="ringSys"):(Mb(d,k,n,O,D,"chend","",1,I,0,0,"",na),h="ring");Tb=rc.length+vc.length;if(Tb===z)return;p=!0;break}if(p)break}if(p)break}if(!p)for(n=0;n<F.length;n++)if(!vc.includes(n)){for(I=1;I<
R.length;I++)if(rc.includes(I)){for(y=0;y<R[I].length;y++)if(-1<Ia(k,R[I][y],F[n].i[0])){y=R[I][y];Ba(d,k,n,y);h="achain";Tb=rc.length+vc.length;if(Tb===z)return;p=!0;break}if(p)break}if(p)break}}Tb!==z&&(zg="Not all components plotted")})(M,Ha);zj[0]=[[0,120,240],[0,120,240],[0,120,240],[0,120,180,240],[30,120,180,240,330]];zj[1]=[[120,240],[120,240],[120,180,240],[60,150,210,270]];xj=M.length-1;for(J=1;J<=xj;J++)if(Qi=uk(M,J,!1),0<M[J].C){M[J].C<=Qi&&(M[J].C=Math.max(M[J].C-Qi,0));sh=[];for(Uc=
0;Uc<M[J].a.length;Uc++)sh.push(Ya(M,J,M[J].a[Uc].p));if(M[J].C>Qi&&1<M[J].C){if(wj=M[J].C,Fa=[],Ne(M,J,!0),1===Fa.length&&0===Fa[0].$&&(Fa[0].$=360),90<=Fa[Fa.length-1].$){var Vm=Ya(M,J,Fa[Fa.length-1].ba),$l=Fa[Fa.length-1].$/(wj+1);of=ha(Vm+$l);for(Fb=0;Fb<wj;Fb++)ec(M,Ha,J,of,1),of=ha(of+$l);M[J].C-=wj}}else for(Uc=0;Uc<M[J].C;Uc++){if(0===sh.length&&6>M[J].C)of=zj[0][M[J].C-1][Uc];else if(1===sh.length&&5>M[J].C)of=ha(sh[0]+zj[1][M[J].C-1][Uc]);else for(Fa=[],Ne(M,J,!0),of=Rf(M,J,Fa[Fa.length-
1].fa,Fa[Fa.length-1].ba,!0),Fb=0;Fb<sh.length;Fb++)5>Math.abs(ha(sh[Fb]-of))&&(of=ha(of+180));ec(M,Ha,J,of,1);--M[J].C}1===Qi&&/@{1,2}/.test(M[J].I)&&1===M[J].D&&1===M[J].F&&(Fa=[],Ne(M,J,!0),of=Rf(M,J,Fa[Fa.length-1].fa,Fa[Fa.length-1].ba,!0),ec(M,Ha,J,of,1))}ge=[];for(J=1;J<M.length;J++)if(M[J].X)for(ge.push(J),Lb=0;Lb<M[J].a.length;Lb++)2===M[J].a[Lb].t&&Of(M,Ha,J,M[J].a[Lb].p,"-");if(1<ge.length)for(Wl=[],Xg=ge.slice(0),vh=Xg[0],Td="+",Jk=1;0<Xg.length&&Jk<=ge.length;)Gk=[],Xg.splice(Xg.indexOf(vh),
1),Gk=Gb(M,vh,Xg,1),Si=Gk[0],void 0!==Si&&-1<Si?("+"===Td?(Of(M,Ha,vh,Si,"+"),Td="-"):Td="+",Wl.push(vh),vh=Si):0<Xg.length&&(vh=Xg[0],Td="+"),Jk++;(function(d,k,n){Ti=[];for(d=1;d<Ha.length;d++)n.includes(Ha[d].f)&&n.includes(Ha[d].g)&&2===Ha[d].B&&Ti.push(d)})(M,Ha,ge);de=[];Dc=[];for(J=0;J<ge.length;J++)1===Qa(M,Ha,ge[J])?de.push(ge[J]):Dc.push(ge[J]);if(0<Dc.length)for(J=0;J<Dc.length-1;J++){for(Uc=J+1;Uc<Dc.length;Uc++)if(ve=yb(M,Ha,Dc[J],Dc[Uc]),1===ve&&0===Ib(M,Ha,lf)){Dc.splice(Dc.indexOf(Dc[J]),
1);Dc.splice(Dc.indexOf(Dc[Uc]),1);de.push(Dc[J]);de.push(Dc[Uc]);break}if(0===Dc.length)break}de=[];Dc=[];for(J=0;J<ge.length;J++)1===Qa(M,Ha,ge[J])?de.push(ge[J]):Dc.push(ge[J]);if(0<Dc.length){for(J=1;J<M.length;J++)if(M[J].X)for(Lb=0;Lb<M[J].a.length;Lb++)2===M[J].a[Lb].t&&M[M[J].a[Lb].p].X&&Of(M,Ha,J,M[J].a[Lb].p,"-");for(J=0;J<Ti.length;J++)Of(M,Ha,Ha[Ti[J]].f,Ha[Ti[J]].g,"+");for(J=0;J<Dc.length-1;J++){for(Uc=J+1;Uc<Dc.length;Uc++)if(ve=ab(M,Ha,Dc[J],Dc[Uc]),1===ve&&0===Ib(M,Ha,lf)){Dc.splice(Dc.indexOf(Dc[J]),
1);Dc.splice(Dc.indexOf(Dc[Uc]),1);de.push(Dc[J]);de.push(Dc[Uc]);break}if(0===Dc.length)break}}(function(d,k){function n(P,X,ca,ka){var va=!1;switch(!0){case 0===ba(ca)&&0===ba(ka):aa(F,ca)<aa(F,ka)&&(va=!0);break;case 0<ba(ca)&&0===ba(ka):va=!0;break;case 0<ba(ca)&&0<ba(ka):R[ba(ca)].length>R[ba(ka)].length&&(va=!0)}va&&(va=ka,ka=ca,ca=va);Ca(P,X,ca,ka)}function p(P,X,ca,ka){var va=la,Ea=la,Ja;n(P,X,ca,ka);if(0<Ed.length){ca=0;for(Ja=-1;ca<Ed.length;)tg(P,X,Ed[ca],1,!0),ka=Zb(P,X,Rb,1,""),tg(P,
X,Ed[ca],-1,!0),ka<va&&(Ja=ca,va=ka),ca++;va<Ea&&-1!==Ja&&(tg(P,X,Ed[Ja],1,!0),la=Zb(P,X,Rb,0,"inside fixAtomAtomCollisionsByFlip: after flipBranch after bestFlip"))}}function h(P,X,ca,ka){var va,Ea=0,Ja=0;for(va=0;va<F.length;va++)R[ca].includes(F[va].m)?Ea=F[va].m:R[ca].includes(F[va].J)&&(Ea=F[va].J),R[ka].includes(F[va].m)?Ja=F[va].m:R[ka].includes(F[va].J)&&(Ja=F[va].J);0<Ea&&0<Ja&&p(P,X,Ea,Ja)}function U(P,X,ca,ka){var va,Ea=0,Ja=0;var Ma=va=0;var Tc=ia(P,X,ca);var gd=ia(P,X,ka);if(0<Tc&&0<
gd){for(T=0;T<R[Tc].length;T++)Ea+=P[R[Tc][T]].x,Ja+=P[R[Tc][T]].y;Ea/=R[Tc].length;Ja/=R[Tc].length;var Xa=(P[X[ca].f].x+P[X[ca].g].x)/2;Tc=(P[X[ca].f].y+P[X[ca].g].y)/2;for(T=0;T<R[gd].length;T++)va+=P[R[gd][T]].x,Ma+=P[R[gd][T]].y;va/=R[gd].length;Ma/=R[gd].length;var vd=(P[X[ka].f].x+P[X[ka].g].x)/2;gd=(P[X[ka].f].y+P[X[ka].g].y)/2;Ea-=Xa;Ja-=Tc;va-=vd;Ma-=gd;gd=Math.sqrt(Ea*Ea+Ja*Ja);Tc=Math.sqrt(va*va+Ma*Ma);Ea=$a*Ea/gd;Ja=$a*Ja/gd;va=$a*va/Tc;Ma=$a*Ma/Tc;P[X[ca].f].x+=Ea;P[X[ca].f].y+=Ja;P[X[ca].g].x+=
Ea;P[X[ca].g].y+=Ja;P[X[ka].f].x+=va;P[X[ka].f].y+=Ma;P[X[ka].g].x+=va;P[X[ka].g].y+=Ma}else 0===Tc&&0===gd&&(Ma=aa(F,X[ca].f),ca=aa(F,X[ca].g),va=aa(F,X[ka].f),ka=aa(F,X[ka].g),Ma===ca&&va===ka&&(0<F[Ma].m?tg(P,X,Ia(X,F[Ma].m,F[Ma].i[0]),1,!0):0<F[Ma].J&&tg(P,X,Ia(X,F[Ma].J,F[Ma].i.slice(-1)[0]),1,!0)))}function z(P,X,ca,ka){var va=new $c(P[X[ka].g].x-P[X[ka].f].x,P[X[ka].g].y-P[X[ka].f].y);var Ea=new $c(P[ca].x-P[X[ka].f].x,P[ca].y-P[X[ka].f].y);va=new $c(va.x/uj(va),va.y/uj(va));va=new $c(va.x*
(Ea.x*va.x+Ea.y*va.y),va.y*(Ea.x*va.x+Ea.y*va.y));var Ja=new $c(0,0);Ea=new $c(0,0);Ja.x=P[ca].x-(P[X[ka].f].x+va.x);Ja.y=P[ca].y-(P[X[ka].f].y+va.y);Ea.x=Ja.x*Rb/uj(Ja);Ea.y=Ja.y*Rb/uj(Ja);for(va=0;0<Wd.length&&Wd[0][0]===ca&&Wd[0][1]===ka&&4>va;)P[ca].x+=Ea.x,P[ca].y+=Ea.y,Zb(P,X,Rb,0," inside fixAtBondCollisions after atom move"),va++}function y(P,X,ca){var ka=Sg[ca][0],va=Sg[ca][1],Ea=Sg[ca][2],Ja,Ma=ca=0,Tc=!1;Fa=[];Ne(P,ka,!0);var gd=ia(P,X,Ia(X,ka,va));var Xa=ia(P,X,Ia(X,ka,Ea));if(0===gd&&
0===Xa)ca=va,Ma=Ea;else if(0===gd&&0<Xa)ca=va,Ma=Ea;else if(0<gd&&0===Xa)ca=Ea,Ma=va;else if(0<gd&&0<Xa){for(Ja=0;Ja<kd.length;Ja++)if(kd[Ja][0]===va&&kd[Ja][1]===Ea||kd[Ja][0]===Ea&&kd[Ja][1]===va){Tc=!0;break}if(Tc)R[gd].length<R[Xa].length?(Ja=ld(P[va].x,P[va].y,fc(P,gd).x,fc(P,gd).y),I(P,va,Ja,1.1*Rb)):(Ja=ld(P[Ea].x,P[Ea].y,fc(P,Xa).x,fc(P,Xa).y),I(P,Ea,Ja,1.1*Rb));else for(Ja=0;Ja<P[ka].a.length;Ja++)if(P[ka].a[Ja].p!==va&&P[ka].a[Ja].p!==Ea){Ja=Ya(P,ka,P[ka].a[Ja].p);I(P,ka,Ja,.3*na);return}}va=
Fa.length-1;for(Ja=Fa.length-1;0<=Ja;Ja--)if(0<wa(Fa[Ja].ba,Fa[Ja].fa))va--;else if(Fa[Ja].ba===ca||Fa[Ja].fa===ca)va--;else break;0>va&&(va=Fa.length-1);0!=ca&&0!=Ma&&void 0!==Fa[va]&&(Ma=Ya(P,ka,ca),Ja=Rf(P,ka,Fa[va].ba,Fa[va].fa,180<Fa[va].$?!0:!1),xa(P,X,ka,ca,Ma,1),xa(P,X,ka,ca,Ja,-1))}function O(P,X,ca){var ka=-1,va=0;Ne(P,ca,!0);180<Fa[Fa.length-1].$&&Rf(P,ca,Fa[Fa.length-1].ba,Fa[Fa.length-1].fa,!0);for(J=0;J<P[ca].a.length;J++){var Ea=Ia(X,ca,P[ca].a[J].p);if(!(0<ia(P,X,Ea))){ka=Ya(P,ca,
P[ca].a[J].p);va=P[ca].a[J].p;break}}-1!==ka&&0<va&&xa(P,X,ca,va,180,-1)}function D(P,X,ca,ka){Ca(P,X,X[ca].f,X[ka].f);var va=Hb.slice(0);var Ea=Ed.slice(0);Ca(P,X,X[ca].g,X[ka].f);Hb.length>va.length&&(va=Hb.slice(0),Ea=Ed.slice(0));Ca(P,X,X[ca].f,X[ka].g);Hb.length>va.length&&(va=Hb.slice(0),Ea=Ed.slice(0));Ca(P,X,X[ca].g,X[ka].g);Hb.length>va.length&&(va=Hb.slice(0),Ea=Ed.slice(0));Hb=va.slice(0);Ed=Ea.slice(0);for(J=0;J<Ed.length&&(tg(P,X,Ed[J],1,!0),la=Zb(P,X,Rb,0," inside fixCrossingBonds: after flipBranch"),
0!==$e.length);J++)tg(P,X,Ed[J],-1,!0)}function I(P,X,ca,ka){var va=ka*Math.sin(Math.PI*ca/180);P[X].x+=ka*Math.cos(Math.PI*ca/180);P[X].y=P[X].y-va}function Q(P,X,ca,ka){var va=na*ka;if(!(void 0===ca||1>ca||ca>X.length)){var Ea=Hb[Math.min(Hb.indexOf(X[ca].f),Hb.indexOf(X[ca].g))];var Ja=Hb[Math.max(Hb.indexOf(X[ca].f),Hb.indexOf(X[ca].g))];ca=Math.sqrt((P[Ja].x-P[Ea].x)*(P[Ja].x-P[Ea].x)+(P[Ja].y-P[Ea].y)*(P[Ja].y-P[Ea].y));var Ma=Ya(P,Ea,Ja);X=va*Math.cos(Math.PI*Ma/180);va=-1*va*Math.sin(Math.PI*
Ma/180);Oh(P,Ja,Ea);Ea=P[lc[1]].x+X;Ja=P[lc[1]].y+va;Ea=Math.sqrt((P[lc[0]].x-Ea)*(P[lc[0]].x-Ea)+(P[lc[0]].y-Ja)*(P[lc[0]].y-Ja));if(Ea<ca&&0<ka||Ea>ca&&0>ka)X*=-1,va*=-1;for(ka=1;ka<lc.length;ka++)P[lc[ka]].x+=X,P[lc[ka]].y+=va}}function xa(P,X,ca,ka,va,Ea){X=Hb[0];Oh(P,ka,ca);for(ka=0;ka<P.length;ka++)P[ka].v=0;for(ka=0;ka<lc.length;ka++)P[lc[ka]].v=1;0===va&&0<X&&(va=Math.sqrt((P[ca].x-P[X].x)*(P[ca].x-P[X].x)+(P[ca].y-P[X].y)*(P[ca].y-P[X].y)),va=180*Math.asin(2*$a/va)/Math.PI);ka=P[ca].x;X=
P[ca].y;nj(P,1,-1*ka,-1*X,!1);Ph(P,1,P[ca].x,P[ca].y,Ea*va,!1);nj(P,1,ka,X,!1);Yc()}function ea(P,X,ca,ka){var va=R[ca].indexOf(ka);X=new $c(P[ka].x,P[ka].y);var Ea=new $c(0,0);new $c(0,0);-1<va&&(ca=fc(P,ca),ca=ld(ca.x,ca.y,X.x,X.y),Ea.x=2*$a*Math.cos(Math.PI*ca/180),Ea.y=-2*$a*Math.sin(Math.PI*ca/180),P[ka].x=X.x+Ea.x,P[ka].y=X.y+Ea.y)}var T=0,v=0,qa=0,Sa=v=0,ma=0,la=0;Sa=-1;la=Zb(d,k,Rb,0," After first checkCollisions");if(0<Sg.length)for(qa=0;0<Sg.length&&6>qa;)y(d,k,0),la=Zb(d,k,Rb,0," after fixLigDirSame"),
qa++;if(0!==la&&0<Th.length)for(qa=0;0<Th.length&&4>qa;)O(d,k,Th[0]),la=Zb(d,k,Rb,0,"after fix_parapluie"),qa++;if(0!==la&&0<jg.length)for(qa=0;0<jg.length&&3>qa;)ea(d,k,jg[0][0],jg[0][1]),la=Zb(d,k,Rb,0,"after fix_pRingAngle"),qa++;if(0<Sh.length)for(qa=0;0<Sh.length&&6>=qa;){h(d,k,Sh[0][0],Sh[0][1]);la=Zb(d,k,Rb,0," after fixIsoRingsColl");if(0===la)return;qa++}if(0<rh.length)for(qa=0;0<rh.length&&6>=qa;){U(d,k,rh[0][0],rh[0][1]);la=Zb(d,k,Rb,0," after fixBondColl");if(0===la)return;qa++}else if(0<
$e.length)for(qa=0;0<$e.length&&6>qa;)D(d,k,$e[0][0],$e[0][1]),0!==$e.length&&(la=Zb(d,k,Rb,0,"after fixCrossingBonds"),qa++);if(0<Wd.length)for(qa=0;0<Wd.length&&6>qa;){for(T=0;T<Wd.length;T++){p(d,k,Wd[0][0],k[Wd[0][1]].f);la=Zb(d,k,Rb,0,"atBondTooClose after fixAtomAtomCollisonByFlip with fra");if(0===la)return;if(0===Wd.length)break;else{p(d,k,Wd[0][0],k[Wd[0][1]].g);la=Zb(d,k,Rb,0,"atBondTooClose after fixAtomAtomCollisonByFlip with toa");if(0===la)return;if(0===Wd.length)break}z(d,k,Wd[T][0],
Wd[T][1])}la=Zb(d,k,Rb,0," after fixAtBondCollisions by moving atom");qa++}for(qa=0;0<kd.length&&10>=qa;){p(d,k,kd[0][0],kd[0][1]);la=Zb(d,k,Rb,0," after fixAtomAtomCollisonByFlip inside tooClose() while loop");if(0===la)return;if(0<kd.length)if(n(d,k,kd[0][0],kd[0][1]),0<Ed.length){if(0===Ed.length%2){Sa=Ed[Math.floor(Ed.length/2)-1];ma=Ed[Math.floor(Ed.length/2)];for(v=0;0<kd.length&&6>v;)Q(d,k,Sa,$a/na),la=Zb(d,k,Rb,0," after stretch bond1 even number"),v++;if(0===la)return;Q(d,k,Sa,-1*(v+1)*$a/
na);for(v=0;0<kd.length&&6>v;)Q(d,k,ma,$a/na),la=Zb(d,k,Rb,0," after stretch bond2 even number"),v++;if(0===la)return;Q(d,k,ma,-1*(v+1)*$a/na);la=Zb(d,k,Rb,0," after stretch bond");if(0===la)return;for(v=0;0<kd.length&&6>v;)Q(d,k,Sa,$a/na),Q(d,k,ma,$a/na),la=Zb(d,k,Rb,0," after stretch 2bonds even number"),v++;if(0===la)return;Q(d,k,Sa,-1*(v+1)*$a/na);Q(d,k,ma,-1*(v+1)*$a/na)}else{Sa=Ed[Math.floor(Ed.length/2)];for(v=0;0<kd.length&&6>v;)Q(d,k,Sa,2*$a/na),la=Zb(d,k,Rb,0," after stretch bond odd number"),
v++;if(0===la)return;Q(d,k,Sa,-2*(v+1)*$a/na)}for(v=1;v<Hb.length-2;v++)if(Ed.includes(Ia(k,Hb[v],Hb[v+1]))){Sa=B(d,Hb[v+1],Hb[v],Hb[v-1]);xa(d,k,Hb[v+1],Hb[v],0,Sa);la=Zb(d,k,Rb,0," after bending bond");if(0===la)return;xa(d,k,Hb[v+1],Hb[v],0,-1*Sa)}}else 0<kd.length&&-1!==aa(F,kd[0][0])&&1===F[aa(F,kd[0][0])].i.length?xa(d,k,F[aa(F,kd[0][0])].m,kd[0][0],30,1):0<kd.length&&-1!==aa(F,kd[0][1])&&1===F[aa(F,kd[0][1])].i.length&&xa(d,k,F[aa(F,kd[0][1])].m,kd[0][1],30,1);qa++}la=Zb(d,k,Rb,0," after while loop");
0!==la&&0<jg.length&&(ea(d,k,jg[0][0],jg[0][1]),la=Zb(d,k,Rb,0," after while loop: after fix_pRingAngle"));0!==la&&la!=$e.length&&0!=kd.length&&(n(d,k,kd[0][0],kd[0][1]),1<Hb.length&&(Sa=Ia(k,Hb[0],Hb[1]),Q(d,k,Sa,-2*$a/na),la=Zb(d,k,Rb,0," after while loop: after stretchBond")));if(0!==la&&la===$e.length)for(qa=0;0<$e.length&&6>qa;)D(d,k,$e[0][0],$e[0][1]),la=Zb(d,k,Rb,0," after while loop: after fixCrossingBonds"),qa++;0!==la&&la===Wd.length&&(z(d,k,Wd[0][0],Wd[0][1]),la=Zb(d,k,Rb,0," after while loop: after fixAtBondCollisions"))})(M,
Ha);if(1<R.length)for(J=1;J<R.length;J++)Xl=fc(M,J),Fk[J]=Xl;for(J=1;J<M.length;J++)if(void 0===Dd[J]||0===Cf[M[J].j]||1===M[J].j)/\[\d{0,1}H\]/.test(Dd[J])&&2===M.length&&(M[J].r=!0);else{Aj=0;uh=[];uh=Dd[J].match(Tl);if(null!==uh)"H"===uh[4]&&(Aj=""!==uh[5]?parseInt(uh[5],10):1);else if("[H]"===Dd[J])Aj=1;else continue;for(Fb=Wf=Hk=Wg=0;Fb<M[J].a.length;Fb++)Wf=4===M[J].a[Fb].t||5===M[J].a[Fb].t?Wf+1:Wf+M[J].a[Fb].t,1===M[M[J].a[Fb].p].j&&Hk++;Wf+=Aj-Hk;Wf+=M[J].D+M[J].F;Wg=Cf[M[J].j]+M[J].s-Wf;
1===Math.abs(Wg)%2&&10<M[J].j?(M[J].r=!0,(17===M[J].j||35===M[J].j||53===M[J].j)&&1<Wf&&0===M[J].s&&(M[J].r=!1)):1===Math.abs(Wg)%2&&0<Wg?M[J].r=!0:2===Wg&&0===M[J].s?(6===M[J].j&&(M[J].o="C:"),7===M[J].j&&(M[J].o="N:")):2===Wg&&1===Wf-M[J].s?7===M[J].j&&(M[J].o="N:"):"[N]"===Dd[J]&&0===Math.abs(Wg)%2&&7===M[J].j&&0===M[J].s&&3===Wf&&(M[J].r=!0);Bg.includes(uh[2])&&0!==Cf[M[J].j]&&Cf[M[J].j]===Wf&&(M[J].r=!0)}if(0<gc.length){for(J=0;J<gc.length;J++)2===Ke(M,Ha,gc[J])&&(Rg.push(gc[J]),gc.splice(J,
1),J--);0<gc.length&&xg(M,Ha);if(0<Rg.length)for(J=0;J<Rg.length;J++)gg(M,Ha,Rg[J])}for(J=1;J<M.length;J++)Nf(M,J)}}function Ad(W){this.ia=W.slice(0);this.eb=[];this.Qa=[];this.Va=this.pa=this.path=0}function Sb(W,E){this.tb=W;this.Ra=E}var Rb=2*$a,Mc=0,tb=0,mc=new yd(0,0,0,0),Za=0,Lb=0,sc=0,zd=0;mc=0;var Cc=!1,Yb=0,bd=0,pc=[],oa={},te={};zd=[];var mh=[],Vb=[],Ld=[],Ee=[[0]],S={},qc=[],Qb=[],we=[],ic={},fb=[],Ji=[],ee=[],Qg=[],yg=!1,Sc=0,uc=0,Ff=[];tb=[];tb=[];var fe=-1,Db={};Yb=Sc=0;new $c(0,0);
var Fe=[],gb=[],Bd=[],Cd="";Za=-1;uc="";var Dd=[],cd=[new De(0,0,0)],zg="";pc=-1;Ff="";var R=[[0]],hg=[];Yb=-1;sc="";var gc=[],Rg=[],ph=Cc=mc=0,mf=[];tb=[];tb=[];var ue=0,Xc=[],kf=0;tb=0;tb=[];if(""!==a)if(ed(),tb=a.match(/!(.+)!/),null!==tb?(Ff=tb[1],pc=tb.index):a.includes("!")&&(Cd="unmatched ! (lone pairs section)"),tb=[],tb=a.match(/\u00bf(.+)\u00bf/),null!==tb?(uc=tb[1],Za=tb.index):a.includes("\u00bf")&&(Cd="unmatched \u00bf (curved arrows section)"),tb=[],tb=a.match(/\u00a7(.+)\u00a7/),null!==
tb?(sc=tb[1],Yb=tb.index):a.includes("\u00a7")&&(Cd="unmatched \u00a7 (reaction arrows section)"),""!==Cd)alert("Parse-SMILES Error:\n"+Cd+"\nin SMILES: "+a);else{-1<Za?a=a.substring(0,Za):-1<pc?a=a.substring(0,pc):-1<Yb&&(a=a.substring(0,Yb));if(/^\./.test(a)||/\.$/.test(a)||/\.\./.test(a))Cd="illegal dot at start and/or end or multiple dots";/^\d/.test(a)&&(Cd="illegal digit at start");if(""!==Cd)alert("Parse-SMILES Error:\n"+Cd+"\nin SMILES: "+a);else{tb=a.split(".");pc=[];if(1<g.length){Sc=g.length-
1;tf=Il();for(Za=1;Za<=tf;Za++)mc=Fd(g,Za,"t"),pc.push(mc);Yb=tf;0<Na.length&&(ta(),ne=[],hf=[],md=[]);0<pa.length?(ue=0,Rc=[],e(pa),ue=pa.length):ue=0}else ue=Yb=0;""!==sc&&Ka(sc,Yb);Za=0;for(Yb=1+Yb;Za<tb.length&&""!==tb[Za];){1===Pl(tb[Za])?Cd="unbalanced ()":-1===Pl(tb[Za])&&(Cd="unbalanced []");if(""!==Cd){alert("Parse-SMILES Error:\n"+Cd+"\nin SMILES: "+tb[Za]);zb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt";return}Ub(tb[Za]);""!=zg&&(Cd=
""===Cd?zg:Cd+("\n"+zg));if(""!==Cd){alert("Parse-SMILES Error:\n"+Cd+"\nin SMILES: '"+tb[Za]+"'");Hl();return}for(sc=1;sc<M.length;sc++)M[sc].v=Yb,M[sc].t=Yb;for(sc=1;sc<Ha.length;sc++)Ha[sc].v=Yb;mc=0;Cc=!1;if(1!==M[1].j)for(sc=1;sc<M.length;sc++)1===M[sc].j&&mc++;else for(Cc=!0,sc=1;sc<M.length;)1!==M[sc].j&&(Cc=!1),sc++;mh.push(mc);Dm(M,Ha,g,Z,Yb,0,0);Ji.push(g.length-1);if(Cc)zd.push(g.length-1);else{for(sc=g.length-1;0<sc&&1===g[sc].j;)sc--;zd.push(sc)}mc=Fd(g,Yb,"s");Ai(g,ra.b+ra.c/2-(mc.b+
mc.c/2),ra.t+ra.h/2-(mc.t+mc.h/2),Yb);mc.b=0;mc.t=0;pc.push(mc);Yb++;Za++}tf=Yb-1;Za=tb=0;for(sc=Lb=1;Za<tf;){for(;sc<=zd[Za];)te[Lb]=Lb+tb,Lb++,sc++;tb+=mh[Za];Za<tf-1&&(sc=Ji[Za]+1);Za++}if(0<hg.length)for(e(hg),Lb=0;Lb<hg.length;)lj(hg,pa,Lb,Lb+ue),Lb++;""!==Ff&&ja(Ff,Sc);""!==uc&&(Ua(uc,Sc),0<Na.length&&ta());(function(){var W,E=[];hf=[];for(W=0;W<ne.length;W++){E.push(ne[W].jb,ne[W].Ma);Nh(g,ne[W].kb,ne[W].lb,ne[W].Ma);if(""!==ne[W].fb){var aa,Ca;for(Ca=0;Ca<g.length;Ca++)g[Ca].v=0;var Qa=1;
for(aa=0;0<Qa;){Qa=0;for(Ca=1;Ca<g.length;Ca++)if(0===g[Ca].v){Qa=Ca;break}if(0===Qa)break;lc=[];var yb=Ih(g,Qa);for(Ca=0;Ca<yb;Ca++)g[lc[Ca]].v=aa;aa++}ze=!0;ih(g,Z,ne[W].fb,ne[W].Ma);Yc()}hf.push([ne[W].jb,ne[W].Ma])}for(W=1;W<=tf;W++)E.includes(W)||(hf.push([W]),E.push(W))})();mj();(function(){var W,E=ra.b+ra.c/2,aa=ra.t+ra.h/2;for(W=0;W<hf.length;W++)Ta(W,E-(md[W].b+md[W].c/2),aa-(md[W].t+md[W].h/2))})();if(0<pa.length){w(Rc);l($a);f();tk=t();mj();for(Za=0;Za<fb.length;Za++){tb=C(Za);for(Lb=0;Lb<
tb.length;Lb++)yg=!0,3!==pa[tb[Lb]].ca&&(yg=!1);if(yg){tb=[];for(Lb=0;Lb<fb[Za].path.length;Lb++)tb.push(Rc[fb[Za].path[Lb]].ia[0]),Da(Rc[fb[Za].path[Lb]].ia[0]);Sc=tb[0];for(Lb=1;Lb<tb.length;Lb++)if(uc=tb[Lb],Ff=Db[uc].La.slice(0),Ff.reverse(),!(vg(Db[Sc].La,Db[uc].La)&&10>Math.abs(Db[Sc].Ka-Db[uc].Ka)))if(vg(Db[Sc].La,Ff)&&10>Math.abs(Db[Sc].Ka-Db[uc].Ka)){for(zd=1;zd<g.length;zd++)g[zd].v=g[zd].t===uc?999:0;ze=!0;Ph(g,999,Db[uc].Ea.x,Db[uc].Ea.y,180,!1);Da(uc);Db[Sc].da.x!=Db[uc].da.x&&(ih(g,
Z,"x",999),Da(uc),Yc())}else{for(zd=1;zd<g.length;zd++)g[zd].v=g[zd].t===uc?999:0;ze=!0;mc=Math.abs(Db[Sc].da.x-Db[uc].da.x)+Math.abs(Db[Sc].da.y-Db[uc].da.y)+Math.abs(Db[Sc].ha.x-Db[uc].ha.x)+Math.abs(Db[Sc].ha.y-Db[uc].ha.y);kf=0;Cc=1E6;for(zd=ph=0;16>zd;zd++)Ph(g,999,Db[uc].Ea.x,Db[uc].Ea.y,15,!1),kf+=15,Da(uc),mc=Math.abs(Db[Sc].da.x-Db[uc].da.x)+Math.abs(Db[Sc].da.y-Db[uc].da.y)+Math.abs(Db[Sc].ha.x-Db[uc].ha.x)+Math.abs(Db[Sc].ha.y-Db[uc].ha.y),mc<Cc&&(Cc=mc,ph=kf);10>Cc?Ph(g,999,Db[uc].Ea.x,
Db[uc].Ea.y,ph-kf,!1):(ih(g,Z,"y",999),Da(uc),mc=Math.abs(Db[Sc].da.x-Db[uc].da.x)+Math.abs(Db[Sc].da.y-Db[uc].da.y)+Math.abs(Db[Sc].ha.x-Db[uc].ha.x)+Math.abs(Db[Sc].ha.y-Db[uc].ha.y),10<mc&&(ih(g,Z,"y",999),ih(g,Z,"x",999)));Da(uc);mc=Math.abs(Db[Sc].da.x-Db[uc].da.x)+Math.abs(Db[Sc].da.y-Db[uc].da.y)+Math.abs(Db[Sc].ha.x-Db[uc].ha.x)+Math.abs(Db[Sc].ha.y-Db[uc].ha.y)}}}qk();ya();mj();for(Za=0;Za<pa.length;Za++){for(Lb=0;Lb<Rc.length;Lb++)tj(Rc[Lb].ia,pa[Za].M)&&(bd=Lb),tj(Rc[Lb].ia,pa[Za].L)&&
(Mc=Lb);re=[];Zj(pa[Za].M,pa[Za].L,sb[bd],sb[Mc]);pa[Za].W.x=re[0];pa[Za].W.y=re[1];pa[Za].V.x=re[2];pa[Za].V.y=re[3]}for(Za=tb=0;Za<sb.length;Za++)tb=Math.max(tb,sb[Za].t+sb[Za].h);c(tb)}else b();Bl();if(0<Lc.length){fg(Lc);vb(Ga,0,!0);for(Za=0;Za<Lc.length;Za++)vi(V,g,Lc[Za]);alert("WARNING:\nParsing of SMILES failed at one or more \nambiguous or inconsistent stereogenic centres!\n\nStereo up/down bonds at centers marked by red squares were replaced by normal single bonds.\n\nThe red squares disappear with the next drawing action");
Lc=[]}else if(ck(),Kd=Kd.trim(),a=a.trim(),Kd.includes(a))vb(Ga,0,!0),zb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt",ed(),Kb();else if(0<Lc.length){fg(Lc);vb(Ga,0,!0);for(Za=0;Za<Lc.length;Za++)vi(V,g,Lc[Za]);alert("WARNING:\nParsing of SMILES produced one or more \nambiguous or inconsistent stereogenic centres!\n\nCheck the stereo-drawing of the centers marked by red squares.\n\nThe red squares disappear with the next drawing action");zb=0;
document.getElementById("shift").className="shift";document.getElementById("alt").className="alt";Lc=[]}else vb(Ga,0,!0),zb=0,document.getElementById("shift").className="shift",document.getElementById("alt").className="alt",alert("Parsing failed!\nentered SMILES:\n"+a+"\n"+Kd+"\nSMILES of parsed structure"),ed(),Kb();tb=[];zb=0;document.getElementById("shift").className="shift";document.getElementById("alt").className="alt"}}}var Vh="yes"===$b?!0:!1,na=da?45:30,L=Math.floor(6+8/30*(na-15)),si=5+(na-
15)/5,$a=na/5,fk=da?ua?na/2:2*$a:$a+4,Kc=da?2*$a:$a+4,jl=na/10,bl=na/10,zi=na/5,Xi=da?ua?na/3:2*zi:zi+2,gl=.86603*na,xi=Math.round(150*na/24)/100,zl=6*xi,Ae=30<na?2:1.5,gk=" c;h;o;n;s;p;f;C;b;i;x;.;+;-".split(";"),xm=" ;;e;r; ; ; ;v; ; ; ; ;Y;y".split(";"),hk="1;2;t;u or <;d or >;3;4;5;6;a;7-9;w;m;l".split(";"),li="C H O N S P F Cl Br I X \u2022 + \u2013".split(" "),wm=/^Ac|Ag|Al|Am|Ar|As|At|Au|Ba|Be|Bh|Bi|Bk|Br|Ca|Cd|Ce|Cf|Cl|Cm|Co|Cr|Cs|Cu|D|Db|Ds|Dy|Er|Es|Eu|Fe|Fm|Fr|Ga|Gd|Ge|He|Hf|Hg|Ho|Hs|In|Ir|K|Kr|La|Li|Lr|Lu|Md|Mg|Mn|Mo|Mt|Na|Nb|Nd|Ne|Ni|No|Np|Os|Pa|Pb|Pd|Pm|Po|Pr|Pt|Pu|Ra|Rb|Re|Rf|Rg|Rh|Rn|Ru|Sb|Sc|Se|Sg|Si|Sm|Sn|Sr|T|Ta|Tb|Tc|Te|Th|Ti|Tl|Tm|Xe|Yb|Zn|Zr|B|C|F|H|I|N|O|P|S|U|V|W|Y$/g,
Bm=/^R[1234]?$/g,qe=["R","R1","R2","R3","R4"],ek=["C:","N:"],Og="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu".split(" "),Cf=[0,1,0,0,0,3,4,3,2,1,0,0,0,3,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,3,2,1,0,1,2,0,0,0,0,0,0,0,0,1,2,3,4,3,2,1,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Cm=["B","Al"],Sl=[1,2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,
653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217],nh="B C N O P S F Cl Br I Si".split(" "),Lm="B C N O P S As Se".split(" "),Bg="b c n o p s as se".split(" "),Km="C:4:0:0 C:3:1:0 Si:4:0:0 Si:3:1:0 Ge:4:0:0 Ge:3:1:0 Sn:4:0:0 Sn:3:1:0 N:4:0:1 P:4:0:1 B:4:0:-1 B:3:1:-1 P:4:0:0 As:4:0:1 N:3:0:az P:3:0:0 As:3:0:0 P:2:1:0 As:2:1:0 S:4:0:0 S:4:0:1 S:3:0:0 S:3:0:1 Se:4:0:0 Se:4:0:1 Se:3:0:0 Se:3:0:1".split(" "),
Em="N:3:0:az P:3:0:0 P:2:1:0 As:3:0:0 As:2:1:0 S:3:0:0 S:3:0:1 Se:3:0:0 Se:3:0:1".split(" "),Bf=0,af=1,he=1,Mj=1,mk=new Image,nk=new Image,ok=new Image,Fc=new yd(10,42,34,503),hc=new yd(38,38,532,36),kc=new yd(10,549,136,36),Lf=new yd(10,0,10,10),za=new yd(48,0,10,10),ra=new yd(0,0,10,10),Zc=new yd(0,0,0,0),H=new yd(0,0,0,0),bf=new yd(0,0,0,0),nl=new yd(0,0,0,0),ol=new yd(0,0,0,0),Gd={x:0,y:0,r:12},ye={x:0,y:0,r:12},zm=new kb(0,"",0,0,0,0,0),g=[new kb(0,"",0,0,0,0,0)],M=[new kb(0,"",0,0,0,0,0)],cg=
[new kb(0,"",0,0,0,0,0)],ef=[new kb(0,"",0,0,0,0,0)],Ac=[new kb(0,"",0,0,0,0,0)],Am=new De(0,0,0),Z=[new De(0,0,0)],Ha=[new De(0,0,0)],Bi=[new De(0,0,0)],ff=[new De(0,0,0)],Na=[],oc=[],tk=[],ne=[],bg="",ud=[new sk(0,0)],Aa=[],hf=[],Rc=[],lh=[],gf=[],pa=[],Lh=[],qb=[],Le=[],Pg={},dg=[],jf=[],Ze=[],sd=[],md=[],sb=[],df=[],eg=[],Bc={},He=[],rd=[],se=[],Hd=[],cb=[],wi=[],Fa=[],Lg=[],Vc=[],nc=[],lc=[],Lc=[],Je=0,be="X",Xb=0,ti="",Uj="",zb=0,tf=0,Ci=0,We=0,hi=0,Zd=0,Ce=0,dh=0,eh=0,qg=0,ai=-1,uf=0,bh=0,
Wi=-1,ie=0,je=0,Wj=0,ej=-1,ql=0,rl=0,ke=0,fi=0,le=0,gi=0,hb=0,bb=0,cc=0,dc=0,pe=0,Hg=-1,$h=-1,Gg=0,zc=0,yc=0,mb=0,rg=-1,hh=-1,ae=0,Oc=0,Wc=0,Kg=-1,Gc=0,Hc=0,bj="",cj=1,Sj=0,Tj=0,Bh=0,aj=0,fh=0,gh=0,Pd=0,Qd=0,ii=0,ji=0,wb="",Ki=1,qh=1,Yh=!1,re=[],ag="reactant",Kd="",Dh=1,Nd,Od,bi=!1,dj=!1,ci=!1,Ge=!1,ah=!1,$g=!1,gj=!1,fj=!1,Jd=!0,Mh=!1,ng=!1,$d=!1,Ig=!1,Zh=!1,Vi=!1,ik=!1,ei=!1,Zi=!1,$i=!1,di=!1,Ch=!1,Wh=!1,ze=!1,Rj=!1,sf=!1,Ah=!1,Ng=!1,ni=!1,pg=!1,wf=!1,vf=!0,xf=!1,Ie=!1,sg=!1,Mf=!1,cf=!1,zf=!1;var im=
document.getElementById("container");var Ic=document.getElementById("bgc");var Te=document.getElementById("igc");var Ue=document.getElementById("pdc");var Wb=document.getElementById("can");var Ve=document.getElementById("sho");var lk=Ic.getContext("2d");var V=Te.getContext("2d");var xc=Ue.getContext("2d");var Ga=Wb.getContext("2d");var jd=Ve.getContext("2d");Ga.setLineDash||(ik=!0);lk.save();V.save();xc.save();Ga.save();jd.save();var rf=document.getElementById("buttonregion");rf.style.position="absolute";
var Wm=document.getElementById("shift");var Xm=document.getElementById("alt");var og=Ga.getImageData(0,0,1,1);var Jh=document.getElementById("xbox");var pm=document.getElementById("xok");var Pf=document.getElementById("xtxa");var jh=document.getElementById("abox");var Kh=document.getElementById("atxa");var ui=document.getElementById("btxa");var wl=document.getElementById("aok");var Zf=document.getElementById("smilesbox");var qm=document.getElementById("smilesok");var ce=document.getElementById("smitxa");
Wh=!1;var Yf=document.getElementById("smixbox");var Af=document.getElementById("smixtxa");var um=document.getElementById("smixcancel");var tm=document.getElementById("smixadd");var vm=document.getElementById("smixok");Sk();Fl();window.addEventListener("focus",function(){zb=0});window.addEventListener("blur",function(){zb=0});pd();da&&window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){setTimeout(xd,500);setTimeout(xd,100);setTimeout(function(){window.scrollTo(0,
0)},500)},!1);(function(){var a,b;return gm(new fm(new bm(function(c){if(1==c.aa)return a=[],a.push(new Promise(function(e){mk.onload=function(){e()};mk.src="elebar.svg"})),a.push(new Promise(function(e){nk.onload=function(){e()};nk.src="toolbar.svg"})),Vh&&a.push(new Promise(function(e){ok.onload=function(){e()};ok.src="lewis_rxnarrows.svg"})),am(c,Promise.all(a));xd();Ic.style.visibility="visible";Te.style.visibility="visible";Ue.style.visibility="visible";Wb.style.visibility="visible";Ve.style.visibility=
"hidden";da&&(Wm.style.visibility="visible",Xm.style.visibility="visible");b=document.getElementsByClassName("but");od(100).then(function(){for(Bf=0;Bf<b.length;Bf++)b[Bf].style.visibility="visible"});c.aa=0})))})();Ra&&!ua&&setTimeout(xd,500);document.getElementById("buttonregion").addEventListener("mouseup",function(a){a||(a=window.event);a.preventDefault();a.stopPropagation();return!1},!1);document.getElementById("undo").addEventListener("click",function(){if("visible"===Zf.style.visibility)return!1;
Yc();Pj();document.getElementById("undo").blur()},!1);document.getElementById("clear").addEventListener("click",function(){if("visible"===Zf.style.visibility)return!1;Ga.clearRect(za.b+1,za.t+1,za.c-2,za.h-2);Yc();Ui();td(0);qd(0);be="X";document.getElementById("clear").blur()},!1);document.getElementById("smiles").addEventListener("click",function(){if("visible"===Zf.style.visibility)return!1;Yc();Tk();document.getElementById("smiles").blur()},!1);document.getElementById("sm2str").addEventListener("click",
function(){if("visible"===Yf.style.visibility)return!1;sm();document.getElementById("sm2str").blur()},!1);document.getElementById("help").addEventListener("click",function(){var a=window.screenX;Ec=window.open("help/MOSFECCS_Help.html","Structural Formula Editor Help","dependent=yes,scrollbars=yes,resizable=yes");Ec.resizeTo(900,900);Ec.moveTo(a-Ec.outerWidth-5,20);document.getElementById("help").blur()},!1);document.getElementById("shift").addEventListener("click",function(){10>zb?(zb+=10,document.getElementById("shift").className=
"shift selected"):(zb-=10,document.getElementById("shift").className="shift")},!1);document.getElementById("alt").addEventListener("click",function(){0===zb%2?(zb+=1,document.getElementById("alt").className="alt selected"):(--zb,document.getElementById("alt").className="alt")},!1)};
//END CODE TO COMPILE
   
    </script>
    <!-- end script2 -->
    <!-- script3 -->
    <script type="text/javascript">
      let drwCanv = window['drawCanvas'];
      drwCanv(pad,phone,app,arrows,helpWindow,{});
    </script>
    <!-- end script3 -->
  </body>
</html>
<!--END HTML-TERM-->
